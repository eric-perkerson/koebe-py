(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    958201,      22666]
NotebookOptionsPosition[    919418,      22102]
NotebookOutlinePosition[    919841,      22119]
CellTagsIndexPosition[    919798,      22116]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Electrical Networks", "Title",
 CellChangeTimes->{{3.6438948204253273`*^9, 3.643894823646573*^9}, {
  3.728305922216711*^9, 
  3.7283059307503853`*^9}},ExpressionUUID->"820cc094-bfce-40b6-b555-\
2af3e155142c"],

Cell["\<\
To run this program, you need the aCute software in the working directory. \
See https://www.cise.ufl.edu/~ungor/aCute/ for details.\
\>", "Text",
 CellChangeTimes->{{3.728394514580529*^9, 
  3.728394536578486*^9}},ExpressionUUID->"214a0f00-39e0-47e8-a191-\
a1b5c60de4d3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"<<", "NDSolve`FEM`"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "You", " ", "also", " ", "need", " ", "to", " ", "import", " ", "the", " ",
     "FEM", " ", 
    RowBox[{"(", 
     RowBox[{"Finite", " ", "Elements", " ", "Method"}], ")"}], " ", 
    "package"}], " ", "*)"}]}], "\n", 
 RowBox[{"<<", "CompiledFunctionTools`", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "REMOVE", " ", "THIS", " ", "WHEN", " ", "PROGRAM", " ", "IS", " ", 
    "COMPLETED"}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.735246309020199*^9, 3.7352463218388643`*^9}, {
  3.7376913262983437`*^9, 3.737691326537682*^9}, {3.7452496068963003`*^9, 
  3.745249610655829*^9}},
 CellLabel->
  "In[601]:=",ExpressionUUID->"46a926a4-9ae1-48db-9962-4c38b4a51137"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Set", " ", "directory", " ", "to", " ", "where", " ", "the", " ", "aCute",
     " ", "program", " ", 
    RowBox[{"is", "."}]}], " ", "*)"}], "\[IndentingNewLine]", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
    "SetDirectory", "[", 
     "\"\</Users/eric/Google Drive/Research/Electrical Networks\>\"", "]"}], 
    ";"}], " ", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "SetDirectory", "[", "\"\</Users/saarhersonsky/Desktop/Acute/\>\"", 
      "]"}], ";"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"SetDirectory", "[", "\"\</Users/eric/Desktop\>\"", "]"}], ";"}],
     "*)"}], " "}]}]], "Input",
 CellChangeTimes->{{3.728400717230047*^9, 3.728400727611829*^9}, {
   3.728475471789323*^9, 3.728475482108534*^9}, {3.7289888587412987`*^9, 
   3.728988866454967*^9}, {3.728989353119196*^9, 3.728989353292118*^9}, {
   3.730815887954803*^9, 3.7308158910958853`*^9}, {3.732016786903759*^9, 
   3.73201680227008*^9}, {3.732024396143121*^9, 3.7320244081649933`*^9}, {
   3.73219477281083*^9, 3.73219478446957*^9}, {3.732896124830665*^9, 
   3.732896132671524*^9}, {3.733664343336049*^9, 3.7336643514915037`*^9}, {
   3.73408732768524*^9, 3.734087338407802*^9}, 3.735136149883816*^9, {
   3.735576081280634*^9, 3.735576081573374*^9}, {3.761011259116796*^9, 
   3.761011259766757*^9}, {3.809373935327631*^9, 3.809373936717534*^9}, {
   3.848744272330344*^9, 3.8487442755013123`*^9}, {3.867458620584437*^9, 
   3.867458625085918*^9}},
 CellLabel->
  "In[603]:=",ExpressionUUID->"e5c8f4aa-c9e2-4145-b97c-6724213e0e5c"],

Cell[CellGroupData[{

Cell["Function Definitions", "Section",
 CellChangeTimes->{{3.6439836552039223`*^9, 
  3.643983657706305*^9}},ExpressionUUID->"2bf113dc-25ce-41fb-8ead-\
2d332d0ac6b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReadPolyFile", "[", "fileName_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "txtFile", ",", "rawNode", ",", "lines", ",", "parsedNodeHeader", ",", 
      "parsedNodeLines", ",", "parsedEdgeHeader", ",", "numEdges", ",", 
      "parsedEdgeLines", ",", "parsedHoleHeader", ",", "numHoles", ",", 
      "parsedHoleLines", ",", "edges", ",", "pointsInHoles", ",", 
      "coordinates", ",", "bdryMarkers", ",", "numVertices"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"txtFile", "=", 
      RowBox[{"fileName", " ", "<>", " ", "\"\<.txt\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "[", "txtFile", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FileExistsQ", "[", "fileName", "]"}], ",", 
         RowBox[{
          RowBox[{"CopyFile", "[", 
           RowBox[{"fileName", ",", "txtFile"}], "]"}], ";"}], ",", 
         RowBox[{"Print", "[", "\"\<File not found\>\"", "]"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"rawNode", " ", "=", " ", 
      RowBox[{"Import", "[", "txtFile", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lines", "=", 
      RowBox[{"StringSplit", "[", 
       RowBox[{"rawNode", ",", "\"\<\\n\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"parsedNodeHeader", "=", 
      RowBox[{"ToExpression", "@", 
       RowBox[{"StringSplit", "[", 
        RowBox[{"lines", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numVertices", "=", 
      RowBox[{"parsedNodeHeader", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"parsedNodeLines", "=", 
      RowBox[{"ToExpression", "@", 
       RowBox[{"(", 
        RowBox[{"StringSplit", "@", 
         RowBox[{"lines", "[", 
          RowBox[{"[", 
           RowBox[{"2", ";;", 
            RowBox[{"numVertices", "+", "1"}]}], "]"}], "]"}]}], ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"parsedEdgeHeader", "=", 
      RowBox[{"ToExpression", "@", 
       RowBox[{"StringSplit", "[", 
        RowBox[{"lines", "[", 
         RowBox[{"[", 
          RowBox[{"numVertices", "+", "2"}], "]"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numEdges", "=", 
      RowBox[{"parsedEdgeHeader", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"parsedEdgeLines", "=", 
      RowBox[{"ToExpression", "@", 
       RowBox[{"(", 
        RowBox[{"StringSplit", "@", 
         RowBox[{"lines", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"numVertices", "+", "3"}], ";;", 
            RowBox[{"numVertices", "+", "numEdges", "+", "2"}]}], "]"}], 
          "]"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"parsedHoleHeader", "=", 
      RowBox[{"ToExpression", "@", 
       RowBox[{"StringSplit", "[", 
        RowBox[{"lines", "[", 
         RowBox[{"[", 
          RowBox[{"numVertices", "+", "numEdges", "+", "3"}], "]"}], "]"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"numHoles", "=", 
      RowBox[{"parsedHoleHeader", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"parsedHoleLines", "=", 
      RowBox[{"ToExpression", "@", 
       RowBox[{"(", 
        RowBox[{"StringSplit", "@", 
         RowBox[{"lines", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"numVertices", "+", "numEdges", "+", "4"}], ";;", 
            RowBox[{
            "numVertices", "+", "numEdges", "+", "numHoles", "+", "3"}]}], 
           "]"}], "]"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"coordinates", "=", 
      RowBox[{"parsedNodeLines", "[", 
       RowBox[{"[", 
        RowBox[{";;", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bdryMarkers", "=", 
      RowBox[{"parsedNodeLines", "[", 
       RowBox[{"[", 
        RowBox[{";;", ",", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"edges", "=", 
      RowBox[{"parsedEdgeLines", "[", 
       RowBox[{"[", 
        RowBox[{";;", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pointsInHoles", "=", 
      RowBox[{"parsedHoleLines", "[", 
       RowBox[{"[", 
        RowBox[{";;", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{"numVertices", "==", 
       RowBox[{"Length", "[", "coordinates", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DeleteFile", "[", "txtFile", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
       "coordinates", ",", " ", "bdryMarkers", ",", "edges", ",", 
        "pointsInHoles"}], "}"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.848686293774173*^9, 3.848686318439151*^9}, {
   3.848686992471545*^9, 3.8486871179814777`*^9}, {3.8486872072474747`*^9, 
   3.848687214481008*^9}, {3.848687423609394*^9, 3.848687426303817*^9}, 
   3.848687490059025*^9, {3.848689029969891*^9, 3.8486890724399137`*^9}, {
   3.848689113974612*^9, 3.848689115054943*^9}, {3.848689151128611*^9, 
   3.848689188879228*^9}, {3.848699405774214*^9, 3.848699435664385*^9}, {
   3.848699490501646*^9, 3.848699497606073*^9}, {3.848700219847085*^9, 
   3.848700379946827*^9}, {3.848700488344747*^9, 3.84870051796351*^9}, 
   3.848700630307024*^9, {3.8487044018179092`*^9, 3.8487044023635387`*^9}, {
   3.848704502495591*^9, 3.8487046889341393`*^9}, {3.848704768525096*^9, 
   3.848704773801414*^9}, {3.848704876715167*^9, 3.8487048783186197`*^9}},
 CellLabel->
  "In[459]:=",ExpressionUUID->"325c2960-1fa0-4c31-9c0b-c4501cb066e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReadNodeFile", "[", "fileName_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "txtFile", ",", "rawNode", ",", "lines", ",", "parsedHeader", ",", 
      "parsedLines", ",", "coordinates", ",", "bdryMarkers", ",", 
      "numVertices"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"txtFile", "=", 
      RowBox[{"fileName", " ", "<>", " ", "\"\<.txt\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "[", "txtFile", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FileExistsQ", "[", "fileName", "]"}], ",", 
         RowBox[{
          RowBox[{"CopyFile", "[", 
           RowBox[{"fileName", ",", "txtFile"}], "]"}], ";"}], ",", 
         RowBox[{"Print", "[", "\"\<File not found\>\"", "]"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"rawNode", " ", "=", " ", 
      RowBox[{"Import", "[", "txtFile", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lines", "=", 
      RowBox[{"StringSplit", "[", 
       RowBox[{"rawNode", ",", "\"\<\\n\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"parsedHeader", "=", 
      RowBox[{"ToExpression", "@", 
       RowBox[{"StringSplit", "[", 
        RowBox[{"lines", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"parsedLines", "=", 
      RowBox[{"ToExpression", "@", 
       RowBox[{"(", 
        RowBox[{"StringSplit", "@", 
         RowBox[{"lines", "[", 
          RowBox[{"[", 
           RowBox[{"2", ";;"}], "]"}], "]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"coordinates", "=", 
      RowBox[{"parsedLines", "[", 
       RowBox[{"[", 
        RowBox[{";;", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bdryMarkers", "=", 
      RowBox[{"parsedLines", "[", 
       RowBox[{"[", 
        RowBox[{";;", ",", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"numVertices", "=", 
      RowBox[{"parsedHeader", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{"numVertices", "==", 
       RowBox[{"Length", "[", "coordinates", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DeleteFile", "[", "txtFile", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"coordinates", ",", " ", "bdryMarkers"}], "}"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.848686293774173*^9, 3.848686318439151*^9}, {
   3.848686992471545*^9, 3.8486871179814777`*^9}, {3.8486872072474747`*^9, 
   3.848687214481008*^9}, {3.848687423609394*^9, 3.848687426303817*^9}, 
   3.848687490059025*^9, {3.848689029969891*^9, 3.8486890724399137`*^9}, {
   3.848689113974612*^9, 3.848689115054943*^9}, {3.848689151128611*^9, 
   3.848689188879228*^9}, {3.848699405774214*^9, 3.848699435664385*^9}, {
   3.848699490501646*^9, 3.848699497606073*^9}, {3.848700219847085*^9, 
   3.848700379946827*^9}, {3.848700488344747*^9, 3.84870051796351*^9}, 
   3.848700630307024*^9},
 CellLabel->
  "In[460]:=",ExpressionUUID->"f9411da3-6737-4fbb-8671-ab262c59245c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReadEleFile", "[", "fileName_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "txtFile", ",", "rawEle", ",", "lines", ",", "parsedHeader", ",", 
      "parsedLines", ",", "triangles", ",", "numTriangles"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"txtFile", "=", 
      RowBox[{"fileName", " ", "<>", " ", "\"\<.txt\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "[", "txtFile", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FileExistsQ", "[", "fileName", "]"}], ",", 
         RowBox[{
          RowBox[{"CopyFile", "[", 
           RowBox[{"fileName", ",", "txtFile"}], "]"}], ";"}], ",", 
         RowBox[{"Print", "[", "\"\<File not found\>\"", "]"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"rawEle", " ", "=", " ", 
      RowBox[{"Import", "[", "txtFile", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lines", "=", 
      RowBox[{"StringSplit", "[", 
       RowBox[{"rawEle", ",", "\"\<\\n\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"parsedHeader", "=", 
      RowBox[{"ToExpression", "@", 
       RowBox[{"StringSplit", "[", 
        RowBox[{"lines", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"parsedLines", "=", 
      RowBox[{"ToExpression", "@", 
       RowBox[{"(", 
        RowBox[{"StringSplit", "@", 
         RowBox[{"lines", "[", 
          RowBox[{"[", 
           RowBox[{"2", ";;"}], "]"}], "]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"triangles", "=", 
      RowBox[{"parsedLines", "[", 
       RowBox[{"[", 
        RowBox[{";;", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numTriangles", "=", 
      RowBox[{"parsedHeader", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{"numTriangles", "==", 
       RowBox[{"Length", "[", "triangles", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DeleteFile", "[", "txtFile", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "triangles", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.848689203123253*^9, 3.848689213931913*^9}, {
   3.848689271516617*^9, 3.848689306571257*^9}, {3.848700482254942*^9, 
   3.84870051300963*^9}, 3.848700628248979*^9, {3.848705338784684*^9, 
   3.848705339059197*^9}},
 CellLabel->
  "In[461]:=",ExpressionUUID->"a8b09301-c7d2-4d07-8336-560e7f2546f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"readData", "[", "fullFileStem_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "regionCoordinates", ",", "regionBdryMarkers", ",", "regionEdges", ",", 
      "pointsToDeviateForOmega0", ",", "pointsInHoles", ",", "coordinates", 
      ",", "bdryMarkers", ",", "triangles", ",", "topology", ",", 
      "omega0Seq"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "regionCoordinates", ",", "regionBdryMarkers", ",", "regionEdges", ",",
         "pointsInHoles"}], "}"}], "=", 
      RowBox[{"ReadPolyFile", "[", 
       RowBox[{"fullFileStem", "<>", "\"\<.poly\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"coordinates", ",", "bdryMarkers"}], "}"}], "=", 
      RowBox[{"ReadNodeFile", "[", 
       RowBox[{"fullFileStem", "<>", "\"\<.node\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"triangles", "=", 
      RowBox[{"ReadEleFile", "[", 
       RowBox[{"fullFileStem", "<>", "\"\<.ele\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"topology", "=", 
      RowBox[{"ReadEleFile", "[", 
       RowBox[{"fullFileStem", "<>", "\"\<.topo.ele\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"pointsInHoles", ",", 
       RowBox[{"pointsInHoles", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Modify", " ", "pointsInHoles", " ", "to", " ", "include", " ", "an", 
       " ", "extra", " ", "copy", " ", "of", " ", "the", " ", "last", " ", 
       "hole"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
       "regionCoordinates", ",", "regionBdryMarkers", ",", "regionEdges", ",",
         "pointsInHoles", ",", "coordinates", ",", "bdryMarkers", ",", 
        "triangles", ",", "topology"}], "}"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.84870492452304*^9, 3.8487051521982822`*^9}, {
  3.8487110022316628`*^9, 3.84871101584798*^9}, {3.8487110480494747`*^9, 
  3.848711065945527*^9}, {3.848711620130672*^9, 3.848711753777343*^9}, {
  3.848711798898651*^9, 3.848711826505622*^9}},
 CellLabel->
  "In[462]:=",ExpressionUUID->"152c9bf9-f594-4c9a-95af-9636cd52651e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeRegionData", "[", 
   RowBox[{
   "regionCoordinates_", ",", "regionEdges_", ",", "pointsInHoles_", ",", 
    "epsilon_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "componentEndingVertices", ",", "regionBdryComponents", ",", 
      "exteriorVertices", ",", "interiorVerticesByHole", ",", "region", ",", 
      "regionSkeleton", ",", "nHoles", ",", "nClasses", ",", 
      "selectedInteriorBdryPoints", ",", "selectedExteriorBdryPoint", ",", 
      "omega0SeqInterior", ",", "omega0SeqExterior", ",", "omega0Seq"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"componentEndingVertices", "=", 
      RowBox[{
       RowBox[{"Flatten", "@", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"Differences", "@", 
           RowBox[{"regionEdges", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "2"}], "]"}], "]"}]}], ",", 
          RowBox[{"x_", "/;", 
           RowBox[{"x", "<", "0"}]}]}], "]"}]}], "+", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PrependTo", "[", 
      RowBox[{"componentEndingVertices", ",", "0"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"regionBdryComponents", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"componentEndingVertices", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "+", "1"}], ",", 
          RowBox[{"componentEndingVertices", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{
           RowBox[{"Length", "[", "componentEndingVertices", "]"}], "-", 
           "1"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"exteriorVertices", "=", 
      RowBox[{"regionBdryComponents", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"interiorVerticesByHole", "=", 
      RowBox[{"regionBdryComponents", "[", 
       RowBox[{"[", 
        RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"region", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nHoles", "==", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{"BoundaryMeshRegion", "[", 
         RowBox[{"regionVertices", ",", 
          RowBox[{"Line", "[", 
           RowBox[{"Append", "[", 
            RowBox[{"exteriorVertices", ",", 
             RowBox[{"exteriorVertices", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"interiorVerticesByHole", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"interiorVerticesByHole", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", 
           "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"BoundaryMeshRegion", "[", 
         RowBox[{"regionVertices", ",", 
          RowBox[{"Line", "[", 
           RowBox[{"Append", "[", 
            RowBox[{"exteriorVertices", ",", 
             RowBox[{"exteriorVertices", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"interiorVerticesByHole", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"interiorVerticesByHole", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", 
           "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"interiorVerticesByHole", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"interiorVerticesByHole", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", 
           "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"regionSkeleton", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"MeshCoordinates", "[", "region", "]"}], ",", " ", 
        RowBox[{"MeshCells", "[", 
         RowBox[{"region", ",", "1"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nHoles", "=", 
      RowBox[{"Length", "[", "interiorVerticesByHole", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nClasses", "=", 
      RowBox[{"nHoles", "+", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"selectedInteriorBdryPoints", "=", 
      RowBox[{"interiorVerticesByHole", "[", 
       RowBox[{"[", 
        RowBox[{";;", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"selectedExteriorBdryPoint", "=", 
      RowBox[{"exteriorVertices", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"omega0SeqInterior", "=", 
      RowBox[{
       RowBox[{"regionCoordinates", "[", 
        RowBox[{"[", "selectedInteriorBdryPoints", "]"}], "]"}], "+", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"epsilon", "*", 
            RowBox[{"#", "/", 
             RowBox[{"Norm", "[", "#", "]"}]}]}], ")"}], "&"}], ",", 
         RowBox[{
          RowBox[{"regionCoordinates", "[", 
           RowBox[{"[", "selectedInteriorBdryPoints", "]"}], "]"}], "-", 
          RowBox[{"pointsInHoles", "[", 
           RowBox[{"[", 
            RowBox[{";;", 
             RowBox[{"-", "2"}]}], "]"}], "]"}]}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"omega0SeqExterior", "=", 
      RowBox[{
       RowBox[{"regionCoordinates", "[", 
        RowBox[{"[", "selectedExteriorBdryPoint", "]"}], "]"}], "+", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"epsilon", "*", 
            RowBox[{"#", "/", 
             RowBox[{"Norm", "[", "#", "]"}]}]}], ")"}], "&"}], ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"regionCoordinates", "[", 
            RowBox[{"[", "selectedExteriorBdryPoint", "]"}], "]"}]}], "+", 
          RowBox[{"pointsInHoles", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"omega0Seq", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"omega0SeqInterior", ",", 
        RowBox[{"{", "omega0SeqExterior", "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
       "exteriorVertices", ",", "interiorVerticesByHole", ",", "region", ",", 
        "regionSkeleton", ",", "nHoles", ",", "nClasses", ",", "omega0Seq"}], 
       "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.848710592424036*^9, 3.8487106785333853`*^9}, {
   3.848710867126247*^9, 3.848710875406187*^9}, {3.848710926087431*^9, 
   3.8487109628953257`*^9}, {3.848711808653253*^9, 3.848711829007762*^9}, {
   3.848711866876266*^9, 3.8487118744491587`*^9}, {3.848711995240316*^9, 
   3.848712017312338*^9}, {3.848743755347443*^9, 3.8487439108247623`*^9}, {
   3.848744120773357*^9, 3.848744167230117*^9}, {3.8487448346281137`*^9, 
   3.848744858389563*^9}, 3.848746737123303*^9, {3.8487475887621803`*^9, 
   3.848747593037434*^9}},
 CellLabel->
  "In[463]:=",ExpressionUUID->"d73f0e29-e2a1-41b8-81f0-d347e123fe4b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ShowRegionSkeleton", "[", "regionSkeleton_", "]"}], ":=", 
  RowBox[{"Show", "[", 
   RowBox[{"Graphics", "/@", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"regionSkeleton", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], "&"}], ",", 
      RowBox[{"regionSkeleton", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], " ", "]"}]}]], "Input",
 CellChangeTimes->{{3.739218507808104*^9, 3.739218534065174*^9}},
 CellLabel->
  "In[464]:=",ExpressionUUID->"93d7b19d-adc5-4fdd-8cca-c613477e607f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ShowHoleNumbers", "[", "pointsInHoles_", "]"}], ":=", 
  RowBox[{"Show", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"ToString", "[", "i", "]"}], ",", 
        RowBox[{"pointsInHoles", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "pointsInHoles", "]"}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{3.809313540149629*^9},
 CellLabel->
  "In[465]:=",ExpressionUUID->"351bf80d-2618-4e11-a3bc-c5c597c2dd8e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FluxContributingEdgesCompiled", "::", "usage"}], "=", 
   "\"\<Find all edges that contribute terms to the expression for computing \
flux. vertices is a path to compute flux across, fValues is the value of f on \
all vertices in a triangulation T, singularHeight is the particular value of \
f to treat as the singular level curve's height.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FluxContributingEdgesCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vertices", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"fValues", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"singularHeight", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"vertexTopology", ",", "_Integer", ",", "2"}], "}"}]}], "}"}],
      ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "n", ",", "m", ",", "nContributingEdges", ",", "contributingEdges", 
         ",", "i", ",", "j", ",", "v"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "vertices", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"m", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"vertexTopology", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nContributingEdges", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"contributingEdges", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"m", "*", "n"}], "}"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", "n"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "1"}], ",", 
             RowBox[{"j", "\[LessEqual]", "m"}], ",", 
             RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"v", "=", 
               RowBox[{
                RowBox[{"vertexTopology", "[", 
                 RowBox[{"[", 
                  RowBox[{"vertices", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], "]"}], "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"v", "\[Equal]", "0"}], ",", 
                RowBox[{"Break", "[", "]"}]}], " ", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"fValues", "[", 
                   RowBox[{"[", "v", "]"}], "]"}], "<", "singularHeight"}], "&&", 
                 RowBox[{"!", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{"vertices", ",", " ", "v"}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"nContributingEdges", "=", 
                  RowBox[{"nContributingEdges", "+", "1"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"contributingEdges", "[", 
                   RowBox[{"[", "nContributingEdges", "]"}], "]"}], "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"vertices", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "v"}], "}"}]}], 
                 ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"contributingEdges", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "nContributingEdges"}], "]"}], "]"}], "]"}]}]}],
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.76347284485253*^9, 3.763472919735924*^9}, {
   3.76347295666395*^9, 3.763473183551231*^9}, {3.7634732681802473`*^9, 
   3.76347333086449*^9}, {3.763473516666404*^9, 3.7634736516914062`*^9}, {
   3.763473756243833*^9, 3.763473797416765*^9}, {3.76347382879298*^9, 
   3.763473833382948*^9}, {3.763474055673255*^9, 3.763474118515232*^9}, {
   3.763474214578257*^9, 3.76347422373543*^9}, {3.76347434915525*^9, 
   3.763474350265881*^9}, {3.763474607089212*^9, 3.7634746076989098`*^9}, {
   3.763475268734503*^9, 3.763475272929031*^9}, 3.763475452892292*^9, {
   3.763905267164502*^9, 3.763905296817589*^9}, {3.763905340910883*^9, 
   3.7639053875405493`*^9}, 3.7668560487580853`*^9},
 CellLabel->
  "In[466]:=",ExpressionUUID->"3d58766d-3a4f-47a7-8465-f416cc1d4907"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FluxOnTriangulation", "[", 
   RowBox[{
   "edges_", ",", "conductanceAssociation_", ",", "g_", ",", 
    "TCoordinates_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "result"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "edges", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"conductanceAssociation", "[", 
          RowBox[{"edges", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], "*", 
         RowBox[{"Abs", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"g", "@@", 
            RowBox[{"TCoordinates", "[", 
             RowBox[{"[", 
              RowBox[{"edges", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], " ", "]"}], "]"}]}], 
           " ", "-", "\[IndentingNewLine]", 
           RowBox[{"g", "@@", 
            RowBox[{"TCoordinates", "[", 
             RowBox[{"[", 
              RowBox[{"edges", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}], "  ", "]"}], "]"}]}]}],
           " ", "\[IndentingNewLine]", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Add", " ", "gsb", 
      RowBox[{"(", "omega0", ")"}], " ", "if", " ", "gsb", 
      RowBox[{"(", "omega0", ")"}]}], "\[NotEqual]", "0"}], " ", "*)"}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.762183640274768*^9, 3.762183656304472*^9}, {
  3.762183707519508*^9, 3.7621837461491137`*^9}, {3.762184202350212*^9, 
  3.762184224946743*^9}, {3.763431601504512*^9, 3.763431631906892*^9}, {
  3.763472402420637*^9, 3.763472410891406*^9}, {3.763475579604375*^9, 
  3.763475615655169*^9}, {3.763475680765918*^9, 3.763475685293713*^9}, {
  3.780416960559236*^9, 3.780416961973034*^9}},
 CellLabel->
  "In[468]:=",ExpressionUUID->"ac777f35-98e8-4c63-8c96-63ece606791e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StarPoints", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_"}], "}"}], ",", "r_", ",", "R_", ",", 
    "nCirclePoints_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Riffle", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"RotationMatrix", "[", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"Pi", "/", "nCirclePoints"}], ")"}]}], "]"}], ".", "#"}], 
        "&"}], ",", 
       RowBox[{"CirclePoints", "[", 
        RowBox[{"R", ",", " ", "nCirclePoints"}], "]"}]}], " ", "]"}], ",", 
     " ", 
     RowBox[{"CirclePoints", "[", 
      RowBox[{"r", ",", " ", "nCirclePoints"}], "]"}]}], "]"}], " ", "+", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nCirclePoints", "*", "2"}], "}"}]}], " ", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.766874365806485*^9, 3.766874436929791*^9}},
 CellLabel->
  "In[469]:=",ExpressionUUID->"796857fb-ea31-420f-895f-fb3a13d94537"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"GSB", "::", "usage"}], "=", 
    "\"\<New and improved \\\\overline{g^*} function computation\>\""}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GSB", "[", 
     RowBox[{
     "omega0_", ",", "omega_", ",", "conductanceAssociation_", ",", 
      "toRightOfEdgePolyAssociation_", ",", "g_", ",", "TCoordinates_", ",", 
      "LambdaGraph_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"gammaLambda", ",", "edges", ",", "n", ",", "gsb"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gammaLambda", " ", "=", " ", 
        RowBox[{"FindShortestPath", "[", 
         RowBox[{"LambdaGraph", ",", " ", "omega0", ",", " ", "omega"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"edges", " ", "=", " ", 
        RowBox[{"EdgesCompiled", "[", "gammaLambda", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"n", " ", "=", " ", 
        RowBox[{"Length", "[", "edges", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"gsb", "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"conductanceAssociation", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"toRightOfEdgePolyAssociation", "[", 
               RowBox[{"edges", "[", 
                RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], ",", 
              RowBox[{"toRightOfEdgePolyAssociation", "[", 
               RowBox[{"Reverse", "[", 
                RowBox[{"edges", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], " ", "]"}]}], 
             "}"}], "]"}], "*", 
           RowBox[{"(", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"g", "@@", 
              RowBox[{"TCoordinates", "[", 
               RowBox[{"[", 
                RowBox[{"toRightOfEdgePolyAssociation", "[", 
                 RowBox[{"edges", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], " ", "]"}], 
               "]"}]}], " ", "-", "\[IndentingNewLine]", 
             RowBox[{"g", "@@", 
              RowBox[{"TCoordinates", "[", 
               RowBox[{"[", 
                RowBox[{"toRightOfEdgePolyAssociation", "[", 
                 RowBox[{"Reverse", "[", 
                  RowBox[{"edges", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], " ", "]"}], 
                " ", "]"}], "]"}]}]}], " ", "\[IndentingNewLine]", ")"}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}]}], " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Add", " ", "gsb", 
        RowBox[{"(", "omega0", ")"}], " ", "if", " ", "gsb", 
        RowBox[{"(", "omega0", ")"}]}], "\[NotEqual]", "0"}], " ", "*)"}], 
     "\[IndentingNewLine]", "]"}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{3.761011262725294*^9},
 CellLabel->
  "In[470]:=",ExpressionUUID->"b68cea10-9bc7-4a86-8cc8-600f6b2f13b3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"VertexTopologyBuilderCompiled", "::", "usage"}], "=", 
   "\"\<Build a datastructure where the ith row is all vertices connected by \
an edge to vertex i\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VertexTopologyBuilderCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nVertices", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"edges", ",", "_Integer", ",", "2"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "nEdges", ",", "nNeighborsList", ",", "maxValenceInitial", ",", 
         "maxValenceActual", ",", "topology", ",", "i", ",", "v1", ",", 
         "v2"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nEdges", "=", 
         RowBox[{"Length", "[", "edges", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nNeighborsList", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "nVertices", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"maxValenceInitial", "=", "50"}], ";", "\[IndentingNewLine]", 
        RowBox[{"topology", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "nVertices", "}"}], ",", 
           RowBox[{"{", "maxValenceInitial", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", "nEdges"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"v1", "=", 
            RowBox[{"edges", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"v2", "=", 
            RowBox[{"edges", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nNeighborsList", "[", 
             RowBox[{"[", "v1", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"nNeighborsList", "[", 
              RowBox[{"[", "v1", "]"}], "]"}], "+", "1"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nNeighborsList", "[", 
             RowBox[{"[", "v2", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"nNeighborsList", "[", 
              RowBox[{"[", "v2", "]"}], "]"}], "+", "1"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"topology", "[", 
             RowBox[{"[", 
              RowBox[{"v1", ",", 
               RowBox[{"nNeighborsList", "[", 
                RowBox[{"[", "v1", "]"}], "]"}]}], " ", "]"}], "]"}], "=", 
            "v2"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"topology", "[", 
             RowBox[{"[", 
              RowBox[{"v2", ",", 
               RowBox[{"nNeighborsList", "[", 
                RowBox[{"[", "v2", "]"}], "]"}]}], " ", "]"}], "]"}], "=", 
            "v1"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"maxValenceActual", "=", 
         RowBox[{"Max", "[", "nNeighborsList", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"topology", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", ";;", "nVertices"}], ",", 
            RowBox[{"1", ";;", "maxValenceActual"}]}], "]"}], "]"}], " ", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.745833097204625*^9, 3.745833102258787*^9}, {
  3.745833427039609*^9, 3.745833467104875*^9}, {3.745833723203595*^9, 
  3.7458338241102247`*^9}, {3.745833859878974*^9, 3.745834061662479*^9}, {
  3.745834111394577*^9, 3.7458341125674047`*^9}, {3.745839695347856*^9, 
  3.745839721050723*^9}, {3.745839942053253*^9, 3.7458399868046417`*^9}, {
  3.745842531211193*^9, 3.745842532801426*^9}, {3.745854594215535*^9, 
  3.745854637071495*^9}, {3.745854723771*^9, 3.745854855955125*^9}, {
  3.7458549376276207`*^9, 3.745854963654149*^9}, {3.745855013045835*^9, 
  3.745855074144535*^9}, {3.745855118865286*^9, 3.745855173074931*^9}, {
  3.745855220204376*^9, 3.745855316523275*^9}},
 CellLabel->
  "In[471]:=",ExpressionUUID->"4e8fbfa8-4e74-421a-9256-3d7da416f586"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NeighborsCompiled", "::", "usage"}], "=", 
   "\"\<Take a vertex and a triangulation and return all vertices in the \
triangulation that are neighbors of the given vertex\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NeighborsCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vertex", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"edges", ",", "_Integer", ",", "2"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "n", ",", "neighbors", ",", "nNeighbors", ",", "i", ",", "result"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "edges", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"neighbors", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "n", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nNeighbors", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", "n"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"edges", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[Equal]", "vertex"}],
              ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"nNeighbors", "=", 
               RowBox[{"nNeighbors", "+", "1"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"neighbors", "[", 
                RowBox[{"[", "nNeighbors", "]"}], "]"}], "=", 
               RowBox[{"edges", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"edges", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}], "\[Equal]", "vertex"}],
              ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"nNeighbors", "=", 
               RowBox[{"nNeighbors", "+", "1"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"neighbors", "[", 
                RowBox[{"[", "nNeighbors", "]"}], "]"}], "=", 
               RowBox[{"edges", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"result", "=", 
         RowBox[{"neighbors", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "nNeighbors"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "result", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.745833097204625*^9, 3.745833102258787*^9}, {
  3.745833427039609*^9, 3.745833467104875*^9}, {3.745833723203595*^9, 
  3.7458338241102247`*^9}, {3.745833859878974*^9, 3.745834061662479*^9}, {
  3.745834111394577*^9, 3.7458341125674047`*^9}},
 CellLabel->
  "In[473]:=",ExpressionUUID->"511bb80d-e2fc-460b-965a-be8affdafffd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NeighborsOrderedCompiled", "::", "usage"}], "=", 
   "\"\<Take an interior vertex and a vertexTopology and return all vertices \
in the triangulation that are neighbors of the given vertex in either \
counterclockwise or clockwise order. Will fail SILENTLY on boundary vertices.\
\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NeighborsOrderedCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vertex", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"vertexTopology", ",", "_Integer", ",", "2"}], "}"}]}], "}"}],
      ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "maxValence", ",", "n", ",", "neighbors", ",", "nNeighbors", ",", "i",
          ",", "j", ",", "result", ",", "neighborsExtended"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"maxValence", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"vertexTopology", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"neighborsExtended", " ", "=", " ", 
         RowBox[{"vertexTopology", "[", 
          RowBox[{"[", "vertex", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nNeighbors", "=", "maxValence"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"j", "\[LessEqual]", "maxValence"}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"neighborsExtended", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"nNeighbors", "=", 
               RowBox[{"j", "-", "1"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"Break", "[", "]"}], ";"}], "\[IndentingNewLine]", 
             ","}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"neighbors", " ", "=", " ", 
         RowBox[{"neighborsExtended", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "nNeighbors"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"result", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "nNeighbors", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"result", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "=", 
         RowBox[{"neighbors", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "There", " ", "will", " ", "always", " ", "be", " ", "two", " ", 
           "intersections", " ", "between", " ", "two", " ", "rings", " ", 
           "of", " ", 
           RowBox[{"neighbors", ".", " ", "In"}], " ", "the", " ", "first", 
           " ", "iteration"}], ",", " ", 
          RowBox[{"pick", " ", "one", " ", "arbitrarily"}], ",", " ", 
          RowBox[{"since", " ", "we", " ", 
           RowBox[{"don", "'"}], "t", " ", "care", " ", "if", " ", 
           "counterclockwise", " ", "or", " ", 
           RowBox[{"clockwise", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"j", "\[LessEqual]", "maxValence"}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"neighbors", ",", 
               RowBox[{"vertexTopology", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"result", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "j"}], "]"}], "]"}]}],
               " ", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"result", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "=", 
               RowBox[{"vertexTopology", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"result", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "j"}], "]"}], "]"}]}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"Break", "[", "]"}], ";"}], "\[IndentingNewLine]", 
             ","}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Now", " ", "continue", " ", "chaining", " ", "together", " ", 
          "elements", " ", "of", " ", "neighbors", " ", "connected", " ", 
          "to", " ", "the", " ", "previously", " ", "added", " ", "element", 
          " ", "of", " ", "result"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "2"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"nNeighbors", "-", "1"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "1"}], ",", 
             RowBox[{"j", "\[LessEqual]", "maxValence"}], ",", 
             RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"neighbors", ",", 
                   RowBox[{"vertexTopology", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"result", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "j"}], "]"}], 
                    "]"}]}], " ", "]"}], " ", "&&", " ", 
                 RowBox[{
                  RowBox[{"vertexTopology", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"result", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "j"}], "]"}], "]"}], 
                  "\[NotEqual]", " ", 
                  RowBox[{"result", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"result", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", 
                  RowBox[{"vertexTopology", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"result", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "j"}], "]"}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"Break", "[", "]"}], ";"}], "\[IndentingNewLine]", 
                ","}], "\[IndentingNewLine]", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "result", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.745855808721946*^9, 3.745855863354199*^9}, {
   3.745856221688868*^9, 3.745856319436718*^9}, {3.745856509353573*^9, 
   3.7458565650740833`*^9}, {3.745856619051116*^9, 3.745856638876423*^9}, 
   3.746042332487146*^9, {3.746364155919948*^9, 3.746364194544442*^9}, {
   3.746364579904202*^9, 3.746364599195835*^9}, {3.74636466542176*^9, 
   3.746364666531582*^9}, {3.746364805332741*^9, 3.746364849042162*^9}, {
   3.74636490258414*^9, 3.746364929943478*^9}, {3.746365255625025*^9, 
   3.74636526822297*^9}, {3.74636537992597*^9, 3.7463653847170353`*^9}, {
   3.7463655800974083`*^9, 3.74636574578067*^9}, {3.746371741721463*^9, 
   3.746371752185219*^9}, {3.74637191156592*^9, 3.746371958903577*^9}, {
   3.746371998790783*^9, 3.746372033340456*^9}, {3.74637206750289*^9, 
   3.746372125440411*^9}, {3.746372181745438*^9, 3.746372271707611*^9}, {
   3.746382758909051*^9, 3.746382758999323*^9}, 3.74638278997397*^9, {
   3.746383118807585*^9, 3.746383118884026*^9}, {3.746386877969805*^9, 
   3.74638687814569*^9}},
 CellLabel->
  "In[475]:=",ExpressionUUID->"8658d419-c103-4ad7-8cfe-879d89a1b867"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TriangulationConnectedQCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"triangleList", ",", "_Integer", ",", "2"}], "}"}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "nTriangles", ",", "connectedClass", ",", "nAllVertices", ",", 
         "updatedFlag", ",", "i", ",", "alreadyUsed"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nTriangles", "=", 
         RowBox[{"Length", "[", "triangleList", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nAllVertices", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"Union", "[", 
           RowBox[{"Flatten", "[", "triangleList", "]"}], "]"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"connectedClass", "=", 
         RowBox[{"triangleList", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"alreadyUsed", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "nTriangles", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"alreadyUsed", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "=", "1"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"updatedFlag", "=", "True"}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{"updatedFlag", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"updatedFlag", "=", "False"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "connectedClass", "]"}], "\[Equal]", 
              "nAllVertices"}], ",", 
             RowBox[{"Return", "[", "True", "]"}], ","}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "1"}], ",", 
             RowBox[{"i", "\[LessEqual]", "nTriangles"}], ",", 
             RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"alreadyUsed", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "1"}], ",", 
                RowBox[{"Continue", "[", "]"}], ","}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"IntersectingQ", "[", 
                 RowBox[{"connectedClass", ",", 
                  RowBox[{"triangleList", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"connectedClass", "=", 
                  RowBox[{"Union", "[", 
                   RowBox[{"Join", "[", 
                    RowBox[{"connectedClass", ",", " ", 
                    RowBox[{"triangleList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}], " ", 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"alreadyUsed", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "=", "1"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"updatedFlag", "=", "True"}], ";"}], 
                "\[IndentingNewLine]", ","}], "\[IndentingNewLine]", "]"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "False", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.738108864847208*^9, 3.7381088867435713`*^9}, {
  3.738108941161612*^9, 3.738108973163282*^9}, {3.73810981999231*^9, 
  3.7381098278153763`*^9}, {3.738110313582646*^9, 3.7381103434464417`*^9}, {
  3.738110411858515*^9, 3.73811047009256*^9}, {3.738110922396978*^9, 
  3.73811094183449*^9}, {3.7381113185691442`*^9, 3.738111412332258*^9}, {
  3.7381116986136436`*^9, 3.738111741102565*^9}, {3.73811177834533*^9, 
  3.738111865579287*^9}, {3.7381118957162733`*^9, 3.738111928459979*^9}, {
  3.7381119860962467`*^9, 3.7381120373611803`*^9}, {3.738112105149522*^9, 
  3.738112116731906*^9}, {3.738112183431299*^9, 3.7381121973578978`*^9}},
 CellLabel->
  "In[477]:=",ExpressionUUID->"204699e0-6828-439b-a059-425d432ed716"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"NOT", " ", "COMPLETELY", " ", "COMPILED"}], " ", "*)"}], 
  RowBox[{
   RowBox[{"TriangulationConnectedComponentsCompiled", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"triangleList", ",", "_Integer", ",", "2"}], "}"}], "}"}], 
      ",", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "nTriangles", ",", "nAllVertices", ",", "updatedFlag", ",", "i", ",",
           "alreadyUsed", ",", "connectedClassList", ",", 
          "connectedClassLengths", ",", "nConnectedClasses", ",", 
          "terminate"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nTriangles", "=", 
          RowBox[{"Length", "[", "triangleList", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"nAllVertices", "=", 
            RowBox[{"Length", "[", 
             RowBox[{"Union", "[", 
              RowBox[{"Flatten", "[", "triangleList", "]"}], "]"}], "]"}]}], 
           ";"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"connectedClassList", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", "100", "}"}], ",", 
            RowBox[{"{", "nTriangles", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"connectedClassLengths", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", "100", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"nConnectedClasses", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"alreadyUsed", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", "nTriangles", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"terminate", "=", "False"}], ";", "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{"True", ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Find", " ", "a", " ", "starting", " ", "point", " ", "for", " ", 
             "a", " ", "new", " ", "connected", " ", "component"}], " ", 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"terminate", "=", "True"}], ";", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"i", "=", "1"}], ",", 
              RowBox[{"i", "\[LessEqual]", "nTriangles"}], ",", 
              RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"alreadyUsed", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"alreadyUsed", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=", "1"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"nConnectedClasses", "=", 
                   RowBox[{"nConnectedClasses", "+", "1"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"connectedClassList", "[", 
                    RowBox[{"[", 
                    RowBox[{"nConnectedClasses", ",", "1"}], "]"}], "]"}], 
                   "=", "i"}], ";", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"connectedClassLengths", "[", 
                    RowBox[{"[", "nConnectedClasses", "]"}], "]"}], "=", 
                   RowBox[{
                    RowBox[{"connectedClassLengths", "[", 
                    RowBox[{"[", "nConnectedClasses", "]"}], "]"}], "+", 
                    "1"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"terminate", "=", "False"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Break", "[", "]"}], ";"}], "\[IndentingNewLine]", 
                 ","}], "\[IndentingNewLine]", "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"terminate", ",", 
              RowBox[{
               RowBox[{"Break", "[", "]"}], ";"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"updatedFlag", "=", "True"}], ";", "\[IndentingNewLine]", 
            RowBox[{"While", "[", 
             RowBox[{"updatedFlag", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"updatedFlag", "=", "False"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"For", "[", 
                RowBox[{
                 RowBox[{"i", "=", "1"}], ",", 
                 RowBox[{"i", "\[LessEqual]", "nTriangles"}], ",", 
                 RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"alreadyUsed", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "1"}], ",", 
                    RowBox[{"Continue", "[", "]"}], ","}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"IntersectingQ", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"triangleList", "[", 
                    RowBox[{"[", 
                    RowBox[{"connectedClassList", "[", 
                    RowBox[{"[", 
                    RowBox[{"nConnectedClasses", ",", 
                    RowBox[{"1", ";;", 
                    RowBox[{"connectedClassLengths", "[", 
                    RowBox[{"[", "nConnectedClasses", "]"}], "]"}]}]}], " ", 
                    "]"}], "]"}], " ", "]"}], "]"}], " ", "]"}], ",", 
                    RowBox[{"triangleList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"alreadyUsed", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=", "1"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"connectedClassLengths", "[", 
                    RowBox[{"[", "nConnectedClasses", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"connectedClassLengths", "[", 
                    RowBox[{"[", "nConnectedClasses", "]"}], "]"}], "+", 
                    "1"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"connectedClassList", "[", 
                    RowBox[{"[", 
                    RowBox[{"nConnectedClasses", ",", 
                    RowBox[{"connectedClassLengths", "[", 
                    RowBox[{"[", "nConnectedClasses", "]"}], "]"}]}], " ", 
                    "]"}], "]"}], "=", "i"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"updatedFlag", "=", "True"}], ";"}], 
                    "\[IndentingNewLine]", ","}], "\[IndentingNewLine]", 
                   "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"connectedClassList", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "nConnectedClasses"}], "]"}], "]"}], " ", 
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.738108864847208*^9, 3.7381088867435713`*^9}, {
   3.738108941161612*^9, 3.738108973163282*^9}, {3.73810981999231*^9, 
   3.7381098278153763`*^9}, {3.738110313582646*^9, 3.7381103434464417`*^9}, {
   3.738110411858515*^9, 3.73811047009256*^9}, {3.738110922396978*^9, 
   3.73811094183449*^9}, {3.7381113185691442`*^9, 3.738111412332258*^9}, {
   3.7381116986136436`*^9, 3.738111741102565*^9}, {3.73811177834533*^9, 
   3.738111865579287*^9}, {3.7381118957162733`*^9, 3.738111928459979*^9}, {
   3.7381119860962467`*^9, 3.7381120373611803`*^9}, {3.738112105149522*^9, 
   3.738112116731906*^9}, {3.738112183431299*^9, 3.7381121973578978`*^9}, {
   3.7391189488314753`*^9, 3.739118972358156*^9}, {3.739119136980163*^9, 
   3.739119200574337*^9}, {3.739119304170188*^9, 3.7391193232667103`*^9}, {
   3.739120669984891*^9, 3.739120687088436*^9}, {3.7391207905405903`*^9, 
   3.739120911160635*^9}, {3.7391211544827967`*^9, 3.739121168282118*^9}, {
   3.73912121307522*^9, 3.73912121465158*^9}, {3.739121270709395*^9, 
   3.73912127961322*^9}, {3.739121414018592*^9, 3.739121576223816*^9}, {
   3.7391221353063507`*^9, 3.73912213548225*^9}, {3.739122440334182*^9, 
   3.739122569346013*^9}, {3.7391226249469337`*^9, 3.739122629195216*^9}, {
   3.7391226773970213`*^9, 3.739122823273917*^9}, {3.7391292531927834`*^9, 
   3.739129264564938*^9}, {3.739129825908884*^9, 3.739129831914009*^9}, 
   3.739131781295487*^9},
 CellLabel->
  "In[478]:=",ExpressionUUID->"9e5e84a4-7ad0-4186-8bb5-c7a5617f2e19"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TriangulationConnectedComponents", "[", "triangleList_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"struct", ",", "connectedComponents"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"struct", "=", 
      RowBox[{
      "TriangulationConnectedComponentsCompiled", "[", "triangleList", 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"connectedComponents", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"struct", ",", "0", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.739132840783499*^9, 3.7391329016987343`*^9}, {
  3.739132954956407*^9, 3.739132974925479*^9}, {3.7392020529758883`*^9, 
  3.7392020538211737`*^9}, {3.750084711412717*^9, 3.7500847138558187`*^9}},
 CellLabel->
  "In[479]:=",ExpressionUUID->"f1f948c3-da1c-48c0-98d8-f88ec16ffa97"],

Cell[BoxData[
 RowBox[{
  RowBox[{"IndexFunction", "[", 
   RowBox[{"vertex_", ",", "vertexTopology_", ",", "coordinates_"}], "]"}], ":=", 
  RowBox[{"SignChanges", "[", 
   RowBox[{
    RowBox[{"f", "@@@", 
     RowBox[{"coordinates", "[", 
      RowBox[{"[", 
       RowBox[{"NeighborsOrderedCompiled", "[", 
        RowBox[{"vertex", ",", "vertexTopology"}], " ", "]"}], " ", "]"}], 
      "]"}]}], ",", 
    RowBox[{"f", "@@", 
     RowBox[{"coordinates", "[", 
      RowBox[{"[", "vertex", "]"}], "]"}]}]}], " ", "]"}]}]], "Input",
 CellChangeTimes->{{3.745837622399403*^9, 3.745837625197949*^9}, {
  3.745837685699431*^9, 3.7458376963123407`*^9}, {3.7458377519170113`*^9, 
  3.745837758841899*^9}, {3.746383222286951*^9, 3.746383225890642*^9}, {
  3.7463833387319717`*^9, 3.746383439491961*^9}},
 CellLabel->
  "In[480]:=",ExpressionUUID->"1c54dea0-ef0f-405d-ba97-9ad44bdca263"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SignChanges", "::", "usage"}], " ", "=", " ", 
   "\"\<SignChanges[{{list,_Real,1},{value,_Real}}] returns the number of \
sign changes in the looped vector {list[[1]]-value, list[[2]]-value, ..., \
list[[n]]-value, list[[1]]-value}.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SignChanges", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"list", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"value", ",", "_Real"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"result", ",", "n", ",", "i"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"result", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"n", "-", "1"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Sign", "[", 
               RowBox[{
                RowBox[{"list", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "-", "value"}], "]"}], 
              "\[NotEqual]", " ", 
              RowBox[{"Sign", "[", 
               RowBox[{
                RowBox[{"list", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", "value"}], 
               "]"}]}], ",", 
             RowBox[{"result", "=", 
              RowBox[{"result", "+", "1"}]}], ","}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Sign", "[", 
            RowBox[{
             RowBox[{"list", "[", 
              RowBox[{"[", "n", "]"}], "]"}], "-", "value"}], "]"}], 
           "\[NotEqual]", " ", 
           RowBox[{"Sign", "[", 
            RowBox[{
             RowBox[{"list", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "value"}], "]"}]}], ",", 
          RowBox[{"result", "=", 
           RowBox[{"result", "+", "1"}]}], ","}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "result", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.745249830757349*^9, 3.745249894535564*^9}, {
  3.745249940065094*^9, 3.745249968525516*^9}, {3.7452500082062893`*^9, 
  3.7452500177810163`*^9}, {3.745250090850225*^9, 3.745250136201038*^9}, {
  3.745250186833494*^9, 3.7452501891630898`*^9}, {3.745250248108746*^9, 
  3.745250509442521*^9}, {3.7452505787342157`*^9, 3.745250593459134*^9}, {
  3.745250699815168*^9, 3.745250787391428*^9}},
 CellLabel->
  "In[481]:=",ExpressionUUID->"d2228eca-cd12-4a4d-842d-1160b71e4c99"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PointToRightOfLineCompiled", "::", "usage"}], " ", "=", " ", 
   "\"\<PointToRightOfLineCompiled[{tailX, _Real},{tailY, _Real},{headX, \
_Real},{headY, _Real},{pointX, _Real},{pointY, _Real}] returns True if the \
point (pointX, pointY) is to the right of the oriented line from (tail) to \
(head).\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"PointToRightOfLineCompiled", " ", "=", " ", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tailX", ",", " ", "_Real"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"tailY", ",", " ", "_Real"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"headX", ",", " ", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"headY", ",", " ", "_Real"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"pointX", ",", " ", "_Real"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"pointY", ",", " ", "_Real"}], "}"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"headY", " ", "-", " ", "tailY"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"pointX", " ", "-", " ", "tailX"}], ")"}]}], " ", "-", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"headX", " ", "-", " ", "tailX"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"pointY", " ", "-", " ", "tailY"}], ")"}]}]}], ">", " ", 
      "0"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.735000951982658*^9, 3.735001019463541*^9}, 
   3.735045874123818*^9, 3.735404210805623*^9},
 CellLabel->
  "In[483]:=",ExpressionUUID->"24f250fe-ee3c-4e1d-9c59-c0c95a8204dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PolygonalAnnulus", "[", 
   RowBox[{"n_", ",", " ", "innerRadius_", ",", " ", 
    RowBox[{"outerRadius_", ":", "1"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "points", ",", " ", "extV", ",", " ", "intV", ",", " ", "vertices"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"points", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"2", "*", "Pi", "*", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", " ", "-", " ", "1"}], ")"}], "/", "n"}]}], " ", 
             "+", " ", 
             RowBox[{"Pi", "/", "2"}]}], "]"}], "]"}], ",", " ", 
          RowBox[{"N", "[", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"2", "*", "Pi", "*", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", " ", "-", " ", "1"}], ")"}], "/", "n"}]}], " ", 
             "+", " ", 
             RowBox[{"Pi", "/", "2"}]}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"extV", " ", "=", 
      RowBox[{"outerRadius", "*", "points"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"intV", " ", "=", " ", 
      RowBox[{"innerRadius", "*", "points"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vertices", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{"extV", ",", " ", "intV"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"vertices", ",", " ", 
        RowBox[{"Range", "[", "n", "]"}], ",", 
        RowBox[{"n", " ", "+", 
         RowBox[{"Range", "[", "n", "]"}]}]}], "}"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7283166049010077`*^9, 3.728316684176399*^9}, {
  3.7283186864156437`*^9, 3.7283187416828117`*^9}, {3.728319514545087*^9, 
  3.7283196610432653`*^9}, {3.728319790865436*^9, 3.728319878035919*^9}, {
  3.728319916437113*^9, 3.728320047508766*^9}},
 CellLabel->
  "In[485]:=",ExpressionUUID->"f598925e-f141-424a-a420-071279d45be0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PolygonPathToVertexPathCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"facesPath", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"paddedPolygonization", ",", "_Integer", ",", "2"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"innerRingVertices", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"outerRingVertices", ",", "_Integer", ",", "1"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "nPathPolygons", ",", "nPolygons", ",", "maxPolygonLength", ",", 
         "nextPolygon", ",", "currentVertex", ",", "nextVertex", ",", 
         "vertexPath", ",", "nVertexPath", ",", "currentPolygonIndex", ",", 
         "currentPolygon", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nPathPolygons", "=", 
         RowBox[{"Length", "[", "facesPath", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nPolygons", "=", 
         RowBox[{"Length", "[", "paddedPolygonization", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"maxPolygonLength", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"paddedPolygonization", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"currentPolygon", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "maxPolygonLength", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nextPolygon", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "maxPolygonLength", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"currentVertex", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"nextVertex", "=", "2"}], ";", "\[IndentingNewLine]", 
        RowBox[{"nVertexPath", "=", "2"}], ";", "\[IndentingNewLine]", 
        RowBox[{"vertexPath", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"maxPolygonLength", "*", "nPathPolygons"}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "For", " ", "first", " ", "polygon", " ", "in", " ", "facesPath"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"currentPolygonIndex", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"currentPolygon", "=", 
         RowBox[{"paddedPolygonization", "[", 
          RowBox[{"[", 
           RowBox[{"facesPath", "[", 
            RowBox[{"[", "currentPolygonIndex", "]"}], "]"}], " ", "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"innerRingVertices", ",", 
               RowBox[{"currentPolygon", "[", 
                RowBox[{"[", "currentVertex", "]"}], "]"}]}], " ", "]"}], "&&", 
             RowBox[{"!", 
              RowBox[{"MemberQ", "[", 
               RowBox[{"innerRingVertices", ",", 
                RowBox[{"currentPolygon", "[", 
                 RowBox[{"[", "nextVertex", "]"}], "]"}]}], " ", "]"}]}]}], 
            ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"currentVertex", "=", "nextVertex"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"currentVertex", "\[Equal]", "maxPolygonLength"}], "||", 
              RowBox[{
               RowBox[{"currentPolygon", "[", 
                RowBox[{"[", 
                 RowBox[{"currentVertex", "+", "1"}], "]"}], "]"}], 
               "\[Equal]", "0"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"nextVertex", "=", "1"}], ",", "\[IndentingNewLine]", 
             RowBox[{"nextVertex", "=", 
              RowBox[{"currentVertex", "+", "1"}]}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"vertexPath", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "=", 
         RowBox[{"currentPolygon", "[", 
          RowBox[{"[", "currentVertex", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"vertexPath", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "=", 
         RowBox[{"currentPolygon", "[", 
          RowBox[{"[", "nextVertex", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"currentVertex", "=", "nextVertex"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "For", " ", "intermediate", " ", "polygons", " ", "in", " ", 
          "facesPath"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"currentPolygonIndex", "=", "1"}], ",", 
          RowBox[{"currentPolygonIndex", "<", "nPathPolygons"}], ",", 
          RowBox[{"currentPolygonIndex", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"currentPolygon", "=", 
            RowBox[{"paddedPolygonization", "[", 
             RowBox[{"[", 
              RowBox[{"facesPath", "[", 
               RowBox[{"[", "currentPolygonIndex", "]"}], "]"}], " ", "]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"nextPolygon", "=", 
            RowBox[{"paddedPolygonization", "[", 
             RowBox[{"[", 
              RowBox[{"facesPath", "[", 
               RowBox[{"[", 
                RowBox[{"currentPolygonIndex", "+", "1"}], "]"}], "]"}], " ", 
              "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Traverse", " ", "new", " ", "polygon", " ", "until", " ", 
             "position", " ", "lines", " ", "up", " ", "with", " ", 
             "vertexPath"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"vertexPath", "[", 
               RowBox[{"[", "nVertexPath", "]"}], "]"}], "\[NotEqual]", 
              RowBox[{"currentPolygon", "[", 
               RowBox[{"[", "currentVertex", "]"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"currentVertex", "=", "nextVertex"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"currentVertex", "\[Equal]", "maxPolygonLength"}], "||", 
                 RowBox[{
                  RowBox[{"currentPolygon", "[", 
                   RowBox[{"[", 
                    RowBox[{"currentVertex", "+", "1"}], "]"}], "]"}], 
                  "\[Equal]", "0"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"nextVertex", "=", "1"}], ",", "\[IndentingNewLine]", 
                RowBox[{"nextVertex", "=", 
                 RowBox[{"currentVertex", "+", "1"}]}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "Now", " ", "that", " ", "alignment", " ", "is", " ", "done"}], 
             ",", " ", 
             RowBox[{
             "traverse", " ", "polygon", " ", "while", " ", "adding", " ", 
              "vertices", " ", "to", " ", "vertexPath", " ", "until", " ", 
              "nextPolygon", " ", "is", " ", "reached"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"MemberQ", "[", 
               RowBox[{"nextPolygon", ",", 
                RowBox[{"currentPolygon", "[", 
                 RowBox[{"[", "currentVertex", "]"}], "]"}]}], " ", "]"}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"currentVertex", "=", "nextVertex"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"currentVertex", "\[Equal]", "maxPolygonLength"}], "||", 
                 RowBox[{
                  RowBox[{"currentPolygon", "[", 
                   RowBox[{"[", 
                    RowBox[{"currentVertex", "+", "1"}], "]"}], "]"}], 
                  "\[Equal]", "0"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"nextVertex", "=", "1"}], ",", "\[IndentingNewLine]", 
                RowBox[{"nextVertex", "=", 
                 RowBox[{"currentVertex", "+", "1"}]}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"nVertexPath", "=", 
               RowBox[{"nVertexPath", "+", "1"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"vertexPath", "[", 
                RowBox[{"[", "nVertexPath", "]"}], "]"}], "=", 
               RowBox[{"currentPolygon", "[", 
                RowBox[{"[", "currentVertex", "]"}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"For", " ", "last", " ", "polygon"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"currentPolygonIndex", "=", "nPathPolygons"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"currentPolygon", "=", 
         RowBox[{"paddedPolygonization", "[", 
          RowBox[{"[", 
           RowBox[{"facesPath", "[", 
            RowBox[{"[", "currentPolygonIndex", "]"}], "]"}], " ", "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Traverse", " ", "new", " ", "polygon", " ", "until", " ", 
          "position", " ", "lines", " ", "up", " ", "with", " ", 
          "vertexPath"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"vertexPath", "[", 
            RowBox[{"[", "nVertexPath", "]"}], "]"}], "\[NotEqual]", 
           RowBox[{"currentPolygon", "[", 
            RowBox[{"[", "currentVertex", "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"currentVertex", "=", "nextVertex"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"currentVertex", "\[Equal]", "maxPolygonLength"}], "||", 
              RowBox[{
               RowBox[{"currentPolygon", "[", 
                RowBox[{"[", 
                 RowBox[{"currentVertex", "+", "1"}], "]"}], "]"}], 
               "\[Equal]", "0"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"nextVertex", "=", "1"}], ",", "\[IndentingNewLine]", 
             RowBox[{"nextVertex", "=", 
              RowBox[{"currentVertex", "+", "1"}]}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "Now", " ", "that", " ", "alignment", " ", "is", " ", "done"}], ",",
           " ", 
          RowBox[{
          "traverse", " ", "polygon", " ", "while", " ", "adding", " ", 
           "vertices", " ", "to", " ", "vertexPath", " ", "until", " ", 
           "outerRingVertices", " ", "is", " ", "reached"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"outerRingVertices", ",", 
             RowBox[{"currentPolygon", "[", 
              RowBox[{"[", "currentVertex", "]"}], "]"}]}], " ", "]"}]}], ",",
           "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"currentVertex", "=", "nextVertex"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"currentVertex", "\[Equal]", "maxPolygonLength"}], "||", 
              RowBox[{
               RowBox[{"currentPolygon", "[", 
                RowBox[{"[", 
                 RowBox[{"currentVertex", "+", "1"}], "]"}], "]"}], 
               "\[Equal]", "0"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"nextVertex", "=", "1"}], ",", "\[IndentingNewLine]", 
             RowBox[{"nextVertex", "=", 
              RowBox[{"currentVertex", "+", "1"}]}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"nVertexPath", "=", 
            RowBox[{"nVertexPath", "+", "1"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"vertexPath", "[", 
             RowBox[{"[", "nVertexPath", "]"}], "]"}], "=", 
            RowBox[{"currentPolygon", "[", 
             RowBox[{"[", "currentVertex", "]"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "nVertexPath", "}"}], ",", "vertexPath"}], "]"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.737649400005571*^9, 3.737649436231701*^9}, {
   3.737649620335319*^9, 3.737649662615232*^9}, {3.7376498370530033`*^9, 
   3.7376498384129267`*^9}, 3.737650636904875*^9, 3.737651377695126*^9, {
   3.737651607558647*^9, 3.73765164728032*^9}, 3.737651781813938*^9, {
   3.737652397586111*^9, 3.737652471204768*^9}, {3.7376527380459423`*^9, 
   3.737652965683526*^9}, {3.737653312598855*^9, 3.737653404665868*^9}, {
   3.737653868353629*^9, 3.737653911264966*^9}, {3.737654367247003*^9, 
   3.737654495719633*^9}, {3.737654870955162*^9, 3.737654871506219*^9}, {
   3.737654937308978*^9, 3.737654938805366*^9}, {3.7376549897579393`*^9, 
   3.737655082937379*^9}, {3.737655147450556*^9, 3.73765518345356*^9}, {
   3.73765528007362*^9, 3.737655282815991*^9}, {3.73765535443626*^9, 
   3.737655363578259*^9}, {3.7376554166544933`*^9, 3.737655419540349*^9}, {
   3.737656392933125*^9, 3.737656433981944*^9}, {3.7376564780953217`*^9, 
   3.737656597331348*^9}, {3.737657071694013*^9, 3.737657131820424*^9}, {
   3.737657179601769*^9, 3.7376572340413923`*^9}, {3.737673582858439*^9, 
   3.737673599428195*^9}},
 CellLabel->
  "In[486]:=",ExpressionUUID->"3565d8e2-1c80-4278-837b-366269905ebe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BoundaryConnectedClassesUnseededCompiled", "::", "usage"}], "=", 
   "\"\<BoundaryConnectedClassesUnseededCompiled[{{boundaryEdges,_Integer,2}}]\
 takes the boundary edges and constructs each connected component.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BoundaryConnectedClassesUnseededCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"boundaryEdges", ",", "_Integer", ",", "2"}], "}"}], "}"}], 
     ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "i", ",", "nBoundaryEdges", ",", "classList", ",", "alreadyUsed", ",",
          "start", ",", "currentVertex", ",", "position", ",", "foundFlag", 
         ",", "nClasses", ",", "allFound"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nBoundaryEdges", "=", 
         RowBox[{"Length", "[", "boundaryEdges", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"classList", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "1000", "}"}], ",", 
           RowBox[{"{", "nBoundaryEdges", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"alreadyUsed", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "nBoundaryEdges", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"alreadyUsed", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "=", "1"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"start", "=", 
         RowBox[{"boundaryEdges", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"currentVertex", "=", 
         RowBox[{"boundaryEdges", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"classList", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", "start"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"classList", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], "=", "currentVertex"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"nClasses", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"position", "=", "3"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Compute", " ", "class1"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"foundFlag", "=", "False"}], ";", "\[IndentingNewLine]", 
        RowBox[{"allFound", "=", "False"}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"!", "foundFlag"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "1"}], ",", 
             RowBox[{"i", "\[LessEqual]", "nBoundaryEdges"}], ",", 
             RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"alreadyUsed", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "1"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Continue", "[", "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"boundaryEdges", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[Equal]", 
                   "currentVertex"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"boundaryEdges", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "\[Equal]", 
                    "start"}], ",", 
                    RowBox[{"foundFlag", "=", "True"}], ","}], "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"classList", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "position"}], "]"}], "]"}], "=", 
                    RowBox[{"boundaryEdges", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"currentVertex", "=", 
                    RowBox[{"boundaryEdges", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"position", "=", 
                    RowBox[{"position", "+", "1"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"alreadyUsed", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=", "1"}], ";"}], 
                  "\[IndentingNewLine]", ","}], "\[IndentingNewLine]", 
                 "]"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"classList", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
         RowBox[{"position", "-", "2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Determine", " ", "if", " ", "all", " ", "edges", " ", "have", " ", 
          "been", " ", "used"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"!", "allFound"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"allFound", "=", "True"}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "1"}], ",", 
             RowBox[{"i", "\[LessEqual]", "nBoundaryEdges"}], ",", 
             RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"alreadyUsed", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                  RowBox[{"If", " ", "not", " ", "all", " ", "used"}], ",", 
                  " ", 
                  RowBox[{
                  "then", " ", "find", " ", "some", " ", "unused", " ", 
                   "edge", " ", "to", " ", "start", " ", "class2"}]}], " ", 
                 "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"allFound", "=", "False"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"nClasses", "=", 
                  RowBox[{"nClasses", "+", "1"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"start", "=", 
                  RowBox[{"boundaryEdges", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"currentVertex", "=", 
                  RowBox[{"boundaryEdges", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"classList", "[", 
                   RowBox[{"[", 
                    RowBox[{"nClasses", ",", "1"}], "]"}], "]"}], "=", 
                  "start"}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"classList", "[", 
                   RowBox[{"[", 
                    RowBox[{"nClasses", ",", "2"}], "]"}], "]"}], "=", 
                  "currentVertex"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"position", "=", "3"}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"alreadyUsed", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "=", "1"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Break", "[", "]"}], ";"}], "\[IndentingNewLine]", 
                ","}], "\[IndentingNewLine]", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"allFound", ",", 
             RowBox[{
              RowBox[{"Break", "[", "]"}], ";"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Compute", " ", "next", " ", "connected", " ", "component"}], " ",
             "*)"}], "\[IndentingNewLine]", 
           RowBox[{"foundFlag", "=", "False"}], ";", "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{"!", "foundFlag"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "\[LessEqual]", "nBoundaryEdges"}], ",", 
                RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"alreadyUsed", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "1"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Continue", "[", "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"boundaryEdges", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[Equal]", 
                    "currentVertex"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"boundaryEdges", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "\[Equal]", 
                    "start"}], ",", 
                    RowBox[{"foundFlag", "=", "True"}], ","}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"classList", "[", 
                    RowBox[{"[", 
                    RowBox[{"nClasses", ",", "position"}], "]"}], "]"}], "=", 
                    RowBox[{"boundaryEdges", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"currentVertex", "=", 
                    RowBox[{"boundaryEdges", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"position", "=", 
                    RowBox[{"position", "+", "1"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"alreadyUsed", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=", "1"}], ";"}], 
                    "\[IndentingNewLine]", ","}], "\[IndentingNewLine]", 
                    "]"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"classList", "[", 
             RowBox[{"[", 
              RowBox[{"nClasses", ",", "1"}], "]"}], "]"}], "=", 
            RowBox[{"position", "-", "2"}]}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"classList", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "nClasses"}], "]"}], "]"}], " ", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.73741962915521*^9, 3.737419634139813*^9}, {
   3.7374314863974752`*^9, 3.7374315340294943`*^9}, {3.737432079154049*^9, 
   3.737432177067313*^9}, {3.737432343010272*^9, 3.737432395380536*^9}, {
   3.737432772840275*^9, 3.737432904659665*^9}, {3.7374635426510983`*^9, 
   3.737463719656907*^9}, {3.737463751249442*^9, 3.737463770747164*^9}, {
   3.737464200877842*^9, 3.7374642101496058`*^9}, {3.7374642452236233`*^9, 
   3.737464249360158*^9}, {3.737464526601454*^9, 3.737464644291031*^9}, {
   3.737464727603071*^9, 3.737464740925767*^9}, {3.737464805881566*^9, 
   3.73746481221679*^9}, {3.737464852933158*^9, 3.737464853019259*^9}, {
   3.7374649042380953`*^9, 3.7374649148121643`*^9}, {3.7374649551335697`*^9, 
   3.73746496591798*^9}, {3.737466222679863*^9, 3.737466423750705*^9}, {
   3.7374668259171057`*^9, 3.737466827376449*^9}, {3.737466900561202*^9, 
   3.737466905814293*^9}, {3.7374670258205137`*^9, 3.737467027795433*^9}, {
   3.737467756678351*^9, 3.737467762237459*^9}, {3.7374679581077843`*^9, 
   3.73746796132298*^9}, {3.7374680767617617`*^9, 3.737468107666068*^9}, {
   3.737489304528762*^9, 3.737489345464326*^9}, {3.7381564897997913`*^9, 
   3.738156675956996*^9}, {3.7381567773378267`*^9, 3.738156801858335*^9}, {
   3.7381568484421864`*^9, 3.7381569617149153`*^9}, {3.738157015948616*^9, 
   3.738157146658873*^9}, {3.738158897042451*^9, 3.7381589069911337`*^9}, 
   3.738158995506426*^9, {3.801764069586349*^9, 3.801764076782864*^9}},
 CellLabel->
  "In[487]:=",ExpressionUUID->"7842211a-3c16-4f88-b4f0-61a0903fe8b2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AngleCompiled", "::", "usage"}], "=", 
   "\"\<AngleCompiled[{{vector1,_Real,1}, {vector2,_Real,1}}] finds the angle \
between the given vectors.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AngleCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vector1", ",", "_Real", ",", "1"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"vector2", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dot", ",", "norm1", ",", "norm2", ",", "angle"}], "}"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dot", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"vector1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "*", 
           RowBox[{"vector2", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"vector1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "*", 
           RowBox[{"vector2", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"norm1", "=", 
         RowBox[{"Norm", "[", "vector1", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"norm2", "=", 
         RowBox[{"Norm", "[", "vector2", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"angle", "=", 
         RowBox[{"ArcCos", "[", 
          RowBox[{"dot", "/", 
           RowBox[{"(", 
            RowBox[{"norm1", "*", "norm2"}], ")"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.737485984091592*^9, 3.737486021612729*^9}, {
  3.737486068934416*^9, 3.7374861599458637`*^9}, {3.737486435758359*^9, 
  3.7374864598855133`*^9}, {3.737486671638351*^9, 3.737486683612096*^9}},
 CellLabel->
  "In[489]:=",ExpressionUUID->"6b80da37-a94e-4be1-bbca-6eb61e140c0f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AngleCompiled", "::", "usage"}], "=", 
   "\"\<AngleCompiled[{{vector1,_Real,1}, {vector2,_Real,1}}] finds the angle \
between the given vectors.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AngleCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vector1", ",", "_Real", ",", "1"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"vector2", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "dot", ",", "norm1", ",", "norm2", ",", "angle", ",", "hold"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dot", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"vector1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "*", 
           RowBox[{"vector2", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"vector1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "*", 
           RowBox[{"vector2", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"norm1", "=", 
         RowBox[{"Norm", "[", "vector1", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"norm2", "=", 
         RowBox[{"Norm", "[", "vector2", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"hold", "=", 
         RowBox[{"dot", "/", 
          RowBox[{"(", 
           RowBox[{"norm1", "*", "norm2"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"hold", "\[GreaterEqual]", "1"}], ",", 
          RowBox[{"hold", "=", "1."}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"hold", "\[LessEqual]", 
           RowBox[{"-", "1"}]}], ",", 
          RowBox[{"hold", "=", 
           RowBox[{"-", "1."}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"angle", "=", 
         RowBox[{"ArcCos", "[", "hold", "]"}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.738249710912559*^9, 3.738249764937272*^9}},
 CellLabel->
  "In[491]:=",ExpressionUUID->"5e85fb9f-0a88-4208-8268-8b813352c9ac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"WindingNumberCompiled", "::", "usage"}], "=", 
   "\"\<WindingNumber[{{pointX,_Real},{pointY,_Real},{path,_Integer,1},{\
coordinates,_Real,2}}] finds the winding number of the path (indices in the \
given list of coordiantes) with respect to the point {pointX, pointY}\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WindingNumberCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pointX", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"pointY", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"path", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"coordinates", ",", "_Real", ",", "2"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "i", ",", "nVertices", ",", "windingNumber", ",", "head1", ",", 
         "head2", ",", "angle", ",", "sign"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nVertices", "=", 
         RowBox[{"Length", "[", "path", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"windingNumber", "=", "0."}], ";", "\[IndentingNewLine]", 
        RowBox[{"angle", "=", "0."}], ";", "\[IndentingNewLine]", 
        RowBox[{"sign", "=", "1."}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", "nVertices"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"head1", "=", 
            RowBox[{"coordinates", "[", 
             RowBox[{"[", 
              RowBox[{"path", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"head2", "=", 
            RowBox[{"coordinates", "[", 
             RowBox[{"[", 
              RowBox[{"path", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{"i", ",", "nVertices"}], "]"}], "+", "1"}], "]"}], 
               "]"}], " ", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"angle", "=", 
            RowBox[{"AngleCompiled", "[", 
             RowBox[{
              RowBox[{"head1", " ", "-", " ", 
               RowBox[{"{", 
                RowBox[{"pointX", ",", "pointY"}], "}"}]}], ",", 
              RowBox[{"head2", " ", "-", " ", 
               RowBox[{"{", 
                RowBox[{"pointX", ",", "pointY"}], "}"}]}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"PointToRightOfLineCompiled", "[", 
              RowBox[{"pointX", ",", "pointY", ",", 
               RowBox[{"head1", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"head1", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"head2", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"head2", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], " ", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"sign", "=", 
               RowBox[{"-", "1."}]}], ";"}], "\[IndentingNewLine]", ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"sign", "=", "1."}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"windingNumber", "=", 
            RowBox[{"windingNumber", "+", 
             RowBox[{"sign", "*", "angle"}]}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"windingNumber", "=", 
         RowBox[{
          RowBox[{"windingNumber", "/", "2"}], "/", "Pi"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<InlineExternalDefinitions\>\"", " ", "->", " ", "True"}], 
       "}"}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.737469934528997*^9, 3.737470089998213*^9}, {
   3.737471701010425*^9, 3.737471809910325*^9}, {3.737478055949216*^9, 
   3.737478056147468*^9}, 3.737478152471574*^9, {3.73747835966919*^9, 
   3.737478360330491*^9}, {3.737486212814157*^9, 3.737486223654833*^9}, {
   3.737486483151791*^9, 3.7374865251918793`*^9}, {3.737486625245357*^9, 
   3.737486636491373*^9}, {3.737487256490079*^9, 3.737487259457213*^9}, {
   3.73748743738545*^9, 3.737487494328669*^9}, {3.737487653655195*^9, 
   3.7374878630373077`*^9}, {3.737488243700267*^9, 3.737488245906617*^9}, {
   3.7374884223769207`*^9, 3.737488437339004*^9}, {3.737488488179668*^9, 
   3.737488545916153*^9}, {3.737488583326933*^9, 3.737488604790353*^9}, {
   3.737488668171255*^9, 3.737488697289446*^9}, {3.7374888255450993`*^9, 
   3.737488825757*^9}, 3.737488856658646*^9, {3.737488898177229*^9, 
   3.737488903968643*^9}, {3.737683435167781*^9, 3.737683438893921*^9}},
 CellLabel->
  "In[493]:=",ExpressionUUID->"20142343-95f3-49d0-9047-e0544ed6a242"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"WindingNumberIntegerCompiled", "::", "usage"}], "=", 
   "\"\<WindingNumber[{{pointX,_Real},{pointY,_Real},{path,_Integer,1},{\
coordinates,_Real,2}}] finds the winding number (rounded to the nearest \
integer) of the path (indices in the given list of coordiantes) with respect \
to the point {pointX, pointY}\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WindingNumberIntegerCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pointX", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"pointY", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"path", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"coordinates", ",", "_Real", ",", "2"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "i", ",", "nVertices", ",", "windingNumber", ",", "head1", ",", 
         "head2", ",", "angle", ",", "sign", ",", "windingNumberResult"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nVertices", "=", 
         RowBox[{"Length", "[", "path", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"windingNumber", "=", "0."}], ";", "\[IndentingNewLine]", 
        RowBox[{"angle", "=", "0."}], ";", "\[IndentingNewLine]", 
        RowBox[{"sign", "=", "1."}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", "nVertices"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"head1", "=", 
            RowBox[{"coordinates", "[", 
             RowBox[{"[", 
              RowBox[{"path", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"head2", "=", 
            RowBox[{"coordinates", "[", 
             RowBox[{"[", 
              RowBox[{"path", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{"i", ",", "nVertices"}], "]"}], "+", "1"}], "]"}], 
               "]"}], " ", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"angle", "=", 
            RowBox[{"AngleCompiled", "[", 
             RowBox[{
              RowBox[{"head1", " ", "-", " ", 
               RowBox[{"{", 
                RowBox[{"pointX", ",", "pointY"}], "}"}]}], ",", 
              RowBox[{"head2", " ", "-", " ", 
               RowBox[{"{", 
                RowBox[{"pointX", ",", "pointY"}], "}"}]}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"PointToRightOfLineCompiled", "[", 
              RowBox[{"pointX", ",", "pointY", ",", 
               RowBox[{"head1", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"head1", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"head2", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"head2", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], " ", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"sign", "=", 
               RowBox[{"-", "1."}]}], ";"}], "\[IndentingNewLine]", ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"sign", "=", "1."}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"windingNumber", "=", 
            RowBox[{"windingNumber", "+", 
             RowBox[{"sign", "*", "angle"}]}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"windingNumberResult", "=", 
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"windingNumber", "/", "2"}], "/", "Pi"}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<InlineExternalDefinitions\>\"", " ", "->", " ", "True"}], 
       "}"}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.737469934528997*^9, 3.737470089998213*^9}, {
   3.737471701010425*^9, 3.737471809910325*^9}, {3.737478055949216*^9, 
   3.737478056147468*^9}, 3.737478152471574*^9, {3.73747835966919*^9, 
   3.737478360330491*^9}, {3.737486212814157*^9, 3.737486223654833*^9}, {
   3.737486483151791*^9, 3.7374865251918793`*^9}, {3.737486625245357*^9, 
   3.737486636491373*^9}, {3.737487256490079*^9, 3.737487259457213*^9}, {
   3.73748743738545*^9, 3.737487494328669*^9}, {3.737487653655195*^9, 
   3.7374878630373077`*^9}, {3.737488243700267*^9, 3.737488245906617*^9}, {
   3.7374884223769207`*^9, 3.737488437339004*^9}, {3.737488488179668*^9, 
   3.737488545916153*^9}, {3.737488583326933*^9, 3.737488604790353*^9}, {
   3.737488668171255*^9, 3.737488697289446*^9}, {3.7374888255450993`*^9, 
   3.737488825757*^9}, 3.737488856658646*^9, {3.737488898177229*^9, 
   3.737488903968643*^9}, {3.737683435167781*^9, 3.737683438893921*^9}, {
   3.73817969084021*^9, 3.738179732280514*^9}, 3.738197237346601*^9},
 CellLabel->
  "In[495]:=",ExpressionUUID->"b42eb961-f0f1-490a-9881-7e6ec2a43ae2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BoundaryEdges", "[", "polygonization_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"allEdges", ",", "tally", ",", "boundaryEdges"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"allEdges", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"EdgesWrapCompiled", ",", "polygonization"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tally", "=", 
      RowBox[{"Tally", "[", 
       RowBox[{"Sort", "/@", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", "allEdges", "]"}], ",", "2"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"boundaryEdges", "=", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"tally", ",", 
         RowBox[{"x_", "/;", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}]}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{";;", ",", "1"}], "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.736866098069872*^9, 3.7368661394451923`*^9}},
 CellLabel->
  "In[497]:=",ExpressionUUID->"75b6397e-b61c-4261-8151-b87af781f7a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BoundaryVertices", "[", "polygonization_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"allEdges", ",", "tally", ",", "boundaryVertices"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"allEdges", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"EdgesWrapCompiled", ",", "polygonization"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tally", "=", 
      RowBox[{"Tally", "[", 
       RowBox[{"Sort", "/@", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", "allEdges", "]"}], ",", "2"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"boundaryVertices", "=", 
      RowBox[{"Union", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"tally", ",", 
           RowBox[{"x_", "/;", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}]}]}], "]"}], 
         "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "1"}], "]"}], "]"}], " ", "]"}], " ", 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7368654182518873`*^9, 3.7368654233380737`*^9}, {
  3.736865494557871*^9, 3.736865499572485*^9}, {3.736865554479388*^9, 
  3.736865591748288*^9}, {3.736865641925449*^9, 3.7368656570211077`*^9}, {
  3.7368657173686666`*^9, 3.736865736553393*^9}},
 CellLabel->
  "In[498]:=",ExpressionUUID->"9e4cf656-b1bc-44ae-ac2e-984954435f6f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BoundaryConnectedClasses", "::", "usage"}], "=", 
   "\"\<BoundaryConnectedClasses[Lambda_, iniClasses__] takes a mesh and a \
sequence of inital connected classes and returns a list of the vertices in \
each connected component of the boundary of mesh.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"BoundaryConnectedClasses", "[", 
   RowBox[{"Lambda_", ",", "iniClasses__"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n", ",", "i", ",", "boundaryEdges", ",", "keepGoingQ", ",", "hold", ",",
       "hold2", ",", 
      RowBox[{"classes", "=", 
       RowBox[{"List", "[", "iniClasses", "]"}]}], ",", "result"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "classes", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"boundaryEdges", " ", "=", " ", 
      RowBox[{"BoundaryEdges", "[", 
       RowBox[{"Lambda", "[", 
        RowBox[{"[", "3", "]"}], "]"}], " ", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"Null", ",", 
        RowBox[{"{", "n", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", "n"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"hold", " ", "=", 
         RowBox[{"classes", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"keepGoingQ", " ", "=", " ", "True"}], ";", 
        "\[IndentingNewLine]", " ", 
        RowBox[{"While", "[", 
         RowBox[{"keepGoingQ", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"hold2", " ", "=", " ", 
            RowBox[{"Union", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Select", "[", 
               RowBox[{"boundaryEdges", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{"hold", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "||", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{"hold", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "&"}]}], "]"}],
               "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"hold", " ", "\[Equal]", "hold2"}], ",", 
             RowBox[{"keepGoingQ", "=", "False"}], ",", 
             RowBox[{"hold", " ", "=", " ", "hold2"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"result", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", "hold"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "result", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.6441615245049562`*^9, 3.644161594923554*^9}, 
   3.7354042695076447`*^9, {3.736866158273884*^9, 3.7368661690098124`*^9}, {
   3.737418579710374*^9, 3.737418581427099*^9}, {3.7376809994989643`*^9, 
   3.737681001004043*^9}},
 CellLabel->
  "In[499]:=",ExpressionUUID->"9843b764-6bc6-452f-b896-079d3d28e2ef"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BuildPolygonizationTopologyCompiled", "::", "usage"}], "=", 
   "\"\<BuildPolygonizationTopologyCompiled[paddedPolygonization,_Integer,2] \
returns a polygonizationTopology giving the adjacent polygons across each \
edge of the given paddedPolygonization. 0 means that edge is a boundary edge, \
whereas -1 means that edge does not exist.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BuildPolygonizationTopologyCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"paddedPolygonization", ",", "_Integer", ",", "2"}], "}"}], 
      "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "i", ",", "j", ",", "k", ",", "m", ",", "edges", ",", "nPolygons", 
         ",", "maxPolygonLength", ",", "polygonizationTopology", ",", 
         "edgesWrapOrdered", ",", "currentEdge", ",", "foundFlag"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nPolygons", "=", 
         RowBox[{"Length", "[", "paddedPolygonization", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"maxPolygonLength", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"paddedPolygonization", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"edgesWrapOrdered", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "nPolygons", "}"}], ",", 
           RowBox[{"{", "maxPolygonLength", "}"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], " ", "for", " ", "non"}], "-", 
          "existant"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"polygonizationTopology", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"-", "1"}], ",", " ", 
           RowBox[{"{", "nPolygons", "}"}], ",", 
           RowBox[{"{", "maxPolygonLength", "}"}]}], "]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], " ", "for", " ", "non"}], "-", "existant"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"foundFlag", "=", "False"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Builds", " ", "the", " ", "edgesWrapOrdered", " ", "array"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", " ", 
          RowBox[{"i", "\[LessEqual]", "nPolygons"}], ",", " ", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "1"}], ",", 
             RowBox[{"j", "\[LessEqual]", "maxPolygonLength"}], ",", 
             RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"j", "\[Equal]", "maxPolygonLength"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                 "When", " ", "j", " ", "has", " ", "reached", " ", "end", 
                  " ", "of", " ", "polygon"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"paddedPolygonization", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[NotEqual]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    "Case", " ", "where", " ", "edge", " ", "wraps", " ", 
                    "back", " ", "to", " ", "first", " ", "vertex"}], " ", 
                    "*)"}], "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}], "=", 
                    RowBox[{"paddedPolygonization", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}], "=", 
                    RowBox[{"paddedPolygonization", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";"}], 
                   "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    "Case", " ", "where", " ", "there", " ", "are", " ", "no",
                     " ", "more", " ", "edges", " ", "that", " ", "exist"}], 
                    " ", "*)"}], "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Break", "[", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
                ",", "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{"When", " ", "j", " ", 
                  RowBox[{"hasn", "'"}], "t", " ", "reached", " ", "end", " ",
                   "of", " ", "polygon"}], " ", "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"paddedPolygonization", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", 
                    RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"paddedPolygonization", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[NotEqual]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    "Case", " ", "where", " ", "edge", " ", "wraps", " ", 
                    "back", " ", "to", " ", "first", " ", "vertex"}], " ", 
                    "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}], "=", 
                    RowBox[{"paddedPolygonization", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}], "=", 
                    RowBox[{"paddedPolygonization", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    "Case", " ", "where", " ", "there", " ", "are", " ", "no",
                     " ", "more", " ", "edges", " ", "that", " ", "exist"}], 
                    " ", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Break", "[", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                   "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}], "=", 
                    RowBox[{"paddedPolygonization", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}], "=", 
                    RowBox[{"paddedPolygonization", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", 
                    RowBox[{"j", "+", "1"}]}], "]"}], "]"}]}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Builds", " ", "polygonizationTopology"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", " ", 
          RowBox[{"i", "\[LessEqual]", "nPolygons"}], ",", " ", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"k", "=", "1"}], ",", 
             RowBox[{"k", "\[LessEqual]", "maxPolygonLength"}], ",", 
             RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"polygonizationTopology", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "k"}], "]"}], "]"}], "\[NotEqual]", 
                 RowBox[{"-", "1"}]}], ",", 
                RowBox[{"Continue", "[", "]"}], ",", " ", 
                RowBox[{"(*", " ", 
                 RowBox[{
                 "Continue", " ", "if", " ", "adjacent", " ", "poly", " ", 
                  "already", " ", "computed"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "k", ",", "1"}], "]"}], "]"}], 
                    "\[Equal]", "0"}], ",", 
                   RowBox[{"Break", "[", "]"}], ",", " ", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    "Break", " ", "if", " ", "end", " ", "of", " ", 
                    "polygon"}], " ", "*)"}], "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"foundFlag", "=", "False"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"currentEdge", " ", "=", " ", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "k"}], "]"}], "]"}], " ", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"j", "=", "1"}], ",", 
                    RowBox[{"j", "\[LessEqual]", "nPolygons"}], ",", 
                    RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"foundFlag", ",", 
                    RowBox[{"Break", "[", "]"}], " ", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"m", "=", "1"}], ",", 
                    RowBox[{"m", "\[LessEqual]", "maxPolygonLength"}], ",", 
                    RowBox[{"m", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"foundFlag", ",", 
                    RowBox[{"Break", "[", "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"currentEdge", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
                    RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "m", ",", "1"}], "]"}], "]"}]}], "&&", 
                    RowBox[{
                    RowBox[{"currentEdge", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
                    RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "m", ",", "2"}], "]"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"polygonizationTopology", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "k"}], "]"}], "]"}], "=", "j"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"polygonizationTopology", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "m"}], "]"}], "]"}], "=", "i"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"foundFlag", "=", "True"}], ";"}], 
                    "\[IndentingNewLine]", ","}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"!", "foundFlag"}], ",", 
                    RowBox[{
                    RowBox[{"polygonizationTopology", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "k"}], "]"}], "]"}], "=", "0"}], ","}], 
                    "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "polygonizationTopology", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.736864043399913*^9, 3.736864083126754*^9}, {
   3.7368641574324417`*^9, 3.736864217828335*^9}, {3.7368644543075123`*^9, 
   3.736864486248407*^9}, {3.736864519452197*^9, 3.736864635083211*^9}, {
   3.736864964364176*^9, 3.7368650351538887`*^9}, {3.736865088767222*^9, 
   3.736865097590604*^9}, {3.737396177355884*^9, 3.737396186568584*^9}, 
   3.737396303802342*^9, {3.737396338130107*^9, 3.737396379948971*^9}, {
   3.737396506850691*^9, 3.737396507417405*^9}, {3.73739656613592*^9, 
   3.7373966240392733`*^9}, {3.737396756461862*^9, 3.737396756669429*^9}, {
   3.737396791634297*^9, 3.737396818906345*^9}, {3.737396854246869*^9, 
   3.737397091104967*^9}, {3.7373977090589237`*^9, 3.73739771886443*^9}, {
   3.737400075046487*^9, 3.737400096467556*^9}, {3.737400149606298*^9, 
   3.7374002198893948`*^9}, {3.737400361074511*^9, 3.737400367194477*^9}},
 CellLabel->
  "In[501]:=",ExpressionUUID->"ce24e228-0c8d-4368-ad53-1673e4d23151"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
   "BuildPolygonizationTopologyAndBoundaryEdgesCompiled", "::", "usage"}], 
   "=", "\"\<BuildPolygonizationTopologyAndBoundaryEdgesCompiled[\
paddedPolygonization,_Integer,2] returns a polygonizationTopology giving the \
adjacent polygons across each edge of the given paddedPolygonization. 0 means \
that edge is a boundary edge, whereas -1 means that edge does not \
exist.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BuildPolygonizationTopologyAndBoundaryEdgesCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"paddedPolygonization", ",", "_Integer", ",", "2"}], "}"}], 
      "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "i", ",", "j", ",", "k", ",", "m", ",", "nBoundaryEdges", ",", 
         "boundaryEdges", ",", "firstRow", ",", "nPolygons", ",", 
         "maxPolygonLength", ",", "polygonizationTopology", ",", 
         "edgesWrapOrdered", ",", "currentEdge", ",", "foundFlag"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nPolygons", "=", 
         RowBox[{"Length", "[", "paddedPolygonization", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"maxPolygonLength", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"paddedPolygonization", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"edgesWrapOrdered", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "nPolygons", "}"}], ",", 
           RowBox[{"{", "maxPolygonLength", "}"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], " ", "for", " ", "non"}], "-", 
          "existant"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"polygonizationTopology", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"-", "1"}], ",", " ", 
           RowBox[{"{", "nPolygons", "}"}], ",", 
           RowBox[{"{", "maxPolygonLength", "}"}]}], "]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], " ", "for", " ", "non"}], "-", "existant"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"nBoundaryEdges", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"boundaryEdges", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"maxPolygonLength", "*", "nPolygons"}], "}"}], ",", 
           RowBox[{"{", "maxPolygonLength", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"foundFlag", "=", "False"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Builds", " ", "the", " ", "edgesWrapOrdered", " ", "array"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", " ", 
          RowBox[{"i", "\[LessEqual]", "nPolygons"}], ",", " ", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "1"}], ",", 
             RowBox[{"j", "\[LessEqual]", "maxPolygonLength"}], ",", 
             RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"j", "\[Equal]", "maxPolygonLength"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                 "When", " ", "j", " ", "has", " ", "reached", " ", "end", 
                  " ", "of", " ", "polygon"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"paddedPolygonization", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[NotEqual]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    "Case", " ", "where", " ", "edge", " ", "wraps", " ", 
                    "back", " ", "to", " ", "first", " ", "vertex"}], " ", 
                    "*)"}], "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}], "=", 
                    RowBox[{"paddedPolygonization", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}], "=", 
                    RowBox[{"paddedPolygonization", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";"}], 
                   "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    "Case", " ", "where", " ", "there", " ", "are", " ", "no",
                     " ", "more", " ", "edges", " ", "that", " ", "exist"}], 
                    " ", "*)"}], "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Break", "[", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
                ",", "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{"When", " ", "j", " ", 
                  RowBox[{"hasn", "'"}], "t", " ", "reached", " ", "end", " ",
                   "of", " ", "polygon"}], " ", "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"paddedPolygonization", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", 
                    RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"paddedPolygonization", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[NotEqual]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    "Case", " ", "where", " ", "edge", " ", "wraps", " ", 
                    "back", " ", "to", " ", "first", " ", "vertex"}], " ", 
                    "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}], "=", 
                    RowBox[{"paddedPolygonization", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}], "=", 
                    RowBox[{"paddedPolygonization", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    "Case", " ", "where", " ", "there", " ", "are", " ", "no",
                     " ", "more", " ", "edges", " ", "that", " ", "exist"}], 
                    " ", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Break", "[", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                   "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}], "=", 
                    RowBox[{"paddedPolygonization", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}], "=", 
                    RowBox[{"paddedPolygonization", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", 
                    RowBox[{"j", "+", "1"}]}], "]"}], "]"}]}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Builds", " ", "polygonizationTopology"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", " ", 
          RowBox[{"i", "\[LessEqual]", "nPolygons"}], ",", " ", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"k", "=", "1"}], ",", 
             RowBox[{"k", "\[LessEqual]", "maxPolygonLength"}], ",", 
             RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"polygonizationTopology", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "k"}], "]"}], "]"}], "\[NotEqual]", 
                 RowBox[{"-", "1"}]}], ",", 
                RowBox[{"Continue", "[", "]"}], ",", " ", 
                RowBox[{"(*", " ", 
                 RowBox[{
                 "Continue", " ", "if", " ", "adjacent", " ", "poly", " ", 
                  "already", " ", "computed"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "k", ",", "1"}], "]"}], "]"}], 
                    "\[Equal]", "0"}], ",", 
                   RowBox[{"Break", "[", "]"}], ",", " ", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    "Break", " ", "if", " ", "end", " ", "of", " ", 
                    "polygon"}], " ", "*)"}], "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"foundFlag", "=", "False"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"currentEdge", " ", "=", " ", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "k"}], "]"}], "]"}], " ", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"j", "=", "1"}], ",", 
                    RowBox[{"j", "\[LessEqual]", "nPolygons"}], ",", 
                    RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"foundFlag", ",", 
                    RowBox[{"Break", "[", "]"}], " ", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"m", "=", "1"}], ",", 
                    RowBox[{"m", "\[LessEqual]", "maxPolygonLength"}], ",", 
                    RowBox[{"m", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"foundFlag", ",", 
                    RowBox[{"Break", "[", "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"currentEdge", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
                    RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "m", ",", "1"}], "]"}], "]"}]}], "&&", 
                    RowBox[{
                    RowBox[{"currentEdge", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
                    RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "m", ",", "2"}], "]"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"polygonizationTopology", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "k"}], "]"}], "]"}], "=", "j"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"polygonizationTopology", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "m"}], "]"}], "]"}], "=", "i"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"foundFlag", "=", "True"}], ";"}], 
                    "\[IndentingNewLine]", ","}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"!", "foundFlag"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"polygonizationTopology", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "k"}], "]"}], "]"}], "=", "0"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"nBoundaryEdges", "=", 
                    RowBox[{"nBoundaryEdges", "+", "1"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"boundaryEdges", "[", 
                    RowBox[{"[", 
                    RowBox[{"nBoundaryEdges", ",", "1"}], "]"}], "]"}], "=", 
                    RowBox[{"currentEdge", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ";", " ", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    "Remember", " ", "that", " ", "currentEdge", " ", "was", 
                    " ", "reversed"}], " ", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"boundaryEdges", "[", 
                    RowBox[{"[", 
                    RowBox[{"nBoundaryEdges", ",", "2"}], "]"}], "]"}], "=", 
                    RowBox[{"currentEdge", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ","}], "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"firstRow", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "maxPolygonLength", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"firstRow", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "=", "nBoundaryEdges"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "firstRow", "}"}], ",", "polygonizationTopology", ",",
            " ", "boundaryEdges"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.736864043399913*^9, 3.736864083126754*^9}, {
   3.7368641574324417`*^9, 3.736864217828335*^9}, {3.7368644543075123`*^9, 
   3.736864486248407*^9}, {3.736864519452197*^9, 3.736864635083211*^9}, {
   3.736864964364176*^9, 3.7368650351538887`*^9}, {3.736865088767222*^9, 
   3.736865097590604*^9}, {3.737396177355884*^9, 3.737396186568584*^9}, 
   3.737396303802342*^9, {3.737396338130107*^9, 3.737396379948971*^9}, {
   3.737396506850691*^9, 3.737396507417405*^9}, {3.73739656613592*^9, 
   3.7373966240392733`*^9}, {3.737396756461862*^9, 3.737396756669429*^9}, {
   3.737396791634297*^9, 3.737396818906345*^9}, {3.737396854246869*^9, 
   3.737397091104967*^9}, {3.7373977090589237`*^9, 3.73739771886443*^9}, {
   3.737400075046487*^9, 3.737400096467556*^9}, {3.737400149606298*^9, 
   3.7374002198893948`*^9}, {3.737400361074511*^9, 3.737400367194477*^9}, {
   3.737424475063034*^9, 3.7374245686825123`*^9}, {3.737425138781363*^9, 
   3.737425280295192*^9}, {3.7374254496743603`*^9, 3.737425451688203*^9}, {
   3.737425564358198*^9, 3.73742562279778*^9}, {3.7374272008736877`*^9, 
   3.737427203465332*^9}, {3.737427247979657*^9, 3.737427260430386*^9}, {
   3.7374273010950527`*^9, 3.73742733216537*^9}, 3.737499697185952*^9},
 CellLabel->
  "In[503]:=",ExpressionUUID->"1825d080-3793-48ec-8586-450cf8b18ffc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BuildPolyTopoBdryEdgesInternalEdgesCompiled", "::", "usage"}], 
   "=", "\"\<BuildPolyTopoBdryEdgesInternalEdgesCompiled[paddedPolygonization,\
_Integer,2] returns a polygonizationTopology giving the adjacent polygons \
across each edge of the given paddedPolygonization. 0 means that edge is a \
boundary edge, whereas -1 means that edge does not exist.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BuildPolyTopoBdryEdgesInternalEdgesCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"paddedPolygonization", ",", "_Integer", ",", "2"}], "}"}], 
      "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "i", ",", "j", ",", "k", ",", "m", ",", "nBoundaryEdges", ",", 
         "boundaryEdges", ",", "firstRow", ",", "nPolygons", ",", 
         "maxPolygonLength", ",", "polygonizationTopology", ",", 
         "edgesWrapOrdered", ",", "currentEdge", ",", "foundFlag", ",", 
         "nInternalEdges", ",", "internalEdges"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nPolygons", "=", 
         RowBox[{"Length", "[", "paddedPolygonization", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"maxPolygonLength", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"paddedPolygonization", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"edgesWrapOrdered", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "nPolygons", "}"}], ",", 
           RowBox[{"{", "maxPolygonLength", "}"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], " ", "for", " ", "non"}], "-", 
          "existant"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"polygonizationTopology", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"-", "1"}], ",", " ", 
           RowBox[{"{", "nPolygons", "}"}], ",", 
           RowBox[{"{", "maxPolygonLength", "}"}]}], "]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], " ", "for", " ", "non"}], "-", "existant"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"nBoundaryEdges", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"boundaryEdges", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"maxPolygonLength", "*", "nPolygons"}], "}"}], ",", 
           RowBox[{"{", "maxPolygonLength", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nInternalEdges", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"internalEdges", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"maxPolygonLength", "*", "nPolygons"}], "}"}], ",", 
           RowBox[{"{", "maxPolygonLength", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"foundFlag", "=", "False"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Builds", " ", "the", " ", "edgesWrapOrdered", " ", "array"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", " ", 
          RowBox[{"i", "\[LessEqual]", "nPolygons"}], ",", " ", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "1"}], ",", 
             RowBox[{"j", "\[LessEqual]", "maxPolygonLength"}], ",", 
             RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"j", "\[Equal]", "maxPolygonLength"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                 "When", " ", "j", " ", "has", " ", "reached", " ", "end", 
                  " ", "of", " ", "polygon"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"paddedPolygonization", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[NotEqual]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    "Case", " ", "where", " ", "edge", " ", "wraps", " ", 
                    "back", " ", "to", " ", "first", " ", "vertex"}], " ", 
                    "*)"}], "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}], "=", 
                    RowBox[{"paddedPolygonization", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}], "=", 
                    RowBox[{"paddedPolygonization", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";"}], 
                   "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    "Case", " ", "where", " ", "there", " ", "are", " ", "no",
                     " ", "more", " ", "edges", " ", "that", " ", "exist"}], 
                    " ", "*)"}], "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Break", "[", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
                ",", "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{"When", " ", "j", " ", 
                  RowBox[{"hasn", "'"}], "t", " ", "reached", " ", "end", " ",
                   "of", " ", "polygon"}], " ", "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"paddedPolygonization", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", 
                    RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"paddedPolygonization", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[NotEqual]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    "Case", " ", "where", " ", "edge", " ", "wraps", " ", 
                    "back", " ", "to", " ", "first", " ", "vertex"}], " ", 
                    "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}], "=", 
                    RowBox[{"paddedPolygonization", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}], "=", 
                    RowBox[{"paddedPolygonization", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    "Case", " ", "where", " ", "there", " ", "are", " ", "no",
                     " ", "more", " ", "edges", " ", "that", " ", "exist"}], 
                    " ", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Break", "[", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                   "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}], "=", 
                    RowBox[{"paddedPolygonization", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}], "=", 
                    RowBox[{"paddedPolygonization", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", 
                    RowBox[{"j", "+", "1"}]}], "]"}], "]"}]}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Builds", " ", "polygonizationTopology"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", " ", 
          RowBox[{"i", "\[LessEqual]", "nPolygons"}], ",", " ", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"k", "=", "1"}], ",", 
             RowBox[{"k", "\[LessEqual]", "maxPolygonLength"}], ",", 
             RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"polygonizationTopology", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "k"}], "]"}], "]"}], "\[NotEqual]", 
                 RowBox[{"-", "1"}]}], ",", 
                RowBox[{"Continue", "[", "]"}], ",", " ", 
                RowBox[{"(*", " ", 
                 RowBox[{
                 "Continue", " ", "if", " ", "adjacent", " ", "poly", " ", 
                  "already", " ", "computed"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "k", ",", "1"}], "]"}], "]"}], 
                    "\[Equal]", "0"}], ",", 
                   RowBox[{"Break", "[", "]"}], ",", " ", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    "Break", " ", "if", " ", "end", " ", "of", " ", 
                    "polygon"}], " ", "*)"}], "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"foundFlag", "=", "False"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"currentEdge", " ", "=", " ", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "k"}], "]"}], "]"}], " ", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"j", "=", "1"}], ",", 
                    RowBox[{"j", "\[LessEqual]", "nPolygons"}], ",", 
                    RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"foundFlag", ",", 
                    RowBox[{"Break", "[", "]"}], " ", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"m", "=", "1"}], ",", 
                    RowBox[{"m", "\[LessEqual]", "maxPolygonLength"}], ",", 
                    RowBox[{"m", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"foundFlag", ",", 
                    RowBox[{"Break", "[", "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"currentEdge", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
                    RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "m", ",", "1"}], "]"}], "]"}]}], "&&", 
                    RowBox[{
                    RowBox[{"currentEdge", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
                    RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "m", ",", "2"}], "]"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"polygonizationTopology", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "k"}], "]"}], "]"}], "=", "j"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"polygonizationTopology", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "m"}], "]"}], "]"}], "=", "i"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"nInternalEdges", "=", 
                    RowBox[{"nInternalEdges", "+", "1"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "\[LessEqual]", "j"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"internalEdges", "[", 
                    RowBox[{"[", 
                    RowBox[{"nInternalEdges", ",", "1"}], "]"}], "]"}], "=", 
                    "i"}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"internalEdges", "[", 
                    RowBox[{"[", 
                    RowBox[{"nInternalEdges", ",", "2"}], "]"}], "]"}], "=", 
                    "j"}], ";"}], "\[IndentingNewLine]", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"internalEdges", "[", 
                    RowBox[{"[", 
                    RowBox[{"nInternalEdges", ",", "1"}], "]"}], "]"}], "=", 
                    "j"}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"internalEdges", "[", 
                    RowBox[{"[", 
                    RowBox[{"nInternalEdges", ",", "2"}], "]"}], "]"}], "=", 
                    "i"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"foundFlag", "=", "True"}], ";"}], 
                    "\[IndentingNewLine]", ","}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"!", "foundFlag"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"polygonizationTopology", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "k"}], "]"}], "]"}], "=", "0"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"nBoundaryEdges", "=", 
                    RowBox[{"nBoundaryEdges", "+", "1"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"boundaryEdges", "[", 
                    RowBox[{"[", 
                    RowBox[{"nBoundaryEdges", ",", "1"}], "]"}], "]"}], "=", 
                    RowBox[{"currentEdge", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ";", " ", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    "Remember", " ", "that", " ", "currentEdge", " ", "was", 
                    " ", "reversed"}], " ", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"boundaryEdges", "[", 
                    RowBox[{"[", 
                    RowBox[{"nBoundaryEdges", ",", "2"}], "]"}], "]"}], "=", 
                    RowBox[{"currentEdge", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ","}], "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"firstRow", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "maxPolygonLength", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"firstRow", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "=", "nBoundaryEdges"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"firstRow", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "=", "nInternalEdges"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "firstRow", "}"}], ",", "polygonizationTopology", ",",
            "boundaryEdges", ",", "internalEdges"}], "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.737499662574787*^9, 3.7374997349596367`*^9}, {
  3.737499985704571*^9, 3.737499993902012*^9}, {3.737500031055469*^9, 
  3.73750006873711*^9}, {3.737500841901019*^9, 3.737500958968987*^9}, {
  3.737501022931404*^9, 3.7375010234431467`*^9}, {3.7375010609306583`*^9, 
  3.737501080539054*^9}},
 CellLabel->
  "In[505]:=",ExpressionUUID->"9138ec83-c73f-4800-b1fd-8a0d8944b7ee"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DistanceCompiled", "::", "usage"}], "=", 
   "\"\<DistanceCompiled[{{vector,_Integer,1},{TCoordinates,_Real,2}}] finds \
the length of the given vector with respect to the given coordinates\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DistanceCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vector", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"TCoordinates", ",", "_Real", ",", "2"}], "}"}]}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"Norm", "[", 
      RowBox[{
       RowBox[{"TCoordinates", "[", 
        RowBox[{"[", 
         RowBox[{"vector", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], "]"}], "-", 
       RowBox[{"TCoordinates", "[", 
        RowBox[{"[", 
         RowBox[{"vector", "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", "]"}], "]"}]}], " ", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.735609386650481*^9, 3.7356094484023037`*^9}, {
  3.73561002101084*^9, 3.735610081811111*^9}},
 CellLabel->
  "In[507]:=",ExpressionUUID->"2312b2ca-c72c-4ebf-b1ed-2aab7b241dfb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CircumcenterCompiled", "::", "usage"}], "=", 
   "\"\<Circumcenter[T] takes a triangle T and returns the circumcenter of T.\
\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"CircumcenterCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"triangle", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"TCoordinates", ",", "_Real", ",", "2"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "bx", ",", "by", ",", "T"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"T", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"TCoordinates", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "triangle"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"a", " ", "=", " ", 
         RowBox[{"Det", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"T", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"T", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"bx", " ", "=", " ", 
         RowBox[{"-", 
          RowBox[{"Det", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"T", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}], "^", "2"}], " ", 
                "+", " ", 
                RowBox[{
                 RowBox[{"T", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "2"}], "]"}], "]"}], "^", "2"}]}], ",", 
               RowBox[{"T", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", "1"}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"by", " ", "=", " ", 
         RowBox[{"Det", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"T", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], "^", "2"}], " ", "+",
                " ", 
               RowBox[{
                RowBox[{"T", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}], "^", "2"}]}], ",", 
              RowBox[{"T", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "bx"}], "/", 
            RowBox[{"(", 
             RowBox[{"2", "a"}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"-", "by"}], "/", 
            RowBox[{"(", 
             RowBox[{"2", "a"}], ")"}]}]}], "}"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6453776843803473`*^9, 3.64537769224095*^9}, 
   3.735404289723288*^9, {3.735564415949707*^9, 3.7355644703822813`*^9}, {
   3.7356107059653187`*^9, 3.735610742925056*^9}, {3.801208614439025*^9, 
   3.801208628967474*^9}},
 CellLabel->
  "In[509]:=",ExpressionUUID->"390450d0-769f-4922-a636-4276b7d3d71f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DistanceNumericCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"pointList", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Norm", "[", 
      RowBox[{
       RowBox[{"pointList", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "-", 
       RowBox[{"pointList", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7356526809053593`*^9, 3.7356527505072613`*^9}},
 CellLabel->
  "In[511]:=",ExpressionUUID->"2632052c-24a5-4152-ad30-a3d4ed1c2eb7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BuildConductanceAssociation", "::", "usage"}], "=", 
   "\"\<BuildConductanceAssociation[triangleList_,interiorEdges_,\
toRightOfEdgeTriAssociation_,TCoordinates_] builds a dictionary association \
between edges in the triangulation and the conductance of that edge, given by \
the distance between circumcenters of the adjoining triangles divided by the \
distance between the endpoints of the edge.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BuildConductanceAssociation", "[", 
   RowBox[{
   "triangleList_", ",", "interiorEdges_", ",", 
    "toRightOfEdgeTriAssociation_", ",", "TCoordinates_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"table", ",", "edgeAssociatedToConductance"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"table", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{"DistanceNumericCompiled", "[", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"CircumcenterCompiled", "[", 
                RowBox[{
                 RowBox[{"triangleList", "[", 
                  RowBox[{"[", 
                   RowBox[{"toRightOfEdgeTriAssociation", "[", "#", "]"}], 
                   " ", "]"}], "]"}], ",", "TCoordinates"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"CircumcenterCompiled", "[", 
                RowBox[{
                 RowBox[{"triangleList", "[", 
                  RowBox[{"[", 
                   RowBox[{"toRightOfEdgeTriAssociation", "[", 
                    RowBox[{"Reverse", "[", "#", "]"}], "]"}], " ", "]"}], 
                  "]"}], ",", "TCoordinates"}], "]"}]}], 
              "\[IndentingNewLine]", "}"}], "]"}], "/", 
            RowBox[{"DistanceCompiled", "[", 
             RowBox[{"#", ",", "TCoordinates"}], "]"}]}]}], "}"}], "&"}], ",",
         "interiorEdges"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"edgeAssociatedToConductance", "=", 
      RowBox[{"Association", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"table", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[Rule]", 
          RowBox[{"table", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "table", "]"}]}], "}"}]}], "]"}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.735573700697398*^9, 3.735573793755438*^9}, {
   3.735609793951478*^9, 3.735609852838538*^9}, {3.735609885840761*^9, 
   3.735609989772581*^9}, {3.7356106330027227`*^9, 3.735610689514633*^9}, {
   3.735610766374343*^9, 3.7356108487745647`*^9}, 3.735616595535388*^9, {
   3.735652777870201*^9, 3.735652793504753*^9}, {3.735656246358561*^9, 
   3.735656258068899*^9}},
 CellLabel->
  "In[512]:=",ExpressionUUID->"9acedfc6-11ac-4918-845d-5d34875ba537"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"EdgesCompiled", "::", "usage"}], "=", 
   "\"\<Edges[{{path,_Integer,1}}] takes a list of indices and returns the \
list of pairs from one index to the next.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"EdgesCompiled", " ", "=", " ", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"path", ",", "_Integer", ",", "1"}], "}"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Partition", "[", 
      RowBox[{"path", ",", "2", ",", "1"}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.725625318832735*^9, 3.725625356864133*^9}, 
   3.728388146756157*^9, {3.735403896424934*^9, 3.7354039175268507`*^9}},
 CellLabel->
  "In[514]:=",ExpressionUUID->"676fd42c-848c-4c6a-92f0-8250e3c73c43"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"EdgesWrapCompiled", "::", "usage"}], "=", 
   "\"\<Edges[{{polygon,_Integer,1}}] takes a list of indices and returns the \
list of pairs from one index to the next.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EdgesWrapCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"polygon", ",", " ", "_Integer", ",", " ", "1"}], "}"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"Append", "[", 
      RowBox[{
       RowBox[{"Partition", "[", 
        RowBox[{"polygon", ",", "2", ",", "1"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"polygon", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], ",", 
         RowBox[{"polygon", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7351426116641207`*^9, 3.735142612623898*^9}, {
  3.73514291727344*^9, 3.7351429385310993`*^9}, {3.735403922073491*^9, 
  3.735403922320923*^9}, {3.735404050590352*^9, 3.735404069429216*^9}},
 CellLabel->
  "In[516]:=",ExpressionUUID->"32503075-63de-412c-957d-75953a59f86b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"EdgesWrapSortCompiled", "::", "usage"}], "=", 
   "\"\<EdgesWrapSortCompiled[{{polygon, _Integer, 1}}] takes a list of \
indices representing a polygon and returns the edges (internally sorted by \
index) going around the polygon.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EdgesWrapSortCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"polygon", ",", " ", "_Integer", ",", " ", "1"}], "}"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{"Sort", ",", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{"polygon", ",", "2", ",", "1"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"polygon", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}], ",", " ", 
           RowBox[{"polygon", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.735399245107386*^9, 3.7353992529313107`*^9}, {
  3.7354039252657537`*^9, 3.7354039255858707`*^9}, {3.73540398278126*^9, 
  3.7354040422766123`*^9}, {3.735404086457225*^9, 3.735404087768917*^9}},
 CellLabel->
  "In[518]:=",ExpressionUUID->"8a334cf8-d089-4ebf-8b0b-90c82c56b80e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InteriorAndBoundaryEdgesCompiled", "::", "usage"}], "=", 
   "\"\<InteriorAndBoundaryEdgesCompiled[{{triangleList,_Integer,2},{\
triangulationTopology,_Integer,2}}] runs the internals for \
InteriorAndBoundaryEdges.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InteriorAndBoundaryEdgesCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"triangleList", ",", "_Integer", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"triangulationTopology", ",", "_Integer", ",", "2"}], "}"}]}],
       "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "nTriangles", ",", "table", ",", "counter", ",", "i", ",", "j"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nTriangles", "=", 
         RowBox[{"Length", "[", "triangleList", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"table", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"3", "*", "nTriangles"}], "}"}], ",", 
           RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"counter", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", "nTriangles"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "1"}], ",", 
             RowBox[{"j", "\[LessEqual]", "2"}], ",", 
             RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"triangulationTopology", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "0"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"counter", "=", 
                  RowBox[{"counter", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"table", "[", 
                   RowBox[{"[", 
                    RowBox[{"counter", ",", "1"}], "]"}], "]"}], "=", 
                  RowBox[{"triangleList", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"table", "[", 
                   RowBox[{"[", 
                    RowBox[{"counter", ",", "2"}], "]"}], "]"}], "=", 
                  RowBox[{"triangleList", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", 
                    RowBox[{"j", "+", "1"}]}], "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"table", "[", 
                   RowBox[{"[", 
                    RowBox[{"counter", ",", "3"}], "]"}], "]"}], "=", "0"}], 
                 ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"counter", "=", 
                  RowBox[{"counter", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"table", "[", 
                   RowBox[{"[", 
                    RowBox[{"counter", ",", "1"}], "]"}], "]"}], "=", 
                  RowBox[{"triangleList", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"table", "[", 
                   RowBox[{"[", 
                    RowBox[{"counter", ",", "2"}], "]"}], "]"}], "=", 
                  RowBox[{"triangleList", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", 
                    RowBox[{"j", "+", "1"}]}], "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"table", "[", 
                   RowBox[{"[", 
                    RowBox[{"counter", ",", "3"}], "]"}], "]"}], "=", "1"}], 
                 ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"j", "=", "3"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"triangulationTopology", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "0"}], ",",
              "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"counter", "=", 
               RowBox[{"counter", "+", "1"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"table", "[", 
                RowBox[{"[", 
                 RowBox[{"counter", ",", "1"}], "]"}], "]"}], "=", 
               RowBox[{"triangleList", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"table", "[", 
                RowBox[{"[", 
                 RowBox[{"counter", ",", "2"}], "]"}], "]"}], "=", 
               RowBox[{"triangleList", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"table", "[", 
                RowBox[{"[", 
                 RowBox[{"counter", ",", "3"}], "]"}], "]"}], "=", "0"}], 
              ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"counter", "=", 
               RowBox[{"counter", "+", "1"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"table", "[", 
                RowBox[{"[", 
                 RowBox[{"counter", ",", "1"}], "]"}], "]"}], "=", 
               RowBox[{"triangleList", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"table", "[", 
                RowBox[{"[", 
                 RowBox[{"counter", ",", "2"}], "]"}], "]"}], "=", 
               RowBox[{"triangleList", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"table", "[", 
                RowBox[{"[", 
                 RowBox[{"counter", ",", "3"}], "]"}], "]"}], "=", "1"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "table", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.735576222267127*^9, 3.735576354662509*^9}, {
   3.735576398617372*^9, 3.73557639977661*^9}, {3.735576437385418*^9, 
   3.735576561901972*^9}, {3.735576594239229*^9, 3.735576642321087*^9}, {
   3.735576676434331*^9, 3.7355766813625717`*^9}, {3.735576713619483*^9, 
   3.7355767709981318`*^9}, {3.735576857251891*^9, 3.735576886061171*^9}, {
   3.73561271273241*^9, 3.735612713491255*^9}, {3.7356138784556007`*^9, 
   3.735613909285787*^9}, 3.801264359234638*^9},
 CellLabel->
  "In[520]:=",ExpressionUUID->"3de36991-9613-419e-b5ce-95a10822a382"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InteriorAndBoundaryEdges", "::", "usage"}], "=", 
   "\"\<InteriorAndBoundaryEdges[triangleList_, triangulationTopology_] \
creates a list of interior edges and a list of boundary edges.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InteriorAndBoundaryEdges", "[", 
    RowBox[{"triangleList_", ",", " ", "triangulationTopology_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "interiorAndBoundaryEdges", ",", "interiorEdgesOrientedTriangulation", 
       ",", "boundaryEdgesOrientedTriangulation"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"interiorAndBoundaryEdges", "=", 
       RowBox[{"InteriorAndBoundaryEdgesCompiled", "[", 
        RowBox[{"triangleList", ",", "triangulationTopology"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"interiorEdgesOrientedTriangulation", "=", 
       RowBox[{"Pick", "[", 
        RowBox[{
         RowBox[{"interiorAndBoundaryEdges", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", 
            RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"interiorAndBoundaryEdges", "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", "3"}], "]"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"0", "\[Rule]", "False"}], ",", 
            RowBox[{"1", "\[Rule]", "True"}]}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"boundaryEdgesOrientedTriangulation", "=", 
       RowBox[{"Pick", "[", 
        RowBox[{
         RowBox[{"interiorAndBoundaryEdges", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", 
            RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"interiorAndBoundaryEdges", "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", "3"}], "]"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "\[Rule]", "False"}], ",", 
            RowBox[{"0", "\[Rule]", "True"}]}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
        "interiorEdgesOrientedTriangulation", ",", 
         "boundaryEdgesOrientedTriangulation"}], "}"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.735578429844513*^9, 3.7355784412436743`*^9}, {
  3.7355784805845013`*^9, 3.735578488436557*^9}, {3.7356076700191708`*^9, 
  3.7356077289316483`*^9}, {3.735608353303507*^9, 3.735608371147828*^9}, {
  3.7356138496790648`*^9, 3.735613873859132*^9}},
 CellLabel->
  "In[522]:=",ExpressionUUID->"e9861e89-56ae-4556-aa29-69c1825f6024"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MakePolyFile", "::", "usage"}], "=", 
   "\"\<MakePolyFile[fileName_,R_, hole_] takes the given region and writes a \
.poly file that can be used by triangle.c and acute.c. It assumes dimensions \
is 2, numAttr is 0, and numBoundaryMarkers is 0, and that there is only one \
hole.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakePolyFile", "[", 
   RowBox[{"fileName_", ",", "R_", ",", " ", "hole_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "vertices", ",", "numVert", ",", "dimensions", ",", "numAttr", ",", 
      "numBoundaryMarkers", ",", "numHoles", ",", "edges", ",", "numEdges", 
      ",", "stream", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"vertices", " ", "=", " ", 
      RowBox[{"Chop", "/@", 
       RowBox[{"MeshCoordinates", "[", "R", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numVert", " ", "=", " ", 
      RowBox[{"Length", "[", "vertices", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dimensions", " ", "=", " ", "2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"numAttr", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"numBoundaryMarkers", " ", "=", " ", "0"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numHoles", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"edges", " ", "=", "  ", 
      RowBox[{
       RowBox[{"MeshCells", "[", 
        RowBox[{"R", ",", "1"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"numEdges", " ", "=", " ", 
      RowBox[{"Length", "[", "edges", " ", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stream", " ", "=", " ", 
      RowBox[{"OpenWrite", "[", 
       RowBox[{"fileName", " ", "<>", "\"\<.poly\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"stream", ",", " ", 
       RowBox[{
        RowBox[{"ToString", "[", "numVert", "]"}], " ", "<>", " ", 
        "\"\< \>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", "dimensions", "]"}], " ", "<>", " ", 
        "\"\< \>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", "numAttr", "]"}], "<>", " ", "\"\< \>\"", 
        " ", "<>", " ", 
        RowBox[{"ToString", "[", "numBoundaryMarkers", "]"}], " ", "<>", " ", 
        "\"\<\\n\>\""}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"i", "\[LessEqual]", " ", "numVert"}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"WriteString", "[", 
         RowBox[{"stream", ",", " ", 
          RowBox[{
           RowBox[{"ToString", "[", "i", "]"}], " ", "<>", " ", "\"\< \>\"", 
           " ", "<>", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"CForm", "[", 
             RowBox[{"vertices", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], " ", "]"}], " ", "]"}], 
           " ", "<>", " ", "\"\< \>\"", " ", "<>", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"CForm", "[", 
             RowBox[{"vertices", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}], " ", "]"}], " ", "]"}], 
           " ", "<>", " ", "\"\<\\n\>\""}]}], " ", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"stream", ",", 
       RowBox[{
        RowBox[{"ToString", "[", "numVert", "]"}], " ", "<>", " ", 
        "\"\< \>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", "numBoundaryMarkers", "]"}], " ", "<>", " ", 
        "\"\<\\n\>\""}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"i", "\[LessEqual]", " ", "numEdges"}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"WriteString", "[", 
         RowBox[{"stream", ",", " ", 
          RowBox[{
           RowBox[{"ToString", "[", "i", "]"}], " ", "<>", " ", "\"\< \>\"", 
           " ", "<>", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"edges", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], " ", "]"}], " ", "<>", 
           " ", "\"\< \>\"", " ", "<>", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"edges", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}], " ", "]"}], " ", "<>", 
           " ", "\"\<\\n\>\""}]}], " ", "]"}], ";"}]}], "\[IndentingNewLine]",
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"stream", ",", 
       RowBox[{
        RowBox[{"ToString", "[", "numHoles", "]"}], " ", "<>", " ", 
        "\"\<\\n\>\""}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"stream", ",", " ", 
       RowBox[{
        RowBox[{"ToString", "[", "1", "]"}], " ", "<>", " ", "\"\< \>\"", " ",
         "<>", " ", 
        RowBox[{"ToString", "[", 
         RowBox[{"CForm", "[", 
          RowBox[{"hole", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], " ", "]"}], " ", "<>", 
        " ", "\"\< \>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", 
         RowBox[{"CForm", "[", 
          RowBox[{"hole", "[", 
           RowBox[{"[", "2", "]"}], "]"}], " ", "]"}], " ", "]"}], " ", "<>", 
        " ", "\"\<\\n\>\""}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Close", "[", "stream", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.6676576656071863`*^9, 3.667657669374466*^9}, {
   3.66765774079263*^9, 3.667657749240988*^9}, {3.667658188491056*^9, 
   3.667658273365045*^9}, {3.6676584360984898`*^9, 3.667658518341626*^9}, {
   3.667658561519208*^9, 3.667658562325863*^9}, {3.66765895383007*^9, 
   3.667659023541954*^9}, {3.667659069055328*^9, 3.6676591277456293`*^9}, {
   3.6676597588717537`*^9, 3.667659990752233*^9}, {3.667660116109655*^9, 
   3.66766020360994*^9}, {3.667660296508556*^9, 3.66766030407638*^9}, {
   3.667660817614253*^9, 3.667660879151476*^9}, {3.667660965355318*^9, 
   3.667660995987316*^9}, {3.667661144216878*^9, 3.6676612144348793`*^9}, {
   3.667661257095067*^9, 3.6676612975103893`*^9}, {3.667661330440637*^9, 
   3.6676613574483633`*^9}, {3.667661396763988*^9, 3.667661396985454*^9}, {
   3.6676614432854033`*^9, 3.6676614478843193`*^9}, {3.6676614935506363`*^9, 
   3.667661493741478*^9}, {3.6676618275142717`*^9, 3.667661857401573*^9}, 
   3.667665090197277*^9, {3.728387741474135*^9, 3.728387774358226*^9}, {
   3.728387915481104*^9, 3.728387919194045*^9}, {3.728388095765745*^9, 
   3.728388140968268*^9}, {3.728389199736742*^9, 3.728389203392461*^9}, {
   3.7283892370903673`*^9, 3.728389266379982*^9}, {3.7354016701357737`*^9, 
   3.7354016972402287`*^9}, {3.735612733028191*^9, 3.735612752333796*^9}},
 CellLabel->
  "In[524]:=",ExpressionUUID->"d4bc25b8-5a67-4f48-b9b6-d721933a7ec5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Assumes", " ", "regionHole", " ", "is", " ", "convex"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"AcuteTriangulateAnnulus", "::", "usage"}], " ", "=", " ", 
     "\"\<AcuteTriangulateAnnulus[vertices_, extV_, intV_] makes an acute \
triangulation of a given polygonal topological annulus.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AcuteTriangulateAnnulus", "::", "aCuteNotFound"}], " ", "=", 
     " ", "\"\<The aCute program was not found\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AcuteTriangulateAnnulus", "[", 
     RowBox[{"vertices_", ",", " ", "extV_", ",", " ", "intV_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "region", ",", "regionHole", ",", " ", "holePoint", ",", " ", "file", 
        ",", " ", "numFlags", ",", " ", "numAttributes", ",", " ", "rawNode", 
        ",", " ", "rawEle", ",", " ", "cleanNode", ",", " ", "cleanEle", ",", 
        " ", "points", ",", " ", "triangles", ",", " ", "edges", ",", " ", 
        "mesh", ",", " ", "T", ",", " ", "triangleCoors"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"regionHole", "=", " ", 
        RowBox[{"Polygon", "[", 
         RowBox[{"vertices", "[", 
          RowBox[{"[", "intV", "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"region", " ", "=", " ", 
        RowBox[{"BoundaryMeshRegion", "[", 
         RowBox[{"vertices", ",", "\[IndentingNewLine]", 
          RowBox[{"Line", "[", 
           RowBox[{"Append", "[", 
            RowBox[{"extV", ",", 
             RowBox[{"extV", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Line", "[", 
           RowBox[{"Append", "[", 
            RowBox[{"intV", ",", 
             RowBox[{"intV", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"holePoint", " ", "=", " ", 
        RowBox[{"N", "[", 
         RowBox[{
          RowBox[{"Mean", "[", 
           RowBox[{"vertices", "[", 
            RowBox[{"[", "intV", "]"}], "]"}], "]"}], ",", " ", "5"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"file", " ", "=", " ", "\"\<acuteTriangulateAnnulus\>\""}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"MakePolyFile", "[", 
        RowBox[{"file", ",", " ", "region", ",", " ", "holePoint"}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Run", "[", 
        RowBox[{
        "\"\<chmod 777 \>\"", " ", "<>", " ", "\"\<\\\"\>\"", " ", "<>", " ", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Directory", "[", "]"}], ",", "file"}], "}"}], "]"}], " ",
          "<>", " ", "\"\<.poly\>\"", "  ", "<>", " ", "\"\<\\\"\>\""}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"FileExistsQ", "[", "\"\<acute\>\"", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Run", "[", 
           RowBox[{
           "\"\<./acute -q35 -U89 \>\"", " ", "<>", " ", "\"\<\\\"\>\"", " ", 
            "<>", " ", 
            RowBox[{"FileNameJoin", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Directory", "[", "]"}], ",", "file"}], "}"}], "]"}], 
            " ", "<>", "\"\<.poly\>\"", " ", "<>", " ", "\"\<\\\"\>\""}], " ",
            "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"FileExistsQ", "[", 
             RowBox[{
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Directory", "[", "]"}], ",", 
                 RowBox[{"file", "<>", " ", "\"\<.1.node\>\""}]}], "}"}], 
               "]"}], " ", "<>", " ", "\"\<.txt\>\""}], "]"}], ",", 
            RowBox[{"DeleteFile", "[", 
             RowBox[{
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Directory", "[", "]"}], ",", 
                 RowBox[{"file", " ", "<>", " ", "\"\<.1.node\>\""}]}], "}"}],
                "]"}], " ", "<>", " ", "\"\<.txt\>\""}], "]"}]}], "]"}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"FileExistsQ", "[", 
             RowBox[{
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Directory", "[", "]"}], ",", 
                 RowBox[{"file", " ", "<>", " ", "\"\<.1.ele\>\""}]}], "}"}], 
               "]"}], " ", "<>", " ", "\"\<.txt\>\""}], "]"}], ",", 
            RowBox[{"DeleteFile", "[", 
             RowBox[{
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Directory", "[", "]"}], ",", 
                 RowBox[{"file", " ", "<>", " ", "\"\<.1.ele\>\""}]}], "}"}], 
               "]"}], " ", "<>", " ", "\"\<.txt\>\""}], "]"}]}], "]"}], ";", 
          RowBox[{"CopyFile", "[", 
           RowBox[{
            RowBox[{"FileNameJoin", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Directory", "[", "]"}], ",", 
               RowBox[{"file", " ", "<>", " ", "\"\<.1.node\>\""}]}], "}"}], 
             "]"}], ",", " ", 
            RowBox[{
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Directory", "[", "]"}], ",", 
                RowBox[{"file", " ", "<>", " ", "\"\<.1.node\>\""}]}], "}"}], 
              "]"}], " ", "<>", " ", "\"\<.txt\>\""}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"CopyFile", "[", 
           RowBox[{
            RowBox[{"FileNameJoin", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Directory", "[", "]"}], ",", 
               RowBox[{"file", " ", "<>", " ", "\"\<.1.ele\>\""}]}], "}"}], 
             "]"}], ",", " ", 
            RowBox[{
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Directory", "[", "]"}], ",", 
                RowBox[{"file", " ", "<>", " ", "\"\<.1.ele\>\""}]}], "}"}], 
              "]"}], " ", "<>", " ", "\"\<.txt\>\""}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"numFlags", " ", "=", " ", "2"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"numAttributes", " ", "=", " ", "0"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"rawNode", " ", "=", " ", 
           RowBox[{"Import", "[", 
            RowBox[{"file", " ", "<>", "\"\<.1.node.txt\>\""}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"rawEle", " ", "=", " ", 
           RowBox[{"Import", "[", 
            RowBox[{"file", " ", "<>", " ", "\"\<.1.ele.txt\>\""}], "]"}]}], 
          ";", 
          RowBox[{"cleanNode", " ", "=", " ", 
           RowBox[{"Map", "[", 
            RowBox[{"Internal`StringToDouble", ",", " ", 
             RowBox[{"Partition", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"StringSplit", "[", "rawNode", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"5", ";;", 
                  RowBox[{"-", 
                   RowBox[{"(", 
                    RowBox[{"numFlags", " ", "+", " ", "6"}], ")"}]}]}], 
                 "]"}], "]"}], ",", 
               RowBox[{"4", "+", "numAttributes"}]}], "]"}], ",", " ", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"cleanEle", " ", "=", " ", 
           RowBox[{"Map", "[", 
            RowBox[{"ToExpression", ",", " ", 
             RowBox[{"Partition", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"StringSplit", "[", "rawEle", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"4", ";;", 
                  RowBox[{"-", 
                   RowBox[{"(", 
                    RowBox[{"numFlags", " ", "+", " ", "6"}], ")"}]}]}], 
                 "]"}], "]"}], ",", "4"}], "]"}], ",", " ", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], ";", 
          RowBox[{"points", " ", "=", " ", 
           RowBox[{"cleanNode", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";", 
          RowBox[{"triangles", " ", "=", " ", 
           RowBox[{"cleanEle", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "]"}], "]"}]}], 
          ";", 
          RowBox[{"edges", " ", "=", " ", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{"EdgesWrapCompiled", ",", " ", "triangles"}], "]"}], 
             ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"DeleteFile", "[", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Directory", "[", "]"}], ",", 
              RowBox[{"file", " ", "<>", " ", "\"\<.1.node\>\""}]}], "}"}], 
            "]"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"DeleteFile", "[", 
           RowBox[{
            RowBox[{"FileNameJoin", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Directory", "[", "]"}], ",", 
               RowBox[{"file", " ", "<>", " ", "\"\<.1.node\>\""}]}], "}"}], 
             "]"}], " ", "<>", " ", "\"\<.txt\>\""}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"DeleteFile", "[", 
           RowBox[{
            RowBox[{"FileNameJoin", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Directory", "[", "]"}], ",", 
               RowBox[{"file", " ", "<>", " ", "\"\<.1.ele\>\""}]}], "}"}], 
             "]"}], " ", "<>", " ", "\"\<.txt\>\""}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"DeleteFile", "[", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Directory", "[", "]"}], ",", 
              RowBox[{"file", " ", "<>", " ", "\"\<.1.ele\>\""}]}], "}"}], 
            "]"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"DeleteFile", "[", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Directory", "[", "]"}], ",", 
              RowBox[{"file", " ", "<>", " ", "\"\<.1.poly\>\""}]}], "}"}], 
            "]"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"DeleteFile", "[", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Directory", "[", "]"}], ",", 
              RowBox[{"file", " ", "<>", " ", "\"\<.poly\>\""}]}], "}"}], 
            "]"}], "]"}], ";", "\n", 
          RowBox[{"Return", "[", 
           RowBox[{"{", 
            RowBox[{"points", ",", " ", "edges", ",", " ", "triangles"}], 
            "}"}], "]"}]}], "\n", ",", "\[IndentingNewLine]", 
         RowBox[{"Message", "[", 
          RowBox[{"AcuteTriangulateAnnulus", "::", "aCuteNotFound"}], "]"}]}],
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.728314855738679*^9, 3.728314885831744*^9}, {
   3.728314969697155*^9, 3.728314972173195*^9}, {3.7283216080238323`*^9, 
   3.7283216132219152`*^9}, {3.7283217330035353`*^9, 3.728321735136095*^9}, {
   3.728321772177478*^9, 3.7283217849376287`*^9}, {3.72832182040061*^9, 
   3.728321822598401*^9}, {3.728322802965671*^9, 3.728322803358184*^9}, {
   3.72832343737201*^9, 3.728323455742305*^9}, {3.7283234938578777`*^9, 
   3.728323504691516*^9}, {3.728323657795681*^9, 3.728323660787603*^9}, {
   3.728323709556827*^9, 3.728323716959447*^9}, {3.7283239327602253`*^9, 
   3.728324009067093*^9}, {3.7283241773610477`*^9, 3.728324177663571*^9}, {
   3.728324265696389*^9, 3.7283242906940813`*^9}, {3.72832441971173*^9, 
   3.728324428626895*^9}, {3.728324558684022*^9, 3.728324569236149*^9}, {
   3.728386022282876*^9, 3.72838603777669*^9}, {3.728386089488171*^9, 
   3.7283861018622913`*^9}, {3.728386190020772*^9, 3.728386214444037*^9}, {
   3.7283862469734383`*^9, 3.728386434891671*^9}, {3.728386479067767*^9, 
   3.7283864813206987`*^9}, {3.72838701274194*^9, 3.728387016859054*^9}, {
   3.7283870655987167`*^9, 3.728387095916045*^9}, {3.7283881546613197`*^9, 
   3.728388164768138*^9}, {3.7283883117368917`*^9, 3.728388314731822*^9}, {
   3.728388403332889*^9, 3.728388436502393*^9}, {3.7283894738363934`*^9, 
   3.7283894774070597`*^9}, {3.72838952447589*^9, 3.7283895342706842`*^9}, {
   3.728389583524931*^9, 3.728389633891972*^9}, {3.728389671932597*^9, 
   3.7283897223765574`*^9}, {3.728389754177987*^9, 3.728389764579842*^9}, {
   3.728389946060816*^9, 3.728390071066842*^9}, {3.728390239351016*^9, 
   3.7283902412868443`*^9}, {3.7284755871026278`*^9, 3.728475590066146*^9}, 
   3.73072260982274*^9, {3.730722690353003*^9, 3.730722693164699*^9}, {
   3.7307227662188473`*^9, 3.730722768006422*^9}, {3.735404123018463*^9, 
   3.7354041545396338`*^9}, {3.7356127001735907`*^9, 
   3.7356127015249443`*^9}, {3.810672076342502*^9, 3.810672093637471*^9}, {
   3.810728863762619*^9, 3.8107288757002172`*^9}},
 CellLabel->
  "In[526]:=",ExpressionUUID->"1d72571a-fd2b-401a-a90e-19cba3ff7bd1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PointInsideConvexPolygonCompiled", "::", "usage"}], " ", "=", 
   " ", "\"\<PointInsideConvexPolygonCompiled[{{pointX, _Real}, {pointY, \
_Real}, {polygon, _Integer, 1}, {coordinates, _Real, 2}}] should only be used \
on convex polygons that are oriented counterclockwise. Returns True if the \
point lies inside the given polygon.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"PointInsideConvexPolygonCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pointX", ",", " ", "_Real"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"pointY", ",", " ", "_Real"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"polygon", ",", " ", "_Integer", ",", " ", "1"}], "}"}], ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{"coordinates", ",", " ", "_Real", ",", " ", "2"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nPolygon", ",", " ", "polygonWrap", ",", "i"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"polygonWrap", " ", "=", " ", 
         RowBox[{"Append", "[", 
          RowBox[{"polygon", ",", " ", 
           RowBox[{"polygon", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nPolygon", "=", 
         RowBox[{"Length", "[", "polygon", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", "nPolygon"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"PointToRightOfLineCompiled", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"coordinates", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"polygonWrap", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", " ", "1"}], "]"}], 
                "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"coordinates", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"polygonWrap", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "2"}], "]"}], "]"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"coordinates", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"polygonWrap", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", "1"}], "]"}], 
                "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"coordinates", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"polygonWrap", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", "2"}], "]"}], 
                "]"}], ",", "\[IndentingNewLine]", "pointX", ",", 
               "\[IndentingNewLine]", "pointY"}], "\[IndentingNewLine]", 
              "]"}], ",", 
             RowBox[{"Return", "[", "False", "]"}], ","}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "True", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], 
       "}"}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7352405829221697`*^9, 3.735240628586239*^9}, 
   3.735241007815625*^9, 3.73540421626162*^9},
 CellLabel->
  "In[529]:=",ExpressionUUID->"18c1bea1-fe3d-408a-9d7b-4494ed32bdbb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PointInsideConvexPaddedPolygonCompiled", "::", "usage"}], " ", 
   "=", " ", 
   "\"\<PointInsideConvexPaddedPolygonCompiled[{{pointX, _Real}, {pointY, \
_Real}, {polygon, _Integer, 1}, {coordinates, _Real, 2}}] should only be used \
on convex polygons that are oriented counterclockwise. Returns True if the \
point lies inside the given polygon. Similar to \
PointInsideConvexPolygonCompiled but works properly for padded polygons as \
well.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PointInsideConvexPaddedPolygonCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pointX", ",", " ", "_Real"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"pointY", ",", " ", "_Real"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"polygon", ",", " ", "_Integer", ",", " ", "1"}], "}"}], ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{"coordinates", ",", " ", "_Real", ",", " ", "2"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "nPolygon", ",", "truePolygonLength", ",", "polygonWrapPadded", ",", 
         "i"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nPolygon", "=", 
         RowBox[{"Length", "[", "polygon", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"truePolygonLength", " ", "=", " ", "nPolygon"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Length", " ", "of", " ", "the", " ", "unpadded"}], ",", 
          " ", 
          RowBox[{"non", "-", 
           RowBox[{"wrapped", " ", "polygon"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", "nPolygon"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"polygon", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"truePolygonLength", "=", 
               RowBox[{"i", "-", "1"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"Break", "[", "]"}], ";"}], "\[IndentingNewLine]", 
             ","}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"polygonWrapPadded", " ", "=", " ", 
         RowBox[{"Prepend", "[", 
          RowBox[{"polygon", ",", " ", 
           RowBox[{"polygon", "[", 
            RowBox[{"[", "truePolygonLength", "]"}], "]"}]}], " ", "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", "truePolygonLength"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"PointToRightOfLineCompiled", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"coordinates", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"polygonWrapPadded", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", " ", "1"}], "]"}], 
                "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"coordinates", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"polygonWrapPadded", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "2"}], "]"}], "]"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"coordinates", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"polygonWrapPadded", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", "1"}], "]"}], 
                "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"coordinates", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"polygonWrapPadded", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", "2"}], "]"}], 
                "]"}], ",", "\[IndentingNewLine]", "pointX", ",", 
               "\[IndentingNewLine]", "pointY"}], "\[IndentingNewLine]", 
              "]"}], ",", 
             RowBox[{"Return", "[", "False", "]"}], ","}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "True", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], 
       "}"}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.735252453050376*^9, 3.735252454576675*^9}, {
   3.735252902440363*^9, 3.735253138820917*^9}, {3.735253215427046*^9, 
   3.7352532201546164`*^9}, 3.735269500828233*^9, {3.735401800212863*^9, 
   3.735401852835919*^9}},
 CellLabel->
  "In[531]:=",ExpressionUUID->"4a03d626-b499-4e1b-bfdf-4e5c8878f0ca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FindPointInPolygonCompiled", "::", "usage"}], "=", 
   "\"\<FindPointInPolygonCompiled[{{pointX,_Real},{pointY,_Real},{\
paddedPolygonization,_Integer,2},{polygonizationCoordinates,_Real,2}}] finds \
the index of the face in the given paddedPolygonization that contains the \
given point.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindPointInPolygonCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pointX", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"pointY", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"paddedPolygonization", ",", "_Integer", ",", "2"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"polygonizationCoordinates", ",", "_Real", ",", "2"}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nPolygons", ",", "maxPolygonLength", ",", "i"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nPolygons", "=", 
         RowBox[{"Length", "[", "paddedPolygonization", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"maxPolygonLength", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"paddedPolygonization", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", "nPolygons"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"PointInsideConvexPaddedPolygonCompiled", "[", 
              RowBox[{"pointX", ",", "pointY", ",", 
               RowBox[{"paddedPolygonization", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               "polygonizationCoordinates"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Return", "[", "i", "]"}], "\[IndentingNewLine]", ","}], 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "0", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<InlineExternalDefinitions\>\"", " ", "->", " ", "True"}], 
       "}"}]}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[533]:=",ExpressionUUID->"26876566-9c18-464f-83cf-39e7df770b3e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PadPolygonsToMatrix", "::", "usage"}], "=", 
   "\"\<PadPolygonsToMatrix[polygons] takes a list of polygons and pads with \
zeros on the right to make the ragged array a proper matrix.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PadPolygonsToMatrix", " ", "=", " ", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", "polygons", "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "maxPolygonLength", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"maxPolygonLength", " ", "=", " ", 
         RowBox[{"Max", "[", 
          RowBox[{"Map", "[", 
           RowBox[{"Length", ",", "polygons"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"PadRight", "[", 
           RowBox[{
            RowBox[{"polygons", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", " ", "maxPolygonLength"}], 
           " ", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "polygons", "]"}]}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.735251609683495*^9, 3.7352517201522293`*^9}, {
  3.735251773500428*^9, 3.735251812019182*^9}, {3.735401863332139*^9, 
  3.7354019081888227`*^9}},
 CellLabel->
  "In[535]:=",ExpressionUUID->"a1c3ec6a-f915-4164-8ea4-b27798357efb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FixDegeneratePolygonCompiled", "::", "usage"}], " ", "=", " ", 
   "\"\<FixDegeneratePolygonCompiled[{polygon, _Integer,1}] is a compiled \
function to remove any duplicate, adjacent indices in a list of \
integers.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"FixDegeneratePolygonCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"polygon", ",", " ", "_Integer", ",", "1"}], "}"}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "nPolygon", ",", " ", "i", ",", " ", "toDelete", ",", "counter", ",", 
         "fixedPolygon"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nPolygon", "=", 
         RowBox[{"Length", "[", "polygon", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"toDelete", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "1000", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"counter", " ", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "0"}], ",", 
          RowBox[{"i", "<", "nPolygon"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"polygon", "[", 
               RowBox[{"[", 
                RowBox[{"i", "+", "1"}], "]"}], "]"}], "\[Equal]", 
              RowBox[{"polygon", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"i", " ", "+", " ", "1"}], ",", "nPolygon"}], 
                  "]"}], " ", "+", "1"}], "]"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"counter", " ", "=", " ", 
               RowBox[{"counter", " ", "+", "1"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"toDelete", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "=", 
               RowBox[{"i", "+", "1"}]}], ";"}], ","}], "\[IndentingNewLine]",
             "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"counter", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"fixedPolygon", " ", "=", " ", "polygon"}], ";"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"fixedPolygon", " ", "=", 
            RowBox[{"Delete", "[", 
             RowBox[{"polygon", ",", " ", 
              RowBox[{"List", "/@", 
               RowBox[{"toDelete", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ";;", "counter"}], "]"}], "]"}]}]}], " ", 
             "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "fixedPolygon", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.735130981175321*^9, 3.73513102000014*^9}, {
   3.735255060292495*^9, 3.7352550616856327`*^9}, 3.735401920289456*^9},
 CellLabel->
  "In[537]:=",ExpressionUUID->"7c6adec0-4c58-4058-85df-1a0da5b7c35f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PolygonOrientedCCKQCompiled", "::", "usage"}], "=", 
   "\"\<PolygonOrientedCCKQCompiled[{{polygon,_Integer,1},{coordinates,_Real,\
2}}]\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PolygonOrientedCCKQCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"polygon", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"coordinates", ",", "_Real", ",", "2"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "polygon", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "0"}], ",", 
          RowBox[{"i", "<", "n"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"PointToRightOfLineCompiled", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"coordinates", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"polygon", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", "1"}], "]"}], 
                "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"coordinates", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"polygon", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", "2"}], "]"}], 
                "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"coordinates", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"polygon", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "n"}], "]"}], "+", "1"}], 
                    "]"}], "]"}], ",", "1"}], "]"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"coordinates", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"polygon", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "n"}], "]"}], "+", "1"}], 
                    "]"}], "]"}], ",", "2"}], "]"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"coordinates", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"polygon", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"i", "+", "2"}], ",", "n"}], "]"}], "+", "1"}], 
                    "]"}], "]"}], ",", "1"}], "]"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"coordinates", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"polygon", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"i", "+", "2"}], ",", "n"}], "]"}], "+", "1"}], 
                    "]"}], "]"}], ",", "2"}], "]"}], "]"}]}], " ", 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Return", "[", "False", "]"}], ","}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "True", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<InlineExternalDefinitions\>\"", " ", "->", " ", "True"}], 
       "}"}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7354063251590014`*^9, 3.735406363153989*^9}, {
  3.735406500240082*^9, 3.735406578786008*^9}, {3.7354066374921207`*^9, 
  3.73540675643204*^9}, {3.735406840818421*^9, 3.735406899718424*^9}, {
  3.735406945959034*^9, 3.7354069790720882`*^9}, {3.7354071716388607`*^9, 
  3.7354072148959923`*^9}},
 CellLabel->
  "In[539]:=",ExpressionUUID->"d37d4ac1-2f11-4032-ac3a-0d89ceb99768"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ReindexLambdaFacesNDLUAC", "::", "usage"}], "=", 
   "\"\<ReindexLambdaFacesNDLUAC[{{TCoordinates,_Real, \
2},{LambdaCoordinates,_Real,2}, {paddedPolygons, _Integer, 2}, {nTCoor, \
_Integer}}] is a compiled function that returns a permutation giving a list \
of polygon indices containing ith triangle vertex\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReindexLambdaFacesNDLUAC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"TCoordinates", ",", "_Real", ",", " ", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"LambdaCoordinates", ",", "_Real", ",", "2"}], "}"}], ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{"paddedPolygons", ",", " ", "_Integer", ",", " ", "2"}], 
        "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"nTCoor", ",", " ", "_Integer"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "i", ",", "j", ",", "permutationInverse", ",", " ", "searchSet"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"permutationInverse", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "nTCoor", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"searchSet", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"1", ",", 
           RowBox[{"{", "nTCoor", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", "nTCoor"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "1"}], ",", 
             RowBox[{"j", "\[LessEqual]", "nTCoor"}], ",", 
             RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"searchSet", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", "1"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"PointInsideConvexPaddedPolygonCompiled", "[", 
                    RowBox[{
                    RowBox[{"TCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"TCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"paddedPolygons", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", 
                    "LambdaCoordinates"}], "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"permutationInverse", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", "j"}], ";",
                     " ", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    "list", " ", "of", " ", "polygon", " ", "indices", " ", 
                    "containing", " ", "ith", " ", "triangle", " ", 
                    "vertex"}], " ", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"searchSet", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "=", "0"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}], ";"}], "\[IndentingNewLine]",
                    ","}], "]"}], ";"}], "\[IndentingNewLine]", ","}], "]"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "permutationInverse", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], 
       "}"}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.735269687448773*^9, 3.735269688173848*^9}, 
   3.7352698666455307`*^9, {3.7352700768046217`*^9, 3.7352700833720016`*^9}, {
   3.735270115765294*^9, 3.735270236289147*^9}, {3.735270266538249*^9, 
   3.735270290088903*^9}, {3.7352703289182663`*^9, 3.735270359749771*^9}, {
   3.735270396805245*^9, 3.735270412369307*^9}, {3.735270524916895*^9, 
   3.73527055288566*^9}, {3.735270706658587*^9, 3.7352707098245077`*^9}, {
   3.7353036919944153`*^9, 3.7353036991456537`*^9}, {3.735309376271194*^9, 
   3.73530944074541*^9}, {3.735309474211988*^9, 3.735309486194215*^9}, {
   3.735309525028344*^9, 3.73530955033315*^9}, {3.735309752899123*^9, 
   3.735309790083682*^9}, {3.7354019282064543`*^9, 3.735401969657254*^9}},
 CellLabel->
  "In[541]:=",ExpressionUUID->"5919d89a-45a3-4b10-a9c5-26d61977a3d9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BuildTriangulationTopologyNDLUACompiled", "::", "usage"}], " ", 
   "=", " ", 
   "\"\<BuildTriangulationTopologyNDLUACompiled[{triangleList,_Integer, 2}] \
returns a list of which triangles are connected to which across which edges. \
This function uses the No Double-Look-up Algorithm for speed.\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"BuildTriangulationTopologyNDLUACompiled", " ", "=", " ", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"triangleList", ",", "_Integer", ",", " ", "2"}], "}"}], "}"}],
      ",", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "n", ",", " ", "edgesWrapOrdered", ",", "triangulationTopology", ",", 
         " ", "currentEdge", ",", "i", ",", " ", "j", ",", " ", "k", ",", " ",
          "m"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "triangleList", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"edgesWrapOrdered", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "}"}], "&"}], ",",
            "triangleList", ",", " ", 
           RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"triangulationTopology", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", " ", 
           RowBox[{"{", "n", "}"}], ",", 
           RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", " ", 
          RowBox[{"i", "\[LessEqual]", "n"}], ",", " ", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"k", "=", "1"}], ",", 
             RowBox[{"k", "\[LessEqual]", "3"}], ",", 
             RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"triangulationTopology", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", " ", "k"}], "]"}], "]"}], "\[NotEqual]", 
                 " ", "0"}], ",", "Continue", ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"currentEdge", " ", "=", " ", 
                  RowBox[{"Reverse", "[", 
                   RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", " ", "k"}], "]"}], "]"}], " ", "]"}]}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"j", "=", "1"}], ",", 
                   RowBox[{"j", "\[LessEqual]", "n"}], ",", 
                   RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"m", "=", "1"}], ",", 
                    RowBox[{"m", "\[LessEqual]", "3"}], ",", 
                    RowBox[{"m", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"currentEdge", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", 
                    RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", " ", "m", ",", " ", "1"}], "]"}], 
                    "]"}]}], " ", "&&", " ", 
                    RowBox[{
                    RowBox[{"currentEdge", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", "\[Equal]", " ", 
                    RowBox[{"edgesWrapOrdered", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", " ", "m", ",", " ", "2"}], "]"}], 
                    "]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"triangulationTopology", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", " ", "k"}], "]"}], "]"}], "=", "j"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"triangulationTopology", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", " ", "m"}], "]"}], "]"}], "=", "i"}], 
                    ";"}], "\[IndentingNewLine]", ","}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "triangulationTopology", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7350009253019867`*^9, 3.735000927020472*^9}, {
   3.7350010283189573`*^9, 3.735001057992239*^9}, {3.735002037587113*^9, 
   3.7350020380112953`*^9}, {3.7350073683001633`*^9, 
   3.7350073692912827`*^9}, {3.735312158691638*^9, 3.7353121614889317`*^9}, 
   3.735312192690722*^9, {3.735401993054838*^9, 3.73540203685042*^9}, 
   3.801259410349639*^9},
 CellLabel->
  "In[543]:=",ExpressionUUID->"687b8177-9efe-4ac2-8b72-22b648980e52"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LocatePointInTriangulationCompiled", "::", "usage"}], " ", "=", 
   " ", "\"\<LocatePointInTriangulationCompiled[{{triangulationVertices,_Real,\
 2}, {triangles,_Integer,2},{triangulationTopology, _Integer,2}, {pointX, \
_Real},{pointY, _Real}, {initialTriangleIndex, _Integer}}] finds the index of \
the triangle in triangles that the point (x,y) belongs to. Should only be \
used on convex triangulations.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"LocatePointInTriangulationCompiled", " ", "=", " ", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"triangulationVertices", ",", "_Real", ",", " ", "2"}], "}"}],
        ",", " ", 
       RowBox[{"{", 
        RowBox[{"triangles", ",", "_Integer", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"triangulationTopology", ",", " ", "_Integer", ",", "2"}], 
        "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"pointX", ",", " ", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"pointY", ",", " ", "_Real"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"initialTriangleIndex", ",", " ", "_Integer"}], "}"}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "triangle", ",", " ", "currentIndex", ",", " ", "toRightOfEdge1", ",",
          " ", "toRightOfEdge2", ",", " ", "toRightOfEdge3"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"currentIndex", " ", "=", " ", "initialTriangleIndex"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{"True", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"triangle", " ", "=", " ", 
            RowBox[{"triangles", "[", 
             RowBox[{"[", "currentIndex", "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"toRightOfEdge1", " ", "=", " ", 
            RowBox[{"PointToRightOfLineCompiled", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"triangulationVertices", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"triangle", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", " ", "1"}], "]"}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"triangulationVertices", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"triangle", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", " ", "2"}], "]"}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"triangulationVertices", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"triangle", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", " ", "1"}], "]"}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"triangulationVertices", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"triangle", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", " ", "2"}], "]"}], 
               "]"}], ",", "\[IndentingNewLine]", "pointX", ",", 
              "\[IndentingNewLine]", "pointY"}], "\[IndentingNewLine]", 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"toRightOfEdge2", " ", "=", " ", 
            RowBox[{"PointToRightOfLineCompiled", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"triangulationVertices", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"triangle", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", " ", "1"}], "]"}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"triangulationVertices", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"triangle", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", " ", "2"}], "]"}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"triangulationVertices", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"triangle", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], ",", " ", "1"}], "]"}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"triangulationVertices", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"triangle", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], ",", " ", "2"}], "]"}], 
               "]"}], ",", "\[IndentingNewLine]", "pointX", ",", 
              "\[IndentingNewLine]", "pointY"}], "\[IndentingNewLine]", 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"toRightOfEdge3", " ", "=", " ", 
            RowBox[{"PointToRightOfLineCompiled", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"triangulationVertices", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"triangle", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], ",", " ", "1"}], "]"}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"triangulationVertices", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"triangle", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], ",", " ", "2"}], "]"}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"triangulationVertices", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"triangle", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", " ", "1"}], "]"}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"triangulationVertices", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"triangle", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", " ", "2"}], "]"}], 
               "]"}], ",", "\[IndentingNewLine]", "pointX", ",", 
              "\[IndentingNewLine]", "pointY"}], "\[IndentingNewLine]", 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "Extending", " ", "the", " ", "lines", " ", "on", " ", "the", 
              " ", "triangle", " ", "partitions", " ", 
              RowBox[{"R", "^", "2"}], " ", "generically", " ", "into", " ", 
              "7", " ", 
              RowBox[{"pieces", ":", " ", "V1"}]}], ",", " ", "V2", ",", " ", 
             "V3", ",", " ", "E12", ",", " ", "E23", ",", " ", "E31", ",", 
             " ", 
             RowBox[{
             "and", " ", "the", " ", "interior", " ", "of", " ", "the", " ", 
              RowBox[{"triangle", "."}]}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"toRightOfEdge1", ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"toRightOfEdge2", ",", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{"In", " ", "region", " ", "V2"}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"currentIndex", " ", "=", " ", 
                 RowBox[{"triangulationTopology", "[", 
                  RowBox[{"[", 
                   RowBox[{"currentIndex", ",", " ", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"RandomInteger", "[", "]"}], " ", "+", " ", "1"}],
                     "]"}], "]"}]}], " ", "]"}], "]"}]}], ";"}], " ", 
               RowBox[{"(*", " ", 
                RowBox[{"Randomly", " ", "1", " ", "or", " ", "2"}], " ", 
                "*)"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"toRightOfEdge3", ",", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{"In", " ", "region", " ", "V1"}], " ", "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"currentIndex", " ", "=", " ", 
                   RowBox[{"triangulationTopology", "[", 
                    RowBox[{"[", 
                    RowBox[{"currentIndex", ",", " ", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"RandomInteger", "[", "]"}], " ", "+", " ", "1"}],
                     "]"}], "]"}]}], " ", "]"}], "]"}]}], ";"}], 
                 "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{"In", " ", "region", " ", "E12"}], " ", "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"currentIndex", " ", "=", " ", 
                   RowBox[{"triangulationTopology", "[", 
                    RowBox[{"[", 
                    RowBox[{"currentIndex", ",", " ", "1"}], "]"}], "]"}]}], 
                  ";"}]}], "\[IndentingNewLine]", "]"}]}], 
              "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"toRightOfEdge2", ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"toRightOfEdge3", ",", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{"In", " ", "region", " ", "V3"}], " ", "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"currentIndex", " ", "=", " ", 
                   RowBox[{"triangulationTopology", "[", 
                    RowBox[{"[", 
                    RowBox[{"currentIndex", ",", " ", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"RandomInteger", "[", "]"}], " ", "+", " ", "1"}],
                     "]"}], "]"}]}], " ", "]"}], "]"}]}], ";"}], " ", 
                 "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{"In", " ", "region", " ", "E23"}], " ", "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"currentIndex", " ", "=", " ", 
                   RowBox[{"triangulationTopology", "[", 
                    RowBox[{"[", 
                    RowBox[{"currentIndex", ",", " ", "2"}], " ", "]"}], 
                    "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
               "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"toRightOfEdge3", ",", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{"In", " ", "region", " ", "E31"}], " ", "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"currentIndex", " ", "=", " ", 
                   RowBox[{"triangulationTopology", "[", 
                    RowBox[{"[", 
                    RowBox[{"currentIndex", ",", "3"}], "]"}], "]"}]}], ";"}],
                  " ", "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                  "In", " ", "the", " ", "interior", " ", "of", " ", "the", 
                   " ", "triangle"}], " ", "*)"}], "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]",
                 "]"}]}], "\[IndentingNewLine]", "]"}]}], 
            "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "currentIndex", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PointToRightOfLineCompiled", "[", "_", "]"}], ",", " ", 
        RowBox[{"True", "|", "False"}]}], "}"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7350583142260857`*^9, 3.735058317256892*^9}, {
   3.735058415295533*^9, 3.735058450596601*^9}, 3.7354020482463903`*^9},
 CellLabel->
  "In[545]:=",ExpressionUUID->"9875c2a2-cd04-48fd-b536-025343f44586"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BuildVUTTrianglesCompiled", "::", "usage"}], "=", 
   "\"\<BuildVUTTrianglesCompiled[{{polygon, _Integer, 1}, {newIndex, \
_Integer}}] takes a polygon and a newIndex and returns the triangles created \
from that polygon with the newIndex at the center. VUT is for 'Voronoi union \
triangulation'.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BuildVUTTrianglesCompiled", " ", "=", " ", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"polygon", ",", " ", "_Integer", ",", " ", "1"}], "}"}], ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{"newIndex", ",", " ", "_Integer"}], "}"}]}], "}"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "VUTTriangles", ",", " ", "counter", ",", "i", ",", " ", "j", ",", 
         " ", "nLambdaFaces", ",", "nPolygon"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nPolygon", " ", "=", " ", 
         RowBox[{"Length", "[", "polygon", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"VUTTriangles", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "nPolygon", "}"}], ",", 
           RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"counter", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "0"}], ",", 
          RowBox[{"j", "<", "nPolygon"}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"counter", " ", "=", " ", 
            RowBox[{"counter", "+", "1"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"VUTTriangles", "[", 
             RowBox[{"[", 
              RowBox[{"counter", ",", " ", 
               RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"polygon", "[", 
               RowBox[{"[", 
                RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", " ", 
              RowBox[{"polygon", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"j", "+", "1"}], ",", "nPolygon"}], "]"}], " ", 
                 "+", " ", "1"}], "]"}], "]"}], ",", " ", "newIndex"}], 
             "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "VUTTriangles", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7350623365694933`*^9, 3.735062482806617*^9}, {
  3.735062782938019*^9, 3.735062829971712*^9}, {3.735063008072228*^9, 
  3.7350630088562517`*^9}, {3.7350630763388357`*^9, 3.735063144116888*^9}, {
  3.735083167624354*^9, 3.735083488680973*^9}, {3.73508371573003*^9, 
  3.735083820211913*^9}, {3.735083877638262*^9, 3.735083880406189*^9}, {
  3.7350839804366417`*^9, 3.735083989690793*^9}, {3.735084378014592*^9, 
  3.73508437897462*^9}, {3.735084715396926*^9, 3.735084720987452*^9}, {
  3.735084803654377*^9, 3.7350848455586843`*^9}, {3.73508516751756*^9, 
  3.735085275367702*^9}, {3.7354020602986526`*^9, 3.7354021283726673`*^9}},
 CellLabel->
  "In[547]:=",ExpressionUUID->"ddcbb14f-5fe4-4b54-9343-43b5469750c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BuildAllVUTTriangles", "::", "usage"}], "=", 
   "\"\<BuildAllVUTTriangles[nLambdaVertices_, LambdaFaces_] takes a number \
of Voronoi verticces and the polygons from that Voronoi diagram and returns \
the triangulation given by the Voronoi union the triangulation.\>\""}], ";", 
  RowBox[{
   RowBox[{"BuildAllVUTTriangles", "[", 
    RowBox[{"nLambdaVertices_", ",", " ", "LambdaFaces_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "VUTTriangles", ",", " ", "nVUTTriangles", ",", "counter", ",", "i", 
       ",", " ", "j", ",", " ", "nLambdaFaces", ",", " ", "polygon", ",", " ",
        "nPolygon"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nLambdaFaces", " ", "=", " ", 
       RowBox[{"Length", "[", "LambdaFaces", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"VUTTriangles", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{",", 
         RowBox[{"{", "nLambdaFaces", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", "nLambdaFaces"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"polygon", " ", "=", " ", 
          RowBox[{"LambdaFaces", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"nPolygon", " ", "=", " ", 
          RowBox[{"Length", "[", "polygon", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"VUTTriangles", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
          RowBox[{"BuildVUTTrianglesCompiled", "[", 
           RowBox[{"polygon", ",", " ", 
            RowBox[{"i", " ", "+", " ", "nLambdaVertices"}]}], "]"}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", "VUTTriangles", "]"}], ",", "3"}], "]"}], 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.735085299065942*^9, 3.735085312457906*^9}, {
  3.735086056266328*^9, 3.7350860675723867`*^9}, {3.735087244418985*^9, 
  3.7350872619623747`*^9}, {3.73508731505206*^9, 3.7350874008002243`*^9}, {
  3.7350875299010153`*^9, 3.735087626614921*^9}, {3.735087926923774*^9, 
  3.735087927320907*^9}, {3.7350879753253613`*^9, 3.735087975738467*^9}, {
  3.7350880852309647`*^9, 3.735088139255617*^9}, {3.735088425013027*^9, 
  3.735088428652768*^9}, {3.735402135566955*^9, 3.735402201502337*^9}},
 CellLabel->
  "In[549]:=",ExpressionUUID->"1e9386ff-ac04-44af-888f-bea60f1e1206"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OrientTriangleCCKCompiled", "::", "usage"}], "=", 
   "\"\<OrientTriangleCCKCompiled[{{triangle, _Integer,1}, {coor,_Real, 2}}] \
takes a triangle and a coordinate list and returns the counterclockwise \
oriented triangle.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OrientTriangleCCKCompiled", " ", "=", " ", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"triangle", ",", " ", "_Integer", ",", "1"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"coor", ",", "_Real", ",", " ", "2"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", " ", "b", ",", " ", "c"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", " ", "b", ",", " ", "c"}], "}"}], " ", "=", " ", 
         RowBox[{"coor", "[", 
          RowBox[{"[", "triangle", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"b", "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", 
               RowBox[{"a", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"c", "[", 
                RowBox[{"[", "2", "]"}], "]"}], " ", "-", " ", 
               RowBox[{"a", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], " ", "-", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"b", "[", 
                RowBox[{"[", "2", "]"}], "]"}], " ", "-", " ", 
               RowBox[{"a", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"c", "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", 
               RowBox[{"a", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], " ", ">", " ", 
           "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "triangle", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"triangle", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
             RowBox[{"triangle", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
             RowBox[{"triangle", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], "]"}]}]}], 
      " ", 
      RowBox[{"(*", " ", 
       RowBox[{"Switch", " ", "2", "nd", " ", "and", " ", "3", "rd"}], " ", 
       "*)"}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.735142410738076*^9, 3.735142479863492*^9}, {
  3.7354022847801313`*^9, 3.735402319179236*^9}},
 CellLabel->
  "In[550]:=",ExpressionUUID->"3684acd5-b38b-4315-a177-9364aaef1b04"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RefineTriangulationTrianglesCompiled", "::", "usage"}], " ", "=", 
   "\"\<RefineTriangulationTrianglesCompiled[{{triangles, \
_Integer,2},{triangulationTopology,_Integer,2},{nTVertices,_Integer}}] uses \
the Mitsuuroko refinement (in order to preserve the property that all \
triangles are acute), in which each triangle in the starting triangulation is \
replaced with four triangles, with the new vertices at the midpoints of the \
edges of the original triangle.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"RefineTriangulationTrianglesCompiled", " ", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"triangles", ",", " ", "_Integer", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"triangulationTopology", ",", "_Integer", ",", "2"}], "}"}], 
       ",", " ", 
       RowBox[{"{", 
        RowBox[{"nTVertices", ",", "_Integer"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "n", ",", " ", "newVertex1", ",", "newVertex2", ",", "newVertex3", 
         ",", "newestVertexCreated", ",", "newTriangleIndex", ",", 
         "newTriangles", ",", "i", ",", " ", "newVerticesRecord", ",", 
         "connectedTriangle", ",", "connectedEdge", ",", 
         "newVerticesLookUpTable"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n", " ", "=", " ", 
         RowBox[{"Length", "[", "triangles", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newVertex1", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"newVertex2", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"newVertex3", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"newTriangles", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"4", "*", "n"}], "}"}], ",", " ", 
           RowBox[{"{", "3", "}"}]}], "]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"New", " ", "triangle", " ", 
          RowBox[{"list", ".", " ", "This"}], " ", "will", " ", "be", " ", 
          "returned", " ", "joined", " ", "with", " ", "newVerticesRecord"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"newVerticesRecord", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "n", "}"}], ",", 
           RowBox[{"{", "3", "}"}]}], "]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Needed", " ", "to", " ", "keep", " ", "track", " ", "of", " ", 
          "which", " ", "new", " ", "vertices", " ", "have", " ", "already", 
          " ", "been", " ", "created", " ", "and", " ", "for", " ", "which", 
          " ", "tri"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"newVerticesLookUpTable", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"3", "*", "n"}], "}"}], ",", 
           RowBox[{"{", "3", "}"}]}], "]"}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{"newVertex", ",", " ", 
          RowBox[{
          "TCoordiantes", " ", "of", " ", "edge", " ", "to", " ", "calculate",
            " ", "midpoint", " ", "later"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"newestVertexCreated", " ", "=", "nTVertices"}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Keeps", " ", "track", " ", "of", " ", "the", " ", "most", " ", 
          "recent", " ", "vertex", " ", "created"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", "n"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"triangulationTopology", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", " ", "1"}], "]"}], "]"}], "\[NotEqual]", 
               " ", "0"}], " ", "&&", " ", 
              RowBox[{
               RowBox[{"triangulationTopology", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", " ", "1"}], "]"}], "]"}], "<", "i"}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"connectedTriangle", " ", "=", " ", 
               RowBox[{"triangulationTopology", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", " ", "1"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"connectedEdge", "=", " ", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{"triangulationTopology", "[", 
                   RowBox[{"[", "connectedTriangle", "]"}], "]"}], ",", " ", 
                  "i"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", " ", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"Either", " ", "1", " ", "for", " ", "E12"}], ",", 
                " ", 
                RowBox[{"2", " ", "for", " ", "E23"}], ",", " ", 
                RowBox[{"or", " ", "3", " ", "for", " ", "E31"}]}], " ", 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{"newVertex1", "=", 
               RowBox[{"newVerticesRecord", "[", 
                RowBox[{"[", 
                 RowBox[{"connectedTriangle", ",", " ", "connectedEdge"}], 
                 "]"}], "]"}]}], ";"}], " ", 
             RowBox[{"(*", " ", 
              RowBox[{
              "Looks", " ", "up", " ", "the", " ", "previously", " ", 
               "created", " ", "vertex"}], " ", "*)"}], "\[IndentingNewLine]",
              ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"newVertex1", " ", "=", " ", 
               RowBox[{"newestVertexCreated", "+", "1"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"newVerticesRecord", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", "newVertex1"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"newestVertexCreated", "=", "newVertex1"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"newVerticesLookUpTable", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"newestVertexCreated", "-", "nTVertices"}], ",", 
                  " ", "1"}], "]"}], "]"}], "=", "newestVertexCreated"}], ";",
               "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"newVerticesLookUpTable", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"newestVertexCreated", "-", "nTVertices"}], ",", 
                  " ", "2"}], "]"}], "]"}], "=", 
               RowBox[{"triangles", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"newVerticesLookUpTable", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"newestVertexCreated", "-", "nTVertices"}], ",", 
                  " ", "3"}], "]"}], "]"}], "=", 
               RowBox[{"triangles", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"triangulationTopology", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", " ", "2"}], "]"}], "]"}], "\[NotEqual]", 
               " ", "0"}], " ", "&&", " ", 
              RowBox[{
               RowBox[{"triangulationTopology", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", " ", "2"}], "]"}], "]"}], "<", "i"}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"connectedTriangle", " ", "=", " ", 
               RowBox[{"triangulationTopology", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", " ", "2"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"connectedEdge", "=", " ", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{"triangulationTopology", "[", 
                   RowBox[{"[", "connectedTriangle", "]"}], "]"}], ",", " ", 
                  "i"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", " ", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"Either", " ", "1", " ", "for", " ", "E12"}], ",", 
                " ", 
                RowBox[{"2", " ", "for", " ", "E23"}], ",", " ", 
                RowBox[{"or", " ", "3", " ", "for", " ", "E31"}]}], " ", 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{"newVertex2", "=", 
               RowBox[{"newVerticesRecord", "[", 
                RowBox[{"[", 
                 RowBox[{"connectedTriangle", ",", " ", "connectedEdge"}], 
                 "]"}], "]"}]}], ";"}], " ", 
             RowBox[{"(*", " ", 
              RowBox[{
              "Looks", " ", "up", " ", "the", " ", "previously", " ", 
               "created", " ", "vertex"}], " ", "*)"}], "\[IndentingNewLine]",
              ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"newVertex2", " ", "=", " ", 
               RowBox[{"newestVertexCreated", "+", "1"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"newVerticesRecord", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", "newVertex2"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"newestVertexCreated", "=", "newVertex2"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"newVerticesLookUpTable", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"newestVertexCreated", "-", "nTVertices"}], ",", 
                  " ", "1"}], "]"}], "]"}], "=", "newestVertexCreated"}], ";",
               "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"newVerticesLookUpTable", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"newestVertexCreated", "-", "nTVertices"}], ",", 
                  " ", "2"}], "]"}], "]"}], "=", 
               RowBox[{"triangles", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"newVerticesLookUpTable", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"newestVertexCreated", "-", "nTVertices"}], ",", 
                  " ", "3"}], "]"}], "]"}], "=", 
               RowBox[{"triangles", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "3"}], "]"}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"triangulationTopology", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", " ", "3"}], "]"}], "]"}], "\[NotEqual]", 
               " ", "0"}], " ", "&&", " ", 
              RowBox[{
               RowBox[{"triangulationTopology", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", " ", "3"}], "]"}], "]"}], "<", "i"}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"connectedTriangle", " ", "=", " ", 
               RowBox[{"triangulationTopology", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", " ", "3"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"connectedEdge", "=", " ", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{"triangulationTopology", "[", 
                   RowBox[{"[", "connectedTriangle", "]"}], "]"}], ",", " ", 
                  "i"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", " ", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"Either", " ", "1", " ", "for", " ", "E12"}], ",", 
                " ", 
                RowBox[{"2", " ", "for", " ", "E23"}], ",", " ", 
                RowBox[{"or", " ", "3", " ", "for", " ", "E31"}]}], " ", 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{"newVertex3", "=", 
               RowBox[{"newVerticesRecord", "[", 
                RowBox[{"[", 
                 RowBox[{"connectedTriangle", ",", " ", "connectedEdge"}], 
                 "]"}], "]"}]}], ";"}], " ", 
             RowBox[{"(*", " ", 
              RowBox[{
              "Looks", " ", "up", " ", "the", " ", "previously", " ", 
               "created", " ", "vertex"}], " ", "*)"}], "\[IndentingNewLine]",
              ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"newVertex3", " ", "=", " ", 
               RowBox[{"newestVertexCreated", "+", "1"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"newVerticesRecord", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "3"}], "]"}], "]"}], "=", "newVertex3"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"newestVertexCreated", "=", "newVertex3"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"newVerticesLookUpTable", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"newestVertexCreated", "-", "nTVertices"}], ",", 
                  " ", "1"}], "]"}], "]"}], "=", "newestVertexCreated"}], ";",
               "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"newVerticesLookUpTable", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"newestVertexCreated", "-", "nTVertices"}], ",", 
                  " ", "2"}], "]"}], "]"}], "=", 
               RowBox[{"triangles", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "3"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"newVerticesLookUpTable", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"newestVertexCreated", "-", "nTVertices"}], ",", 
                  " ", "3"}], "]"}], "]"}], "=", 
               RowBox[{"triangles", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"newTriangleIndex", "=", 
            RowBox[{
             RowBox[{"4", "*", "i"}], "-", "3"}]}], ";", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Starting", " ", "index", " ", "for", " ", "inserting", " ", 
             "new", " ", "triangles"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"newTriangles", "[", 
             RowBox[{"[", 
              RowBox[{"newTriangleIndex", ",", " ", "1"}], "]"}], "]"}], "=", 
            RowBox[{"triangles", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "1"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"newTriangles", "[", 
             RowBox[{"[", 
              RowBox[{"newTriangleIndex", ",", " ", "2"}], "]"}], "]"}], "=", 
            "newVertex1"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"newTriangles", "[", 
             RowBox[{"[", 
              RowBox[{"newTriangleIndex", ",", " ", "3"}], "]"}], "]"}], "=", 
            "newVertex3"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"newTriangles", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"newTriangleIndex", "+", "1"}], ",", " ", "1"}], "]"}],
              "]"}], "=", 
            RowBox[{"triangles", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"newTriangles", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"newTriangleIndex", "+", "1"}], ",", " ", "2"}], "]"}],
              "]"}], "=", "newVertex2"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"newTriangles", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"newTriangleIndex", "+", "1"}], ",", " ", "3"}], "]"}],
              "]"}], "=", "newVertex1"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"newTriangles", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"newTriangleIndex", "+", "2"}], ",", " ", "1"}], "]"}],
              "]"}], "=", 
            RowBox[{"triangles", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"newTriangles", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"newTriangleIndex", "+", "2"}], ",", " ", "2"}], "]"}],
              "]"}], "=", "newVertex3"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"newTriangles", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"newTriangleIndex", "+", "2"}], ",", " ", "3"}], "]"}],
              "]"}], "=", "newVertex2"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"newTriangles", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"newTriangleIndex", "+", "3"}], ",", " ", "1"}], "]"}],
              "]"}], "=", "newVertex1"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"newTriangles", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"newTriangleIndex", "+", "3"}], ",", " ", "2"}], "]"}],
              "]"}], "=", "newVertex2"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"newTriangles", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"newTriangleIndex", "+", "3"}], ",", " ", "3"}], "]"}],
              "]"}], "=", "newVertex3"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"newestVertexCreated", ",", "0", ",", "0"}], "}"}], 
            "}"}], ",", "newTriangles", ",", "newVerticesLookUpTable"}], 
          "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.73531274958344*^9, 3.735312826702038*^9}, 
   3.735315163233832*^9, {3.735316790005989*^9, 3.7353168146832647`*^9}, {
   3.7353171629081383`*^9, 3.735317164823024*^9}, 3.7354043043294287`*^9, 
   3.801253803217972*^9},
 CellLabel->
  "In[552]:=",ExpressionUUID->"e9b0a380-2229-42ed-a366-6389f08939d9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RefineTriangulationVerticesCompiled", "::", "usage"}], "=", 
   "\"\<RefineTriangulationVerticesCompiled[{{TCoordinates,_Real,2},{\
nVertices,_Integer},{newVerticesLookUpTable,_Integer,2}}] creates a list of \
vertices coordinates for the refined triangulation.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RefineTriangulationVerticesCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"TCoordinates", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nVertices", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"newVerticesLookUpTable", ",", "_Integer", ",", "2"}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "nOldVertices", ",", "nAddedVertices", ",", "allVertexCoordinates", 
         ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nOldVertices", "=", 
         RowBox[{"Length", "[", "TCoordinates", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nAddedVertices", "=", 
         RowBox[{"nVertices", "-", "nOldVertices"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"allVertexCoordinates", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"{", "nVertices", "}"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", "nOldVertices"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"allVertexCoordinates", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
            RowBox[{"TCoordinates", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"allVertexCoordinates", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
            RowBox[{"TCoordinates", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", "nAddedVertices"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"allVertexCoordinates", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i", "+", "nOldVertices"}], ",", "1"}], "]"}], "]"}], 
            "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TCoordinates", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"newVerticesLookUpTable", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", "1"}], "]"}], 
                "]"}], "+", 
               RowBox[{"TCoordinates", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"newVerticesLookUpTable", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", " ", "1"}], 
                 "]"}], "]"}]}], ")"}], "/", "2."}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"allVertexCoordinates", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i", "+", "nOldVertices"}], ",", "2"}], "]"}], "]"}], 
            "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TCoordinates", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"newVerticesLookUpTable", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", "2"}], "]"}], 
                "]"}], "+", 
               RowBox[{"TCoordinates", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"newVerticesLookUpTable", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", " ", "2"}], 
                 "]"}], "]"}]}], ")"}], "/", "2."}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "allVertexCoordinates", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7353955311208477`*^9, 3.735395546122045*^9}, {
  3.735395675592404*^9, 3.735395711968202*^9}, {3.735396102460738*^9, 
  3.735396267770583*^9}, {3.7353963120131598`*^9, 3.735396316188241*^9}, {
  3.735398727469565*^9, 3.735398771037022*^9}, {3.735398810927664*^9, 
  3.7353988243267107`*^9}, {3.7353988561272163`*^9, 3.73539886409547*^9}, {
  3.7353989401551867`*^9, 3.73539901033913*^9}, {3.73540027165703*^9, 
  3.7354002833118153`*^9}, {3.73540031456852*^9, 3.735400382890936*^9}, {
  3.735404325854949*^9, 3.7354043585921164`*^9}},
 CellLabel->
  "In[554]:=",ExpressionUUID->"860f6a44-883b-4822-a516-3695febd298a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RefineTriangulation", "::", "usage"}], " ", "=", 
   "\"\<RefineTriangulation[triangulation] uses the Mitsuuroko refinement (in \
order to preserve the property that all triangles are acute), in which each \
triangle in the starting triangulation is replaced with four triangles, with \
the new vertices at the midpoints of the edges of the original \
triangle.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RefineTriangulation", "[", "T_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "nOldVertices", ",", " ", "nOldTriangles", ",", "triangulationTopology", 
      ",", "dataStructure", ",", "nNewVertices", ",", 
      "newTriangulationTriangles", ",", "newVerticesLookUpTable", ",", 
      "newTriangulationVertices", ",", "newTriangulationEdges", ",", "newT"}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nOldVertices", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"T", "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nOldTriangles", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"T", "[", 
        RowBox[{"[", "3", "]"}], "]"}], " ", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"triangulationTopology", "=", 
      RowBox[{"BuildTriangulationTopologyNDLUACompiled", "[", 
       RowBox[{"T", "[", 
        RowBox[{"[", "3", "]"}], "]"}], " ", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dataStructure", "=", 
      RowBox[{"RefineTriangulationTrianglesCompiled", "[", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "triangulationTopology", ",", 
        "nOldVertices"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nNewVertices", "=", 
      RowBox[{"dataStructure", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newTriangulationTriangles", "=", 
      RowBox[{"dataStructure", "[", 
       RowBox[{"[", 
        RowBox[{"2", ";;", 
         RowBox[{
          RowBox[{"4", "*", "nOldTriangles"}], "+", "1"}]}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"newVerticesLookUpTable", "=", 
      RowBox[{"dataStructure", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{"4", "*", "nOldTriangles"}], "+", "2"}], ";;"}], " ", "]"}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newTriangulationVertices", "=", 
      RowBox[{"RefineTriangulationVerticesCompiled", "[", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "nNewVertices", ",", 
        "newVerticesLookUpTable"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newTriangulationEdges", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Map", "[", 
          RowBox[{"EdgesWrapSortCompiled", ",", "newTriangulationTriangles"}],
           "]"}], "]"}], ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newT", "=", 
      RowBox[{"{", 
       RowBox[{
       "newTriangulationVertices", ",", "newTriangulationEdges", ",", 
        "newTriangulationTriangles"}], "}"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.73539565722793*^9, 3.735395671102408*^9}, {
  3.735395743659628*^9, 3.73539604930754*^9}, {3.735399043773081*^9, 
  3.735399053663931*^9}, {3.735399174129126*^9, 3.73539921092247*^9}, {
  3.7353992925984793`*^9, 3.735399345094892*^9}, {3.7353998578749933`*^9, 
  3.73539987988957*^9}, {3.7354043706424522`*^9, 3.735404390001114*^9}, {
  3.7356136538708067`*^9, 3.7356136703736763`*^9}},
 CellLabel->
  "In[556]:=",ExpressionUUID->"1d684129-c7ee-4427-aa80-48a4016234c2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ToRightOfEdgeLookupTriangulationCompiled", "::", "usage"}], "=", 
   "\"\<ToRightOfEdgeLookupTriangulationCompiled[triangles] creates a \
datastructure containing the length of a table in its first row, and in the \
following rows a table with \
{edge[[1]],edge[[2]],triangleToRightOfEdge}\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToRightOfEdgeLookupTriangulationCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"triangles", ",", "_Integer", ",", "2"}], "}"}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "nTriangles", ",", "table", ",", "counter", ",", "i", ",", "j"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nTriangles", "=", 
         RowBox[{"Length", "[", "triangles", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"table", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"3", "*", "nTriangles"}], "+", "1"}], "}"}], ",", 
           RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"counter", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", "nTriangles"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "1"}], ",", 
             RowBox[{"j", "\[LessEqual]", "2"}], ",", 
             RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"counter", "=", 
               RowBox[{"counter", "+", "1"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"table", "[", 
                RowBox[{"[", 
                 RowBox[{"counter", ",", "1"}], "]"}], "]"}], "=", 
               RowBox[{"triangles", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", 
                  RowBox[{"j", "+", "1"}]}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"table", "[", 
                RowBox[{"[", 
                 RowBox[{"counter", ",", "2"}], "]"}], "]"}], "=", 
               RowBox[{"triangles", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"table", "[", 
                RowBox[{"[", 
                 RowBox[{"counter", ",", "3"}], "]"}], "]"}], "=", "i"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"counter", "=", 
            RowBox[{"counter", "+", "1"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"table", "[", 
             RowBox[{"[", 
              RowBox[{"counter", ",", "1"}], "]"}], "]"}], "=", 
            RowBox[{"triangles", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"table", "[", 
             RowBox[{"[", 
              RowBox[{"counter", ",", "2"}], "]"}], "]"}], "=", 
            RowBox[{"triangles", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"table", "[", 
             RowBox[{"[", 
              RowBox[{"counter", ",", "3"}], "]"}], "]"}], "=", "i"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"table", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
         RowBox[{"counter", "-", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "table", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.73557243510076*^9, 3.735572611979041*^9}, {
  3.735574279638008*^9, 3.7355742891212263`*^9}},
 CellLabel->
  "In[558]:=",ExpressionUUID->"ed67832d-f94f-4297-be1c-0cc5daed46ba"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BuildEdgeToRightTriangulationAssociation", "::", "usage"}], "=", 
   "\"\<BuildEdgeToRightTriangulationAssociation[triangles] builds a \
dictionary association between edges in Lambda and the polygon lying to the \
right of that edge.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "BuildEdgeToRightTriangulationAssociation", "[", "triangles_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "toRightOfEdgeLookupTable", ",", "edgeAssociatedToRightTriangle"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"toRightOfEdgeLookupTable", "=", 
      RowBox[{
      "ToRightOfEdgeLookupTriangulationCompiled", "[", "triangles", "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"edgeAssociatedToRightTriangle", "=", 
      RowBox[{"Association", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"toRightOfEdgeLookupTable", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", 
             RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "\[Rule]", 
          RowBox[{"toRightOfEdgeLookupTable", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "3"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{
            RowBox[{"toRightOfEdgeLookupTable", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", "1"}]}], "}"}]}], 
        "]"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.735570491313014*^9, 3.7355706065420523`*^9}, {
  3.735571235261325*^9, 3.735571297847199*^9}, {3.735572814954299*^9, 
  3.7355728533075533`*^9}, {3.735573833124482*^9, 3.7355738365474787`*^9}},
 CellLabel->
  "In[560]:=",ExpressionUUID->"8bb0af07-2dea-420b-bfdf-8cbe5ef6ed7c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ToRightOfEdgeLookupPolygonsCompiled", "::", "usage"}], "=", 
   "\"\<ToRightOfEdgeLookupTableCompiled[paddedPolygons] creates a \
datastructure containing the length of a table in its first row, and in the \
following rows a table with {edge[[1]],edge[[2]],polygonToRightOfEdge}\>\""}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToRightOfEdgeLookupPolygonsCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"paddedPolygons", ",", "_Integer", ",", "2"}], "}"}], "}"}], 
     ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "nPolygons", ",", "maxPolygonLength", ",", "table", ",", "counter", 
         ",", "actualPolygonLength", ",", "i", ",", "j"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nPolygons", "=", 
         RowBox[{"Length", "[", "paddedPolygons", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"maxPolygonLength", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"paddedPolygons", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"table", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"maxPolygonLength", "*", "nPolygons"}], "+", "1"}], 
            "}"}], ",", 
           RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"counter", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"actualPolygonLength", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", "nPolygons"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "maxPolygonLength"}], ",", 
             RowBox[{"j", "\[GreaterEqual]", "1"}], ",", 
             RowBox[{"j", "--"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"paddedPolygons", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[NotEqual]", 
                 "0"}], ",", 
                RowBox[{
                 RowBox[{"actualPolygonLength", "=", "j"}], ";", 
                 RowBox[{"Break", "[", "]"}], ";"}], ","}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "1"}], ",", 
             RowBox[{"j", "\[LessEqual]", 
              RowBox[{"actualPolygonLength", "-", "1"}]}], ",", 
             RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"counter", "=", 
               RowBox[{"counter", "+", "1"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"table", "[", 
                RowBox[{"[", 
                 RowBox[{"counter", ",", "1"}], "]"}], "]"}], "=", 
               RowBox[{"paddedPolygons", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", 
                  RowBox[{"j", "+", "1"}]}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"table", "[", 
                RowBox[{"[", 
                 RowBox[{"counter", ",", "2"}], "]"}], "]"}], "=", 
               RowBox[{"paddedPolygons", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"table", "[", 
                RowBox[{"[", 
                 RowBox[{"counter", ",", "3"}], "]"}], "]"}], "=", "i"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"counter", "=", 
            RowBox[{"counter", "+", "1"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"table", "[", 
             RowBox[{"[", 
              RowBox[{"counter", ",", "1"}], "]"}], "]"}], "=", 
            RowBox[{"paddedPolygons", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"table", "[", 
             RowBox[{"[", 
              RowBox[{"counter", ",", "2"}], "]"}], "]"}], "=", 
            RowBox[{"paddedPolygons", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "actualPolygonLength"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"table", "[", 
             RowBox[{"[", 
              RowBox[{"counter", ",", "3"}], "]"}], "]"}], "=", "i"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"table", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
         RowBox[{"counter", "-", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "table", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.735568860104004*^9, 3.735568901476756*^9}, {
  3.735569045267919*^9, 3.735569227257145*^9}, {3.735569312395952*^9, 
  3.735569342765098*^9}, {3.735569373054336*^9, 3.735569494842186*^9}, {
  3.735569716217537*^9, 3.7355697761807756`*^9}, {3.735569948354254*^9, 
  3.73556995948248*^9}, {3.73557003646871*^9, 3.7355701938261013`*^9}, {
  3.73557022526964*^9, 3.735570293333602*^9}, {3.735572566762135*^9, 
  3.7355725701699133`*^9}, {3.735573872551032*^9, 3.735573887061832*^9}},
 CellLabel->
  "In[562]:=",ExpressionUUID->"50e20fb1-5573-43ff-bade-2834e91b84fd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BuildEdgeToRightPolygonsAssociation", "::", "usage"}], "=", 
   "\"\<BuildEdgeToRightAssociation[paddedPolygons] builds a dictionary \
association between edges in Lambda and the polygon lying to the right of \
that edge.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "BuildEdgeToRightPolygonsAssociation", "[", "paddedPolygons_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "toRightOfEdgeLookupTable", ",", "edgeAssociatedToRightPolygon"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"toRightOfEdgeLookupTable", "=", 
      RowBox[{
      "ToRightOfEdgeLookupPolygonsCompiled", "[", "paddedPolygons", "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"edgeAssociatedToRightPolygon", "=", 
      RowBox[{"Association", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"toRightOfEdgeLookupTable", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", 
             RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "\[Rule]", 
          RowBox[{"toRightOfEdgeLookupTable", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "3"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{
            RowBox[{"toRightOfEdgeLookupTable", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", "1"}]}], "}"}]}], 
        "]"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.735570491313014*^9, 3.7355706065420523`*^9}, {
  3.735571235261325*^9, 3.735571297847199*^9}, {3.735573900078958*^9, 
  3.7355739009253483`*^9}, {3.735578166836656*^9, 3.735578171189905*^9}},
 CellLabel->
  "In[564]:=",ExpressionUUID->"ccdea71f-3262-4a40-80a5-2a0061c71d23"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BuildLambda", "::", "usage"}], "=", 
   "\"\<BuildLambda[T_,regionOuterBoundary_, regionInnerBoundaryList_, \
regionVertexCoordinates_] constructs the Voronoi diagram Lambda.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BuildLambda", "[", 
    RowBox[{
    "T_", ",", "regionOuterBoundary_", ",", " ", "regionInnerBoundaryList_", 
     ",", " ", "regionVertexCoordinates_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"voronoi", ",", "Lambda", ",", "paddedPolygons", ",", "p"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"voronoi", " ", "=", " ", 
       RowBox[{"VoronoiMesh", "[", 
        RowBox[{"T", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Lambda", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"MeshCoordinates", "[", "voronoi", "]"}], ",", " ", "Null", 
         ",", " ", 
         RowBox[{
          RowBox[{"MeshCells", "[", 
           RowBox[{"voronoi", ",", "2"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Lambda", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "=", 
       RowBox[{"Map", "[", 
        RowBox[{"FixDegeneratePolygonCompiled", ",", 
         RowBox[{"Lambda", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], " ", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"paddedPolygons", "=", 
       RowBox[{"PadPolygonsToMatrix", "[", 
        RowBox[{"Lambda", "[", 
         RowBox[{"[", "3", "]"}], "]"}], " ", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{"ReindexLambdaFacesNDLUAC", "[", 
        RowBox[{
         RowBox[{"T", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
         RowBox[{"Lambda", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "paddedPolygons", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"T", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Lambda", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "=", 
       RowBox[{"Lambda", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "p"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Lambda", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "=", 
       RowBox[{"Union", "[", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"EdgesWrapSortCompiled", "[", "#", "]"}], "&"}], ",", 
             RowBox[{"Lambda", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], " ", "]"}], " ", "]"}], ",", 
          "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "Lambda", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.728989741586975*^9, 3.728989766877493*^9}, {
   3.72898981919746*^9, 3.728989876155755*^9}, {3.728989955081195*^9, 
   3.7289900590048532`*^9}, {3.728990089789513*^9, 3.728990103323325*^9}, {
   3.728990135715942*^9, 3.728990149441825*^9}, {3.7289901845059967`*^9, 
   3.728990421087922*^9}, {3.7289904840694427`*^9, 3.7289905576086607`*^9}, {
   3.728990596432827*^9, 3.728990651045089*^9}, {3.72899068663785*^9, 
   3.728990705069606*^9}, {3.728990742436208*^9, 3.728990776593823*^9}, {
   3.728990895463641*^9, 3.7289910905309963`*^9}, {3.728991628034316*^9, 
   3.728991761906144*^9}, {3.7289918503341513`*^9, 3.728991907495338*^9}, {
   3.728991949479959*^9, 3.728991997363986*^9}, {3.7289923709699593`*^9, 
   3.728992372092807*^9}, {3.728992632937949*^9, 3.7289926619639072`*^9}, {
   3.728992694261311*^9, 3.728992694628079*^9}, {3.728993851821144*^9, 
   3.7289938539253263`*^9}, {3.7289960886052732`*^9, 3.728996090365757*^9}, {
   3.728996436921028*^9, 3.728996439241509*^9}, 3.728997952011153*^9, {
   3.730725375462008*^9, 3.730725430701377*^9}, {3.730725706149928*^9, 
   3.730725716572597*^9}, {3.730737592644991*^9, 3.730737593750996*^9}, {
   3.735232744349511*^9, 3.73523274568659*^9}, {3.7352327771298428`*^9, 
   3.7352327828418303`*^9}, {3.735232916669643*^9, 3.7352329983221283`*^9}, {
   3.735233147752419*^9, 3.73523315487638*^9}, 3.735233218903727*^9, {
   3.735233258369515*^9, 3.7352332666177807`*^9}, {3.7352334371670027`*^9, 
   3.7352334474162197`*^9}, {3.7352335155054493`*^9, 3.735233560018849*^9}, {
   3.735240035710691*^9, 3.735240058519291*^9}, {3.73524020615961*^9, 
   3.735240244168213*^9}, 3.735244606501864*^9, {3.735244669774682*^9, 
   3.735244685477619*^9}, {3.735244791922521*^9, 3.735244797514965*^9}, {
   3.735245298083681*^9, 3.735245300219643*^9}, {3.7352453316847963`*^9, 
   3.735245361165472*^9}, {3.7352453973527937`*^9, 3.735245434328157*^9}, {
   3.735245476224449*^9, 3.7352455195634747`*^9}, {3.735246363233296*^9, 
   3.735246413010075*^9}, {3.735246453394697*^9, 3.7352465121793737`*^9}, {
   3.735246549797473*^9, 3.735246555181266*^9}, {3.735246605751795*^9, 
   3.7352466664893723`*^9}, {3.7352466976244793`*^9, 3.735246720710244*^9}, {
   3.735246816241115*^9, 3.7352468845993633`*^9}, {3.735247039438745*^9, 
   3.735247183146921*^9}, {3.735247254381392*^9, 3.735247709295621*^9}, 
   3.735247845751313*^9, {3.735247899842039*^9, 3.735247906193574*^9}, {
   3.7352503918777637`*^9, 3.735250446245088*^9}, 3.73525098108785*^9, 
   3.735251418833638*^9, {3.735403078867413*^9, 3.735403090833679*^9}, {
   3.735403144186989*^9, 3.735403151753495*^9}, {3.735403208234811*^9, 
   3.7354032160590878`*^9}, {3.735403602904564*^9, 3.735403616736146*^9}, {
   3.735404709741948*^9, 3.735404711220317*^9}, {3.735405241361109*^9, 
   3.735405310136561*^9}, {3.73540582560625*^9, 3.7354058268192253`*^9}, {
   3.735405904965907*^9, 3.7354059067488203`*^9}, {3.735405952943609*^9, 
   3.735406017064063*^9}, {3.735406106163766*^9, 3.735406144044537*^9}, {
   3.735406186958362*^9, 3.735406208854218*^9}, 3.735406239968458*^9, {
   3.735407337134179*^9, 3.735407367753689*^9}, {3.735407450816803*^9, 
   3.7354074521157217`*^9}, {3.735407687032548*^9, 3.735407719906992*^9}, 
   3.735407808166972*^9, {3.735407886136702*^9, 3.735407912791321*^9}, 
   3.735407968780737*^9, {3.735408037261977*^9, 3.735408052333046*^9}, {
   3.735408093830502*^9, 3.735408120885145*^9}, {3.735408175768195*^9, 
   3.73540819919239*^9}},
 CellLabel->
  "In[566]:=",ExpressionUUID->"1db5c79d-9caa-4b44-8182-add563980223"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ContainedVerticesIndicatorCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"LambdaCoordinates", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"regionOuterBoundary", ",", "_Integer", ",", "1"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"regionInnerBoundaryList", ",", "_Integer", ",", "2"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"regionVertexCoordinates", ",", "_Real", ",", "2"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "nVertices", ",", "nHoles", ",", "i", ",", "j", ",", 
         "inHoleVerticesIndicatorList", ",", "exteriorVerticesIndicator", ",",
          "containedVerticesIndicator"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nVertices", "=", 
         RowBox[{"Length", "[", "LambdaCoordinates", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nHoles", " ", "=", " ", 
         RowBox[{"Length", "[", "regionInnerBoundaryList", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"containedVerticesIndicator", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"1", ",", 
           RowBox[{"{", "nVertices", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"j", "\[LessEqual]", "nVertices"}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"containedVerticesIndicator", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"PointInsideConvexPaddedPolygonCompiled", "[", 
               RowBox[{
                RowBox[{"LambdaCoordinates", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", " ", "1"}], "]"}], "]"}], ",", " ", 
                RowBox[{"LambdaCoordinates", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "2"}], "]"}], "]"}], ",", " ", 
                "regionOuterBoundary", ",", " ", "regionVertexCoordinates"}], 
               "]"}], ",", "1", ",", "0"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", "nHoles"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "1"}], ",", 
             RowBox[{"j", "\[LessEqual]", "nVertices"}], ",", 
             RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"containedVerticesIndicator", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", "1"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"containedVerticesIndicator", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "=", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"PointInsideConvexPaddedPolygonCompiled", "[", 
                    RowBox[{
                    RowBox[{"LambdaCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", " ", "1"}], "]"}], "]"}], ",", " ", 
                    RowBox[{"LambdaCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "2"}], "]"}], "]"}], ",", " ", 
                    RowBox[{"regionInnerBoundaryList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
                    "regionVertexCoordinates"}], "]"}], ",", "0", ",", "1"}], 
                   "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
                RowBox[{"Continue", "[", "]"}]}], " ", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "containedVerticesIndicator", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<InlineExternalDefinitions\>\"", " ", "->", " ", "True"}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7668526609806547`*^9, 3.766852664348913*^9}},
 CellLabel->
  "In[568]:=",ExpressionUUID->"78df3197-662b-4be7-94bf-5dd2dce2a076"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"ContainedVerticesIndicatorCompiled", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"LambdaCoordinates", ",", "_Real", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"regionOuterBoundary", ",", "_Integer", ",", "1"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"regionInnerBoundaryList", ",", "_Integer", ",", "2"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"regionVertexCoordinates", ",", "_Real", ",", "2"}], "}"}]}],
        "}"}], ",", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "nVertices", ",", "nHoles", ",", "i", ",", "j", ",", 
          "inHoleVerticesIndicatorList", ",", "exteriorVerticesIndicator", 
          ",", "containedVerticesIndicator"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nVertices", "=", 
          RowBox[{"Length", "[", "LambdaCoordinates", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"nHoles", " ", "=", " ", 
          RowBox[{"Length", "[", "regionInnerBoundaryList", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"containedVerticesIndicator", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", "nVertices", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "\[LessEqual]", "nVertices"}], ",", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"containedVerticesIndicator", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"PointInsideConvexPolygonCompiled", "[", 
                RowBox[{
                 RowBox[{"LambdaCoordinates", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", " ", "1"}], "]"}], "]"}], ",", " ", 
                 RowBox[{"LambdaCoordinates", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "2"}], "]"}], "]"}], ",", " ", 
                 "regionOuterBoundary", ",", " ", "regionVertexCoordinates"}],
                 "]"}], ",", "1", ",", "0"}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "\[LessEqual]", "nHoles"}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"j", "=", "1"}], ",", 
              RowBox[{"j", "\[LessEqual]", "nVertices"}], ",", 
              RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"containedVerticesIndicator", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", "1"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"containedVerticesIndicator", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "=", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"PointInsideConvexPolygonCompiled", "[", 
                    RowBox[{
                    RowBox[{"LambdaCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", " ", "1"}], "]"}], "]"}], ",", " ", 
                    RowBox[{"LambdaCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "2"}], "]"}], "]"}], ",", " ", 
                    RowBox[{"regionInnerBoundaryList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
                    "regionVertexCoordinates"}], "]"}], ",", "0", ",", "1"}], 
                    "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
                 RowBox[{"Continue", "[", "]"}]}], " ", "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "containedVerticesIndicator", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"CompilationOptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<InlineExternalDefinitions\>\"", " ", "->", " ", "True"}],
         "}"}]}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.735408129351201*^9, 3.735408157734064*^9}, {
   3.735408377462862*^9, 3.7354083855855103`*^9}, {3.735408423129897*^9, 
   3.7354084366743603`*^9}, {3.735408518772353*^9, 3.735408523620772*^9}, {
   3.73540870023529*^9, 3.7354087597719793`*^9}, {3.735408805758677*^9, 
   3.7354088327002974`*^9}, 3.735409170746593*^9, {3.735409235515338*^9, 
   3.7354092520836773`*^9}, {3.7354092941744957`*^9, 3.735409294584999*^9}, {
   3.735409326503262*^9, 3.735409388689478*^9}, {3.735409455195923*^9, 
   3.7354095571582747`*^9}, {3.735409673521209*^9, 3.735409744275447*^9}, {
   3.7354097782608747`*^9, 3.735409974602666*^9}, {3.7354100144724207`*^9, 
   3.735410127232699*^9}, {3.7354101735782843`*^9, 3.735410329679525*^9}, {
   3.73541037244038*^9, 3.735410408330429*^9}, 3.735411019648601*^9, {
   3.735412110054029*^9, 3.7354121117550507`*^9}, 3.766851508597555*^9, {
   3.7668526505625467`*^9, 3.7668526507614393`*^9}},
 EmphasizeSyntaxErrors->True,
 CellLabel->
  "In[569]:=",ExpressionUUID->"363c882e-ff0f-407d-a340-ada3bbd673c2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ContainedVertices", "[", 
   RowBox[{
   "LambdaCoordinates_", ",", "regionOuterBoundary_", ",", 
    "regionInnerBoundaryList_", ",", "regionVertexCoordinates_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"containedVertices", ",", "containedVerticesIndicator"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"containedVerticesIndicator", "=", 
      RowBox[{"ContainedVerticesIndicatorCompiled", "[", 
       RowBox[{
       "LambdaCoordinates", ",", "regionOuterBoundary", ",", 
        "regionInnerBoundaryList", ",", "regionVertexCoordinates"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"containedVertices", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "LambdaCoordinates", " ", "]"}], " ", "]"}], 
        ",", 
        RowBox[{"containedVerticesIndicator", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"0", "\[Rule]", "False"}], ",", 
           RowBox[{"1", "\[Rule]", "True"}]}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "containedVertices", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.735412622458684*^9, 3.735412761568075*^9}, {
  3.7354127972831917`*^9, 3.735412798512204*^9}, {3.735412923392411*^9, 
  3.735412927477233*^9}},
 CellLabel->
  "In[569]:=",ExpressionUUID->"0b27616d-eea0-4eaa-97ed-76463b6ef2e1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ContainedFaces", "[", 
    RowBox[{"polygons_", ",", "containedVertices_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"containedFacesIndicator", ",", "containedFaces"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"containedFacesIndicator", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ContainsAll", "[", 
           RowBox[{"containedVertices", ",", "#"}], "]"}], "&"}], ",", 
         "polygons"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"containedFaces", "=", 
       RowBox[{"Pick", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "polygons", "]"}], " ", "]"}], ",", 
         "containedFacesIndicator"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "containedFaces", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.735417501886903*^9, 3.73541751467108*^9}, {
  3.735417583409828*^9, 3.735417747967266*^9}, {3.7354180736818*^9, 
  3.735418104082735*^9}, {3.735418202751381*^9, 3.7354183542675467`*^9}, {
  3.735418404918716*^9, 3.7354184445987997`*^9}, {3.735418547789784*^9, 
  3.735418550090116*^9}, {3.735418893437035*^9, 3.73541902400974*^9}},
 CellLabel->
  "In[570]:=",ExpressionUUID->"f02eb623-7e7e-430c-b6d5-50e201bb1fe4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Show2Skeleton", "[", "Lambda_", "]"}], ":=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"Graphics", " ", "/@", " ", 
     RowBox[{"Point", "/@", 
      RowBox[{"Lambda", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Graphics", " ", "/@", " ", 
     RowBox[{"Line", " ", "/@", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Lambda", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], "&"}], " ", "/@", " ", 
        RowBox[{"Lambda", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"RGBColor", "[", 
            RowBox[{"{", 
             RowBox[{".8", ",", " ", ".8", ",", " ", "1"}], "}"}], "]"}], ",",
            " ", 
           RowBox[{"Opacity", "[", ".4", "]"}]}], "]"}], ",", " ", "#"}], 
        "}"}], "]"}], "&"}], " ", "/@", " ", 
     RowBox[{"Polygon", " ", "/@", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Lambda", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], "&"}], " ", "/@", " ", 
        RowBox[{"Lambda", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7289957788042*^9, 3.728995891556141*^9}, 
   3.7289985662888823`*^9, 3.735240156526375*^9, 3.751383780689838*^9},
 CellLabel->
  "In[571]:=",ExpressionUUID->"316a4d07-82ee-48a8-bd4f-73782406e608"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Show2Skeleton", "[", 
   RowBox[{"Lambda_", ",", "highlight_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"showVertices", ",", " ", "showEdges", ",", " ", "showFaces"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"highlight", ",", " ", "\"\<Vertices\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"showVertices", " ", "=", " ", 
         RowBox[{"Show", "[", 
          RowBox[{"Graphics", " ", "/@", " ", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"ToString", "[", "i", "]"}], ",", " ", 
               RowBox[{"Lambda", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", " ", "i"}], "]"}], "]"}]}], " ", "]"}], 
             ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", 
               RowBox[{"Length", "[", 
                RowBox[{"Lambda", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], "}"}]}], 
            "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"showVertices", " ", "=", " ", 
         RowBox[{"Graphics", "[", "]"}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"highlight", ",", " ", "\"\<Edges\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"showEdges", " ", "=", " ", 
         RowBox[{"Show", "[", 
          RowBox[{"Graphics", " ", "/@", " ", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"ToString", "[", "i", "]"}], ",", " ", 
               RowBox[{"Mean", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Lambda", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], "&"}], " ", "/@",
                  " ", 
                 RowBox[{"Lambda", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", " ", "i"}], "]"}], "]"}]}], " ", "]"}]}],
               "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", 
               RowBox[{"Length", "[", 
                RowBox[{"Lambda", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", "]"}]}], "}"}]}], 
            "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"showEdges", " ", "=", " ", 
         RowBox[{"Graphics", "[", "]"}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"highlight", ",", " ", "\"\<Faces\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"showFaces", " ", "=", " ", 
         RowBox[{"Show", "[", 
          RowBox[{"Graphics", " ", "/@", " ", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"ToString", "[", "i", "]"}], ",", " ", 
               RowBox[{"Mean", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Lambda", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], "&"}], " ", "/@",
                  " ", 
                 RowBox[{"Lambda", "[", 
                  RowBox[{"[", 
                   RowBox[{"3", ",", " ", "i"}], "]"}], "]"}]}], " ", "]"}]}],
               "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", 
               RowBox[{"Length", "[", 
                RowBox[{"Lambda", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], " ", "]"}]}], "}"}]}], 
            "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"showFaces", " ", "=", " ", 
         RowBox[{"Graphics", "[", "]"}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"Graphics", " ", "/@", " ", 
        RowBox[{"Point", "/@", 
         RowBox[{"Lambda", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Graphics", " ", "/@", " ", 
        RowBox[{"Line", " ", "/@", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Lambda", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], "&"}], " ", "/@", 
           " ", 
           RowBox[{"Lambda", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"RGBColor", "[", 
               RowBox[{"{", 
                RowBox[{".8", ",", " ", ".8", ",", " ", "1"}], "}"}], "]"}], 
              ",", " ", 
              RowBox[{"Opacity", "[", ".4", "]"}]}], "]"}], ",", " ", "#"}], 
           "}"}], "]"}], "&"}], " ", "/@", " ", 
        RowBox[{"Polygon", " ", "/@", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Lambda", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], "&"}], " ", "/@", 
           " ", 
           RowBox[{"Lambda", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", "showVertices", ",", "\[IndentingNewLine]", 
       "showEdges", ",", "\[IndentingNewLine]", "showFaces"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.728997055444008*^9, 3.7289970594503403`*^9}, {
   3.7289972166704283`*^9, 3.728997241915642*^9}, {3.7289972807303963`*^9, 
   3.728997298411605*^9}, {3.7289973696252737`*^9, 3.72899740609407*^9}, {
   3.7289974379809647`*^9, 3.7289974537485323`*^9}, {3.728997504567378*^9, 
   3.72899761246404*^9}, {3.728997670913082*^9, 3.728997680277712*^9}, {
   3.72899771401372*^9, 3.7289977173819*^9}, {3.7289977654852333`*^9, 
   3.7289977698740473`*^9}, {3.728997809179405*^9, 3.72899786660585*^9}, 
   3.7289985634443007`*^9, 3.735240136337912*^9},
 CellLabel->
  "In[572]:=",ExpressionUUID->"5b93cf2c-5504-47c8-bec3-898ee917d84d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Show2Skeleton", "[", 
   RowBox[{"Lambda_", ",", "highlightNames_", ",", "highlightObjects_", ",", 
    RowBox[{"color_", ":", "Yellow"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "showVertices", ",", " ", "showEdges", ",", " ", "showFaces", ",", 
      "hlVertices", ",", "hlEdges", ",", "hlFaces"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"highlightNames", ",", " ", "\"\<Vertices\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"showVertices", " ", "=", " ", 
         RowBox[{"Show", "[", 
          RowBox[{"Graphics", " ", "/@", " ", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"ToString", "[", "i", "]"}], ",", " ", 
               RowBox[{"Lambda", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", " ", "i"}], "]"}], "]"}]}], " ", "]"}], 
             ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", 
               RowBox[{"Length", "[", 
                RowBox[{"Lambda", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], "}"}]}], 
            "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"showVertices", " ", "=", " ", 
         RowBox[{"Graphics", "[", "]"}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"highlightNames", ",", " ", "\"\<Edges\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"showEdges", " ", "=", " ", 
         RowBox[{"Show", "[", 
          RowBox[{"Graphics", " ", "/@", " ", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"ToString", "[", "i", "]"}], ",", " ", 
               RowBox[{"Mean", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Lambda", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], "&"}], " ", "/@",
                  " ", 
                 RowBox[{"Lambda", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", " ", "i"}], "]"}], "]"}]}], " ", "]"}]}],
               "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", 
               RowBox[{"Length", "[", 
                RowBox[{"Lambda", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", "]"}]}], "}"}]}], 
            "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"showEdges", " ", "=", " ", 
         RowBox[{"Graphics", "[", "]"}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"highlightNames", ",", " ", "\"\<Faces\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"showFaces", " ", "=", " ", 
         RowBox[{"Show", "[", 
          RowBox[{"Graphics", " ", "/@", " ", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"ToString", "[", "i", "]"}], ",", " ", 
               RowBox[{"Mean", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Lambda", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], "&"}], " ", "/@",
                  " ", 
                 RowBox[{"Lambda", "[", 
                  RowBox[{"[", 
                   RowBox[{"3", ",", " ", "i"}], "]"}], "]"}]}], " ", "]"}]}],
               "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", 
               RowBox[{"Length", "[", 
                RowBox[{"Lambda", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], " ", "]"}]}], "}"}]}], 
            "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"showFaces", " ", "=", " ", 
         RowBox[{"Graphics", "[", "]"}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"highlightObjects", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"hlVertices", "=", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Graphics", "[", 
            RowBox[{"{", 
             RowBox[{"color", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
          RowBox[{"Point", "/@", 
           RowBox[{"Lambda", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", 
              RowBox[{"highlightObjects", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}], "]"}]}]}], " ", 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"hlVertices", "=", 
        RowBox[{"Graphics", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"highlightObjects", "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", "]"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"hlEdges", "=", 
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{"color", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
           RowBox[{"Line", "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Lambda", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], "&"}], " ", "/@",
               " ", 
              RowBox[{"Lambda", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", 
                 RowBox[{"highlightObjects", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], " ", "]"}], "]"}]}], 
             ")"}]}]}], "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
       RowBox[{"hlEdges", "=", 
        RowBox[{"Graphics", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"highlightObjects", "[", 
          RowBox[{"[", "3", "]"}], "]"}], " ", "]"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"hlFaces", "=", 
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Directive", "[", 
                RowBox[{
                 RowBox[{"RGBColor", "[", 
                  RowBox[{"0.93", ",", "0.9", ",", "0.03"}], "]"}], ",", " ", 
                 RowBox[{"Opacity", "[", ".6", "]"}]}], "]"}], ",", " ", 
               "#"}], "}"}], "]"}], "&"}], " ", "/@", " ", 
           RowBox[{"Polygon", " ", "/@", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Lambda", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], "&"}], " ", "/@",
               " ", 
              RowBox[{"Lambda", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", 
                 RowBox[{"highlightObjects", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], " ", "]"}], "]"}]}], 
             ")"}]}]}], "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
       RowBox[{"hlFaces", "=", 
        RowBox[{"Graphics", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"Graphics", " ", "/@", " ", 
        RowBox[{"Point", "/@", 
         RowBox[{"Lambda", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Graphics", " ", "/@", " ", 
        RowBox[{"Line", " ", "/@", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Lambda", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], "&"}], " ", "/@", 
           " ", 
           RowBox[{"Lambda", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"RGBColor", "[", 
               RowBox[{"{", 
                RowBox[{".8", ",", " ", ".8", ",", " ", "1"}], "}"}], "]"}], 
              ",", " ", 
              RowBox[{"Opacity", "[", ".4", "]"}]}], "]"}], ",", " ", "#"}], 
           "}"}], "]"}], "&"}], " ", "/@", " ", 
        RowBox[{"Polygon", " ", "/@", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Lambda", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], "&"}], " ", "/@", 
           " ", 
           RowBox[{"Lambda", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", "showVertices", ",", "\[IndentingNewLine]", 
       "showEdges", ",", "\[IndentingNewLine]", "showFaces", ",", 
       "\[IndentingNewLine]", "hlVertices", ",", "\[IndentingNewLine]", 
       "hlEdges", ",", "\[IndentingNewLine]", "hlFaces"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.750082267718547*^9, 3.750082299245132*^9}, {
  3.750082338661422*^9, 3.750082456719252*^9}, {3.750082489711981*^9, 
  3.750082500851864*^9}, {3.750082543551536*^9, 3.750082580860735*^9}, {
  3.750082645733989*^9, 3.7500827140894957`*^9}, {3.75150007598437*^9, 
  3.751500090363346*^9}, {3.751500174839554*^9, 3.751500186170638*^9}, {
  3.761057762762374*^9, 3.761057781974025*^9}},
 CellLabel->
  "In[573]:=",ExpressionUUID->"e2487772-ef9d-4d39-9477-5c3a0af185c0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GSB2", "::", "usage"}], "=", 
   "\"\<New, new and improved \\\\overline{g^*} function computation. Doesn't \
have to recompute shortest paths each usage and instead uses a \
LambdaShortestPathFunction.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GSB2", "[", 
   RowBox[{
   "omega_", ",", "conductanceAssociation_", ",", 
    "toRightOfEdgePolyAssociation_", ",", "g_", ",", "TCoordinates_", ",", 
    "LambdaShortestPathFunction_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gammaLambda", ",", "edges", ",", "n", ",", "gsb"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gammaLambda", " ", "=", " ", 
      RowBox[{"LambdaShortestPathFunction", "[", "omega", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"edges", " ", "=", " ", 
      RowBox[{"EdgesCompiled", "[", "gammaLambda", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "edges", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gsb", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"conductanceAssociation", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"toRightOfEdgePolyAssociation", "[", 
             RowBox[{"edges", "[", 
              RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], ",", 
            RowBox[{"toRightOfEdgePolyAssociation", "[", 
             RowBox[{"Reverse", "[", 
              RowBox[{"edges", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], " ", "]"}]}], 
           "}"}], "]"}], "*", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"g", "@@", 
            RowBox[{"TCoordinates", "[", 
             RowBox[{"[", 
              RowBox[{"toRightOfEdgePolyAssociation", "[", 
               RowBox[{"edges", "[", 
                RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], " ", "]"}], 
             "]"}]}], " ", "-", "\[IndentingNewLine]", 
           RowBox[{"g", "@@", 
            RowBox[{"TCoordinates", "[", 
             RowBox[{"[", 
              RowBox[{"toRightOfEdgePolyAssociation", "[", 
               RowBox[{"Reverse", "[", 
                RowBox[{"edges", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], " ", "]"}], " ", 
              "]"}], "]"}]}]}], " ", "\[IndentingNewLine]", ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Add", " ", "gsb", 
      RowBox[{"(", "omega0", ")"}], " ", "if", " ", "gsb", 
      RowBox[{"(", "omega0", ")"}]}], "\[NotEqual]", "0"}], " ", "*)"}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.738181056468649*^9, 3.738181061263709*^9}, {
   3.7381811085104313`*^9, 3.738181111686392*^9}, {3.738251817949174*^9, 
   3.738251832771859*^9}, {3.750085103931108*^9, 3.750085119362158*^9}, 
   3.750085883467147*^9, {3.750085956847226*^9, 3.7500860088873463`*^9}},
 CellLabel->
  "In[574]:=",ExpressionUUID->"43bf2ed3-1b48-486f-961c-b4be71bc39a4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LineHeightIntersect", "::", "usage"}], " ", "=", " ", 
   "\"\<LineHeightIntersect[{u1_, u2_}, {v1_, v2_}, fu_, fv_, h_] takes \
points u = {u1, u2} and v = {v1, v2}, values fu and fv, and the height value \
h and returns the first two coordinates of the intersection between (the line \
between (u, fu) and (v, fv) ) and the plane parallel to the xy-plane with \
height h.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LineHeightIntersect", "::", "samevalues"}], " ", "=", " ", 
   "\"\<Input f values are the same, so either there is no solution or \
infinite solutions.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LineHeightIntersect", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"u1_", ",", " ", "u2_"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"v1_", ",", " ", "v2_"}], "}"}], ",", " ", "fu_", ",", " ", 
    "fv_", ",", " ", "h_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "t", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"fu", " ", "\[Equal]", " ", "fv"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"LineHeightIntersect", "::", "samevalues"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", "}"}], "]"}], ";"}], "\[IndentingNewLine]", ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"t", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"h", " ", "-", " ", "fu"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"fv", "-", "fu"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{
          RowBox[{"t", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}], " ", "-", " ", 
             RowBox[{"{", 
              RowBox[{"u1", ",", "u2"}], "}"}]}], ")"}]}], "+", 
          RowBox[{"{", 
           RowBox[{"u1", ",", "u2"}], "}"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.668001784566506*^9, 3.6680021395296803`*^9}, {
   3.668002209965711*^9, 3.668002248911662*^9}, 3.668002998324029*^9},
 CellLabel->
  "In[576]:=",ExpressionUUID->"feb4c7cc-40d8-477c-a0d3-5fe5cdf709cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TriLevelSets", "::", "usage"}], "=", 
   "\"\<TriLevelSets[t_, f_, h_, coordinates_] takes a triangle t in terms of \
indices, a function f defined on those indices, and a set of level curve \
heights h0. It returns a list corresponding to h that contains the Lines or \
Triangles corresponding to each level curve height.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"TriLevelSets", "[", 
   RowBox[{"t_", ",", " ", "f_", ",", " ", "h_", ",", " ", "coordinates_"}], 
   "]"}], ":=", " ", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "perm", ",", "values", ",", "lowVertex", ",", "midVertex", ",", 
      "highVertex", ",", "BuildLine", ",", " ", "results"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"perm", " ", "=", " ", 
      RowBox[{"Sort", "[", 
       RowBox[{"t", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", "#1", "]"}], "<", 
          RowBox[{"f", "[", "#2", "]"}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"values", " ", "=", " ", 
      RowBox[{"f", "/@", "perm"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lowVertex", " ", "=", " ", 
      RowBox[{"perm", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"midVertex", " ", "=", " ", 
      RowBox[{"perm", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"highVertex", " ", "=", " ", 
      RowBox[{"perm", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"BuildLine", "[", "height_", "]"}], " ", ":=", " ", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"values", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "<", " ", "height"}], ",", 
             "  ", 
             RowBox[{"height", " ", "<", " ", 
              RowBox[{"values", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], " ", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "\[IndentingNewLine]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"LineHeightIntersect", "[", 
               RowBox[{
                RowBox[{"coordinates", "[", 
                 RowBox[{"[", "lowVertex", "]"}], "]"}], ",", " ", 
                RowBox[{"coordinates", "[", 
                 RowBox[{"[", "midVertex", "]"}], "]"}], ",", " ", 
                RowBox[{"f", "[", "lowVertex", "]"}], ",", " ", 
                RowBox[{"f", "[", "midVertex", "]"}], ",", "height"}], " ", 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"LineHeightIntersect", "[", 
               RowBox[{
                RowBox[{"coordinates", "[", 
                 RowBox[{"[", "lowVertex", "]"}], "]"}], ",", " ", 
                RowBox[{"coordinates", "[", 
                 RowBox[{"[", "highVertex", "]"}], "]"}], ",", " ", 
                RowBox[{"f", "[", "lowVertex", "]"}], ",", " ", 
                RowBox[{"f", "[", "highVertex", "]"}], ",", "height"}], " ", 
               "]"}]}], "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", 
            "]"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"values", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", " ", 
                 "height"}], ",", "  ", 
                RowBox[{"height", " ", "<", " ", 
                 RowBox[{"values", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}]}], " ", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Return", "[", "\[IndentingNewLine]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"LineHeightIntersect", "[", 
                  RowBox[{
                   RowBox[{"coordinates", "[", 
                    RowBox[{"[", "lowVertex", "]"}], "]"}], ",", " ", 
                   RowBox[{"coordinates", "[", 
                    RowBox[{"[", "highVertex", "]"}], "]"}], ",", " ", 
                   RowBox[{"f", "[", "lowVertex", "]"}], ",", " ", 
                   RowBox[{"f", "[", "highVertex", "]"}], ",", "height"}], 
                  " ", "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"LineHeightIntersect", "[", 
                  RowBox[{
                   RowBox[{"coordinates", "[", 
                    RowBox[{"[", "midVertex", "]"}], "]"}], ",", " ", 
                   RowBox[{"coordinates", "[", 
                    RowBox[{"[", "highVertex", "]"}], "]"}], ",", " ", 
                   RowBox[{"f", "[", "midVertex", "]"}], ",", " ", 
                   RowBox[{"f", "[", "highVertex", "]"}], ",", "height"}], 
                  " ", "]"}]}], "\[IndentingNewLine]", "}"}], 
               "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Return", "[", 
               RowBox[{"{", "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"results", " ", "=", " ", 
      RowBox[{"BuildLine", "/@", " ", "h"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "results", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.6680016240616426`*^9, 3.668001633171612*^9}, {
   3.668003019260297*^9, 3.668003132619227*^9}, {3.6680031686136427`*^9, 
   3.668003232696965*^9}, {3.6680032784702873`*^9, 3.668003289012237*^9}, {
   3.668003391089858*^9, 3.668003410403315*^9}, {3.6680035296982403`*^9, 
   3.6680035628921633`*^9}, {3.6680035929351797`*^9, 3.66800368229914*^9}, {
   3.668003899551759*^9, 3.6680039762523603`*^9}, 3.668004184552*^9, {
   3.668004254620109*^9, 3.668004335048758*^9}, {3.668004387230736*^9, 
   3.6680044196297417`*^9}, {3.668004574190752*^9, 3.6680047447048197`*^9}, {
   3.66800477653998*^9, 3.668004993559496*^9}, {3.668006494920439*^9, 
   3.668006520648592*^9}, {3.668006550771018*^9, 3.668006560794951*^9}, {
   3.668006668178399*^9, 3.66800673052493*^9}, 3.668006883761345*^9, {
   3.668006940654258*^9, 3.668006949664846*^9}, {3.668006990632312*^9, 
   3.6680070870508623`*^9}, {3.668009375713716*^9, 3.6680094969028463`*^9}, {
   3.668009584824855*^9, 3.668009587665142*^9}, {3.668009746022111*^9, 
   3.66800992842824*^9}, 3.668047263516433*^9, {3.6680473302740993`*^9, 
   3.668047334994072*^9}, {3.668048183783873*^9, 3.668048243235835*^9}, {
   3.66807613106842*^9, 3.668076134565525*^9}, {3.668282672503365*^9, 
   3.668282693898944*^9}, {3.668284554175704*^9, 3.6682845542386723`*^9}, {
   3.6682862512847977`*^9, 3.668286252771241*^9}, {3.668286437026534*^9, 
   3.668286446870072*^9}, {3.668286483380875*^9, 3.668286485218062*^9}, {
   3.66828651573941*^9, 3.6682866314970827`*^9}, {3.668286737614069*^9, 
   3.668286791535961*^9}, {3.6682868245474367`*^9, 3.668286888001656*^9}, {
   3.668287876991557*^9, 3.668287879882039*^9}, {3.668288459231975*^9, 
   3.668288459783914*^9}, {3.668288503086049*^9, 3.6682885590326653`*^9}, {
   3.668288715408848*^9, 3.668288806216497*^9}, {3.6683043864603443`*^9, 
   3.668304437700169*^9}, {3.66830453865762*^9, 3.668304572113502*^9}, {
   3.668304606664527*^9, 3.668304658091537*^9}, {3.668304794295764*^9, 
   3.6683048290487423`*^9}, {3.6683048659223022`*^9, 3.66830493026615*^9}, {
   3.668305427455645*^9, 3.668305427774625*^9}, {3.668305537207365*^9, 
   3.668305661446912*^9}, {3.668305725548687*^9, 3.668305731864655*^9}, {
   3.668305773155117*^9, 3.668305852333107*^9}, {3.668305907388373*^9, 
   3.668306097958633*^9}, {3.668306149455674*^9, 3.66830614959052*^9}, {
   3.668306655850728*^9, 3.6683067031328*^9}, {3.668306771942292*^9, 
   3.668306787509921*^9}, {3.6683076218374147`*^9, 3.668307648448059*^9}, {
   3.668309637249222*^9, 3.668309642278942*^9}, 3.867458350008726*^9, 
   3.8674583835965977`*^9},
 CellLabel->
  "In[579]:=",ExpressionUUID->"db748872-099f-4061-98cf-ad0aa4c717d6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LinearSplineLevelCurve2D", "::", "usage"}], " ", "=", " ", 
   "\"\<LinearSplineLevelCurve2D[triangles, f, h, coordinates, \
colorScheme:'TemperatureMap', triangleColor:Gray] takes a set of triangles \
'triangles', given as triplets of indices, a function f defined on the \
indices of the vertices of those triangles, a single level curve height h, \
the a set of coordinates for the vertices of the triangles, and then two \
optional arguments that control the color for the level curve height and the \
color of the triangles displyaed in the returned image.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LinearSplineLevelCurve2D", "[", 
   RowBox[{
   "triangles_", ",", " ", "f_", ",", "h_", ",", " ", "coordinates_", ",", 
    " ", 
    RowBox[{"color_", ":", "Blue"}], ",", " ", 
    RowBox[{"triangleColor_", ":", "Gray"}]}], "]"}], ":=", " ", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "test1", ",", " ", "test2", ",", " ", "test3", ",", " ", "test4", ",", 
      " ", "AppendHeights"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"test1", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"TriLevelSets", "[", 
         RowBox[{"#", ",", " ", "f", ",", " ", "h", ",", "coordinates"}], 
         "]"}], "&"}], "/@", " ", "triangles"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"test2", " ", "=", " ", 
      RowBox[{"Transpose", "[", "test1", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"test3", " ", "=", " ", 
      RowBox[{"Map", "[", 
       RowBox[{"Line", ",", "test2", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"test4", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{"color", ",", " ", "#"}], "}"}], "]"}], "&"}], ",", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"test3", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "/.", 
              RowBox[{
               RowBox[{"Line", "[", 
                RowBox[{"{", "}"}], "]"}], "\[Rule]", "Null"}]}], ",", 
             "Null"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "test3", "]"}]}], "}"}]}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{"triangleColor", ",", 
          RowBox[{"EdgeForm", "[", "]"}], ",", 
          RowBox[{"Triangle", "/@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"coordinates", "[", 
              RowBox[{"[", 
               RowBox[{"triangles", "[", 
                RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "triangles", "]"}]}], "}"}]}], 
            "]"}]}]}], "}"}], "]"}], ",", "test4"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.760992887733059*^9, 3.760992985252743*^9}, {
  3.760993181172702*^9, 3.760993182464582*^9}},
 CellLabel->
  "In[581]:=",ExpressionUUID->"afd966be-0ee3-4fd0-bfcf-d2dd31cfb69e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LinearSplineLevelCurves2D", "::", "usage"}], " ", "=", " ", 
   "\"\<LinearSplineLevelCurves2D[triangles, f, h, coordinates, \
colorScheme:'TemperatureMap', triangleColor:Gray] takes a set of triangles \
'triangles', given as triplets of indices, a function f defined on the \
indices of the vertices of those triangles, a set of level curve heights h, \
the a set of coordinates for the vertices of the triangles, and then two \
optional arguments that control the color scheme for the level curve heights \
and the color of the triangles displyaed in the returned image.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LinearSplineLevelCurves2D", "[", 
   RowBox[{
   "triangles_", ",", " ", "f_", ",", "h_", ",", " ", "coordinates_", ",", 
    " ", 
    RowBox[{"colorScheme_", ":", "\"\<TemperatureMap\>\""}], ",", " ", 
    RowBox[{"triangleColor_", ":", "Gray"}]}], "]"}], ":=", " ", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "test1", ",", " ", "test2", ",", " ", "test3", ",", " ", "test4", ",", 
      " ", "AppendHeights", ",", "ColorNormalize", ",", " ", "hRange"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ColorNormalize", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"hRange", "[", 
            RowBox[{"[", "2", "]"}], "]"}], " ", "-", " ", 
           RowBox[{"hRange", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "*", 
        RowBox[{"(", 
         RowBox[{"#", " ", "-", " ", 
          RowBox[{"hRange", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "&"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"hRange", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Min", "[", "h", "]"}], ",", 
        RowBox[{"Max", "[", "h", "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"test1", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"TriLevelSets", "[", 
         RowBox[{"#", ",", " ", "f", ",", " ", "h", ",", "coordinates"}], 
         "]"}], "&"}], "/@", " ", "triangles"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"test2", " ", "=", " ", 
      RowBox[{"Transpose", "[", "test1", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"test3", " ", "=", " ", 
      RowBox[{"Map", "[", 
       RowBox[{"Line", ",", "test2", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"test4", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"ColorData", "[", "colorScheme", "]"}], "[", 
                RowBox[{"ColorNormalize", "[", 
                 RowBox[{"h", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], "]"}], ",", " ",
                "#"}], "}"}], "]"}], "&"}], ",", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"test3", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "/.", 
              RowBox[{
               RowBox[{"Line", "[", 
                RowBox[{"{", "}"}], "]"}], "\[Rule]", "Null"}]}], ",", 
             "Null"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "test3", "]"}]}], "}"}]}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"Graphics", "[", 
         RowBox[{"{", 
          RowBox[{"triangleColor", ",", 
           RowBox[{"Opacity", "[", ".5", "]"}], ",", 
           RowBox[{"EdgeForm", "[", "]"}], ",", 
           RowBox[{"Triangle", "/@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"coordinates", "[", 
               RowBox[{"[", 
                RowBox[{"triangles", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "triangles", "]"}]}], "}"}]}], 
             "]"}]}]}], "}"}], "]"}], ",", "test4"}], "]"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{"triangleColor", ",", 
          RowBox[{"EdgeForm", "[", "]"}], ",", 
          RowBox[{"Triangle", "/@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"coordinates", "[", 
              RowBox[{"[", 
               RowBox[{"triangles", "[", 
                RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "triangles", "]"}]}], "}"}]}], 
            "]"}]}]}], "}"}], "]"}], ",", "test4"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.668363641434278*^9, 3.6683636511371193`*^9}, {
  3.668363700908589*^9, 3.668363756727042*^9}, {3.668363818830534*^9, 
  3.668363825574502*^9}, {3.6688620620949907`*^9, 3.6688621380876923`*^9}, {
  3.668862200430245*^9, 3.668862212552682*^9}, {3.668862267180932*^9, 
  3.668862351121063*^9}, {3.668863404675654*^9, 3.668863407467023*^9}, {
  3.668865215054509*^9, 3.66886521539325*^9}, {3.733744176789679*^9, 
  3.733744187730397*^9}, {3.760992265596767*^9, 3.7609922695165052`*^9}, {
  3.760992409316594*^9, 3.760992443044861*^9}, {3.76099249604924*^9, 
  3.76099249662578*^9}, {3.761005842687045*^9, 3.761005851875622*^9}},
 CellLabel->
  "In[583]:=",ExpressionUUID->"0955ceb0-2694-4c6b-a692-832fbf2bc81c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LinearSplineLevelCurves3D", "::", "usage"}], " ", "=", " ", 
   "\"\<LinearSplineLevelCurves2D[triangles, f, h, coordinates, \
colorScheme:'Temperature Map', triangleColor:Gray] takes a set of triangles \
'triangles', given as triplets of indices, a function f defined on the \
indices of the vertices of those triangles, a set of level curve heights h, \
the a set of coordinates for the vertices of the triangles, and then two \
optional arguments that control the color scheme for the level curve heights \
and the color of the triangles displyaed in the returned image.\>\""}], ";", 
  RowBox[{
   RowBox[{"LinearSplineLevelCurves3D", "[", 
    RowBox[{
    "triangles_", ",", " ", "f_", ",", "h_", ",", " ", "coordinates_", ",", 
     " ", 
     RowBox[{"colorScheme_", ":", "\"\<TemperatureMap\>\""}], ",", " ", 
     RowBox[{"triangleColor_", ":", "Gray"}]}], "]"}], ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "test1", ",", " ", "test2", ",", " ", "test3", ",", " ", "test4", ",", 
       " ", "test5", ",", " ", "AppendHeights", ",", "ColorNormalize", ",", 
       " ", "hRange"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"AppendHeights", "[", 
        RowBox[{"arg_", ",", " ", "height_"}], "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "arg", "]"}], "\[Equal]", "2"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"arg", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", " ", "height"}], "]"}], 
           ",", " ", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"arg", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", " ", "height"}], "]"}]}], 
          "}"}], ",", 
         RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ColorNormalize", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"hRange", "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", "-", " ", 
            RowBox[{"hRange", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "*", 
         RowBox[{"(", 
          RowBox[{"#", " ", "-", " ", 
           RowBox[{"hRange", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "&"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"hRange", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Min", "[", "h", "]"}], ",", 
         RowBox[{"Max", "[", "h", "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"test1", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"TriLevelSets", "[", 
          RowBox[{"#", ",", " ", "f", ",", " ", "h", ",", "coordinates"}], 
          "]"}], "&"}], "/@", " ", "triangles"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"test2", " ", "=", " ", 
       RowBox[{"Transpose", "[", "test1", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"test3", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"AppendHeights", "[", 
            RowBox[{"#", ",", " ", 
             RowBox[{"h", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}], "&"}], "/@", 
          RowBox[{"test2", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "h", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"test4", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{"Line", ",", "test3", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"test5", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Graphics3D", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"ColorData", "[", "colorScheme", "]"}], "[", 
                 RowBox[{"ColorNormalize", "[", 
                  RowBox[{"h", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], "]"}], ",", 
                " ", "#"}], "}"}], "]"}], "&"}], ",", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"test4", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "/.", 
               RowBox[{
                RowBox[{"Line", "[", 
                 RowBox[{"{", "}"}], "]"}], "\[Rule]", "Null"}]}], ",", 
              "Null"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "test4", "]"}]}], "}"}]}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"Graphics3D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"triangleColor", ",", 
            RowBox[{"Opacity", "[", ".5", "]"}], ",", 
            RowBox[{"EdgeForm", "[", "]"}], ",", 
            RowBox[{"Triangle", "/@", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"coordinates", "[", 
                  RowBox[{"[", 
                   RowBox[{"triangles", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "]"}], "]"}], 
                 ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"f", "[", 
                   RowBox[{"triangles", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "]"}], 
                  "}"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "[", "triangles", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}]}], "}"}], ",", " ", 
          RowBox[{"BoxRatios", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"1", ",", " ", "1", ",", " ", ".25"}], "}"}]}]}], "]"}], 
        ",", "test5"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.668362118398123*^9, 3.6683622342698307`*^9}, {
   3.668362345942156*^9, 3.668362350404071*^9}, {3.6683624001346607`*^9, 
   3.6683624033497677`*^9}, {3.668362434936974*^9, 3.668362460056527*^9}, {
   3.66836259273411*^9, 3.668362628252421*^9}, {3.668362668768381*^9, 
   3.668362685417225*^9}, 3.668362716666174*^9, {3.668362818007843*^9, 
   3.668362864208571*^9}, {3.668363221226987*^9, 3.66836323644895*^9}, {
   3.66886235620933*^9, 3.668862369130961*^9}, {3.6688652111496477`*^9, 
   3.668865222389367*^9}},
 CellLabel->
  "In[585]:=",ExpressionUUID->"57c01efc-309e-4ef5-ab68-95d8fb5e272b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MakePolyFile2", "::", "usage"}], "=", 
   "\"\<MakePolyFile[fileName_, R_, hole_] takes the given region and writes \
a .poly file that can be used by triangle.c and acute.c. It assumes \
dimensions is 2, numAttr is 0, and numBoundaryMarkers is 0, and that there is \
only one hole.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakePolyFile2", "[", 
   RowBox[{"fileName_", ",", "R_", ",", " ", "pointsInHoles_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "nHoles", ",", "vertices", ",", "numVert", ",", "dimensions", ",", 
      "numAttr", ",", "numBoundaryMarkers", ",", "edges", ",", "numEdges", 
      ",", "stream", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nHoles", "=", 
      RowBox[{"Length", "[", "pointsInHoles", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vertices", " ", "=", " ", 
      RowBox[{"Chop", "/@", 
       RowBox[{"MeshCoordinates", "[", "R", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numVert", " ", "=", " ", 
      RowBox[{"Length", "[", "vertices", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dimensions", " ", "=", " ", "2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"numAttr", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"numBoundaryMarkers", " ", "=", " ", "0"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"edges", " ", "=", "  ", 
      RowBox[{
       RowBox[{"MeshCells", "[", 
        RowBox[{"R", ",", "1"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"numEdges", " ", "=", " ", 
      RowBox[{"Length", "[", "edges", " ", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stream", " ", "=", " ", 
      RowBox[{"OpenWrite", "[", 
       RowBox[{"fileName", " ", "<>", "\"\<.poly\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"stream", ",", " ", 
       RowBox[{
        RowBox[{"ToString", "[", "numVert", "]"}], " ", "<>", " ", 
        "\"\< \>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", "dimensions", "]"}], " ", "<>", " ", 
        "\"\< \>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", "numAttr", "]"}], "<>", " ", "\"\< \>\"", 
        " ", "<>", " ", 
        RowBox[{"ToString", "[", "numBoundaryMarkers", "]"}], " ", "<>", " ", 
        "\"\<\\n\>\""}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"i", "\[LessEqual]", " ", "numVert"}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"WriteString", "[", 
         RowBox[{"stream", ",", " ", 
          RowBox[{
           RowBox[{"ToString", "[", "i", "]"}], " ", "<>", " ", "\"\< \>\"", 
           " ", "<>", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"CForm", "[", 
             RowBox[{"vertices", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], " ", "]"}], " ", "]"}], 
           " ", "<>", " ", "\"\< \>\"", " ", "<>", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"CForm", "[", 
             RowBox[{"vertices", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}], " ", "]"}], " ", "]"}], 
           " ", "<>", " ", "\"\<\\n\>\""}]}], " ", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"stream", ",", 
       RowBox[{
        RowBox[{"ToString", "[", "numVert", "]"}], " ", "<>", " ", 
        "\"\< \>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", "numBoundaryMarkers", "]"}], " ", "<>", " ", 
        "\"\<\\n\>\""}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"i", "\[LessEqual]", " ", "numEdges"}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"WriteString", "[", 
         RowBox[{"stream", ",", " ", 
          RowBox[{
           RowBox[{"ToString", "[", "i", "]"}], " ", "<>", " ", "\"\< \>\"", 
           " ", "<>", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"edges", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], " ", "]"}], " ", "<>", 
           " ", "\"\< \>\"", " ", "<>", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"edges", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}], " ", "]"}], " ", "<>", 
           " ", "\"\<\\n\>\""}]}], " ", "]"}], ";"}]}], "\[IndentingNewLine]",
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"stream", ",", 
       RowBox[{
        RowBox[{"ToString", "[", "nHoles", "]"}], " ", "<>", " ", 
        "\"\<\\n\>\""}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"i", "\[LessEqual]", " ", "nHoles"}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"WriteString", "[", 
         RowBox[{"stream", ",", " ", 
          RowBox[{
           RowBox[{"ToString", "[", "i", "]"}], " ", "<>", " ", "\"\< \>\"", 
           " ", "<>", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"CForm", "[", 
             RowBox[{"pointsInHoles", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], " ", "]"}], " ", "]"}], 
           " ", "<>", " ", "\"\< \>\"", " ", "<>", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"CForm", "[", 
             RowBox[{"pointsInHoles", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}], " ", "]"}], " ", "]"}], 
           " ", "<>", " ", "\"\<\\n\>\""}]}], " ", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Close", "[", "stream", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.6676576656071863`*^9, 3.667657669374466*^9}, {
   3.66765774079263*^9, 3.667657749240988*^9}, {3.667658188491056*^9, 
   3.667658273365045*^9}, {3.6676584360984898`*^9, 3.667658518341626*^9}, {
   3.667658561519208*^9, 3.667658562325863*^9}, {3.66765895383007*^9, 
   3.667659023541954*^9}, {3.667659069055328*^9, 3.6676591277456293`*^9}, {
   3.6676597588717537`*^9, 3.667659990752233*^9}, {3.667660116109655*^9, 
   3.66766020360994*^9}, {3.667660296508556*^9, 3.66766030407638*^9}, {
   3.667660817614253*^9, 3.667660879151476*^9}, {3.667660965355318*^9, 
   3.667660995987316*^9}, {3.667661144216878*^9, 3.6676612144348793`*^9}, {
   3.667661257095067*^9, 3.6676612975103893`*^9}, {3.667661330440637*^9, 
   3.6676613574483633`*^9}, {3.667661396763988*^9, 3.667661396985454*^9}, {
   3.6676614432854033`*^9, 3.6676614478843193`*^9}, {3.6676614935506363`*^9, 
   3.667661493741478*^9}, {3.6676618275142717`*^9, 3.667661857401573*^9}, 
   3.667665090197277*^9, {3.728387741474135*^9, 3.728387774358226*^9}, {
   3.728387915481104*^9, 3.728387919194045*^9}, {3.728388095765745*^9, 
   3.728388140968268*^9}, {3.728389199736742*^9, 3.728389203392461*^9}, {
   3.7283892370903673`*^9, 3.728389266379982*^9}, {3.7354016701357737`*^9, 
   3.7354016972402287`*^9}, {3.735612733028191*^9, 3.735612752333796*^9}, {
   3.7380785492893763`*^9, 3.738078550303482*^9}, 3.7380795467463713`*^9, {
   3.738079723710634*^9, 3.738079799801406*^9}, {3.738080397895466*^9, 
   3.738080429173811*^9}, 3.738080488064703*^9, {3.738080559673616*^9, 
   3.738080560697606*^9}, {3.738080592572103*^9, 3.73808059725939*^9}, 
   3.7380808279243402`*^9, {3.738080949799869*^9, 3.7380809623766108`*^9}},
 CellLabel->
  "In[586]:=",ExpressionUUID->"e84c35ed-faf0-4a69-af24-6c42060142dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Assumes", " ", "regionHole", " ", "is", " ", "convex"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"AcuteTriangulate", "::", "usage"}], " ", "=", " ", 
     "\"\<AcuteTriangulateAnnulus[vertices_, extV_, intV_] makes an acute \
triangulation of a given polygonal topological annulus.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AcuteTriangulate", "::", "aCuteNotFound"}], " ", "=", " ", 
     "\"\<The aCute program was not found\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AcuteTriangulate", "[", 
     RowBox[{"region_", ",", " ", "pointsInHoles_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "nHoles", ",", "file", ",", " ", "numFlags", ",", " ", "numAttributes",
         ",", " ", "rawNode", ",", " ", "rawEle", ",", " ", "cleanNode", ",", 
        " ", "cleanEle", ",", " ", "points", ",", " ", "triangles", ",", " ", 
        "edges"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nHoles", "=", 
        RowBox[{"Length", "[", "pointsInHoles", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"file", " ", "=", " ", "\"\<acuteTriangulateAnnulus\>\""}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"MakePolyFile2", "[", 
        RowBox[{"file", ",", "region", ",", "pointsInHoles"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Run", "[", 
        RowBox[{
        "\"\<chmod 777 \>\"", " ", "<>", " ", "\"\<\\\"\>\"", " ", "<>", " ", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Directory", "[", "]"}], ",", "file"}], "}"}], "]"}], " ",
          "<>", " ", "\"\<.poly\>\"", "  ", "<>", " ", "\"\<\\\"\>\""}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FileExistsQ", "[", "\"\<acute\>\"", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Run", "[", 
           RowBox[{
           "\"\<./acute -q35 -U89 \>\"", " ", "<>", " ", "\"\<\\\"\>\"", " ", 
            "<>", " ", 
            RowBox[{"FileNameJoin", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Directory", "[", "]"}], ",", "file"}], "}"}], "]"}], 
            " ", "<>", "\"\<.poly\>\"", " ", "<>", " ", "\"\<\\\"\>\""}], " ",
            "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"FileExistsQ", "[", 
             RowBox[{
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Directory", "[", "]"}], ",", 
                 RowBox[{"file", "<>", " ", "\"\<.1.node\>\""}]}], "}"}], 
               "]"}], " ", "<>", " ", "\"\<.txt\>\""}], "]"}], ",", 
            RowBox[{"DeleteFile", "[", 
             RowBox[{
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Directory", "[", "]"}], ",", 
                 RowBox[{"file", " ", "<>", " ", "\"\<.1.node\>\""}]}], "}"}],
                "]"}], " ", "<>", " ", "\"\<.txt\>\""}], "]"}]}], "]"}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"FileExistsQ", "[", 
             RowBox[{
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Directory", "[", "]"}], ",", 
                 RowBox[{"file", " ", "<>", " ", "\"\<.1.ele\>\""}]}], "}"}], 
               "]"}], " ", "<>", " ", "\"\<.txt\>\""}], "]"}], ",", 
            RowBox[{"DeleteFile", "[", 
             RowBox[{
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Directory", "[", "]"}], ",", 
                 RowBox[{"file", " ", "<>", " ", "\"\<.1.ele\>\""}]}], "}"}], 
               "]"}], " ", "<>", " ", "\"\<.txt\>\""}], "]"}]}], "]"}], ";", 
          RowBox[{"CopyFile", "[", 
           RowBox[{
            RowBox[{"FileNameJoin", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Directory", "[", "]"}], ",", 
               RowBox[{"file", " ", "<>", " ", "\"\<.1.node\>\""}]}], "}"}], 
             "]"}], ",", " ", 
            RowBox[{
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Directory", "[", "]"}], ",", 
                RowBox[{"file", " ", "<>", " ", "\"\<.1.node\>\""}]}], "}"}], 
              "]"}], " ", "<>", " ", "\"\<.txt\>\""}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"CopyFile", "[", 
           RowBox[{
            RowBox[{"FileNameJoin", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Directory", "[", "]"}], ",", 
               RowBox[{"file", " ", "<>", " ", "\"\<.1.ele\>\""}]}], "}"}], 
             "]"}], ",", " ", 
            RowBox[{
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Directory", "[", "]"}], ",", 
                RowBox[{"file", " ", "<>", " ", "\"\<.1.ele\>\""}]}], "}"}], 
              "]"}], " ", "<>", " ", "\"\<.txt\>\""}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"numFlags", " ", "=", " ", "2"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"numAttributes", " ", "=", " ", "0"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"rawNode", " ", "=", " ", 
           RowBox[{"Import", "[", 
            RowBox[{"file", " ", "<>", "\"\<.1.node.txt\>\""}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"rawEle", " ", "=", " ", 
           RowBox[{"Import", "[", 
            RowBox[{"file", " ", "<>", " ", "\"\<.1.ele.txt\>\""}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"cleanNode", " ", "=", " ", 
           RowBox[{"Map", "[", 
            RowBox[{"Internal`StringToDouble", ",", " ", 
             RowBox[{"Partition", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"StringSplit", "[", "rawNode", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"5", ";;", 
                  RowBox[{"-", 
                   RowBox[{"(", 
                    RowBox[{"numFlags", " ", "+", " ", "6"}], ")"}]}]}], 
                 "]"}], "]"}], ",", 
               RowBox[{"4", "+", "numAttributes"}]}], "]"}], ",", " ", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"cleanEle", " ", "=", " ", 
           RowBox[{"Map", "[", 
            RowBox[{"ToExpression", ",", " ", 
             RowBox[{"Partition", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"StringSplit", "[", "rawEle", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"4", ";;", 
                  RowBox[{"-", 
                   RowBox[{"(", 
                    RowBox[{"numFlags", " ", "+", " ", "6"}], ")"}]}]}], 
                 "]"}], "]"}], ",", "4"}], "]"}], ",", " ", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], ";", 
          RowBox[{"points", " ", "=", " ", 
           RowBox[{"cleanNode", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";", 
          RowBox[{"triangles", " ", "=", " ", 
           RowBox[{"cleanEle", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "]"}], "]"}]}], 
          ";", 
          RowBox[{"edges", " ", "=", " ", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{"EdgesWrapCompiled", ",", " ", "triangles"}], "]"}], 
             ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"DeleteFile", "[", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Directory", "[", "]"}], ",", 
              RowBox[{"file", " ", "<>", " ", "\"\<.1.node\>\""}]}], "}"}], 
            "]"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"DeleteFile", "[", 
           RowBox[{
            RowBox[{"FileNameJoin", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Directory", "[", "]"}], ",", 
               RowBox[{"file", " ", "<>", " ", "\"\<.1.node\>\""}]}], "}"}], 
             "]"}], " ", "<>", " ", "\"\<.txt\>\""}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"DeleteFile", "[", 
           RowBox[{
            RowBox[{"FileNameJoin", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Directory", "[", "]"}], ",", 
               RowBox[{"file", " ", "<>", " ", "\"\<.1.ele\>\""}]}], "}"}], 
             "]"}], " ", "<>", " ", "\"\<.txt\>\""}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"DeleteFile", "[", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Directory", "[", "]"}], ",", 
              RowBox[{"file", " ", "<>", " ", "\"\<.1.ele\>\""}]}], "}"}], 
            "]"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"DeleteFile", "[", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Directory", "[", "]"}], ",", 
              RowBox[{"file", " ", "<>", " ", "\"\<.1.poly\>\""}]}], "}"}], 
            "]"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"DeleteFile", "[", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Directory", "[", "]"}], ",", 
              RowBox[{"file", " ", "<>", " ", "\"\<.poly\>\""}]}], "}"}], 
            "]"}], "]"}], ";", "\n", 
          RowBox[{"Return", "[", 
           RowBox[{"{", 
            RowBox[{"points", ",", " ", "edges", ",", " ", "triangles"}], 
            "}"}], "]"}]}], "\n", ",", "\[IndentingNewLine]", 
         RowBox[{"Message", "[", 
          RowBox[{"AcuteTriangulateAnnulus", "::", "aCuteNotFound"}], "]"}]}],
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.728314855738679*^9, 3.728314885831744*^9}, {
   3.728314969697155*^9, 3.728314972173195*^9}, {3.7283216080238323`*^9, 
   3.7283216132219152`*^9}, {3.7283217330035353`*^9, 3.728321735136095*^9}, {
   3.728321772177478*^9, 3.7283217849376287`*^9}, {3.72832182040061*^9, 
   3.728321822598401*^9}, {3.728322802965671*^9, 3.728322803358184*^9}, {
   3.72832343737201*^9, 3.728323455742305*^9}, {3.7283234938578777`*^9, 
   3.728323504691516*^9}, {3.728323657795681*^9, 3.728323660787603*^9}, {
   3.728323709556827*^9, 3.728323716959447*^9}, {3.7283239327602253`*^9, 
   3.728324009067093*^9}, {3.7283241773610477`*^9, 3.728324177663571*^9}, {
   3.728324265696389*^9, 3.7283242906940813`*^9}, {3.72832441971173*^9, 
   3.728324428626895*^9}, {3.728324558684022*^9, 3.728324569236149*^9}, {
   3.728386022282876*^9, 3.72838603777669*^9}, {3.728386089488171*^9, 
   3.7283861018622913`*^9}, {3.728386190020772*^9, 3.728386214444037*^9}, {
   3.7283862469734383`*^9, 3.728386434891671*^9}, {3.728386479067767*^9, 
   3.7283864813206987`*^9}, {3.72838701274194*^9, 3.728387016859054*^9}, {
   3.7283870655987167`*^9, 3.728387095916045*^9}, {3.7283881546613197`*^9, 
   3.728388164768138*^9}, {3.7283883117368917`*^9, 3.728388314731822*^9}, {
   3.728388403332889*^9, 3.728388436502393*^9}, {3.7283894738363934`*^9, 
   3.7283894774070597`*^9}, {3.72838952447589*^9, 3.7283895342706842`*^9}, {
   3.728389583524931*^9, 3.728389633891972*^9}, {3.728389671932597*^9, 
   3.7283897223765574`*^9}, {3.728389754177987*^9, 3.728389764579842*^9}, {
   3.728389946060816*^9, 3.728390071066842*^9}, {3.728390239351016*^9, 
   3.7283902412868443`*^9}, {3.7284755871026278`*^9, 3.728475590066146*^9}, 
   3.73072260982274*^9, {3.730722690353003*^9, 3.730722693164699*^9}, {
   3.7307227662188473`*^9, 3.730722768006422*^9}, {3.735404123018463*^9, 
   3.7354041545396338`*^9}, {3.7356127001735907`*^9, 
   3.7356127015249443`*^9}, {3.7380807296382008`*^9, 3.738080734785101*^9}, {
   3.738080768604533*^9, 3.7380808114220953`*^9}, {3.738080886352188*^9, 
   3.7380809364079447`*^9}, 3.738080969859008*^9, 3.8012044574876842`*^9, 
   3.848686275920699*^9},
 CellLabel->
  "In[588]:=",ExpressionUUID->"dda74a74-986f-4a8c-879f-91d9f349296a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SelectTrianglesAtHeightCompiled", "::", "usage"}], "=", 
   "\"\<SelectTrianglesAtHeightCompiled[{{triangleList,_Integer,2},{fValues,_\
Real,1},{height,_Real}}] finds all triangles at a given height using fValues \
list defined on vertices.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SelectTrianglesAtHeightCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"triangleList", ",", "_Integer", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"fValues", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"height", ",", "_Real"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "nTriangles", ",", "nSelectedTriangles", ",", "selectedTriangles", 
         ",", "i", ",", "values", ",", "maxValue", ",", "minValue"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nTriangles", "=", 
         RowBox[{"Length", "[", "triangleList", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nSelectedTriangles", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"selectedTriangles", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "nTriangles", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", "nTriangles"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"values", "=", 
            RowBox[{"fValues", "[", 
             RowBox[{"[", 
              RowBox[{"triangleList", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"maxValue", "=", 
            RowBox[{"Max", "[", "values", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"minValue", "=", 
            RowBox[{"Min", "[", "values", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"height", "\[LessEqual]", "maxValue"}], "&&", 
              RowBox[{"height", "\[GreaterEqual]", "minValue"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"nSelectedTriangles", "=", 
               RowBox[{"nSelectedTriangles", "+", "1"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"selectedTriangles", "[", 
                RowBox[{"[", "nSelectedTriangles", "]"}], "]"}], "=", "i"}], 
              ";"}], "\[IndentingNewLine]", ","}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"selectedTriangles", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "nSelectedTriangles"}], "]"}], "]"}], " ", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.738106955536569*^9, 3.7381069738731527`*^9}, {
  3.73810708984739*^9, 3.7381071106303873`*^9}, {3.7381073739902687`*^9, 
  3.738107411680522*^9}, {3.7381074451294327`*^9, 3.7381076328071327`*^9}, {
  3.739117441012719*^9, 3.739117474923606*^9}},
 CellLabel->
  "In[591]:=",ExpressionUUID->"2ef27559-b98d-47f4-a7ca-63dcdfde1af8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"EulerCharacteristicCompiled", "::", "usage"}], "=", 
   "\"\<EulerCharacteristicCompiled[{{triangleList,_Integer,2}}]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EulerCharacteristicCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"triangleList", ",", "_Integer", ",", "2"}], "}"}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "nTriangles", ",", "nEdges", ",", "nVertices", ",", "edgesAll", ",", 
         "eulerCharacteristic"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nTriangles", "=", 
         RowBox[{"Length", "[", "triangleList", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"edgesAll", "=", 
         RowBox[{"Map", "[", 
          RowBox[{"EdgesWrapSortCompiled", ",", "triangleList"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"nEdges", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"Union", "[", 
           RowBox[{"Level", "[", 
            RowBox[{"edgesAll", ",", 
             RowBox[{"{", 
              RowBox[{"-", "2"}], "}"}]}], "]"}], " ", "]"}], " ", "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"nVertices", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"Union", "[", 
           RowBox[{"Flatten", "[", "triangleList", "]"}], " ", "]"}], " ", 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"eulerCharacteristic", "=", 
         RowBox[{"Round", "[", 
          RowBox[{"nVertices", "-", "nEdges", "+", "nTriangles"}], 
          "]"}]}]}]}], " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "For", " ", "some", " ", "reason", " ", "this", " ", "was", " ", 
         "returning", " ", "a", " ", "real", " ", "value"}], ",", " ", 
        RowBox[{"hence", " ", "the", " ", "Round"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.738094007333591*^9, 3.7380940949955263`*^9}, {
   3.7381067190277157`*^9, 3.738106809925596*^9}, 3.7381068713051853`*^9, {
   3.7381081981555367`*^9, 3.738108219955174*^9}, {3.739133229805249*^9, 
   3.739133242205871*^9}, {3.761064446508354*^9, 3.761064455104957*^9}},
 CellLabel->
  "In[593]:=",ExpressionUUID->"8bc01033-062d-417f-956d-35f1be89a72f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindFigureEightLevelCurveCompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"triangleList", ",", "_Integer", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"fValues", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "height", ",", "selectedTriangles", ",", "lowerBound", ",", 
         "upperBound"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"height", "=", "0.5"}], ";", "\[IndentingNewLine]", 
        RowBox[{"lowerBound", "=", "0."}], ";", "\[IndentingNewLine]", 
        RowBox[{"upperBound", "=", "1."}], ";", "\[IndentingNewLine]", 
        RowBox[{"selectedTriangles", "=", 
         RowBox[{"SelectTrianglesAtHeightCompiled", "[", 
          RowBox[{"triangleList", ",", "fValues", ",", "height"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{"True", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"selectedTriangles", "=", 
            RowBox[{"SelectTrianglesAtHeightCompiled", "[", 
             RowBox[{"triangleList", ",", "fValues", ",", "height"}], "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"EulerCharacteristicCompiled", "[", 
               RowBox[{"triangleList", "[", 
                RowBox[{"[", "selectedTriangles", "]"}], "]"}], " ", "]"}], "==", 
              RowBox[{"-", "1"}]}], ",", 
             RowBox[{
              RowBox[{"Break", "[", "]"}], ";"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"TriangulationConnectedQCompiled", "[", 
                 RowBox[{"triangleList", "[", 
                  RowBox[{"[", "selectedTriangles", "]"}], "]"}], " ", "]"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                 "Height", " ", "is", " ", "too", " ", "high", " ", "if", " ",
                   "the", " ", "triangles", " ", "are", " ", "connected"}], 
                 " ", "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"upperBound", "=", "height"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"height", "=", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"height", "+", "lowerBound"}], ")"}], "/", 
                   "2."}]}], ";"}], "\[IndentingNewLine]", ",", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                 "Height", " ", "is", " ", "too", " ", "low", " ", "if", " ", 
                  "the", " ", "triangles", " ", "are", " ", "not", " ", 
                  "connected"}], " ", "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"lowerBound", "=", "height"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"height", "=", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"height", "+", "upperBound"}], ")"}], "/", 
                   "2."}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "selectedTriangles", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.73810789265123*^9, 3.738107940777256*^9}, {
  3.738108230187172*^9, 3.73810828096419*^9}, {3.738108399873637*^9, 
  3.738108451878181*^9}, {3.73810903127811*^9, 3.738109085143845*^9}, {
  3.7381091152870617`*^9, 3.738109183802565*^9}, {3.738109302568565*^9, 
  3.7381093034628563`*^9}, {3.738109344384493*^9, 3.738109363014516*^9}, {
  3.738109393897381*^9, 3.738109398258595*^9}, {3.7381094282830563`*^9, 
  3.738109440405019*^9}, {3.738112778988626*^9, 3.73811287051162*^9}, {
  3.7381129915899563`*^9, 3.7381130229327297`*^9}, {3.738114886048977*^9, 
  3.7381148869281807`*^9}},
 CellLabel->
  "In[595]:=",ExpressionUUID->"884ec593-3c33-493f-83e2-f05901b0bc5f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PartitionClassIndicatorWNACompiled", "::", "usage"}], "=", 
   "\"\<PartitionClassIndicatorWNACompiled[{{coordinates,_Real,2},{\
containedFaces,_Integer,1},{partitionBoundary1,_Integer,1},{\
partitionBoundary2,_Integer,1}}]Using winding number algorithm\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PartitionClassIndicatorWNACompiled", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"coordinates", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"containedFaces", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"partitionBoundary1", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"partitionBoundary2", ",", "_Integer", ",", "1"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "nCoordinates", ",", "partitionClassIndicator", ",", " ", "i"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nCoordinates", "=", 
         RowBox[{"Length", "[", "coordinates", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"partitionClassIndicator", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "nCoordinates", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", "nCoordinates"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"containedFaces", ",", "i"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"partitionBoundary1", ",", "i"}], "]"}], "||", 
                 RowBox[{
                  RowBox[{"WindingNumberIntegerCompiled", "[", 
                   RowBox[{
                    RowBox[{"coordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"coordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
                    "partitionBoundary1", ",", "coordinates"}], "]"}], 
                  "\[NotEqual]", "0"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"partitionClassIndicator", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "=", "1"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Continue", "[", "]"}], ";"}], "\[IndentingNewLine]",
                 ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"partitionBoundary2", ",", "i"}], "]"}], "||", 
                    RowBox[{
                    RowBox[{"WindingNumberIntegerCompiled", "[", 
                    RowBox[{
                    RowBox[{"coordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"coordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
                    "partitionBoundary2", ",", "coordinates"}], "]"}], 
                    "\[NotEqual]", "0"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"partitionClassIndicator", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=", "2"}], ";"}], 
                   "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"partitionClassIndicator", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=", "3"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
             ","}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "partitionClassIndicator", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<InlineExternalDefinitions\>\"", " ", "->", " ", "True"}], 
       "}"}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.738199713402738*^9, 3.7381997254014*^9}},
 CellLabel->
  "In[596]:=",ExpressionUUID->"43ae648b-e730-4d12-90d1-404bee69f717"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
   "BuildSlittedWeightedVoronoiGraph", "::", "omega0notincontainedface"}], 
   " ", "=", " ", "\"\<omega0 is not contained in any containedFace\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BuildSlittedWeightedVoronoiGraph", "::", "usage"}], "=", 
   "\"\<BuildSlittedWeightedVoronoiGraph[Lambda_,containedVertices_,\
containedFaces_,omega0_,pointInHole_]\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BuildSlittedWeightedVoronoiGraph", "[", 
    RowBox[{
    "Lambda_", ",", "containedVertices_", ",", "containedFaces_", ",", 
     "omega0_", ",", "pointInHole_", ",", "toRightOfEdgePolyAssociation_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "proxyInfinity", ",", "paddedPolygonizationAll", ",", "omega0Face", ",",
        "paddedPolygonization", ",", "nPolygons", ",", "maxPolygonLength", 
       ",", "struct", ",", "nBoundaryEdges", ",", "nInternalEdges", ",", 
       "polygonizationTopology", ",", "boundaryEdges", ",", "internalEdges", 
       ",", "classes", ",", "class1", ",", "class2", ",", "winding1", ",", 
       "outerRingVertices", ",", "innerRingVertices", ",", "outerRingFaces", 
       ",", "innerRingFaces", ",", "containedFacesGraph", ",", 
       "shortestPathFunction", ",", "pathsToInnerRingFaces", ",", 
       "pathsToOuterRingFaces", ",", "slitFaceStart", ",", "slitFaceEnd", ",",
        "slitFacePath", ",", "slitVertices", ",", "edgesToWeightWithInf", ",",
        "edgeWeights", ",", "LambdaGraph", ",", "omega0nCandidates", ",", 
       "omega0n"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"proxyInfinity", " ", "=", " ", 
       RowBox[{"100", "*", 
        RowBox[{"Length", "[", 
         RowBox[{"Lambda", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "All"}], "]"}], "]"}], "]"}]}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"Infinity", " ", 
        RowBox[{"can", "'"}], "t", " ", "be", " ", "used", " ", "as", " ", 
        "an", " ", "edge", " ", "weight", " ", "of", " ", "a", " ", "graph", 
        " ", "object"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Find", " ", "which", " ", "face", " ", "contains", " ", "omega0"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"paddedPolygonizationAll", "=", 
       RowBox[{"PadPolygonsToMatrix", "[", 
        RowBox[{"Lambda", "[", 
         RowBox[{"[", "3", "]"}], "]"}], " ", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"omega0Face", "=", 
       RowBox[{"FindPointInPolygonCompiled", "[", 
        RowBox[{
         RowBox[{"omega0", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"omega0", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "paddedPolygonizationAll", ",",
          " ", 
         RowBox[{"Lambda", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Position", "[", 
           RowBox[{"containedFaces", ",", "omega0Face"}], "]"}], "]"}], 
         "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
          "BuildSlittedWeightedVoronoiGraph", "::", 
           "omega0notincontainedface"}], " ", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"proxyInfinity", " ", "=", " ", 
       RowBox[{"100", "*", 
        RowBox[{"Length", "[", 
         RowBox[{"Lambda", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "All"}], "]"}], "]"}], "]"}]}]}], ";", 
      RowBox[{"paddedPolygonization", "=", 
       RowBox[{"PadPolygonsToMatrix", "[", 
        RowBox[{"Lambda", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "containedFaces"}], "]"}], "]"}], " ", "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"nPolygons", "=", 
       RowBox[{"Length", "[", "paddedPolygonization", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"maxPolygonLength", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"paddedPolygonization", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"struct", "=", 
       RowBox[{
       "BuildPolyTopoBdryEdgesInternalEdgesCompiled", "[", 
        "paddedPolygonization", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nBoundaryEdges", "=", 
       RowBox[{"struct", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nInternalEdges", "=", 
       RowBox[{"struct", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"polygonizationTopology", "=", 
       RowBox[{"struct", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;", 
          RowBox[{
           RowBox[{"Length", "[", "paddedPolygonization", "]"}], "+", "1"}]}],
          " ", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"boundaryEdges", "=", 
       RowBox[{"struct", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "paddedPolygonization", "]"}], "+", "2"}], 
           ";;", 
           RowBox[{
            RowBox[{"Length", "[", "paddedPolygonization", "]"}], "+", 
            "nBoundaryEdges", "+", "1"}]}], ",", " ", 
          RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"internalEdges", "=", 
       RowBox[{"struct", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "+", "nPolygons", "+", 
            RowBox[{"maxPolygonLength", "*", "nPolygons"}]}], ";;", 
           RowBox[{"1", "+", "nPolygons", "+", 
            RowBox[{"maxPolygonLength", "*", "nPolygons"}], "+", 
            "nInternalEdges"}]}], ",", 
          RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"classes", "=", 
       RowBox[{
       "BoundaryConnectedClassesUnseededCompiled", "[", "boundaryEdges", 
        "]"}]}], ";", 
      RowBox[{"class1", "=", 
       RowBox[{"classes", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", 
          RowBox[{"2", ";;", 
           RowBox[{
            RowBox[{"classes", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", "1"}]}]}], " ", 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"class2", "=", 
       RowBox[{"classes", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", 
          RowBox[{"2", ";;", 
           RowBox[{
            RowBox[{"classes", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}], "+", "1"}]}]}], " ", 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"winding1", "=", 
       RowBox[{"WindingNumberCompiled", "[", 
        RowBox[{
         RowBox[{"pointInHole", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"pointInHole", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "class1", ",", 
         RowBox[{"Lambda", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"winding1", ">", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"outerRingVertices", "=", "class1"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"innerRingVertices", "=", "class2"}], ";"}], 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"outerRingVertices", "=", "class2"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"innerRingVertices", "=", "class1"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"innerRingFaces", "=", 
       RowBox[{"Pick", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "paddedPolygonization", "]"}], "]"}], ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"IntersectingQ", "[", 
             RowBox[{"innerRingVertices", ",", "#"}], "]"}], "&"}], ",", 
           "paddedPolygonization"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"outerRingFaces", "=", 
       RowBox[{"Pick", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "paddedPolygonization", "]"}], "]"}], ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"IntersectingQ", "[", 
             RowBox[{"outerRingVertices", ",", "#"}], "]"}], "&"}], ",", 
           "paddedPolygonization"}], "]"}]}], "]"}]}], ";", 
      RowBox[{"containedFacesGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "containedFaces", "]"}], " ", "]"}], ",", 
         "internalEdges"}], "]"}]}], ";", 
      RowBox[{"shortestPathFunction", "=", 
       RowBox[{"FindShortestPath", "[", 
        RowBox[{"containedFacesGraph", ",", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"containedFaces", ",", "omega0Face"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "All"}], "]"}]}], ";", 
      RowBox[{"pathsToInnerRingFaces", "=", 
       RowBox[{"shortestPathFunction", "/@", "innerRingFaces"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pathsToOuterRingFaces", "=", 
       RowBox[{"shortestPathFunction", "/@", "outerRingFaces"}]}], ";", 
      RowBox[{"slitFaceStart", "=", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"Length", "/@", "pathsToInnerRingFaces"}], ",", " ", 
          RowBox[{"Min", "[", 
           RowBox[{"Length", "/@", "pathsToInnerRingFaces"}], "]"}]}], " ", 
         "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"slitFaceEnd", "=", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"Length", "/@", "pathsToOuterRingFaces"}], ",", " ", 
          RowBox[{"Min", "[", 
           RowBox[{"Length", "/@", "pathsToOuterRingFaces"}], "]"}]}], " ", 
         "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
      RowBox[{"slitFacePath", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Reverse", "[", 
          RowBox[{"pathsToInnerRingFaces", "[", 
           RowBox[{"[", "slitFaceStart", "]"}], "]"}], " ", "]"}], ",", 
         RowBox[{
          RowBox[{"pathsToOuterRingFaces", "[", 
           RowBox[{"[", "slitFaceEnd", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ";;"}], "]"}], "]"}]}], " ", "]"}]}], ";", 
      RowBox[{"struct", "=", 
       RowBox[{"PolygonPathToVertexPathCompiled", "[", 
        RowBox[{
        "slitFacePath", ",", "paddedPolygonization", ",", "innerRingVertices",
          ",", "outerRingVertices"}], "]"}]}], ";", 
      RowBox[{"slitVertices", "=", 
       RowBox[{"struct", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;", 
          RowBox[{
           RowBox[{"struct", "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "+", "1"}]}], "]"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"omega0nCandidates", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Lambda", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "omega0Face"}], "]"}], "]"}], ",", 
         "slitVertices"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"omega0n", "=", 
       RowBox[{"omega0nCandidates", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"edgesToWeightWithInf", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"!", 
             RowBox[{"MemberQ", "[", 
              RowBox[{"containedVertices", ",", " ", 
               RowBox[{"Lambda", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "i", ",", "1"}], "]"}], "]"}]}], " ", 
              "]"}]}], " ", "||", " ", 
            RowBox[{"!", 
             RowBox[{"MemberQ", "[", 
              RowBox[{"containedVertices", ",", " ", 
               RowBox[{"Lambda", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "i", ",", "2"}], "]"}], "]"}]}], "]"}]}], 
            " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"slitVertices", ",", " ", 
                RowBox[{"Lambda", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", " ", "i", ",", " ", "1"}], "]"}], "]"}]}],
                " ", "]"}], " ", "||", " ", 
              RowBox[{"MemberQ", "[", 
               RowBox[{"slitVertices", ",", " ", 
                RowBox[{"Lambda", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", " ", "i", ",", " ", "2"}], "]"}], "]"}]}],
                " ", "]"}], " ", "||", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"containedFaces", ",", 
                   RowBox[{"toRightOfEdgePolyAssociation", "[", 
                    RowBox[{"Lambda", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "i"}], "]"}], "]"}], " ", "]"}]}], " ", 
                  "]"}]}], " ", "&&", " ", 
                RowBox[{"!", 
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"containedFaces", ",", 
                   RowBox[{"toRightOfEdgePolyAssociation", "[", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Lambda", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "i"}], "]"}], "]"}], " ", "]"}], " ", 
                    "]"}]}], " ", "]"}]}]}], ")"}]}], ")"}]}], ",", "i"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"Lambda", "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"edgesToWeightWithInf", " ", "=", " ", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"edgesToWeightWithInf", ",", " ", "Null"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"edgeWeights", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"edgesToWeightWithInf", ",", "  ", "#"}], "]"}], ",", 
           "proxyInfinity", ",", " ", "1"}], "]"}], "&"}], " ", "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", 
          RowBox[{"Lambda", "[", 
           RowBox[{"[", "2", "]"}], "]"}], " ", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "We", " ", "need", " ", "to", " ", "build", " ", "Graph", " ", 
         "object", " ", "in", " ", "Mathematica", " ", "to", " ", "use", " ", 
         "the", " ", "built"}], "-", 
        RowBox[{"in", " ", "path", " ", "finding", " ", 
         RowBox[{"algorithms", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"LambdaGraph", " ", "=", " ", 
       RowBox[{"Graph", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", 
           RowBox[{"Lambda", "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], "]"}], ",", " ", 
         RowBox[{"Lambda", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"EdgeWeight", "\[Rule]", "edgeWeights"}], ",", " ", 
         RowBox[{"VertexLabels", "\[Rule]", "\"\<Name\>\""}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"LambdaGraph", ",", "omega0n", ",", "slitVertices"}], "}"}], 
       "]"}]}]}], " ", "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.728989741586975*^9, 3.728989766877493*^9}, {
   3.72898981919746*^9, 3.728989876155755*^9}, {3.728989955081195*^9, 
   3.7289900590048532`*^9}, {3.728990089789513*^9, 3.728990103323325*^9}, {
   3.728990135715942*^9, 3.728990149441825*^9}, {3.7289901845059967`*^9, 
   3.728990421087922*^9}, {3.7289904840694427`*^9, 3.7289905576086607`*^9}, {
   3.728990596432827*^9, 3.728990651045089*^9}, {3.72899068663785*^9, 
   3.728990705069606*^9}, {3.728990742436208*^9, 3.728990776593823*^9}, {
   3.728990895463641*^9, 3.7289910905309963`*^9}, {3.728991628034316*^9, 
   3.728991761906144*^9}, {3.7289918503341513`*^9, 3.728991907495338*^9}, {
   3.728991949479959*^9, 3.728991997363986*^9}, {3.7289923709699593`*^9, 
   3.728992372092807*^9}, {3.728992632937949*^9, 3.7289926619639072`*^9}, {
   3.728992694261311*^9, 3.728992694628079*^9}, {3.728993851821144*^9, 
   3.7289938539253263`*^9}, {3.7289960886052732`*^9, 3.728996090365757*^9}, {
   3.728996436921028*^9, 3.728996439241509*^9}, 3.728997952011153*^9, {
   3.730725375462008*^9, 3.730725430701377*^9}, {3.730725706149928*^9, 
   3.730725716572597*^9}, {3.730737592644991*^9, 3.730737593750996*^9}, {
   3.735232744349511*^9, 3.73523274568659*^9}, {3.7352327771298428`*^9, 
   3.7352327828418303`*^9}, {3.735232916669643*^9, 3.7352329983221283`*^9}, {
   3.735233147752419*^9, 3.73523315487638*^9}, 3.735233218903727*^9, {
   3.735233258369515*^9, 3.7352332666177807`*^9}, {3.7352334371670027`*^9, 
   3.7352334474162197`*^9}, {3.7352335155054493`*^9, 3.735233560018849*^9}, {
   3.735240035710691*^9, 3.735240058519291*^9}, {3.73524020615961*^9, 
   3.735240244168213*^9}, 3.735244606501864*^9, {3.735244669774682*^9, 
   3.735244685477619*^9}, {3.735244791922521*^9, 3.735244797514965*^9}, {
   3.735245298083681*^9, 3.735245300219643*^9}, {3.7352453316847963`*^9, 
   3.735245361165472*^9}, {3.7352453973527937`*^9, 3.735245434328157*^9}, {
   3.735245476224449*^9, 3.7352455195634747`*^9}, {3.735246363233296*^9, 
   3.735246413010075*^9}, {3.735246453394697*^9, 3.7352465121793737`*^9}, {
   3.735246549797473*^9, 3.735246555181266*^9}, {3.735246605751795*^9, 
   3.7352466664893723`*^9}, {3.7352466976244793`*^9, 3.735246720710244*^9}, {
   3.735246816241115*^9, 3.7352468845993633`*^9}, {3.735247039438745*^9, 
   3.735247183146921*^9}, {3.735247254381392*^9, 3.735247709295621*^9}, 
   3.735247845751313*^9, {3.735247899842039*^9, 3.735247906193574*^9}, {
   3.7352503918777637`*^9, 3.735250446245088*^9}, 3.73525098108785*^9, 
   3.735251418833638*^9, {3.735403078867413*^9, 3.735403090833679*^9}, {
   3.735403144186989*^9, 3.7354031738815928`*^9}, {3.735405323483226*^9, 
   3.735405358915947*^9}, {3.735405830764124*^9, 3.735405843179944*^9}, {
   3.735405910877851*^9, 3.73540591844802*^9}, {3.7354084445945787`*^9, 
   3.735408450183888*^9}, {3.735419459298526*^9, 3.735419461225512*^9}, {
   3.735419570628702*^9, 3.735419608655633*^9}, {3.735419643456356*^9, 
   3.735419762140724*^9}, {3.73541984412327*^9, 3.73541984773533*^9}, {
   3.73561131340965*^9, 3.735611316014204*^9}, {3.735612791503358*^9, 
   3.735612792889513*^9}, {3.736866684353366*^9, 3.736866697136385*^9}, {
   3.737413815930737*^9, 3.737413839803301*^9}, {3.737414590675021*^9, 
   3.737414710624016*^9}, {3.737414747031571*^9, 3.737414750624072*^9}, {
   3.7374181671112347`*^9, 3.7374181862227793`*^9}, 3.737660935028171*^9, {
   3.7376610097806187`*^9, 3.737661014667954*^9}, {3.7376664127605658`*^9, 
   3.737666722655966*^9}, {3.737666972586742*^9, 3.737667004842565*^9}, {
   3.7376687745422373`*^9, 3.737668789425085*^9}, {3.737673789713941*^9, 
   3.737673790832396*^9}, {3.7376869553711863`*^9, 3.73768695659722*^9}, {
   3.738250709379754*^9, 3.738250720562831*^9}, {3.738250854913507*^9, 
   3.7382508808737583`*^9}, {3.738250939350425*^9, 3.738251014318717*^9}, 
   3.749481927392786*^9, {3.749483976056926*^9, 3.749483984153963*^9}, 
   3.750086215420785*^9, 3.799344068701331*^9, {3.799349224493123*^9, 
   3.799349273780303*^9}, {3.79934942673732*^9, 3.799349493927431*^9}, {
   3.799349548022112*^9, 3.7993495483473177`*^9}},
 CellLabel->
  "In[598]:=",ExpressionUUID->"7fad0a5a-4b29-46f7-af6a-ff3568d8178e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Main Function (Genus 1)", "Section",
 CellChangeTimes->{{3.749479544567781*^9, 3.749479547814333*^9}, {
   3.750095281373163*^9, 3.750095283131371*^9}, 3.761234005172523*^9, {
   3.787942841209887*^9, 
   3.787942843896345*^9}},ExpressionUUID->"a7082d18-8b5d-4356-a3a2-\
925c661afabd"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Main", " ", 
   RowBox[{"outline", ":", "\[IndentingNewLine]", " ", 
    RowBox[{
    "Triangulate", "\[IndentingNewLine]", "Compute", " ", "f", 
     "\[IndentingNewLine]", "Compute", " ", "Lambda", "\[IndentingNewLine]", 
     "Compute", " ", "GSB", "\[IndentingNewLine]", "Make", " ", "objects", 
     " ", "for", " ", "plotting"}]}]}], "\[IndentingNewLine]", " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.749479769037278*^9, 3.7494798137257423`*^9}, {
  3.7494808668280067`*^9, 3.749480871866756*^9}, {3.75008946776235*^9, 
  3.7500894882150183`*^9}},
 CellLabel->
  "In[160]:=",ExpressionUUID->"1f7dab26-ed71-4f93-b756-03c07492802f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Main", "[", 
   RowBox[{
   "region_", ",", "regionVertices_", ",", "interiorVerticesByHole_", ",", 
    "exteriorVertices_", ",", "nHoles_", ",", "pointsInHoles_", ",", 
    "omega0Seq_", ",", "refinementLevel_", ",", "convex_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "TUnrefined", ",", "T", ",", "regionSkeleton", ",", 
      "triangulationTopology", ",", "interiorEdgesOrientedTriangulation", ",",
       "boundaryEdgesOrientedTriangulation", ",", "eMesh", ",", 
      "exteriorBoundary", ",", "interiorBoundaries", ",", "\[CapitalGamma]1", 
      ",", "\[CapitalGamma]2", ",", "f", ",", "u", ",", "fValues", ",", 
      "Lambda", ",", "containedVertices", ",", "containedFaces", ",", 
      "LambdaGraph", ",", "omega0n", ",", "slitVertices", ",", 
      "paddedPolygons", ",", "toRightOfEdgeTriAssociation", ",", 
      "toRightOfEdgePolyAssociation", ",", 
      "conductanceAssociationtoRightOfEdgeTriAssociation", ",", 
      "conductanceAssociation", ",", "LambdaShortestPathFunction", ",", 
      "GSBValuesExtended", ",", "GSBValues", ",", "periodApprox", ",", 
      "GSBValuesExtendedNormalized", ",", "phiValuesExtended", ",", 
      "phiValues", ",", "GSBValuePolygons", ",", "interpolatedGSBValueMesh", 
      ",", "interpolatedGSBValueMeshExtended", ",", "TBoundaryVertices", ",", 
      "interiorTriangles", ",", "GSBMin", ",", "GSBMax", ",", "h2", ",", 
      "slitPolygons", ",", "slitPolygonsByIndex", ",", "slitTriangles", ",", 
      "nonslitTriangles", ",", "interiorNonslitTriangles", ",", "newPoints", 
      ",", "cleaned", ",", "radius", ",", "holeRegion", ",", "rmf", ",", 
      "containedVerticesIndicator"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", "Triangulate", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TUnrefined", "=", 
      RowBox[{"AcuteTriangulate", "[", 
       RowBox[{"region", ",", "pointsInHoles"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"T", "=", 
      RowBox[{"Nest", "[", 
       RowBox[{
       "RefineTriangulation", ",", "TUnrefined", ",", "refinementLevel"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{"[", "2", "]"}], "]"}], " ", "=", " ", 
      RowBox[{"Union", "[", 
       RowBox[{"Sort", "/@", 
        RowBox[{"T", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], " ", "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Remove", " ", "duplicated", " ", "edges"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"regionSkeleton", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"MeshCoordinates", "[", "region", "]"}], ",", " ", 
        RowBox[{"MeshCells", "[", 
         RowBox[{"region", ",", "1"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Compute", " ", "f"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"triangulationTopology", "=", 
      RowBox[{"BuildTriangulationTopologyNDLUACompiled", "[", 
       RowBox[{"T", "[", 
        RowBox[{"[", "3", "]"}], "]"}], " ", "]"}]}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "interiorEdgesOrientedTriangulation", ",", 
        "boundaryEdgesOrientedTriangulation"}], "}"}], "=", 
      RowBox[{"InteriorAndBoundaryEdges", "[", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "triangulationTopology"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"eMesh", "=", 
      RowBox[{"ToElementMesh", "[", 
       RowBox[{
        RowBox[{"\"\<Coordinates\>\"", "\[Rule]", 
         RowBox[{"T", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"\"\<MeshElements\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"TriangleElement", "[", 
           RowBox[{"T", "[", 
            RowBox[{"[", "3", "]"}], "]"}], " ", "]"}], "}"}]}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"exteriorBoundary", " ", "=", " ", 
      RowBox[{"Line", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"regionVertices", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", " ", 
        RowBox[{"Append", "[", 
         RowBox[{"exteriorVertices", ",", 
          RowBox[{"exteriorVertices", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}]}], " ", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"interiorBoundaries", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Line", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"regionVertices", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", " ", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}]}], " ", "]"}]}], " ", 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"\[CapitalGamma]1", "=", 
      RowBox[{"DirichletCondition", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"u", "[", 
          RowBox[{"x", ",", "y"}], "]"}], " ", "\[Equal]", " ", "1"}], ",", 
        " ", 
        RowBox[{
         RowBox[{"RegionDistance", "[", 
          RowBox[{"exteriorBoundary", ",", " ", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}]}], "]"}], " ", "<", " ", 
         RowBox[{"1", "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "5"}], ")"}]}]}]}]}], "]"}]}], ";", 
     RowBox[{"\[CapitalGamma]2", "=", 
      RowBox[{"DirichletCondition", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"u", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"RegionDistance", "[", 
             RowBox[{"#", ",", " ", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}]}], "]"}], "&"}], "/@", 
           "interiorBoundaries"}], "]"}], " ", "<", " ", 
         RowBox[{"1", "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "5"}], ")"}]}]}]}]}], "]"}]}], ";", 
     RowBox[{"f", "=", 
      RowBox[{"NDSolveValue", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Laplacian", "[", 
             RowBox[{
              RowBox[{"u", "[", 
               RowBox[{"x", ",", "y"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], "\[Equal]", "0"}], 
          ",", "\[CapitalGamma]1", ",", "\[CapitalGamma]2"}], " ", "}"}], ",",
         "u", ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "eMesh"}]}], "]"}]}], 
     ";", 
     RowBox[{"fValues", "=", 
      RowBox[{"f", "@@@", 
       RowBox[{"T", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Constructing", " ", "Lambda"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Lambda", "=", 
      RowBox[{"BuildLambda", "[", 
       RowBox[{
       "T", ",", "exteriorVertices", ",", "interiorVerticesByHole", ",", 
        "regionVertices"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"containedVertices", " ", "=", " ", 
        RowBox[{"ContainedVertices", "[", 
         RowBox[{
          RowBox[{"Lambda", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "exteriorVertices", ",", 
          "interiorVerticesByHole", ",", "regionVertices"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", "convex"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"holeRegion", "=", 
           RowBox[{"BoundaryMeshRegion", "[", 
            RowBox[{"regionVertices", ",", 
             RowBox[{"Delete", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Line", "[", 
                  RowBox[{"Append", "[", 
                   RowBox[{
                    RowBox[{"interiorVerticesByHole", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"interiorVerticesByHole", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", 
                  "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}], ",", "0"}], 
              "]"}]}], " ", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"containedVertices", "=", 
           RowBox[{"Pick", "[", 
            RowBox[{"containedVertices", ",", 
             RowBox[{"Not", "/@", 
              RowBox[{"RegionMember", "[", 
               RowBox[{"holeRegion", ",", 
                RowBox[{"Lambda", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "containedVertices"}], "]"}], "]"}]}], 
               "]"}]}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"rmf", "=", 
      RowBox[{"RegionMember", "[", "region", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"containedVerticesIndicator", "=", 
      RowBox[{"rmf", "/@", 
       RowBox[{"Lambda", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", 
     RowBox[{"containedVertices", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", 
          RowBox[{"Lambda", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
        "containedVerticesIndicator"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"containedFaces", "=", 
      RowBox[{"ContainedFaces", "[", 
       RowBox[{
        RowBox[{"Lambda", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "containedVertices"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"paddedPolygons", "=", 
      RowBox[{"PadPolygonsToMatrix", "[", 
       RowBox[{"Lambda", "[", 
        RowBox[{"[", "3", "]"}], "]"}], " ", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"toRightOfEdgeTriAssociation", "=", 
      RowBox[{"BuildEdgeToRightTriangulationAssociation", "[", 
       RowBox[{"T", "[", 
        RowBox[{"[", "3", "]"}], "]"}], " ", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"toRightOfEdgePolyAssociation", "=", 
      RowBox[{
      "BuildEdgeToRightPolygonsAssociation", "[", "paddedPolygons", "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"conductanceAssociation", "=", 
      RowBox[{"BuildConductanceAssociation", "[", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        "interiorEdgesOrientedTriangulation", ",", 
        "toRightOfEdgeTriAssociation", ",", 
        RowBox[{"T", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"LambdaGraph", ",", "omega0n", ",", "slitVertices"}], "}"}], 
      "=", "\[IndentingNewLine]", 
      RowBox[{"BuildSlittedWeightedVoronoiGraph", "[", 
       RowBox[{"Lambda", ",", "containedVertices", ",", "containedFaces", ",", 
        RowBox[{"omega0Seq", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"pointsInHoles", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        "toRightOfEdgePolyAssociation"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Compute", " ", "GSB"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"LambdaShortestPathFunction", "=", 
      RowBox[{"FindShortestPath", "[", 
       RowBox[{"LambdaGraph", ",", "omega0n", ",", "All"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"GSBValuesExtended", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"containedVertices", ",", " ", "i"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"GSB2", "[", 
           RowBox[{
           "i", ",", "conductanceAssociation", ",", 
            "toRightOfEdgePolyAssociation", ",", "f", ",", 
            RowBox[{"T", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            "LambdaShortestPathFunction"}], "]"}], ",", "\[IndentingNewLine]",
           " ", "Null"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", 
          RowBox[{"Length", "[", 
           RowBox[{"Lambda", "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"GSBValues", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"GSBValuesExtended", ",", "Null"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"periodApprox", "=", " ", 
      RowBox[{"Max", "[", 
       RowBox[{"Abs", "[", "GSBValues", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"GSBValuesExtendedNormalized", "=", "GSBValuesExtended"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"phiValuesExtended", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"2", "*", 
          RowBox[{"Pi", "/", "periodApprox"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"containedVertices", ",", " ", "#"}], "]"}], ",", 
              RowBox[{"f", "[", 
               RowBox[{"Delete", "[", 
                RowBox[{
                 RowBox[{"Lambda", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "#"}], "]"}], "]"}], ",", " ", "0"}], 
                "]"}], "]"}], ",", "Null"}], "]"}], " ", "+", " ", 
            RowBox[{"I", "*", 
             RowBox[{"GSBValuesExtendedNormalized", "[", 
              RowBox[{"[", "#", "]"}], "]"}]}]}], ")"}]}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", 
         RowBox[{"Lambda", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"phiValuesExtended", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"NumberQ", "[", "#", "]"}], ",", "#", ",", "Null"}], "]"}],
          "&"}], ",", "phiValuesExtended", ",", 
        RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"phiValues", "=", 
      RowBox[{"phiValuesExtended", "[", 
       RowBox[{"[", "containedVertices", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Compute", " ", "the", " ", "average", " ", 
       RowBox[{"(", 
        RowBox[{
        "use", " ", "Wachspress", " ", "average", " ", "later", " ", "for", 
         " ", "better", " ", "accuracy"}], ")"}], " ", "of", " ", "GSB", " ", 
       "values", " ", "on", " ", "each", " ", "polygon", " ", "for", " ", 
       "interpolation", " ", "values", " ", "for", " ", "points", " ", "in", 
       " ", "T"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"GSBValuePolygons", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GSBValuesExtended", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], ",", 
        RowBox[{"Lambda", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "containedFaces"}], "]"}], "]"}], ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"interpolatedGSBValueMesh", "=", 
      RowBox[{"Mean", "/@", "GSBValuePolygons"}]}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{
      "GSBValues", " ", "on", " ", "containedFaces", " ", "polygons"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"interpolatedGSBValueMeshExtended", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"containedFaces", ",", "i"}], "]"}], ",", 
          RowBox[{"Mean", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"GSBValuesExtended", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
            RowBox[{"Lambda", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "i"}], "]"}], "]"}]}], " ", "]"}], ",", 
          "Null"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"T", "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"TBoundaryVertices", "=", 
      RowBox[{"Union", "[", 
       RowBox[{"Flatten", "[", "boundaryEdgesOrientedTriangulation", "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"regionSkeleton", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"MeshCoordinates", "[", "region", "]"}], ",", " ", 
        RowBox[{"MeshCells", "[", 
         RowBox[{"region", ",", "1"}], "]"}]}], "}"}]}], ";", 
     RowBox[{"interiorTriangles", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{"x_", "/;", 
         RowBox[{"!", 
          RowBox[{"ContainsAny", "[", 
           RowBox[{"x", ",", "TBoundaryVertices"}], " ", "]"}]}]}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"GSBMin", ",", "GSBMax"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Min", "[", "interpolatedGSBValueMesh", "]"}], ",", " ", 
        RowBox[{"Max", "[", "interpolatedGSBValueMesh", "]"}]}], "}"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"h2", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "GSBMin", ",", "GSBMax", ",", ".05"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"slitPolygons", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"Lambda", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
        RowBox[{"x_", "/;", 
         RowBox[{"ContainsAny", "[", 
          RowBox[{"x", ",", " ", "slitVertices"}], "]"}]}]}], " ", "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"slitPolygonsByIndex", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Lambda", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", " ", "#"}], "]"}], "&"}], "/@",
         " ", "slitPolygons"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"slitTriangles", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
        RowBox[{"x_", "/;", 
         RowBox[{"ContainsAny", "[", 
          RowBox[{"x", ",", "slitPolygonsByIndex"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nonslitTriangles", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "slitTriangles"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"interiorNonslitTriangles", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"nonslitTriangles", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{"!", 
          RowBox[{"ContainsAny", "[", 
           RowBox[{"x", ",", " ", "TBoundaryVertices"}], "]"}]}]}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"newPoints", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"#", ",", "Null"}], "]"}], ",", "Null", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Re", "[", "#", "]"}], ",", 
            RowBox[{"Im", "[", "#", "]"}]}], "}"}]}], "]"}], "&"}], "/@", 
       "phiValuesExtended"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cleaned", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"newPoints", ",", "Null"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"radius", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"Norm", "/@", "cleaned"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
       "regionSkeleton", ",", "T", ",", "f", ",", "Lambda", ",", 
        "LambdaGraph", ",", "GSBValuesExtended", ",", "phiValuesExtended", 
        ",", "interiorNonslitTriangles", ",", 
        "interpolatedGSBValueMeshExtended", ",", "h2", ",", "newPoints", ",", 
        "cleaned", ",", "radius", ",", "slitVertices"}], "}"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.74947935197923*^9, 3.749479365085166*^9}, {
   3.7494794210410137`*^9, 3.749479433016589*^9}, {3.7494796706291103`*^9, 
   3.749479736530945*^9}, {3.749479921706791*^9, 3.749480091962109*^9}, {
   3.7494801568664923`*^9, 3.749480306638796*^9}, {3.749480378732911*^9, 
   3.749480379010577*^9}, {3.749480599742567*^9, 3.7494806050686293`*^9}, {
   3.749481373583269*^9, 3.7494813803183403`*^9}, {3.749481420030665*^9, 
   3.74948147130942*^9}, {3.749481520403808*^9, 3.749481522963842*^9}, {
   3.749481665469215*^9, 3.749481787133342*^9}, {3.749481974067051*^9, 
   3.749481986946453*^9}, 3.749482118203006*^9, {3.74948246948943*^9, 
   3.749482479209113*^9}, {3.74948303479564*^9, 3.749483036858204*^9}, {
   3.74948311378281*^9, 3.749483122940175*^9}, {3.749483755279253*^9, 
   3.7494837604660378`*^9}, {3.749483799701997*^9, 3.749483916857972*^9}, {
   3.749484001719734*^9, 3.749484063237677*^9}, {3.750078846927745*^9, 
   3.750078877155795*^9}, {3.750079078423862*^9, 3.750079087893455*^9}, {
   3.750086161950366*^9, 3.750086224498906*^9}, {3.750086643882621*^9, 
   3.7500866523679037`*^9}, {3.750086981272925*^9, 3.750086981762649*^9}, {
   3.750087019616775*^9, 3.750087130189054*^9}, {3.750087163550383*^9, 
   3.750087269488401*^9}, {3.750087328293714*^9, 3.750087329661751*^9}, {
   3.750087974019589*^9, 3.750088255550747*^9}, {3.7500883160389223`*^9, 
   3.7500883889816236`*^9}, {3.7500890002262487`*^9, 
   3.7500890429764347`*^9}, {3.750089235732286*^9, 3.750089257846716*^9}, {
   3.750089327909058*^9, 3.7500893289011803`*^9}, {3.7500897857498913`*^9, 
   3.750089787415536*^9}, {3.751385780926332*^9, 3.751385838450933*^9}, {
   3.7669356094227552`*^9, 3.766935650670186*^9}, {3.801170792813588*^9, 
   3.801170814107677*^9}, {3.801171628201873*^9, 3.8011716476515417`*^9}},
 CellLabel->
  "In[161]:=",ExpressionUUID->"d6313f5f-f615-449a-a77e-47a60bcfaef0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MainPreTriangulated", "[", 
   RowBox[{"fullFileStem_", ",", "omega0epsilon_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "regionVertices", ",", "regionBdryMarkers", ",", "regionEdges", ",", 
      "pointsInHoles", ",", "coordinates", ",", "bdryMarkers", ",", 
      "triangles", ",", "exteriorVertices", ",", "interiorVerticesByHole", 
      ",", "region", ",", "nHoles", ",", "nClasses", ",", "omega0Seq", ",", 
      "T", ",", "regionSkeleton", ",", "triangulationTopology", ",", 
      "interiorEdgesOrientedTriangulation", ",", 
      "boundaryEdgesOrientedTriangulation", ",", "eMesh", ",", 
      "exteriorBoundary", ",", "interiorBoundaries", ",", "\[CapitalGamma]1", 
      ",", "\[CapitalGamma]2", ",", "f", ",", "u", ",", "fValues", ",", 
      "Lambda", ",", "containedVertices", ",", "containedFaces", ",", 
      "LambdaGraph", ",", "omega0n", ",", "slitVertices", ",", 
      "paddedPolygons", ",", "toRightOfEdgeTriAssociation", ",", 
      "toRightOfEdgePolyAssociation", ",", 
      "conductanceAssociationtoRightOfEdgeTriAssociation", ",", 
      "conductanceAssociation", ",", "LambdaShortestPathFunction", ",", 
      "GSBValuesExtended", ",", "GSBValues", ",", "periodApprox", ",", 
      "GSBValuesExtendedNormalized", ",", "phiValuesExtended", ",", 
      "phiValues", ",", "GSBValuePolygons", ",", "interpolatedGSBValueMesh", 
      ",", "interpolatedGSBValueMeshExtended", ",", "TBoundaryVertices", ",", 
      "interiorTriangles", ",", "GSBMin", ",", "GSBMax", ",", "h2", ",", 
      "slitPolygons", ",", "slitPolygonsByIndex", ",", "slitTriangles", ",", 
      "nonslitTriangles", ",", "interiorNonslitTriangles", ",", "newPoints", 
      ",", "cleaned", ",", "radius", ",", "holeRegion", ",", "rmf", ",", 
      "containedVerticesIndicator"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Read", " ", "in", " ", "triangulation"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "regionVertices", ",", "regionBdryMarkers", ",", "regionEdges", ",", 
        "pointsInHoles", ",", "coordinates", ",", "bdryMarkers", ",", 
        "triangles", ",", "triangulationTopology"}], "}"}], "=", 
      RowBox[{"readData", "[", "fullFileStem", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "exteriorVertices", ",", "interiorVerticesByHole", ",", "region", ",", 
        "regionSkeleton", ",", "nHoles", ",", "nClasses", ",", "omega0Seq"}], 
       "}"}], "=", 
      RowBox[{"makeRegionData", "[", 
       RowBox[{
       "regionVertices", ",", "regionEdges", ",", "pointsInHoles", ",", 
        "omega0epsilon"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"T", "=", 
      RowBox[{"{", 
       RowBox[{"coordinates", ",", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"EdgesWrapCompiled", "/@", "triangles"}], "]"}], ",", 
          "2"}], "]"}], ",", "triangles"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{"[", "2", "]"}], "]"}], " ", "=", " ", 
      RowBox[{"Union", "[", 
       RowBox[{"Sort", "/@", 
        RowBox[{"T", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], " ", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "interiorEdgesOrientedTriangulation", ",", 
        "boundaryEdgesOrientedTriangulation"}], "}"}], "=", 
      RowBox[{"InteriorAndBoundaryEdges", "[", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "triangulationTopology"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Compute", " ", "f"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"eMesh", "=", 
      RowBox[{"ToElementMesh", "[", 
       RowBox[{
        RowBox[{"\"\<Coordinates\>\"", "\[Rule]", 
         RowBox[{"T", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"\"\<MeshElements\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"TriangleElement", "[", 
           RowBox[{"T", "[", 
            RowBox[{"[", "3", "]"}], "]"}], " ", "]"}], "}"}]}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"exteriorBoundary", " ", "=", " ", 
      RowBox[{"Line", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"regionVertices", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", " ", 
        RowBox[{"Append", "[", 
         RowBox[{"exteriorVertices", ",", 
          RowBox[{"exteriorVertices", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}]}], " ", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"interiorBoundaries", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Line", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"regionVertices", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", " ", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}]}], " ", "]"}]}], " ", 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"\[CapitalGamma]1", "=", 
      RowBox[{"DirichletCondition", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"u", "[", 
          RowBox[{"x", ",", "y"}], "]"}], " ", "\[Equal]", " ", "1"}], ",", 
        " ", 
        RowBox[{
         RowBox[{"RegionDistance", "[", 
          RowBox[{"exteriorBoundary", ",", " ", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}]}], "]"}], " ", "<", " ", 
         RowBox[{"1", "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "5"}], ")"}]}]}]}]}], "]"}]}], ";", 
     RowBox[{"\[CapitalGamma]2", "=", 
      RowBox[{"DirichletCondition", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"u", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"RegionDistance", "[", 
             RowBox[{"#", ",", " ", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}]}], "]"}], "&"}], "/@", 
           "interiorBoundaries"}], "]"}], " ", "<", " ", 
         RowBox[{"1", "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "5"}], ")"}]}]}]}]}], "]"}]}], ";", 
     RowBox[{"f", "=", 
      RowBox[{"NDSolveValue", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Laplacian", "[", 
             RowBox[{
              RowBox[{"u", "[", 
               RowBox[{"x", ",", "y"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], "\[Equal]", "0"}], 
          ",", "\[CapitalGamma]1", ",", "\[CapitalGamma]2"}], " ", "}"}], ",",
         "u", ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "eMesh"}]}], "]"}]}], 
     ";", 
     RowBox[{"fValues", "=", 
      RowBox[{"f", "@@@", 
       RowBox[{"T", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Constructing", " ", "Lambda"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Lambda", "=", 
      RowBox[{"BuildLambda", "[", 
       RowBox[{
       "T", ",", "exteriorVertices", ",", "interiorVerticesByHole", ",", 
        "regionVertices"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"containedVertices", " ", "=", " ", 
        RowBox[{"ContainedVertices", "[", 
         RowBox[{
          RowBox[{"Lambda", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "exteriorVertices", ",", 
          "interiorVerticesByHole", ",", "regionVertices"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", "convex"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"holeRegion", "=", 
           RowBox[{"BoundaryMeshRegion", "[", 
            RowBox[{"regionVertices", ",", 
             RowBox[{"Delete", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Line", "[", 
                  RowBox[{"Append", "[", 
                   RowBox[{
                    RowBox[{"interiorVerticesByHole", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"interiorVerticesByHole", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", 
                  "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}], ",", "0"}], 
              "]"}]}], " ", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"containedVertices", "=", 
           RowBox[{"Pick", "[", 
            RowBox[{"containedVertices", ",", 
             RowBox[{"Not", "/@", 
              RowBox[{"RegionMember", "[", 
               RowBox[{"holeRegion", ",", 
                RowBox[{"Lambda", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "containedVertices"}], "]"}], "]"}]}], 
               "]"}]}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"rmf", "=", 
      RowBox[{"RegionMember", "[", "region", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"containedVerticesIndicator", "=", 
      RowBox[{"rmf", "/@", 
       RowBox[{"Lambda", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"containedVertices", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", 
          RowBox[{"Lambda", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
        "containedVerticesIndicator"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"containedFaces", "=", 
      RowBox[{"ContainedFaces", "[", 
       RowBox[{
        RowBox[{"Lambda", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "containedVertices"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"paddedPolygons", "=", 
      RowBox[{"PadPolygonsToMatrix", "[", 
       RowBox[{"Lambda", "[", 
        RowBox[{"[", "3", "]"}], "]"}], " ", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"toRightOfEdgeTriAssociation", "=", 
      RowBox[{"BuildEdgeToRightTriangulationAssociation", "[", 
       RowBox[{"T", "[", 
        RowBox[{"[", "3", "]"}], "]"}], " ", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"toRightOfEdgePolyAssociation", "=", 
      RowBox[{
      "BuildEdgeToRightPolygonsAssociation", "[", "paddedPolygons", "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"conductanceAssociation", "=", 
      RowBox[{"BuildConductanceAssociation", "[", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        "interiorEdgesOrientedTriangulation", ",", 
        "toRightOfEdgeTriAssociation", ",", 
        RowBox[{"T", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"LambdaGraph", ",", "omega0n", ",", "slitVertices"}], "}"}], 
      "=", "\[IndentingNewLine]", 
      RowBox[{"BuildSlittedWeightedVoronoiGraph", "[", 
       RowBox[{"Lambda", ",", "containedVertices", ",", "containedFaces", ",", 
        RowBox[{"omega0Seq", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"pointsInHoles", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        "toRightOfEdgePolyAssociation"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Compute", " ", "GSB"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"LambdaShortestPathFunction", "=", 
      RowBox[{"FindShortestPath", "[", 
       RowBox[{"LambdaGraph", ",", "omega0n", ",", "All"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"GSBValuesExtended", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"containedVertices", ",", " ", "i"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"GSB2", "[", 
           RowBox[{
           "i", ",", "conductanceAssociation", ",", 
            "toRightOfEdgePolyAssociation", ",", "f", ",", 
            RowBox[{"T", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            "LambdaShortestPathFunction"}], "]"}], ",", "\[IndentingNewLine]",
           " ", "Null"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", 
          RowBox[{"Length", "[", 
           RowBox[{"Lambda", "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"GSBValues", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"GSBValuesExtended", ",", "Null"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"periodApprox", "=", " ", 
      RowBox[{"Max", "[", 
       RowBox[{"Abs", "[", "GSBValues", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"GSBValuesExtendedNormalized", "=", "GSBValuesExtended"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"phiValuesExtended", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"2", "*", 
          RowBox[{"Pi", "/", "periodApprox"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"containedVertices", ",", " ", "#"}], "]"}], ",", 
              RowBox[{"f", "[", 
               RowBox[{"Delete", "[", 
                RowBox[{
                 RowBox[{"Lambda", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "#"}], "]"}], "]"}], ",", " ", "0"}], 
                "]"}], "]"}], ",", "Null"}], "]"}], " ", "+", " ", 
            RowBox[{"I", "*", 
             RowBox[{"GSBValuesExtendedNormalized", "[", 
              RowBox[{"[", "#", "]"}], "]"}]}]}], ")"}]}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", 
         RowBox[{"Lambda", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"phiValuesExtended", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"NumberQ", "[", "#", "]"}], ",", "#", ",", "Null"}], "]"}],
          "&"}], ",", "phiValuesExtended", ",", 
        RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"phiValues", "=", 
      RowBox[{"phiValuesExtended", "[", 
       RowBox[{"[", "containedVertices", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Compute", " ", "the", " ", "average", " ", 
       RowBox[{"(", 
        RowBox[{
        "use", " ", "Wachspress", " ", "average", " ", "later", " ", "for", 
         " ", "better", " ", "accuracy"}], ")"}], " ", "of", " ", "GSB", " ", 
       "values", " ", "on", " ", "each", " ", "polygon", " ", "for", " ", 
       "interpolation", " ", "values", " ", "for", " ", "points", " ", "in", 
       " ", "T"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"GSBValuePolygons", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GSBValuesExtended", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], ",", 
        RowBox[{"Lambda", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "containedFaces"}], "]"}], "]"}], ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"interpolatedGSBValueMesh", "=", 
      RowBox[{"Mean", "/@", "GSBValuePolygons"}]}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{
      "GSBValues", " ", "on", " ", "containedFaces", " ", "polygons"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"interpolatedGSBValueMeshExtended", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"containedFaces", ",", "i"}], "]"}], ",", 
          RowBox[{"Mean", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"GSBValuesExtended", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
            RowBox[{"Lambda", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "i"}], "]"}], "]"}]}], " ", "]"}], ",", 
          "Null"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"T", "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"TBoundaryVertices", "=", 
      RowBox[{"Union", "[", 
       RowBox[{"Flatten", "[", "boundaryEdgesOrientedTriangulation", "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"regionSkeleton", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"MeshCoordinates", "[", "region", "]"}], ",", " ", 
        RowBox[{"MeshCells", "[", 
         RowBox[{"region", ",", "1"}], "]"}]}], "}"}]}], ";", 
     RowBox[{"interiorTriangles", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{"x_", "/;", 
         RowBox[{"!", 
          RowBox[{"ContainsAny", "[", 
           RowBox[{"x", ",", "TBoundaryVertices"}], " ", "]"}]}]}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"GSBMin", ",", "GSBMax"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Min", "[", "interpolatedGSBValueMesh", "]"}], ",", " ", 
        RowBox[{"Max", "[", "interpolatedGSBValueMesh", "]"}]}], "}"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"h2", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "GSBMin", ",", "GSBMax", ",", ".05"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"slitPolygons", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"Lambda", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
        RowBox[{"x_", "/;", 
         RowBox[{"ContainsAny", "[", 
          RowBox[{"x", ",", " ", "slitVertices"}], "]"}]}]}], " ", "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"slitPolygonsByIndex", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Lambda", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", " ", "#"}], "]"}], "&"}], "/@",
         " ", "slitPolygons"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"slitTriangles", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
        RowBox[{"x_", "/;", 
         RowBox[{"ContainsAny", "[", 
          RowBox[{"x", ",", "slitPolygonsByIndex"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nonslitTriangles", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "slitTriangles"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"interiorNonslitTriangles", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"nonslitTriangles", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{"!", 
          RowBox[{"ContainsAny", "[", 
           RowBox[{"x", ",", " ", "TBoundaryVertices"}], "]"}]}]}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"newPoints", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"#", ",", "Null"}], "]"}], ",", "Null", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Re", "[", "#", "]"}], ",", 
            RowBox[{"Im", "[", "#", "]"}]}], "}"}]}], "]"}], "&"}], "/@", 
       "phiValuesExtended"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cleaned", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"newPoints", ",", "Null"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"radius", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"Norm", "/@", "cleaned"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
       "regionSkeleton", ",", "T", ",", "f", ",", "Lambda", ",", 
        "LambdaGraph", ",", "GSBValuesExtended", ",", "phiValuesExtended", 
        ",", "interiorNonslitTriangles", ",", 
        "interpolatedGSBValueMeshExtended", ",", "h2", ",", "newPoints", ",", 
        "cleaned", ",", "radius", ",", "slitVertices"}], "}"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.74947935197923*^9, 3.749479365085166*^9}, {
   3.7494794210410137`*^9, 3.749479433016589*^9}, {3.7494796706291103`*^9, 
   3.749479736530945*^9}, {3.749479921706791*^9, 3.749480091962109*^9}, {
   3.7494801568664923`*^9, 3.749480306638796*^9}, {3.749480378732911*^9, 
   3.749480379010577*^9}, {3.749480599742567*^9, 3.7494806050686293`*^9}, {
   3.749481373583269*^9, 3.7494813803183403`*^9}, {3.749481420030665*^9, 
   3.74948147130942*^9}, {3.749481520403808*^9, 3.749481522963842*^9}, {
   3.749481665469215*^9, 3.749481787133342*^9}, {3.749481974067051*^9, 
   3.749481986946453*^9}, 3.749482118203006*^9, {3.74948246948943*^9, 
   3.749482479209113*^9}, {3.74948303479564*^9, 3.749483036858204*^9}, {
   3.74948311378281*^9, 3.749483122940175*^9}, {3.749483755279253*^9, 
   3.7494837604660378`*^9}, {3.749483799701997*^9, 3.749483916857972*^9}, {
   3.749484001719734*^9, 3.749484063237677*^9}, {3.750078846927745*^9, 
   3.750078877155795*^9}, {3.750079078423862*^9, 3.750079087893455*^9}, {
   3.750086161950366*^9, 3.750086224498906*^9}, {3.750086643882621*^9, 
   3.7500866523679037`*^9}, {3.750086981272925*^9, 3.750086981762649*^9}, {
   3.750087019616775*^9, 3.750087130189054*^9}, {3.750087163550383*^9, 
   3.750087269488401*^9}, {3.750087328293714*^9, 3.750087329661751*^9}, {
   3.750087974019589*^9, 3.750088255550747*^9}, {3.7500883160389223`*^9, 
   3.7500883889816236`*^9}, {3.7500890002262487`*^9, 
   3.7500890429764347`*^9}, {3.750089235732286*^9, 3.750089257846716*^9}, {
   3.750089327909058*^9, 3.7500893289011803`*^9}, {3.7500897857498913`*^9, 
   3.750089787415536*^9}, {3.751385780926332*^9, 3.751385838450933*^9}, {
   3.7669356094227552`*^9, 3.766935650670186*^9}, {3.801170792813588*^9, 
   3.801170814107677*^9}, {3.801171628201873*^9, 3.8011716476515417`*^9}, {
   3.84874468554521*^9, 3.848744733634609*^9}, {3.848744974707047*^9, 
   3.848745046431278*^9}, {3.848745193085734*^9, 3.848745215102457*^9}, 
   3.8487452897552137`*^9, {3.848745737544129*^9, 3.848745758760619*^9}, {
   3.848746898910014*^9, 3.848746900061932*^9}, {3.848746982852057*^9, 
   3.8487469864076357`*^9}, {3.848748470209015*^9, 3.848748470425026*^9}, 
   3.848748798438038*^9},
 CellLabel->
  "In[162]:=",ExpressionUUID->"f9cf5955-8f3a-485e-9334-a152556dbdad"],

Cell[CellGroupData[{

Cell["Example", "Subsection",
 CellChangeTimes->{{3.848748848444799*^9, 
  3.8487488508666153`*^9}},ExpressionUUID->"d6be7719-6bf0-4ad4-a2ae-\
159979597873"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "fullFileStem", "=", 
   "\"\</Users/eric/Code/combinatorial-topology/regions/ex_1\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"omega0epsilon", "=", "25"}], ";"}]}], "Input",
 CellChangeTimes->{{3.848747740740711*^9, 3.848747744661992*^9}, 
   3.848747935990715*^9},
 CellLabel->
  "In[191]:=",ExpressionUUID->"d7902d28-a62e-46a8-98cb-455c8b70444e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "regionVertices", ",", "regionBdryMarkers", ",", "regionEdges", ",", 
     "pointsInHoles", ",", "coordinates", ",", "bdryMarkers", ",", 
     "triangles", ",", "triangulationTopology"}], "}"}], "=", 
   RowBox[{"readData", "[", "fullFileStem", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.848746851742831*^9},
 CellLabel->
  "In[186]:=",ExpressionUUID->"d8babc06-1295-485c-827a-d8e61ea6c45a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "exteriorVertices", ",", "interiorVerticesByHole", ",", "region", ",", 
     "regionSkeleton", ",", "nHoles", ",", "nClasses", ",", "omega0Seq"}], 
    "}"}], "=", 
   RowBox[{"makeRegionData", "[", 
    RowBox[{
    "regionVertices", ",", "regionEdges", ",", "pointsInHoles", ",", 
     "omega0epsilon"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8487458106011467`*^9, 3.84874581251558*^9}, {
   3.848746463636023*^9, 3.848746464932982*^9}, 3.848746854299962*^9, 
   3.8487477486007833`*^9, 
   3.8487479394914083`*^9},ExpressionUUID->"77b62404-285a-4c43-90e8-\
266812818805"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "regionSkeleton", ",", "T", ",", "f", ",", "Lambda", ",", "LambdaGraph", 
     ",", "GSBValuesExtended", ",", "phiValuesExtended", ",", 
     "interiorNonslitTriangles", ",", "interpolatedGSBValueMeshExtended", ",",
      "h2", ",", "newPoints", ",", "cleaned", ",", "radius", ",", 
     "slitVertices"}], "}"}], "=", 
   RowBox[{"MainPreTriangulated", "[", 
    RowBox[{"fullFileStem", ",", "omega0epsilon"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.848747648107419*^9, 3.848747661882614*^9}, {
   3.8487477534292088`*^9, 3.848747757464815*^9}, 3.848747940480044*^9, 
   3.848748822853053*^9},ExpressionUUID->"1d4d57ab-aa93-443a-9847-\
b2b833f96d4b"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}]}], "]"}]], "Input",
 CellLabel->
  "In[189]:=",ExpressionUUID->"d67f1cb2-1faa-4306-a339-1f9756399739"],

Cell[BoxData[
 RowBox[{
  RowBox[{"h", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"i", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "1", ",", ".05"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.750089735177541*^9, 3.7500897354556932`*^9}, 
   3.750089766449644*^9},
 CellLabel->
  "In[198]:=",ExpressionUUID->"174e292e-8ed3-4b14-a908-47495d8dde7c"],

Cell[BoxData[
 RowBox[{"GraphicsGrid", "[", 
  RowBox[{"{", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LinearSplineLevelCurves2D", "[", 
        RowBox[{
         RowBox[{"T", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"Delete", "[", 
            RowBox[{
             RowBox[{"T", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], ",", "0"}], "]"}], 
           "]"}], "&"}], " ", ",", " ", "h", ",", " ", 
         RowBox[{"T", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\"\<AvocadoColors\>\"", 
         ",", " ", "Transparent"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Graphics", "/@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"regionSkeleton", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], "&"}], ",", 
          RowBox[{"regionSkeleton", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
          RowBox[{"{", "2", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"LinearSplineLevelCurves2D", "[", 
        RowBox[{"interiorNonslitTriangles", ",", " ", 
         RowBox[{
          RowBox[{"interpolatedGSBValueMeshExtended", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "&"}], ",", " ", "h2", ",", " ", 
         RowBox[{"T", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\"\<CandyColors\>\"", 
         ",", "  ", 
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.84", ",", "0.84", ",", "0.84"}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Graphics", "/@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"regionSkeleton", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], "&"}], ",", 
          RowBox[{"regionSkeleton", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
          RowBox[{"{", "2", "}"}]}], "]"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"LinearSplineLevelCurves2D", "[", 
        RowBox[{"interiorNonslitTriangles", ",", " ", 
         RowBox[{
          RowBox[{"interpolatedGSBValueMeshExtended", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "&"}], ",", " ", "h2", ",", " ", 
         RowBox[{"T", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\"\<CandyColors\>\"", 
         ",", " ", "Transparent"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"LinearSplineLevelCurves2D", "[", 
        RowBox[{
         RowBox[{"T", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"Delete", "[", 
            RowBox[{
             RowBox[{"T", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], ",", "0"}], "]"}], 
           "]"}], "&"}], " ", ",", " ", "h", ",", " ", 
         RowBox[{"T", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\"\<AvocadoColors\>\"", 
         ",", " ", "Transparent"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Graphics", "/@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"regionSkeleton", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], "&"}], ",", 
          RowBox[{"regionSkeleton", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
          RowBox[{"{", "2", "}"}]}], "]"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "}"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.733668552992518*^9, 3.7336685820139647`*^9}, {
   3.733668622678598*^9, 3.733668662059663*^9}, {3.733743734456108*^9, 
   3.733743740556603*^9}, {3.733743838618285*^9, 3.733743854080759*^9}, {
   3.733743885041329*^9, 3.733743888303382*^9}, {3.733743938871714*^9, 
   3.7337439396860113`*^9}, {3.733743984452228*^9, 3.7337440159935226`*^9}, {
   3.733744373782214*^9, 3.7337444174905167`*^9}, {3.733744468856512*^9, 
   3.7337444938562737`*^9}, 3.734091156395405*^9, {3.735420016153471*^9, 
   3.735420016176614*^9}, {3.735656866916383*^9, 3.7356568706975403`*^9}, {
   3.750088827975836*^9, 3.750088956958353*^9}, {3.750089091663211*^9, 
   3.750089093789413*^9}, {3.750126100577346*^9, 3.750126102524624*^9}},
 CellLabel->
  "In[199]:=",ExpressionUUID->"39250806-3a12-4773-82f7-c3c81b7e0580"],

Cell[BoxData[
 RowBox[{"Show2Skeleton", "[", "T", "]"}]], "Input",
 CellChangeTimes->{{3.766935781706234*^9, 3.7669357864229507`*^9}},
 CellLabel->
  "In[342]:=",ExpressionUUID->"31392fe6-712f-492f-a3a1-14260eefd447"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "radius"}], ",", " ", "radius"}], "}"}], ",", " ", 
     RowBox[{"PlotRange", "\[Rule]", "radius"}], ",", " ", 
     RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}], ",", 
   RowBox[{"ListPlot", "[", "newPoints", "]"}], ",", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{"Red", ",", " ", 
         RowBox[{"PointSize", "[", ".008", "]"}], ",", " ", "#"}], "}"}], 
       "]"}], "&"}], " ", "/@", " ", 
     RowBox[{"Point", "/@", 
      RowBox[{"newPoints", "[", 
       RowBox[{"[", "slitVertices", "]"}], "]"}]}]}], " ", "]"}]}], " ", 
  "]"}]], "Input",
 CellChangeTimes->{{3.750089309986261*^9, 3.7500893762784557`*^9}, {
  3.750089505887411*^9, 3.7500895098714437`*^9}},
 CellLabel->
  "In[343]:=",ExpressionUUID->"b8148c51-3c79-4ae3-afc7-a6299f366a6c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Construct Various Examples", "Section",
 CellChangeTimes->{{3.643894833344541*^9, 3.6438948339272127`*^9}, {
   3.644162773684428*^9, 3.644162790258747*^9}, 3.644352087003854*^9, {
   3.667672780323709*^9, 3.667672786096717*^9}, 3.667819626126384*^9, {
   3.668565700062798*^9, 
   3.668565701180217*^9}},ExpressionUUID->"d989e864-5aba-4d8d-b410-\
34f5838e32d4"],

Cell[CellGroupData[{

Cell["Genus 1 Examples", "Subsection",
 CellChangeTimes->{{3.766934406128594*^9, 
  3.766934434821*^9}},ExpressionUUID->"d1918a01-2593-4ec9-820a-f7d48b046aaf"],

Cell[CellGroupData[{

Cell["Test Region 1", "Subsubsection",
 CellChangeTimes->{{3.644162803428446*^9, 3.6441628122022457`*^9}, {
  3.6676666680849953`*^9, 3.667666671595355*^9}, {3.667819602240049*^9, 
  3.667819605853395*^9}, {3.667825314881927*^9, 3.667825318000515*^9}, {
  3.6685652329859324`*^9, 3.668565234267295*^9}, {3.7669344702931833`*^9, 
  3.766934486674933*^9}},ExpressionUUID->"f3b155bd-e289-47b3-9827-\
858209a8eb0e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nHoles", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorBoundaryPoints", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "3"}], ",", 
       RowBox[{"1", "/", "4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"8", "/", "3"}], ",", 
       RowBox[{"7", "/", "3"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "3"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nExteriorBoundaryPoints", "=", 
   RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"holePointsList", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"nHoles", "+", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorVertices", " ", "=", " ", 
   RowBox[{"Range", "[", "nExteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"5", ",", "6", ",", "7", ",", "8"}], "}"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"regionVertices", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"exteriorBoundaryPoints", ",", 
     RowBox[{"Delete", "[", 
      RowBox[{"holePointsList", ",", "0"}], "]"}]}], " ", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.738344788026334*^9}, {3.73834499365376*^9, 
   3.738345007381412*^9}, {3.738345041585004*^9, 3.7383450491514063`*^9}, {
   3.7383451644523897`*^9, 3.738345181717914*^9}, {3.7391147015206738`*^9, 
   3.739114701566883*^9}, 3.739114820074377*^9, {3.739116019013297*^9, 
   3.739116022468959*^9}, {3.739888997348928*^9, 3.739888997459691*^9}, {
   3.749474629526999*^9, 3.749474629605356*^9}, {3.749475888244898*^9, 
   3.749475923820779*^9}, 3.749476152858592*^9, {3.749476247478722*^9, 
   3.749476247756988*^9}},
 CellLabel->
  "In[326]:=",ExpressionUUID->"e4761998-647f-4549-8b42-16926bccbed3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"regionVertices", ",", "\[IndentingNewLine]", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"exteriorVertices", ",", 
        RowBox[{"exteriorVertices", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Delete", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}], ",", "0"}], "]"}]}], 
    " ", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.739115894052528*^9, 3.739115895033699*^9}},
 CellLabel->
  "In[334]:=",ExpressionUUID->"4de27928-ad6f-4690-9781-08eaf3b1a570"],

Cell[BoxData[
 RowBox[{
  RowBox[{"omega0Seq", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", ".1"}], ",", 
        RowBox[{"-", ".1"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.739115974221128*^9, 3.739116008692827*^9}, {
  3.7494762141902122`*^9, 3.749476217560429*^9}, {3.7494804677960033`*^9, 
  3.7494804698296003`*^9}, {3.749483665088717*^9, 3.749483668733768*^9}},
 CellLabel->
  "In[335]:=",ExpressionUUID->"6d37266e-2322-4aba-8a4b-0ec768029a26"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pointsInHoles", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Mean", "[", 
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7383447910264378`*^9, 3.7383447914517193`*^9}, {
   3.738344938932295*^9, 3.738344948618271*^9}, 3.738344984591922*^9, {
   3.7383450654821177`*^9, 3.738345068024321*^9}, {3.73911595565195*^9, 
   3.739115956682572*^9}, {3.739116038239038*^9, 3.739116073806284*^9}, {
   3.749476219325287*^9, 3.749476220903041*^9}},
 CellLabel->
  "In[336]:=",ExpressionUUID->"702f65e6-c72d-4211-a06e-efb9049370ab"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.738284112367519*^9, 3.738284173092161*^9}},
 CellLabel->
  "In[337]:=",ExpressionUUID->"f614f0fc-47f4-412f-a7a0-8d3735d2c375"],

Cell[BoxData[
 GraphicsBox[{
   GraphicsComplexBox[{{0.3333333333333333, 0.25}, {3., 0.}, {
    2.6666666666666665`, 2.3333333333333335`}, {0., 3.}, {1., 1.}, {2., 1.}, {
    2., 2.}, {1., 2.}}, 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     TagBox[FilledCurveBox[{{Line[{1, 2, 3, 4}]}, {Line[{5, 6, 7, 8}]}}],
      Annotation[#, "Geometry"]& ]}], 
   {RGBColor[1, 0, 0], 
    PointBox[NCache[{Rational[3, 2], Rational[3, 2]}, {1.5, 1.5}]]}, 
   {RGBColor[0, 1, 0], PointBox[{0.9, 0.9}]}}]], "Output",
 CellChangeTimes->{3.7513865707436113`*^9, 3.7669352749701433`*^9, 
  3.768748995638129*^9, 3.7879421552764997`*^9, 3.787942201930868*^9},
 CellLabel->
  "Out[337]=",ExpressionUUID->"57b8ce9c-8700-4f17-869b-b5ff5c791d91"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Region 2", "Subsubsection",
 CellChangeTimes->{{3.750096246645008*^9, 3.750096248082485*^9}, {
   3.76693447453932*^9, 3.766934494914501*^9}, 
   3.766934533176499*^9},ExpressionUUID->"5e96009e-5007-49e2-8847-\
c07056b6e160"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nHoles", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorBoundaryPoints", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", " ", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", " ", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", " ", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nExteriorBoundaryPoints", "=", 
   RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"holePointsList", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}], ",", " ", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "2"}], ",", " ", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "2"}], ",", " ", 
        RowBox[{"1", "/", "2"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}], ",", " ", 
        RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"nHoles", "+", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorVertices", " ", "=", " ", 
   RowBox[{"Range", "[", "nExteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"5", ",", "6", ",", "7", ",", "8"}], "}"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"regionVertices", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"exteriorBoundaryPoints", ",", 
     RowBox[{"Delete", "[", 
      RowBox[{"holePointsList", ",", "0"}], "]"}]}], " ", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.738344788026334*^9}, {3.73834499365376*^9, 
   3.738345007381412*^9}, {3.738345041585004*^9, 3.7383450491514063`*^9}, {
   3.7383451644523897`*^9, 3.738345181717914*^9}, {3.7391147015206738`*^9, 
   3.739114701566883*^9}, 3.739114820074377*^9, {3.739116019013297*^9, 
   3.739116022468959*^9}, {3.739888997348928*^9, 3.739888997459691*^9}, {
   3.749474629526999*^9, 3.749474629605356*^9}, {3.749475888244898*^9, 
   3.749475923820779*^9}, 3.749476152858592*^9, {3.749476247478722*^9, 
   3.749476247756988*^9}, {3.750090906556975*^9, 3.7500909223059072`*^9}},
 CellLabel->
  "In[558]:=",ExpressionUUID->"863208fe-7068-4f60-a4c9-3923efa2c871"],

Cell[BoxData[
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"regionVertices", ",", "\[IndentingNewLine]", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"exteriorVertices", ",", 
        RowBox[{"exteriorVertices", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Delete", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}], ",", "0"}], "]"}]}], 
    " ", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.739115894052528*^9, 3.739115895033699*^9}},
 CellLabel->
  "In[566]:=",ExpressionUUID->"da4245de-11ad-4788-bb8a-a88592934a29"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"omega0Seq", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"holePointsList", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", ".1"}], ",", 
         RowBox[{"-", ".1"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}], ";"}]], "Input",
 CellChangeTimes->{{3.739115974221128*^9, 3.739116008692827*^9}, {
  3.7494762141902122`*^9, 3.749476217560429*^9}, {3.7494804677960033`*^9, 
  3.7494804698296003`*^9}, {3.749483665088717*^9, 3.749483668733768*^9}, {
  3.750090875765485*^9, 3.7500908877540894`*^9}, {3.750090947250733*^9, 
  3.7500909909842377`*^9}},
 CellLabel->
  "In[567]:=",ExpressionUUID->"efa7712a-4297-459b-8f44-ceb1532c5500"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pointsInHoles", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0.", ",", "0."}], "}"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7383447910264378`*^9, 3.7383447914517193`*^9}, {
   3.738344938932295*^9, 3.738344948618271*^9}, 3.738344984591922*^9, {
   3.7383450654821177`*^9, 3.738345068024321*^9}, {3.73911595565195*^9, 
   3.739115956682572*^9}, {3.739116038239038*^9, 3.739116073806284*^9}, {
   3.749476219325287*^9, 3.749476220903041*^9}, {3.750090883917017*^9, 
   3.7500908859079533`*^9}, {3.750090939492277*^9, 3.7500909410401173`*^9}},
 CellLabel->
  "In[568]:=",ExpressionUUID->"c557dff3-5185-4089-884f-21d7efba1e8e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.738284112367519*^9, 3.738284173092161*^9}},
 CellLabel->
  "In[569]:=",ExpressionUUID->"b0a9db28-a31d-46ba-8416-1c45ad093c00"],

Cell[BoxData[
 GraphicsBox[{
   GraphicsComplexBox[{{-1., -1.}, {1., -1.}, {1., 1.}, {-1., 
    1.}, {-0.5, -0.5}, {0.5, -0.5}, {0.5, 0.5}, {-0.5, 0.5}}, 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     TagBox[FilledCurveBox[{{Line[{1, 2, 3, 4}]}, {Line[{5, 6, 7, 8}]}}],
      Annotation[#, "Geometry"]& ]}], 
   {RGBColor[1, 0, 0], PointBox[{0., 0.}]}, 
   {RGBColor[0, 1, 0], PointBox[{-0.6, -0.6}]}}]], "Output",
 CellChangeTimes->{{3.750090933088497*^9, 3.75009099284233*^9}, 
   3.751386657183387*^9},
 CellLabel->
  "Out[569]=",ExpressionUUID->"e6516cc6-dd56-4bd8-b042-bfd8d5fbb35d"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Region 3", "Subsubsection",
 CellChangeTimes->{{3.750091000912918*^9, 3.750091001312873*^9}, {
  3.7669345243372917`*^9, 
  3.766934527464822*^9}},ExpressionUUID->"ff33ea34-70ae-402a-be61-\
ed7adc31fe04"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nHoles", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorBoundaryPoints", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", " ", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", " ", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", " ", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nExteriorBoundaryPoints", "=", 
   RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"holePointsList", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", "4"}], ",", " ", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "4"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "4"}], ",", " ", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "4"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "4"}], ",", " ", 
        RowBox[{"1", "/", "4"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", "4"}], ",", " ", 
        RowBox[{"1", "/", "4"}]}], "}"}]}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"nHoles", "+", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorVertices", " ", "=", " ", 
   RowBox[{"Range", "[", "nExteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"5", ",", "6", ",", "7", ",", "8"}], "}"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"regionVertices", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"exteriorBoundaryPoints", ",", 
     RowBox[{"Delete", "[", 
      RowBox[{"holePointsList", ",", "0"}], "]"}]}], " ", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.738344788026334*^9}, {3.73834499365376*^9, 
   3.738345007381412*^9}, {3.738345041585004*^9, 3.7383450491514063`*^9}, {
   3.7383451644523897`*^9, 3.738345181717914*^9}, {3.7391147015206738`*^9, 
   3.739114701566883*^9}, 3.739114820074377*^9, {3.739116019013297*^9, 
   3.739116022468959*^9}, {3.739888997348928*^9, 3.739888997459691*^9}, {
   3.749474629526999*^9, 3.749474629605356*^9}, {3.749475888244898*^9, 
   3.749475923820779*^9}, 3.749476152858592*^9, {3.749476247478722*^9, 
   3.749476247756988*^9}, {3.750090906556975*^9, 3.7500909223059072`*^9}, {
   3.750096104294702*^9, 3.7500961052705936`*^9}},
 CellLabel->
  "In[160]:=",ExpressionUUID->"a02657cb-3d8a-4b29-8429-124b47a58839"],

Cell[BoxData[
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"regionVertices", ",", "\[IndentingNewLine]", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"exteriorVertices", ",", 
        RowBox[{"exteriorVertices", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Delete", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}], ",", "0"}], "]"}]}], 
    " ", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.739115894052528*^9, 3.739115895033699*^9}},
 CellLabel->
  "In[168]:=",ExpressionUUID->"7b68bab2-3e04-459b-8e16-32a10f126d2f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"omega0Seq", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"holePointsList", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", ".1"}], ",", 
         RowBox[{"-", ".1"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}], ";"}]], "Input",
 CellChangeTimes->{{3.739115974221128*^9, 3.739116008692827*^9}, {
  3.7494762141902122`*^9, 3.749476217560429*^9}, {3.7494804677960033`*^9, 
  3.7494804698296003`*^9}, {3.749483665088717*^9, 3.749483668733768*^9}, {
  3.750090875765485*^9, 3.7500908877540894`*^9}, {3.750090947250733*^9, 
  3.7500909909842377`*^9}},
 CellLabel->
  "In[169]:=",ExpressionUUID->"2540fc18-44fd-4077-b91e-30e8430a37a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pointsInHoles", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0.", ",", "0."}], "}"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7383447910264378`*^9, 3.7383447914517193`*^9}, {
   3.738344938932295*^9, 3.738344948618271*^9}, 3.738344984591922*^9, {
   3.7383450654821177`*^9, 3.738345068024321*^9}, {3.73911595565195*^9, 
   3.739115956682572*^9}, {3.739116038239038*^9, 3.739116073806284*^9}, {
   3.749476219325287*^9, 3.749476220903041*^9}, {3.750090883917017*^9, 
   3.7500908859079533`*^9}, {3.750090939492277*^9, 3.7500909410401173`*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"565e35bb-aa31-4f26-aefd-889b15e47fe0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.738284112367519*^9, 3.738284173092161*^9}},
 CellLabel->
  "In[171]:=",ExpressionUUID->"6c04867f-dab1-4d83-a6f2-eab36948ca0e"],

Cell[BoxData[
 GraphicsBox[{
   GraphicsComplexBox[{{-1., -1.}, {1., -1.}, {1., 1.}, {-1., 
    1.}, {-0.25, -0.25}, {0.25, -0.25}, {0.25, 0.25}, {-0.25, 0.25}}, 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     TagBox[FilledCurveBox[{{Line[{1, 2, 3, 4}]}, {Line[{5, 6, 7, 8}]}}],
      Annotation[#, "Geometry"]& ]}], 
   {RGBColor[1, 0, 0], PointBox[{0., 0.}]}, 
   {RGBColor[0, 1, 0], PointBox[{-0.35, -0.35}]}}]], "Output",
 CellChangeTimes->{{3.750090933088497*^9, 3.75009099284233*^9}, 
   3.750096111015031*^9, 3.768749116271648*^9},
 CellLabel->
  "Out[171]=",ExpressionUUID->"92859dd8-1bd5-49ee-990f-004f44ec5ee5"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Region 4", "Subsubsection",
 CellChangeTimes->{{3.750096185324935*^9, 3.750096186500126*^9}, {
  3.766934535672699*^9, 
  3.76693453724853*^9}},ExpressionUUID->"670cf7a0-243c-4bb3-915f-\
ef399aec3344"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nHoles", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorBoundaryPoints", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", " ", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", " ", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", " ", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nExteriorBoundaryPoints", "=", 
   RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"holePointsList", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", "4"}], ",", " ", 
        RowBox[{"2", "/", "3"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}], ",", " ", 
        RowBox[{"2", "/", "3"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], "/", "3"}], ",", " ", 
        RowBox[{"1", "/", "4"}]}], "}"}]}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"nHoles", "+", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorVertices", " ", "=", " ", 
   RowBox[{"Range", "[", "nExteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"5", ",", "6", ",", "7", ",", "8"}], "}"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"regionVertices", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"exteriorBoundaryPoints", ",", 
     RowBox[{"Delete", "[", 
      RowBox[{"holePointsList", ",", "0"}], "]"}]}], " ", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.738344788026334*^9}, {3.73834499365376*^9, 
   3.738345007381412*^9}, {3.738345041585004*^9, 3.7383450491514063`*^9}, {
   3.7383451644523897`*^9, 3.738345181717914*^9}, {3.7391147015206738`*^9, 
   3.739114701566883*^9}, 3.739114820074377*^9, {3.739116019013297*^9, 
   3.739116022468959*^9}, {3.739888997348928*^9, 3.739888997459691*^9}, {
   3.749474629526999*^9, 3.749474629605356*^9}, {3.749475888244898*^9, 
   3.749475923820779*^9}, 3.749476152858592*^9, {3.749476247478722*^9, 
   3.749476247756988*^9}, {3.750090906556975*^9, 3.7500909223059072`*^9}, {
   3.750096104294702*^9, 3.7500961052705936`*^9}, 3.750096144679007*^9},
 CellLabel->
  "In[178]:=",ExpressionUUID->"12ab6c87-83a6-49d8-a8f1-185422e1c44a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"regionVertices", ",", "\[IndentingNewLine]", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"exteriorVertices", ",", 
        RowBox[{"exteriorVertices", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Delete", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}], ",", "0"}], "]"}]}], 
    " ", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.739115894052528*^9, 3.739115895033699*^9}},
 CellLabel->
  "In[186]:=",ExpressionUUID->"e4b33262-e0a5-450a-b310-f288223bb72d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"omega0Seq", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"holePointsList", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", ".1"}], ",", 
         RowBox[{"-", ".1"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}], ";"}]], "Input",
 CellChangeTimes->{{3.739115974221128*^9, 3.739116008692827*^9}, {
  3.7494762141902122`*^9, 3.749476217560429*^9}, {3.7494804677960033`*^9, 
  3.7494804698296003`*^9}, {3.749483665088717*^9, 3.749483668733768*^9}, {
  3.750090875765485*^9, 3.7500908877540894`*^9}, {3.750090947250733*^9, 
  3.7500909909842377`*^9}},
 CellLabel->
  "In[187]:=",ExpressionUUID->"3afefab7-32e0-4e02-a939-f58345ca1b80"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pointsInHoles", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", ".35"}], ",", ".4"}], "}"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7383447910264378`*^9, 3.7383447914517193`*^9}, {
   3.738344938932295*^9, 3.738344948618271*^9}, 3.738344984591922*^9, {
   3.7383450654821177`*^9, 3.738345068024321*^9}, {3.73911595565195*^9, 
   3.739115956682572*^9}, {3.739116038239038*^9, 3.739116073806284*^9}, {
   3.749476219325287*^9, 3.749476220903041*^9}, {3.750090883917017*^9, 
   3.7500908859079533`*^9}, {3.750090939492277*^9, 3.7500909410401173`*^9}, 
   3.750096158638649*^9},
 CellLabel->
  "In[188]:=",ExpressionUUID->"b4df3cce-384f-4691-ae09-becd0652b386"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.738284112367519*^9, 3.738284173092161*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"86a78462-f8e0-4d07-923e-521228f167b4"],

Cell[BoxData[
 GraphicsBox[{
   GraphicsComplexBox[{{-1., -1.}, {1., -1.}, {1., 1.}, {-1., 1.}, {0., 
    0.}, {-0.25, 0.6666666666666666}, {-0.5, 
    0.6666666666666666}, {-0.6666666666666666, 0.25}}, 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     TagBox[FilledCurveBox[{{Line[{1, 2, 3, 4}]}, {Line[{5, 6, 7, 8}]}}],
      Annotation[#, "Geometry"]& ]}], 
   {RGBColor[1, 0, 0], PointBox[{-0.35, 0.4}]}, 
   {RGBColor[0, 1, 0], PointBox[{-0.1, -0.1}]}}]], "Output",
 CellChangeTimes->{{3.750090933088497*^9, 3.75009099284233*^9}, 
   3.750096111015031*^9, {3.7500961489446087`*^9, 3.750096160123139*^9}, 
   3.7687494246837873`*^9},
 CellLabel->
  "Out[189]=",ExpressionUUID->"0dc90397-d625-45aa-abe7-feb4e02e12eb"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Region 5", "Subsubsection",
 CellChangeTimes->{{3.7283055485101833`*^9, 3.7283055769077168`*^9}, {
  3.728394673215453*^9, 3.72839467326083*^9}, {3.7669345439363527`*^9, 
  3.766934546176072*^9}},ExpressionUUID->"325d8d1e-840f-4d0c-b109-\
16b74d640c18"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"innerRadius", " ", "=", " ", 
   RowBox[{"1", "/", "3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nMesh", " ", "=", " ", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"refinementLevel", " ", "=", " ", "3"}], ";"}]}], "Input",
 CellChangeTimes->{{3.728305610125451*^9, 3.728305627289599*^9}, {
   3.7283056685398903`*^9, 3.728305703878974*^9}, {3.728305748552929*^9, 
   3.728305824218855*^9}, {3.7283138366839943`*^9, 3.7283138471338453`*^9}, 
   3.72832311596756*^9, {3.730810469839458*^9, 3.730810474406348*^9}, {
   3.730816631440692*^9, 3.7308166314915447`*^9}, {3.7308256118556843`*^9, 
   3.730825615301309*^9}, {3.73772081958339*^9, 3.737720822229734*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"6b0bbb70-2227-4eea-8c94-5d2d90c1871a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pointInHoleSeq", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.", ",", "0."}], "}"}], ",", 
     RowBox[{"{", "nMesh", "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"omega0Seq", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1.", "+", "innerRadius"}], ")"}], "/", "2"}]}], "}"}], ",", 
     RowBox[{"{", "nMesh", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.737689337749942*^9, 3.7376893582620687`*^9}, 
   3.737689431528153*^9, {3.7377201883185177`*^9, 3.737720192642509*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"7de3a8b3-730f-4e09-8a56-0b354bf440d7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TSeq", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{",", 
     RowBox[{"{", "nMesh", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"regionSeq", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{",", 
     RowBox[{"{", "nMesh", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"regionSkeletonSeq", "=", 
   RowBox[{"Table", "[", 
    RowBox[{",", 
     RowBox[{"{", "nMesh", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"regionVerticesSeq", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{",", 
     RowBox[{"{", "nMesh", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"extVSeq", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{",", 
     RowBox[{"{", "nMesh", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intVSeq", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{",", 
     RowBox[{"{", "nMesh", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"iter", "=", "1"}], ",", " ", 
    RowBox[{"iter", "\[LessEqual]", " ", "nMesh"}], ",", 
    RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"regionVerticesSeq", "[", 
         RowBox[{"[", "iter", "]"}], "]"}], ",", " ", 
        RowBox[{"extVSeq", "[", 
         RowBox[{"[", "iter", "]"}], "]"}], ",", " ", 
        RowBox[{"intVSeq", "[", 
         RowBox[{"[", "iter", "]"}], "]"}]}], "}"}], " ", "=", " ", 
      RowBox[{"PolygonalAnnulus", "[", 
       RowBox[{
        RowBox[{"iter", " ", "+", " ", "2"}], ",", " ", 
        RowBox[{"1", "/", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"regionSeq", "[", 
       RowBox[{"[", "iter", "]"}], "]"}], "=", 
      RowBox[{"BoundaryMeshRegion", "[", 
       RowBox[{
        RowBox[{"regionVerticesSeq", "[", 
         RowBox[{"[", "iter", "]"}], "]"}], ",", " ", 
        RowBox[{"Line", "[", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"extVSeq", "[", 
            RowBox[{"[", "iter", "]"}], "]"}], ",", 
           RowBox[{"extVSeq", "[", 
            RowBox[{"[", 
             RowBox[{"iter", ",", "1"}], "]"}], "]"}]}], " ", "]"}], "]"}], 
        ",", " ", 
        RowBox[{"Line", "[", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"intVSeq", "[", 
            RowBox[{"[", "iter", "]"}], "]"}], ",", 
           RowBox[{"intVSeq", "[", 
            RowBox[{"[", 
             RowBox[{"iter", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}]}], " ", 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TSeq", "[", 
       RowBox[{"[", "iter", "]"}], "]"}], " ", "=", " ", 
      RowBox[{"Evaluate", "[", 
       RowBox[{"AcuteTriangulateAnnulus", "[", 
        RowBox[{
         RowBox[{"regionVerticesSeq", "[", 
          RowBox[{"[", "iter", "]"}], "]"}], ",", " ", 
         RowBox[{"extVSeq", "[", 
          RowBox[{"[", "iter", "]"}], "]"}], ",", " ", 
         RowBox[{"intVSeq", "[", 
          RowBox[{"[", "iter", "]"}], "]"}]}], " ", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TSeq", "[", 
       RowBox[{"[", "iter", "]"}], "]"}], " ", "=", " ", 
      RowBox[{"Nest", "[", 
       RowBox[{"RefineTriangulation", ",", " ", 
        RowBox[{"TSeq", "[", 
         RowBox[{"[", "iter", "]"}], "]"}], ",", " ", "refinementLevel"}], 
       "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.728391465019184*^9, 3.728391539013257*^9}, {
   3.728391584637945*^9, 3.7283916261853724`*^9}, {3.728391673004313*^9, 
   3.728391706926043*^9}, {3.72839175847118*^9, 3.7283917760543118`*^9}, {
   3.728391821526457*^9, 3.728391825810689*^9}, {3.728392530346702*^9, 
   3.72839255023844*^9}, 3.7283938116052237`*^9, 3.7284003528036737`*^9, {
   3.730815943329562*^9, 3.7308159587259274`*^9}, {3.730816344902269*^9, 
   3.730816381166005*^9}, {3.7308164399661713`*^9, 3.730816444651857*^9}, {
   3.730824896962488*^9, 3.730824906808002*^9}, {3.730824943384244*^9, 
   3.730825020644236*^9}, {3.730825110322789*^9, 3.730825204582574*^9}, {
   3.730825505971291*^9, 3.730825545552589*^9}, {3.730825576319235*^9, 
   3.7308255852563334`*^9}, {3.730825621597538*^9, 3.730825623813611*^9}, {
   3.737689528134452*^9, 3.737689567198688*^9}, {3.7376898476184187`*^9, 
   3.737689848944326*^9}, {3.737690566132563*^9, 3.7376905980251637`*^9}, {
   3.7376906798387938`*^9, 3.7376906825077353`*^9}, {3.737690774232394*^9, 
   3.737690794343742*^9}, {3.737690830481962*^9, 3.737690853097801*^9}, {
   3.73769092054849*^9, 3.737690925189661*^9}, {3.7377204586058407`*^9, 
   3.737720485221162*^9}},
 CellLabel->
  "In[160]:=",ExpressionUUID->"39de57c6-935c-4430-86bf-619c93ecc3b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"iter", "=", "1"}], ",", " ", 
    RowBox[{"iter", "\[LessEqual]", " ", "nMesh"}], ",", 
    RowBox[{"iter", "++"}], ",", 
    RowBox[{
     RowBox[{"regionSkeletonSeq", "[", 
      RowBox[{"[", "iter", "]"}], "]"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MeshCoordinates", "[", 
        RowBox[{"regionSeq", "[", 
         RowBox[{"[", "iter", "]"}], "]"}], "]"}], ",", " ", 
       RowBox[{"MeshCells", "[", 
        RowBox[{
         RowBox[{"regionSeq", "[", 
          RowBox[{"[", "iter", "]"}], "]"}], ",", "1"}], "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.73772059791197*^9, 3.737720606789872*^9}},
 CellLabel->
  "In[167]:=",ExpressionUUID->"7ae37542-d36d-40af-b1d5-4a9cc6a59d1f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"regionSeq", "[", 
  RowBox[{"[", "4", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7500963414749823`*^9, 3.750096349251402*^9}},
 CellLabel->
  "In[168]:=",ExpressionUUID->"50fec267-23f8-4211-bf17-25af3794d9fb"],

Cell[BoxData[
 GraphicsBox[
  TagBox[
   DynamicModuleBox[{Typeset`mesh = HoldComplete[
     BoundaryMeshRegion[{{0., 1.}, {-0.8660254037844386, 
      0.5}, {-0.8660254037844386, -0.5}, {0., -1.}, {
      0.8660254037844386, -0.5}, {0.8660254037844386, 0.5}, {0., 
      0.3333333333333333}, {-0.28867513459481287`, 
      0.16666666666666666`}, {-0.28867513459481287`, -0.16666666666666666`}, {
      0., -0.3333333333333333}, {
      0.28867513459481287`, -0.16666666666666666`}, {0.28867513459481287`, 
      0.16666666666666666`}}, {
       Line[{{1, 2}, {2, 3}, {3, 4}, {4, 5}, {5, 6}, {6, 1}}]}, {
       Line[{{7, 8}, {8, 9}, {9, 10}, {10, 11}, {11, 12}, {12, 7}}]}, 
      Method -> {
       "EliminateUnusedCoordinates" -> True, "DeleteDuplicateCoordinates" -> 
        Automatic, "DeleteDuplicateCells" -> Automatic, "VertexAlias" -> 
        Identity, "CheckOrientation" -> Automatic, "CoplanarityTolerance" -> 
        Automatic, "CheckIntersections" -> Automatic, 
        "BoundaryNesting" -> {{0, 0}, {1, 1}}, "SeparateBoundaries" -> False, 
        "TJunction" -> Automatic, "PropagateMarkers" -> True, "ZeroTest" -> 
        Automatic, "Hash" -> 927710550414217376}]]}, 
    TagBox[
     GraphicsComplexBox[{{0., 1.}, {-0.8660254037844386, 
      0.5}, {-0.8660254037844386, -0.5}, {0., -1.}, {
      0.8660254037844386, -0.5}, {0.8660254037844386, 0.5}, {0., 
      0.3333333333333333}, {-0.28867513459481287`, 
      0.16666666666666666`}, {-0.28867513459481287`, -0.16666666666666666`}, {
      0., -0.3333333333333333}, {
      0.28867513459481287`, -0.16666666666666666`}, {0.28867513459481287`, 
      0.16666666666666666`}}, 
      {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
       TagBox[
        FilledCurveBox[{{Line[{1, 2, 3, 4, 5, 6}]}, {
          Line[{7, 8, 9, 10, 11, 12}]}}],
        Annotation[#, "Geometry"]& ]}],
     MouseAppearanceTag["LinkHand"]],
    AllowKernelInitialization->False],
   "MeshGraphics",
   AutoDelete->True,
   Editable->False,
   Selectable->False],
  DefaultBaseStyle->{
   "MeshGraphics", FrontEnd`GraphicsHighlightColor -> 
    Hue[0.1, 1, 0.7]}]], "Output",
 CellChangeTimes->{3.787942139011168*^9},
 CellLabel->
  "Out[168]=",ExpressionUUID->"38fe61c5-9176-433f-b66d-2f99d4853c35"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Region 6", "Subsubsection",
 CellChangeTimes->{{3.750091244601646*^9, 3.7500912604319267`*^9}, {
  3.7669345685999002`*^9, 
  3.7669345709351788`*^9}},ExpressionUUID->"5b36b870-91a6-45e3-8a2d-\
4ce3fb2de28b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nHoles", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorBoundaryPoints", "=", 
   RowBox[{"N", "/@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "3"}], ",", 
        RowBox[{"1", "/", "4"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"8", "/", "3"}], ",", 
        RowBox[{"7", "/", "3"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "3"}], "}"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nExteriorBoundaryPoints", "=", 
   RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"holePointsList", "=", 
   RowBox[{"{", 
    RowBox[{"StarPoints", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1.5", ",", "1.5"}], "}"}], ",", ".2", ",", ".6", ",", "5"}], 
     "]"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"nHoles", "+", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorVertices", " ", "=", " ", 
   RowBox[{"Range", "[", "nExteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", "=", 
   RowBox[{"{", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}], "+", "1"}], 
      ",", " ", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"holePointsList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], " ", "+", " ", 
       RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}]}], " ", "]"}],
     "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"regionVertices", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"exteriorBoundaryPoints", ",", 
     RowBox[{"Delete", "[", 
      RowBox[{"holePointsList", ",", "0"}], "]"}]}], " ", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"regionVertices", ",", "\[IndentingNewLine]", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"exteriorVertices", ",", 
        RowBox[{"exteriorVertices", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Delete", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}], ",", "0"}], "]"}]}], 
    " ", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"omega0Seq", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", ".1"}], ",", 
        RowBox[{"-", ".1"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"pointsInHoles", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Mean", "[", 
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.738344788026334*^9}, {3.73834499365376*^9, 
   3.738345007381412*^9}, {3.738345041585004*^9, 3.7383450491514063`*^9}, {
   3.7383451644523897`*^9, 3.738345181717914*^9}, {3.7391147015206738`*^9, 
   3.739114701566883*^9}, 3.739114820074377*^9, {3.739116019013297*^9, 
   3.739116022468959*^9}, {3.739888997348928*^9, 3.739888997459691*^9}, {
   3.749474629526999*^9, 3.749474629605356*^9}, {3.749475888244898*^9, 
   3.749475923820779*^9}, 3.749476152858592*^9, {3.749476247478722*^9, 
   3.749476247756988*^9}, {3.750091291619179*^9, 3.750091339142214*^9}, {
   3.75138214163763*^9, 3.751382156190321*^9}, 3.751382186327859*^9, {
   3.751382363700944*^9, 3.751382364899321*^9}, {3.751382479417938*^9, 
   3.751382480192438*^9}, {3.751382513665051*^9, 3.751382543245013*^9}, {
   3.751382798423822*^9, 3.751382799070187*^9}, 3.751382865276003*^9, {
   3.751382906641285*^9, 3.751382917727352*^9}, {3.7513829479598083`*^9, 
   3.751383044520556*^9}, {3.766934646743341*^9, 3.7669346621110983`*^9}, 
   3.76693508481115*^9},ExpressionUUID->"3c73f68d-9064-45d5-82de-\
da6f093fac08"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.738284112367519*^9, 3.738284173092161*^9}, {
  3.750092940368393*^9, 3.750092956172657*^9}},
 CellLabel->
  "In[1099]:=",ExpressionUUID->"db1550e1-a4f0-4c93-b678-00fafd58bdf5"],

Cell[BoxData[
 GraphicsBox[{
   GraphicsComplexBox[{{0.3333333333333333, 0.25}, {3., 0.}, {
    2.6666666666666665`, 2.3333333333333335`}, {0., 3.}, {1.5, 0.9}, {
    1.6175570504584946`, 1.3381966011250106`}, {2.070633909777092, 
    1.3145898033750316`}, {1.6902113032590307`, 1.5618033988749895`}, {
    1.8526711513754839`, 1.9854101966249684`}, {1.5, 1.7}, {
    1.1473288486245161`, 1.9854101966249684`}, {1.3097886967409693`, 
    1.5618033988749895`}, {0.9293660902229078, 1.3145898033750316`}, {
    1.3824429495415054`, 1.3381966011250106`}}, 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     TagBox[
      FilledCurveBox[{{Line[{1, 2, 3, 4}]}, {
        Line[{5, 6, 7, 8, 9, 10, 11, 12, 13, 14}]}}],
      Annotation[#, "Geometry"]& ]}], 
   {RGBColor[1, 0, 0], PointBox[{1.5000000000000002`, 1.5000000000000002`}]}, 
   {RGBColor[0, 1, 0], PointBox[{1.4, 0.8}]}}]], "Output",
 CellChangeTimes->{
  3.751381901934205*^9, {3.751382345820074*^9, 3.7513823677534657`*^9}, {
   3.7513825509898157`*^9, 3.751382582588876*^9}, 3.751382811353744*^9, {
   3.751382877552411*^9, 3.751382923442932*^9}, {3.751383012669023*^9, 
   3.7513830470810423`*^9}, 3.751386814275961*^9, 3.7669342503659163`*^9, 
   3.766934671016816*^9},
 CellLabel->
  "Out[1099]=",ExpressionUUID->"49427b5e-654a-4489-981b-bf0d8365c6fb"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Region 7", "Subsubsection",
 CellChangeTimes->{{3.750091244601646*^9, 3.7500912604319267`*^9}, {
  3.7669345685999002`*^9, 3.7669345709351788`*^9}, {3.766935094616336*^9, 
  3.766935094886773*^9}},ExpressionUUID->"f982916d-b932-44dc-baf9-\
50905808a369"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nHoles", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorBoundaryPoints", "=", 
   RowBox[{"StarPoints", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", "1", ",", "2", ",", "5"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nExteriorBoundaryPoints", "=", 
   RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"holePointsList", "=", 
   RowBox[{"{", 
    RowBox[{"StarPoints", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", ".2", ",", ".6", ",", "5"}], 
     "]"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"nHoles", "+", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorVertices", " ", "=", " ", 
   RowBox[{"Range", "[", "nExteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", "=", 
   RowBox[{"{", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}], "+", "1"}], 
      ",", " ", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"holePointsList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], " ", "+", " ", 
       RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}]}], " ", "]"}],
     "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"regionVertices", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"exteriorBoundaryPoints", ",", 
     RowBox[{"Delete", "[", 
      RowBox[{"holePointsList", ",", "0"}], "]"}]}], " ", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"regionVertices", ",", "\[IndentingNewLine]", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"exteriorVertices", ",", 
        RowBox[{"exteriorVertices", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Delete", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}], ",", "0"}], "]"}]}], 
    " ", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"omega0Seq", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", ".1"}], ",", 
        RowBox[{"-", ".1"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"pointsInHoles", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Mean", "[", 
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.738344788026334*^9}, {3.73834499365376*^9, 
   3.738345007381412*^9}, {3.738345041585004*^9, 3.7383450491514063`*^9}, {
   3.7383451644523897`*^9, 3.738345181717914*^9}, {3.7391147015206738`*^9, 
   3.739114701566883*^9}, 3.739114820074377*^9, {3.739116019013297*^9, 
   3.739116022468959*^9}, {3.739888997348928*^9, 3.739888997459691*^9}, {
   3.749474629526999*^9, 3.749474629605356*^9}, {3.749475888244898*^9, 
   3.749475923820779*^9}, 3.749476152858592*^9, {3.749476247478722*^9, 
   3.749476247756988*^9}, {3.750091291619179*^9, 3.750091339142214*^9}, {
   3.75138214163763*^9, 3.751382156190321*^9}, 3.751382186327859*^9, {
   3.751382363700944*^9, 3.751382364899321*^9}, {3.751382479417938*^9, 
   3.751382480192438*^9}, {3.751382513665051*^9, 3.751382543245013*^9}, {
   3.751382798423822*^9, 3.751382799070187*^9}, 3.751382865276003*^9, {
   3.751382906641285*^9, 3.751382917727352*^9}, {3.7513829479598083`*^9, 
   3.751383044520556*^9}, {3.766934646743341*^9, 3.7669346621110983`*^9}, {
   3.76693508481115*^9, 3.766935123454219*^9}},
 CellLabel->
  "In[430]:=",ExpressionUUID->"8f537ed8-42eb-4b0c-bb95-791f7887c24e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.738284112367519*^9, 3.738284173092161*^9}, {
  3.750092940368393*^9, 3.750092956172657*^9}},
 CellLabel->
  "In[441]:=",ExpressionUUID->"dd905fec-3aa0-49d8-a220-50ca5752d0d4"],

Cell[BoxData[
 GraphicsBox[{GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQjQYOxEWVsiiff2S/4sv02eWPX+5nCHUR5sv/Z+//
Ut/8/bHH+/+HgPjv7APA/Mv2EPWfoOp/2qMa9wEmvx8mD9W/H6Yfaj6U/3g/
1P79cPvBYIGNMRg83m+kpcRuIbHPPjjWzfPn1iP7jdL6uRc5PbKfuDGntHX3
8f0z72by34g4YS/h9OzjxiXr7ZfOj2TVmnTN/k/3y7dfBe7bFx0Lfs1pm2Mz
ayYInLRfDJHfD5OH6t8vA9VvDDF//wSo+VD798PsBwCklJT9
    "], 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     TagBox[
      FilledCurveBox[{{Line[{1, 2, 3, 4, 5, 6, 7, 8, 9, 10}]}, {
        Line[{11, 12, 13, 14, 15, 16, 17, 18, 19, 20}]}}],
      Annotation[#, "Geometry"]& ]}], 
   {RGBColor[1, 0, 0], 
    PointBox[{8.326672684688674*^-18, 1.3877787807814457`*^-17}]}, 
   {RGBColor[0, 1, 0], PointBox[{-0.0999999999999999, -0.7}]}}]], "Output",
 CellChangeTimes->{3.766935127658557*^9, 3.766935357706502*^9, 
  3.7669356649491243`*^9, 3.7669385604707003`*^9},
 CellLabel->
  "Out[441]=",ExpressionUUID->"6704bf49-5e6b-4af4-bc04-43a68c20b466"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Region 8", "Subsubsection",
 CellChangeTimes->{{3.750091244601646*^9, 3.7500912604319267`*^9}, {
  3.7669345685999002`*^9, 3.7669345709351788`*^9}, {3.766935094616336*^9, 
  3.766935094886773*^9}, {3.766936018966009*^9, 
  3.766936019452475*^9}},ExpressionUUID->"37da7f79-1e2d-4c30-afb3-\
0d33661d9a20"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nHoles", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorBoundaryPoints", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1.5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nExteriorBoundaryPoints", "=", 
   RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"holePointsList", "=", 
   RowBox[{"{", 
    RowBox[{"CirclePoints", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "1.5"}], "}"}], ",", ".5", ",", "3"}], "]"}], 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"nHoles", "+", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorVertices", " ", "=", " ", 
   RowBox[{"Range", "[", "nExteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", "=", 
   RowBox[{"{", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}], "+", "1"}], 
      ",", " ", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"holePointsList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], " ", "+", " ", 
       RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}]}], " ", "]"}],
     "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"regionVertices", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"exteriorBoundaryPoints", ",", 
     RowBox[{"Delete", "[", 
      RowBox[{"holePointsList", ",", "0"}], "]"}]}], " ", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"regionVertices", ",", "\[IndentingNewLine]", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"exteriorVertices", ",", 
        RowBox[{"exteriorVertices", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Delete", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}], ",", "0"}], "]"}]}], 
    " ", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"omega0Seq", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", ".1"}], ",", 
        RowBox[{"-", ".1"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"pointsInHoles", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Mean", "[", 
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.738344788026334*^9}, {3.73834499365376*^9, 
   3.738345007381412*^9}, {3.738345041585004*^9, 3.7383450491514063`*^9}, {
   3.7383451644523897`*^9, 3.738345181717914*^9}, {3.7391147015206738`*^9, 
   3.739114701566883*^9}, 3.739114820074377*^9, {3.739116019013297*^9, 
   3.739116022468959*^9}, {3.739888997348928*^9, 3.739888997459691*^9}, {
   3.749474629526999*^9, 3.749474629605356*^9}, {3.749475888244898*^9, 
   3.749475923820779*^9}, 3.749476152858592*^9, {3.749476247478722*^9, 
   3.749476247756988*^9}, {3.750091291619179*^9, 3.750091339142214*^9}, {
   3.75138214163763*^9, 3.751382156190321*^9}, 3.751382186327859*^9, {
   3.751382363700944*^9, 3.751382364899321*^9}, {3.751382479417938*^9, 
   3.751382480192438*^9}, {3.751382513665051*^9, 3.751382543245013*^9}, {
   3.751382798423822*^9, 3.751382799070187*^9}, 3.751382865276003*^9, {
   3.751382906641285*^9, 3.751382917727352*^9}, {3.7513829479598083`*^9, 
   3.751383044520556*^9}, {3.766934646743341*^9, 3.7669346621110983`*^9}, {
   3.76693508481115*^9, 3.766935123454219*^9}, {3.766936153112279*^9, 
   3.766936253214611*^9}},
 CellLabel->
  "In[418]:=",ExpressionUUID->"268c19a1-5f25-463b-9e48-0d1559ee667a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.738284112367519*^9, 3.738284173092161*^9}, {
  3.750092940368393*^9, 3.750092956172657*^9}},
 CellLabel->
  "In[429]:=",ExpressionUUID->"b6f5cab2-2a6d-4814-966e-873671e96997"],

Cell[BoxData[
 GraphicsBox[{
   GraphicsComplexBox[{{0., 0.}, {2., 0.}, {3., 1.}, {3., 2.}, {2., 3.}, {0., 
    3.}, {0., 2.}, {1., 1.5}, {0., 1.}, {2.433012701892219, 1.25}, {2., 2.}, {
    1.5669872981077806`, 1.25}}, 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     TagBox[
      FilledCurveBox[{{Line[{1, 2, 3, 4, 5, 6, 7, 8, 9}]}, {
        Line[{10, 11, 12}]}}],
      Annotation[#, "Geometry"]& ]}], 
   {RGBColor[1, 0, 0], PointBox[{1.9999999999999998`, 1.5}]}, 
   {RGBColor[0, 1, 0], PointBox[{2.333012701892219, 1.15}]}}]], "Output",
 CellChangeTimes->{3.766938553227873*^9},
 CellLabel->
  "Out[429]=",ExpressionUUID->"04295853-bd2d-4def-b98e-63bd679aea65"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Region 9", "Subsubsection",
 CellChangeTimes->{{3.750091244601646*^9, 3.7500912604319267`*^9}, {
  3.7669345685999002`*^9, 3.7669345709351788`*^9}, {3.766935094616336*^9, 
  3.766935094886773*^9}, {3.766936018966009*^9, 3.766936019452475*^9}, {
  3.7669370491669064`*^9, 
  3.766937049741078*^9}},ExpressionUUID->"6e44c868-3e80-447d-aa55-\
57e903fc5a9f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nHoles", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorBoundaryPoints", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1.5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nExteriorBoundaryPoints", "=", 
   RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"holePointsList", "=", 
   RowBox[{"{", 
    RowBox[{"StarPoints", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "1.5"}], "}"}], ",", ".3", ",", ".6", ",", "5"}], 
     "]"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"nHoles", "+", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorVertices", " ", "=", " ", 
   RowBox[{"Range", "[", "nExteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", "=", 
   RowBox[{"{", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}], "+", "1"}], 
      ",", " ", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"holePointsList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], " ", "+", " ", 
       RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}]}], " ", "]"}],
     "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"regionVertices", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"exteriorBoundaryPoints", ",", 
     RowBox[{"Delete", "[", 
      RowBox[{"holePointsList", ",", "0"}], "]"}]}], " ", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"regionVertices", ",", "\[IndentingNewLine]", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"exteriorVertices", ",", 
        RowBox[{"exteriorVertices", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Delete", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}], ",", "0"}], "]"}]}], 
    " ", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"omega0Seq", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", ".1"}], ",", 
        RowBox[{"-", ".1"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"pointsInHoles", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Mean", "[", 
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.738344788026334*^9}, {3.73834499365376*^9, 
   3.738345007381412*^9}, {3.738345041585004*^9, 3.7383450491514063`*^9}, {
   3.7383451644523897`*^9, 3.738345181717914*^9}, {3.7391147015206738`*^9, 
   3.739114701566883*^9}, 3.739114820074377*^9, {3.739116019013297*^9, 
   3.739116022468959*^9}, {3.739888997348928*^9, 3.739888997459691*^9}, {
   3.749474629526999*^9, 3.749474629605356*^9}, {3.749475888244898*^9, 
   3.749475923820779*^9}, 3.749476152858592*^9, {3.749476247478722*^9, 
   3.749476247756988*^9}, {3.750091291619179*^9, 3.750091339142214*^9}, {
   3.75138214163763*^9, 3.751382156190321*^9}, 3.751382186327859*^9, {
   3.751382363700944*^9, 3.751382364899321*^9}, {3.751382479417938*^9, 
   3.751382480192438*^9}, {3.751382513665051*^9, 3.751382543245013*^9}, {
   3.751382798423822*^9, 3.751382799070187*^9}, 3.751382865276003*^9, {
   3.751382906641285*^9, 3.751382917727352*^9}, {3.7513829479598083`*^9, 
   3.751383044520556*^9}, {3.766934646743341*^9, 3.7669346621110983`*^9}, {
   3.76693508481115*^9, 3.766935123454219*^9}, {3.766936153112279*^9, 
   3.766936253214611*^9}, {3.766937056229465*^9, 3.7669370808127832`*^9}},
 CellLabel->
  "In[180]:=",ExpressionUUID->"a6ca313b-0c35-46f1-accb-feb1a7fe7ce0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.738284112367519*^9, 3.738284173092161*^9}, {
  3.750092940368393*^9, 3.750092956172657*^9}},
 CellLabel->
  "In[191]:=",ExpressionUUID->"9cc7ca0c-ffe2-475d-974a-a240441ebdc6"],

Cell[BoxData[
 GraphicsBox[{GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGAQBmIQjQM4oHI5oPwP9qh8BjQaLs6AnQ9TBzPnhz2qNEyc
weHsGRB4Y/9rZugCpUxGh8ZzTk4PZb/Y99x83LRiAovDucygwH6Or/bH3hQ6
hngwOUieDgvfUf3T/qvxagfXS0wO/5Oqqm2P/Ecz74+9+IyVdaXRv+xh8iVq
MrXh+b/tYfqf+Vj8Wnfvmz3MfO4zIft36f61h9kPAJbmVB0=
    "], 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     TagBox[
      FilledCurveBox[{{Line[{1, 2, 3, 4, 5, 6, 7, 8, 9}]}, {
        Line[{10, 11, 12, 13, 14, 15, 16, 17, 18, 19}]}}],
      Annotation[#, "Geometry"]& ]}], 
   {RGBColor[1, 0, 0], PointBox[{2., 1.5000000000000002`}]}, 
   {RGBColor[0, 1, 0], PointBox[{1.9, 0.8}]}}]], "Output",
 CellChangeTimes->{
  3.766935127658557*^9, 3.766935357706502*^9, 3.7669356649491243`*^9, {
   3.7669362443286467`*^9, 3.766936257479273*^9}, 3.76693692576677*^9, {
   3.766937065873773*^9, 3.766937083123837*^9}},
 CellLabel->
  "Out[191]=",ExpressionUUID->"385d3bbf-26ac-4442-bb1f-7a1a32e0dd87"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Region 10", "Subsubsection",
 CellChangeTimes->{{3.750091244601646*^9, 3.7500912604319267`*^9}, {
  3.7669345685999002`*^9, 3.7669345709351788`*^9}, {3.766935094616336*^9, 
  3.766935094886773*^9}, {3.766936018966009*^9, 3.766936019452475*^9}, {
  3.7669370491669064`*^9, 3.766937049741078*^9}, {3.766937147282064*^9, 
  3.766937147815949*^9}},ExpressionUUID->"e9b1e95b-82fe-4b78-92e2-\
5595c41b650a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nHoles", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorBoundaryPoints", "=", 
   RowBox[{"StarPoints", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", "1.8", ",", "3", ",", "6"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nExteriorBoundaryPoints", "=", 
   RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"holePointsList", "=", 
   RowBox[{"{", 
    RowBox[{"StarPoints", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", ".3", ",", ".6", ",", "5"}], 
     "]"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"nHoles", "+", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorVertices", " ", "=", " ", 
   RowBox[{"Range", "[", "nExteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", "=", 
   RowBox[{"{", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}], "+", "1"}], 
      ",", " ", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"holePointsList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], " ", "+", " ", 
       RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}]}], " ", "]"}],
     "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"regionVertices", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"exteriorBoundaryPoints", ",", 
     RowBox[{"Delete", "[", 
      RowBox[{"holePointsList", ",", "0"}], "]"}]}], " ", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"regionVertices", ",", "\[IndentingNewLine]", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"exteriorVertices", ",", 
        RowBox[{"exteriorVertices", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Delete", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}], ",", "0"}], "]"}]}], 
    " ", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"omega0Seq", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", ".1"}], ",", 
        RowBox[{"-", ".1"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"pointsInHoles", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Mean", "[", 
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.738344788026334*^9}, {3.73834499365376*^9, 
   3.738345007381412*^9}, {3.738345041585004*^9, 3.7383450491514063`*^9}, {
   3.7383451644523897`*^9, 3.738345181717914*^9}, {3.7391147015206738`*^9, 
   3.739114701566883*^9}, 3.739114820074377*^9, {3.739116019013297*^9, 
   3.739116022468959*^9}, {3.739888997348928*^9, 3.739888997459691*^9}, {
   3.749474629526999*^9, 3.749474629605356*^9}, {3.749475888244898*^9, 
   3.749475923820779*^9}, 3.749476152858592*^9, {3.749476247478722*^9, 
   3.749476247756988*^9}, {3.750091291619179*^9, 3.750091339142214*^9}, {
   3.75138214163763*^9, 3.751382156190321*^9}, 3.751382186327859*^9, {
   3.751382363700944*^9, 3.751382364899321*^9}, {3.751382479417938*^9, 
   3.751382480192438*^9}, {3.751382513665051*^9, 3.751382543245013*^9}, {
   3.751382798423822*^9, 3.751382799070187*^9}, 3.751382865276003*^9, {
   3.751382906641285*^9, 3.751382917727352*^9}, {3.7513829479598083`*^9, 
   3.751383044520556*^9}, {3.766934646743341*^9, 3.7669346621110983`*^9}, {
   3.76693508481115*^9, 3.766935123454219*^9}, {3.766936153112279*^9, 
   3.766936253214611*^9}, {3.766937056229465*^9, 3.7669370808127832`*^9}, {
   3.766937156481443*^9, 3.766937177792007*^9}, {3.766937286246264*^9, 
   3.7669372865071077`*^9}},
 CellLabel->
  "In[406]:=",ExpressionUUID->"62b843b0-222d-47ae-9314-7d62de864fc1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.738284112367519*^9, 3.738284173092161*^9}, {
  3.750092940368393*^9, 3.750092956172657*^9}},
 CellLabel->
  "In[417]:=",ExpressionUUID->"254f88fd-0c92-4edd-a816-eb3579a82474"],

Cell[BoxData[
 GraphicsBox[{GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGAQA2IQjQo4Dpw/AwJv7NNWN5lzfPyxv8HSSe/OCRYHiPyP
/WfB8n/sYTrQ5O3R9Nujme8Ald8Pk4fqPwDTDzV/v4P9Po3VR9bboMnvvwLV
nwJ1H0R8gY0xGDzev3R+JKvWpGP2v7tfvv0qcH6/UVo/9yKnR/YTN+aUtu4+
DuVfsp8E5m+3h6i/Zv8HrP6+/dUrdQXHdUuh5l22XwyR3w+Th+rfPwWq3xhi
/v4JUPOh9u+H2Q8AH5Gf+g==
    "], 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     TagBox[
      FilledCurveBox[{{Line[{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12}]}, {
        Line[{13, 14, 15, 16, 17, 18, 19, 20, 21, 22}]}}],
      Annotation[#, "Geometry"]& ]}], 
   {RGBColor[1, 0, 0], 
    PointBox[{-1.3877787807814457`*^-17, 1.3877787807814457`*^-17}]}, 
   {RGBColor[0, 1, 0], PointBox[{-0.0999999999999999, -0.7}]}}]], "Output",
 CellChangeTimes->{3.766938540656493*^9},
 CellLabel->
  "Out[417]=",ExpressionUUID->"9a5268f3-d5bf-4dd1-b0ea-670994b2588a"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Region 11", "Subsubsection",
 CellChangeTimes->{{3.750091244601646*^9, 3.7500912604319267`*^9}, {
  3.7669345685999002`*^9, 3.7669345709351788`*^9}, {3.766935094616336*^9, 
  3.766935094886773*^9}, {3.766936018966009*^9, 3.766936019452475*^9}, {
  3.7669370491669064`*^9, 3.766937049741078*^9}, {3.766937147282064*^9, 
  3.766937147815949*^9}, {3.766937401038672*^9, 
  3.7669374011089993`*^9}},ExpressionUUID->"54112d84-e4a8-45ad-8029-\
103022b111da"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nHoles", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorBoundaryPoints", "=", 
   RowBox[{"CirclePoints", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", "1", ",", "3"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nExteriorBoundaryPoints", "=", 
   RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"holePointsList", "=", 
   RowBox[{"{", 
    RowBox[{"CirclePoints", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{".3", ",", "0"}], "}"}], ",", ".2", ",", "3"}], "]"}], "}"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"nHoles", "+", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorVertices", " ", "=", " ", 
   RowBox[{"Range", "[", "nExteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", "=", 
   RowBox[{"{", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}], "+", "1"}], 
      ",", " ", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"holePointsList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], " ", "+", " ", 
       RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}]}], " ", "]"}],
     "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"regionVertices", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"exteriorBoundaryPoints", ",", 
     RowBox[{"Delete", "[", 
      RowBox[{"holePointsList", ",", "0"}], "]"}]}], " ", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"regionVertices", ",", "\[IndentingNewLine]", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"exteriorVertices", ",", 
        RowBox[{"exteriorVertices", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Delete", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}], ",", "0"}], "]"}]}], 
    " ", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"omega0Seq", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
      RowBox[{"{", 
       RowBox[{".1", ",", 
        RowBox[{"-", ".1"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"pointsInHoles", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Mean", "[", 
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.738344788026334*^9}, {3.73834499365376*^9, 
   3.738345007381412*^9}, {3.738345041585004*^9, 3.7383450491514063`*^9}, {
   3.7383451644523897`*^9, 3.738345181717914*^9}, {3.7391147015206738`*^9, 
   3.739114701566883*^9}, 3.739114820074377*^9, {3.739116019013297*^9, 
   3.739116022468959*^9}, {3.739888997348928*^9, 3.739888997459691*^9}, {
   3.749474629526999*^9, 3.749474629605356*^9}, {3.749475888244898*^9, 
   3.749475923820779*^9}, 3.749476152858592*^9, {3.749476247478722*^9, 
   3.749476247756988*^9}, {3.750091291619179*^9, 3.750091339142214*^9}, {
   3.75138214163763*^9, 3.751382156190321*^9}, 3.751382186327859*^9, {
   3.751382363700944*^9, 3.751382364899321*^9}, {3.751382479417938*^9, 
   3.751382480192438*^9}, {3.751382513665051*^9, 3.751382543245013*^9}, {
   3.751382798423822*^9, 3.751382799070187*^9}, 3.751382865276003*^9, {
   3.751382906641285*^9, 3.751382917727352*^9}, {3.7513829479598083`*^9, 
   3.751383044520556*^9}, {3.766934646743341*^9, 3.7669346621110983`*^9}, {
   3.76693508481115*^9, 3.766935123454219*^9}, {3.766936153112279*^9, 
   3.766936253214611*^9}, {3.766937056229465*^9, 3.7669370808127832`*^9}, {
   3.766937156481443*^9, 3.766937177792007*^9}, {3.766937286246264*^9, 
   3.7669372865071077`*^9}, {3.766937405397862*^9, 3.766937436691087*^9}, 
   3.766937487349389*^9, 3.76693755205643*^9, {3.7669376795317*^9, 
   3.766937682561051*^9}},
 CellLabel->
  "In[394]:=",ExpressionUUID->"31d48733-2014-4381-9b60-2489d69ba065"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.738284112367519*^9, 3.738284173092161*^9}, {
  3.750092940368393*^9, 3.750092956172657*^9}},
 CellLabel->
  "In[405]:=",ExpressionUUID->"d8a96c6a-1928-4e76-baa8-a679915fb714"],

Cell[BoxData[
 GraphicsBox[{
   GraphicsComplexBox[{{0.8660254037844386, -0.5}, {0., 
    1.}, {-0.8660254037844386, -0.5}, {
    0.4732050807568877, -0.09999999999999999}, {0.3, 0.2}, {
    0.1267949192431122, -0.09999999999999996}}, 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     TagBox[FilledCurveBox[{{Line[{1, 2, 3}]}, {Line[{4, 5, 6}]}}],
      Annotation[#, "Geometry"]& ]}], 
   {RGBColor[1, 0, 0], PointBox[{0.3, 1.850371707708594*^-17}]}, 
   {RGBColor[0, 1, 0], PointBox[{0.5732050807568877, -0.2}]}}]], "Output",
 CellChangeTimes->{3.766938535236664*^9},
 CellLabel->
  "Out[405]=",ExpressionUUID->"151b10fe-17c0-47ca-bfbb-93ee03850f4c"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Region 12", "Subsubsection",
 CellChangeTimes->{{3.750091244601646*^9, 3.7500912604319267`*^9}, {
  3.7669345685999002`*^9, 3.7669345709351788`*^9}, {3.766935094616336*^9, 
  3.766935094886773*^9}, {3.766936018966009*^9, 3.766936019452475*^9}, {
  3.7669370491669064`*^9, 3.766937049741078*^9}, {3.766937147282064*^9, 
  3.766937147815949*^9}, {3.766937401038672*^9, 3.7669374011089993`*^9}, {
  3.766937768365479*^9, 
  3.766937768403413*^9}},ExpressionUUID->"440e3c92-8a36-4230-ae27-\
a7ab212fd7b1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nHoles", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorBoundaryPoints", "=", 
   RowBox[{"CirclePoints", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", "1", ",", "8"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nExteriorBoundaryPoints", "=", 
   RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"holePointsList", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"RotationMatrix", "[", 
          RowBox[{"Pi", "/", "6"}], "]"}], ".", "#"}], "&"}], "/@", 
       RowBox[{"CirclePoints", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", ".2", ",", "3"}], "]"}]}], 
      ")"}], "+", ".1"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"nHoles", "+", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorVertices", " ", "=", " ", 
   RowBox[{"Range", "[", "nExteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", "=", 
   RowBox[{"{", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}], "+", "1"}], 
      ",", " ", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"holePointsList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], " ", "+", " ", 
       RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}]}], " ", "]"}],
     "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"regionVertices", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"exteriorBoundaryPoints", ",", 
     RowBox[{"Delete", "[", 
      RowBox[{"holePointsList", ",", "0"}], "]"}]}], " ", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"regionVertices", ",", "\[IndentingNewLine]", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"exteriorVertices", ",", 
        RowBox[{"exteriorVertices", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Delete", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}], ",", "0"}], "]"}]}], 
    " ", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"omega0Seq", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
      RowBox[{"{", 
       RowBox[{".1", ",", 
        RowBox[{"-", ".1"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"pointsInHoles", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Mean", "[", 
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.738344788026334*^9}, {3.73834499365376*^9, 
   3.738345007381412*^9}, {3.738345041585004*^9, 3.7383450491514063`*^9}, {
   3.7383451644523897`*^9, 3.738345181717914*^9}, {3.7391147015206738`*^9, 
   3.739114701566883*^9}, 3.739114820074377*^9, {3.739116019013297*^9, 
   3.739116022468959*^9}, {3.739888997348928*^9, 3.739888997459691*^9}, {
   3.749474629526999*^9, 3.749474629605356*^9}, {3.749475888244898*^9, 
   3.749475923820779*^9}, 3.749476152858592*^9, {3.749476247478722*^9, 
   3.749476247756988*^9}, {3.750091291619179*^9, 3.750091339142214*^9}, {
   3.75138214163763*^9, 3.751382156190321*^9}, 3.751382186327859*^9, {
   3.751382363700944*^9, 3.751382364899321*^9}, {3.751382479417938*^9, 
   3.751382480192438*^9}, {3.751382513665051*^9, 3.751382543245013*^9}, {
   3.751382798423822*^9, 3.751382799070187*^9}, 3.751382865276003*^9, {
   3.751382906641285*^9, 3.751382917727352*^9}, {3.7513829479598083`*^9, 
   3.751383044520556*^9}, {3.766934646743341*^9, 3.7669346621110983`*^9}, {
   3.76693508481115*^9, 3.766935123454219*^9}, {3.766936153112279*^9, 
   3.766936253214611*^9}, {3.766937056229465*^9, 3.7669370808127832`*^9}, {
   3.766937156481443*^9, 3.766937177792007*^9}, {3.766937286246264*^9, 
   3.7669372865071077`*^9}, {3.766937405397862*^9, 3.766937436691087*^9}, 
   3.766937487349389*^9, 3.76693755205643*^9, {3.7669376795317*^9, 
   3.766937682561051*^9}, {3.766937774963876*^9, 3.766937835817916*^9}, {
   3.766937915342531*^9, 3.766937917142049*^9}},
 CellLabel->
  "In[382]:=",ExpressionUUID->"3835584c-a354-4f07-9156-83ea8eaf1fa4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.738284112367519*^9, 3.738284173092161*^9}, {
  3.750092940368393*^9, 3.750092956172657*^9}},
 CellLabel->
  "In[393]:=",ExpressionUUID->"72bdc100-1db8-4198-b900-50e79224dc2c"],

Cell[BoxData[
 GraphicsBox[{
   GraphicsComplexBox[{{0.3826834323650898, -0.9238795325112867}, {
    0.9238795325112867, -0.3826834323650898}, {0.9238795325112867, 
    0.3826834323650898}, {0.3826834323650898, 
    0.9238795325112867}, {-0.3826834323650898, 
    0.9238795325112867}, {-0.9238795325112867, 
    0.3826834323650898}, {-0.9238795325112867, -0.3826834323650898}, \
{-0.3826834323650898, -0.9238795325112867}, {0.30000000000000004`, 
    0.10000000000000003`}, {1.3877787807814457`*^-17, 
    0.27320508075688776`}, {-5.551115123125783*^-17, -0.07320508075688772}}, 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     TagBox[
      FilledCurveBox[{{Line[{1, 2, 3, 4, 5, 6, 7, 8}]}, {Line[{9, 10, 11}]}}],
      Annotation[#, "Geometry"]& ]}], 
   {RGBColor[1, 0, 0], PointBox[{0.09999999999999999, 0.10000000000000002`}]}, 
   {RGBColor[0, 1, 0], PointBox[{0.4, 2.7755575615628914`*^-17}]}}]], "Output",
 CellChangeTimes->{3.7669385262862883`*^9},
 CellLabel->
  "Out[393]=",ExpressionUUID->"f4206ca1-6144-44b1-ae15-969d6dfb33e9"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Region 13", "Subsubsection",
 CellChangeTimes->{{3.766938049999228*^9, 
  3.766938053733856*^9}},ExpressionUUID->"425b798d-050c-4213-af4c-\
4350f2275346"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nHoles", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorBoundaryPoints", "=", 
   RowBox[{"StarPoints", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "1.5"}], "}"}], ",", "6", ",", "10", ",", "5"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nExteriorBoundaryPoints", "=", 
   RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"holePointsList", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1.5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"nHoles", "+", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorVertices", " ", "=", " ", 
   RowBox[{"Range", "[", "nExteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", "=", 
   RowBox[{"{", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}], "+", "1"}], 
      ",", " ", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"holePointsList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], " ", "+", " ", 
       RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}]}], " ", "]"}],
     "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"regionVertices", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"exteriorBoundaryPoints", ",", 
     RowBox[{"Delete", "[", 
      RowBox[{"holePointsList", ",", "0"}], "]"}]}], " ", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"regionVertices", ",", "\[IndentingNewLine]", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"exteriorVertices", ",", 
        RowBox[{"exteriorVertices", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Delete", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}], ",", "0"}], "]"}]}], 
    " ", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"omega0Seq", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"pointsInHoles", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Mean", "[", 
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.738344788026334*^9}, {3.73834499365376*^9, 
   3.738345007381412*^9}, {3.738345041585004*^9, 3.7383450491514063`*^9}, {
   3.7383451644523897`*^9, 3.738345181717914*^9}, {3.7391147015206738`*^9, 
   3.739114701566883*^9}, 3.739114820074377*^9, {3.739116019013297*^9, 
   3.739116022468959*^9}, {3.739888997348928*^9, 3.739888997459691*^9}, {
   3.749474629526999*^9, 3.749474629605356*^9}, {3.749475888244898*^9, 
   3.749475923820779*^9}, 3.749476152858592*^9, {3.749476247478722*^9, 
   3.749476247756988*^9}, {3.750091291619179*^9, 3.750091339142214*^9}, {
   3.75138214163763*^9, 3.751382156190321*^9}, 3.751382186327859*^9, {
   3.751382363700944*^9, 3.751382364899321*^9}, {3.751382479417938*^9, 
   3.751382480192438*^9}, {3.751382513665051*^9, 3.751382543245013*^9}, {
   3.751382798423822*^9, 3.751382799070187*^9}, 3.751382865276003*^9, {
   3.751382906641285*^9, 3.751382917727352*^9}, {3.7513829479598083`*^9, 
   3.751383044520556*^9}, {3.766934646743341*^9, 3.7669346621110983`*^9}, {
   3.76693508481115*^9, 3.766935123454219*^9}, {3.766936153112279*^9, 
   3.766936253214611*^9}, {3.766937056229465*^9, 3.7669370808127832`*^9}, {
   3.766938184483717*^9, 3.76693820082472*^9}, {3.766938289693804*^9, 
   3.766938292077182*^9}},
 CellLabel->
  "In[364]:=",ExpressionUUID->"7a0472ab-056b-4cc6-9281-b1b58067d67b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.738284112367519*^9, 3.738284173092161*^9}, {
  3.750092940368393*^9, 3.750092956172657*^9}},
 CellLabel->
  "In[375]:=",ExpressionUUID->"1b63fa8d-f02b-4526-845d-6d660d131c02"],

Cell[BoxData[
 GraphicsBox[{GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGAQBmIQDQUOEErxwDHmCOcoaTGHP++SM42vch1Q2Mp1JoNV
3cHt+HfOsMKf+/fbF/d5XZaDyTt82zDp6OsmeYeXP+wOaukpO6CaJ+fwKlG1
+zor/wGYfF39M5mpy3gPwPQ7ZInOuMgld8ADar4UfwJvZu6P/TD7GbADB1Qu
B5T/wR6Vz4BGw8UZsPNh6mDm/LBHlf5gDwDl/Ual
    "], 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     TagBox[
      FilledCurveBox[{{Line[{1, 2, 3, 4, 5, 6, 7, 8, 9, 10}]}, {
        Line[{11, 12, 13, 14, 15, 16, 17, 18, 19}]}}],
      Annotation[#, "Geometry"]& ]}], 
   {RGBColor[1, 0, 0], 
    PointBox[NCache[{Rational[11, 9], 1.5}, {1.2222222222222223`, 1.5}]]}, 
   {RGBColor[0, 1, 0], PointBox[{-1, -1}]}}]], "Output",
 CellChangeTimes->{
  3.766935127658557*^9, 3.766935357706502*^9, 3.7669356649491243`*^9, {
   3.7669362443286467`*^9, 3.766936257479273*^9}, 3.76693692576677*^9, {
   3.766937065873773*^9, 3.766937083123837*^9}, 3.766938203842029*^9, 
   3.766938293821027*^9},
 CellLabel->
  "Out[375]=",ExpressionUUID->"1baae7e2-5dcd-432e-8441-30fc8ca8a215"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Region 14", "Subsubsection",
 CellChangeTimes->{{3.766938049999228*^9, 3.766938053733856*^9}, {
  3.7669391328158007`*^9, 3.7669391328933907`*^9}, {3.766939263625839*^9, 
  3.7669392779508038`*^9}},ExpressionUUID->"d242dc60-155f-4ead-8cd4-\
1ea52e31f8d6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nHoles", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorBoundaryPoints", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "3"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nExteriorBoundaryPoints", "=", 
   RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"holePointsList", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1.5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5.5", ",", "1.5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5.5", ",", "1.7"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1.7"}], "}"}]}], "}"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"nHoles", "+", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorVertices", " ", "=", " ", 
   RowBox[{"Range", "[", "nExteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", "=", 
   RowBox[{"{", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}], "+", "1"}], 
      ",", " ", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"holePointsList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], " ", "+", " ", 
       RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}]}], " ", "]"}],
     "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"regionVertices", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"exteriorBoundaryPoints", ",", 
     RowBox[{"Delete", "[", 
      RowBox[{"holePointsList", ",", "0"}], "]"}]}], " ", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"regionVertices", ",", "\[IndentingNewLine]", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"exteriorVertices", ",", 
        RowBox[{"exteriorVertices", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Delete", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}], ",", "0"}], "]"}]}], 
    " ", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"omega0Seq", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
      RowBox[{"{", 
       RowBox[{".2", ",", 
        RowBox[{"-", ".2"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"pointsInHoles", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Mean", "[", 
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.738344788026334*^9}, {3.73834499365376*^9, 
   3.738345007381412*^9}, {3.738345041585004*^9, 3.7383450491514063`*^9}, {
   3.7383451644523897`*^9, 3.738345181717914*^9}, {3.7391147015206738`*^9, 
   3.739114701566883*^9}, 3.739114820074377*^9, {3.739116019013297*^9, 
   3.739116022468959*^9}, {3.739888997348928*^9, 3.739888997459691*^9}, {
   3.749474629526999*^9, 3.749474629605356*^9}, {3.749475888244898*^9, 
   3.749475923820779*^9}, 3.749476152858592*^9, {3.749476247478722*^9, 
   3.749476247756988*^9}, {3.750091291619179*^9, 3.750091339142214*^9}, {
   3.75138214163763*^9, 3.751382156190321*^9}, 3.751382186327859*^9, {
   3.751382363700944*^9, 3.751382364899321*^9}, {3.751382479417938*^9, 
   3.751382480192438*^9}, {3.751382513665051*^9, 3.751382543245013*^9}, {
   3.751382798423822*^9, 3.751382799070187*^9}, 3.751382865276003*^9, {
   3.751382906641285*^9, 3.751382917727352*^9}, {3.7513829479598083`*^9, 
   3.751383044520556*^9}, {3.766934646743341*^9, 3.7669346621110983`*^9}, {
   3.76693508481115*^9, 3.766935123454219*^9}, {3.766936153112279*^9, 
   3.766936253214611*^9}, {3.766937056229465*^9, 3.7669370808127832`*^9}, {
   3.766938184483717*^9, 3.76693820082472*^9}, {3.766938289693804*^9, 
   3.766938292077182*^9}, {3.766938592376636*^9, 3.766938615111511*^9}, {
   3.766938926465578*^9, 3.766939105655684*^9}, {3.766939140486435*^9, 
   3.766939152888254*^9}, {3.766939339165596*^9, 3.7669393495709543`*^9}, {
   3.7669393905782833`*^9, 3.766939500429509*^9}},
 CellLabel->
  "In[595]:=",ExpressionUUID->"fcf7ab20-b2c9-4ff9-866b-94e7d25aa387"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.738284112367519*^9, 3.738284173092161*^9}, {
  3.750092940368393*^9, 3.750092956172657*^9}},
 CellLabel->
  "In[606]:=",ExpressionUUID->"1d8564ac-4add-49da-8794-ce5b5e3b5b49"],

Cell[BoxData[
 GraphicsBox[{
   GraphicsComplexBox[{{0., 0.}, {6., 0.}, {9., 4.}, {5., 6.}, {2., 2.}, {-1.,
     3.}, {0., 1.5}, {5.5, 1.5}, {5.5, 1.7}, {0., 1.7}}, 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     TagBox[
      FilledCurveBox[{{Line[{1, 2, 3, 4, 5, 6}]}, {Line[{7, 8, 9, 10}]}}],
      Annotation[#, "Geometry"]& ]}], 
   {RGBColor[1, 0, 0], PointBox[{2.75, 1.6}]}, 
   {RGBColor[0, 1, 0], PointBox[{0.2, 1.3}]}}]], "Output",
 CellChangeTimes->{
  3.766935127658557*^9, 3.766935357706502*^9, 3.7669356649491243`*^9, {
   3.7669362443286467`*^9, 3.766936257479273*^9}, 3.76693692576677*^9, {
   3.766937065873773*^9, 3.766937083123837*^9}, 3.766938203842029*^9, 
   3.766938293821027*^9, {3.7669390044973927`*^9, 3.766939108106662*^9}, {
   3.766939146029557*^9, 3.766939155787551*^9}, {3.766939479139347*^9, 
   3.766939502820475*^9}},
 CellLabel->
  "Out[606]=",ExpressionUUID->"6a16f6c9-0b4b-46f9-b7fc-c7fc08cb756d"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Region 15", "Subsubsection",
 CellChangeTimes->{{3.766938049999228*^9, 3.766938053733856*^9}, {
  3.7669391328158007`*^9, 3.7669391328933907`*^9}, {3.766939263625839*^9, 
  3.7669392779508038`*^9}, {3.766939877924656*^9, 
  3.7669398790991077`*^9}},ExpressionUUID->"032f6b45-7a3e-4723-ae8a-\
f96633c0364e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nHoles", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorBoundaryPoints", "=", 
   RowBox[{"CirclePoints", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", "10", ",", "4"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nExteriorBoundaryPoints", "=", 
   RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"holePointsList", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "2"}], ",", 
        RowBox[{"-", "4"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"-", "4"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "2"}], ",", "4"}], "}"}]}], "}"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"nHoles", "+", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorVertices", " ", "=", " ", 
   RowBox[{"Range", "[", "nExteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", "=", 
   RowBox[{"{", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}], "+", "1"}], 
      ",", " ", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"holePointsList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], " ", "+", " ", 
       RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}]}], " ", "]"}],
     "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"regionVertices", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"exteriorBoundaryPoints", ",", 
     RowBox[{"Delete", "[", 
      RowBox[{"holePointsList", ",", "0"}], "]"}]}], " ", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"regionVertices", ",", "\[IndentingNewLine]", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"exteriorVertices", ",", 
        RowBox[{"exteriorVertices", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Delete", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}], ",", "0"}], "]"}]}], 
    " ", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"omega0Seq", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
      RowBox[{"{", 
       RowBox[{".2", ",", 
        RowBox[{"-", ".2"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"pointsInHoles", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Mean", "[", 
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.738344788026334*^9}, {3.73834499365376*^9, 
   3.738345007381412*^9}, {3.738345041585004*^9, 3.7383450491514063`*^9}, {
   3.7383451644523897`*^9, 3.738345181717914*^9}, {3.7391147015206738`*^9, 
   3.739114701566883*^9}, 3.739114820074377*^9, {3.739116019013297*^9, 
   3.739116022468959*^9}, {3.739888997348928*^9, 3.739888997459691*^9}, {
   3.749474629526999*^9, 3.749474629605356*^9}, {3.749475888244898*^9, 
   3.749475923820779*^9}, 3.749476152858592*^9, {3.749476247478722*^9, 
   3.749476247756988*^9}, {3.750091291619179*^9, 3.750091339142214*^9}, {
   3.75138214163763*^9, 3.751382156190321*^9}, 3.751382186327859*^9, {
   3.751382363700944*^9, 3.751382364899321*^9}, {3.751382479417938*^9, 
   3.751382480192438*^9}, {3.751382513665051*^9, 3.751382543245013*^9}, {
   3.751382798423822*^9, 3.751382799070187*^9}, 3.751382865276003*^9, {
   3.751382906641285*^9, 3.751382917727352*^9}, {3.7513829479598083`*^9, 
   3.751383044520556*^9}, {3.766934646743341*^9, 3.7669346621110983`*^9}, {
   3.76693508481115*^9, 3.766935123454219*^9}, {3.766936153112279*^9, 
   3.766936253214611*^9}, {3.766937056229465*^9, 3.7669370808127832`*^9}, {
   3.766938184483717*^9, 3.76693820082472*^9}, {3.766938289693804*^9, 
   3.766938292077182*^9}, {3.766938592376636*^9, 3.766938615111511*^9}, {
   3.766938926465578*^9, 3.766939105655684*^9}, {3.766939140486435*^9, 
   3.766939152888254*^9}, {3.766939339165596*^9, 3.7669393495709543`*^9}, {
   3.7669393905782833`*^9, 3.766939500429509*^9}, {3.766939886019725*^9, 
   3.766939939633219*^9}},
 CellLabel->
  "In[626]:=",ExpressionUUID->"fe184d55-e3c8-44ea-8747-85862dc9ed94"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.738284112367519*^9, 3.738284173092161*^9}, {
  3.750092940368393*^9, 3.750092956172657*^9}},
 CellLabel->
  "In[637]:=",ExpressionUUID->"1e79d43f-8138-4fa0-b15f-2a29ce108c93"],

Cell[BoxData[
 GraphicsBox[{
   GraphicsComplexBox[{{7.0710678118654755`, -7.0710678118654755`}, {
    7.0710678118654755`, 7.0710678118654755`}, {-7.0710678118654755`, 
    7.0710678118654755`}, {-7.0710678118654755`, -7.0710678118654755`}, {-2., \
-4.}, {0., -1.}, {2., -4.}, {2., 4.}, {0., 1.}, {-2., 4.}}, 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     TagBox[
      FilledCurveBox[{{Line[{1, 2, 3, 4}]}, {Line[{5, 6, 7, 8, 9, 10}]}}],
      Annotation[#, "Geometry"]& ]}], 
   {RGBColor[1, 0, 0], PointBox[{0, 0}]}, 
   {RGBColor[0, 1, 0], PointBox[{-1.8, -4.2}]}}]], "Output",
 CellChangeTimes->{
  3.766935127658557*^9, 3.766935357706502*^9, 3.7669356649491243`*^9, {
   3.7669362443286467`*^9, 3.766936257479273*^9}, 3.76693692576677*^9, {
   3.766937065873773*^9, 3.766937083123837*^9}, 3.766938203842029*^9, 
   3.766938293821027*^9, {3.7669390044973927`*^9, 3.766939108106662*^9}, {
   3.766939146029557*^9, 3.766939155787551*^9}, {3.766939479139347*^9, 
   3.766939502820475*^9}, 3.766939941464511*^9},
 CellLabel->
  "Out[637]=",ExpressionUUID->"403a0c63-d170-4563-b883-e1c7a0d6c92c"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Region 16", "Subsubsection",
 CellChangeTimes->{{3.766938049999228*^9, 3.766938053733856*^9}, {
  3.7669391328158007`*^9, 3.7669391328933907`*^9}, {3.766939263625839*^9, 
  3.7669392779508038`*^9}, {3.766939877924656*^9, 3.7669398790991077`*^9}, {
  3.7669401051858997`*^9, 
  3.766940106176764*^9}},ExpressionUUID->"2ec8b8b2-cfcb-40fc-9913-\
5a82ea1243f7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nHoles", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorBoundaryPoints", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "6"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nExteriorBoundaryPoints", "=", 
   RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"holePointsList", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{".5", ",", "4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2.3", ",", "3.8"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "4.7"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1.8", ",", "5"}], "}"}]}], "}"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"nHoles", "+", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorVertices", " ", "=", " ", 
   RowBox[{"Range", "[", "nExteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", "=", 
   RowBox[{"{", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}], "+", "1"}], 
      ",", " ", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"holePointsList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], " ", "+", " ", 
       RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}]}], " ", "]"}],
     "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"regionVertices", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"exteriorBoundaryPoints", ",", 
     RowBox[{"Delete", "[", 
      RowBox[{"holePointsList", ",", "0"}], "]"}]}], " ", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"regionVertices", ",", "\[IndentingNewLine]", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"exteriorVertices", ",", 
        RowBox[{"exteriorVertices", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Delete", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}], ",", "0"}], "]"}]}], 
    " ", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"omega0Seq", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
      RowBox[{"{", 
       RowBox[{".2", ",", 
        RowBox[{"-", ".2"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"pointsInHoles", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Mean", "[", 
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.738344788026334*^9}, {3.73834499365376*^9, 
   3.738345007381412*^9}, {3.738345041585004*^9, 3.7383450491514063`*^9}, {
   3.7383451644523897`*^9, 3.738345181717914*^9}, {3.7391147015206738`*^9, 
   3.739114701566883*^9}, 3.739114820074377*^9, {3.739116019013297*^9, 
   3.739116022468959*^9}, {3.739888997348928*^9, 3.739888997459691*^9}, {
   3.749474629526999*^9, 3.749474629605356*^9}, {3.749475888244898*^9, 
   3.749475923820779*^9}, 3.749476152858592*^9, {3.749476247478722*^9, 
   3.749476247756988*^9}, {3.750091291619179*^9, 3.750091339142214*^9}, {
   3.75138214163763*^9, 3.751382156190321*^9}, 3.751382186327859*^9, {
   3.751382363700944*^9, 3.751382364899321*^9}, {3.751382479417938*^9, 
   3.751382480192438*^9}, {3.751382513665051*^9, 3.751382543245013*^9}, {
   3.751382798423822*^9, 3.751382799070187*^9}, 3.751382865276003*^9, {
   3.751382906641285*^9, 3.751382917727352*^9}, {3.7513829479598083`*^9, 
   3.751383044520556*^9}, {3.766934646743341*^9, 3.7669346621110983`*^9}, {
   3.76693508481115*^9, 3.766935123454219*^9}, {3.766936153112279*^9, 
   3.766936253214611*^9}, {3.766937056229465*^9, 3.7669370808127832`*^9}, {
   3.766938184483717*^9, 3.76693820082472*^9}, {3.766938289693804*^9, 
   3.766938292077182*^9}, {3.766938592376636*^9, 3.766938615111511*^9}, {
   3.766938926465578*^9, 3.766939105655684*^9}, {3.766939140486435*^9, 
   3.766939152888254*^9}, {3.766939339165596*^9, 3.7669393495709543`*^9}, {
   3.7669393905782833`*^9, 3.766939500429509*^9}, {3.766939886019725*^9, 
   3.766939939633219*^9}, {3.766940125324377*^9, 3.766940141047668*^9}, {
   3.766940493098701*^9, 3.7669404933037786`*^9}, {3.766940580557439*^9, 
   3.7669406491095257`*^9}, {3.766940700903775*^9, 3.766940901524476*^9}, {
   3.766941012597649*^9, 3.766941040605369*^9}},
 CellLabel->
  "In[855]:=",ExpressionUUID->"e2946f32-3711-43e5-86a7-004264061e52"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.738284112367519*^9, 3.738284173092161*^9}, {
  3.750092940368393*^9, 3.750092956172657*^9}},
 CellLabel->
  "In[866]:=",ExpressionUUID->"68455884-9540-4759-b9c3-e41dcf78d14b"],

Cell[BoxData[
 GraphicsBox[{
   GraphicsComplexBox[{{0., 0.}, {2., 0.}, {3., 2.}, {4., 0.}, {7., 5.}, {4., 
    6.}, {0., 6.}, {0.5, 4.}, {2.3, 3.8}, {3., 4.7}, {1.8, 5.}}, 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     TagBox[
      FilledCurveBox[{{Line[{1, 2, 3, 4, 5, 6, 7}]}, {Line[{8, 9, 10, 11}]}}],
      Annotation[#, "Geometry"]& ]}], 
   {RGBColor[1, 0, 0], PointBox[{1.9, 4.375}]}, 
   {RGBColor[0, 1, 0], PointBox[{0.7, 3.8}]}}]], "Output",
 CellChangeTimes->{
  3.766935127658557*^9, 3.766935357706502*^9, 3.7669356649491243`*^9, {
   3.7669362443286467`*^9, 3.766936257479273*^9}, 3.76693692576677*^9, {
   3.766937065873773*^9, 3.766937083123837*^9}, 3.766938203842029*^9, 
   3.766938293821027*^9, {3.7669390044973927`*^9, 3.766939108106662*^9}, {
   3.766939146029557*^9, 3.766939155787551*^9}, {3.766939479139347*^9, 
   3.766939502820475*^9}, 3.766939941464511*^9, 3.766940146207411*^9, 
   3.7669404958961678`*^9, {3.766940636158414*^9, 3.766940651470984*^9}, {
   3.766940738368011*^9, 3.766940815787678*^9}, 3.7669408614483013`*^9, {
   3.766940894340046*^9, 3.766940903410489*^9}, {3.766941015373396*^9, 
   3.766941042584731*^9}},
 CellLabel->
  "Out[866]=",ExpressionUUID->"17a634f0-2671-4880-a2f7-f540fd33a2b9"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Region BROKEN", "Subsubsection",
 CellChangeTimes->{{3.766938049999228*^9, 3.766938053733856*^9}, {
  3.7669391328158007`*^9, 3.7669391328933907`*^9}, {3.766939263625839*^9, 
  3.7669392779508038`*^9}, {3.766939877924656*^9, 3.7669398790991077`*^9}, {
  3.7669401051858997`*^9, 3.766940106176764*^9}, {3.7669409917778473`*^9, 
  3.766940993271677*^9}},ExpressionUUID->"d5e2d86e-92e5-4ccd-ba52-\
bea590b91757"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nHoles", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorBoundaryPoints", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "6"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nExteriorBoundaryPoints", "=", 
   RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"holePointsList", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{".5", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2.3", ",", "3.8"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "4.7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1.8", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2.1", ",", "4.5"}], "}"}]}], "}"}], "+", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{".5", ",", "0"}], "}"}], ",", 
       RowBox[{"{", "5", "}"}]}], "]"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"nHoles", "+", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorVertices", " ", "=", " ", 
   RowBox[{"Range", "[", "nExteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", "=", 
   RowBox[{"{", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}], "+", "1"}], 
      ",", " ", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"holePointsList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], " ", "+", " ", 
       RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}]}], " ", "]"}],
     "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"regionVertices", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"exteriorBoundaryPoints", ",", 
     RowBox[{"Delete", "[", 
      RowBox[{"holePointsList", ",", "0"}], "]"}]}], " ", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"regionVertices", ",", "\[IndentingNewLine]", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"exteriorVertices", ",", 
        RowBox[{"exteriorVertices", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Delete", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}], ",", "0"}], "]"}]}], 
    " ", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"omega0Seq", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
      RowBox[{"{", 
       RowBox[{".2", ",", 
        RowBox[{"-", ".2"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"pointsInHoles", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"2.44", ",", "4.2"}], "}"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.738344788026334*^9}, {3.73834499365376*^9, 
   3.738345007381412*^9}, {3.738345041585004*^9, 3.7383450491514063`*^9}, {
   3.7383451644523897`*^9, 3.738345181717914*^9}, {3.7391147015206738`*^9, 
   3.739114701566883*^9}, 3.739114820074377*^9, {3.739116019013297*^9, 
   3.739116022468959*^9}, {3.739888997348928*^9, 3.739888997459691*^9}, {
   3.749474629526999*^9, 3.749474629605356*^9}, {3.749475888244898*^9, 
   3.749475923820779*^9}, 3.749476152858592*^9, {3.749476247478722*^9, 
   3.749476247756988*^9}, {3.750091291619179*^9, 3.750091339142214*^9}, {
   3.75138214163763*^9, 3.751382156190321*^9}, 3.751382186327859*^9, {
   3.751382363700944*^9, 3.751382364899321*^9}, {3.751382479417938*^9, 
   3.751382480192438*^9}, {3.751382513665051*^9, 3.751382543245013*^9}, {
   3.751382798423822*^9, 3.751382799070187*^9}, 3.751382865276003*^9, {
   3.751382906641285*^9, 3.751382917727352*^9}, {3.7513829479598083`*^9, 
   3.751383044520556*^9}, {3.766934646743341*^9, 3.7669346621110983`*^9}, {
   3.76693508481115*^9, 3.766935123454219*^9}, {3.766936153112279*^9, 
   3.766936253214611*^9}, {3.766937056229465*^9, 3.7669370808127832`*^9}, {
   3.766938184483717*^9, 3.76693820082472*^9}, {3.766938289693804*^9, 
   3.766938292077182*^9}, {3.766938592376636*^9, 3.766938615111511*^9}, {
   3.766938926465578*^9, 3.766939105655684*^9}, {3.766939140486435*^9, 
   3.766939152888254*^9}, {3.766939339165596*^9, 3.7669393495709543`*^9}, {
   3.7669393905782833`*^9, 3.766939500429509*^9}, {3.766939886019725*^9, 
   3.766939939633219*^9}, {3.766940125324377*^9, 3.766940141047668*^9}, {
   3.766940493098701*^9, 3.7669404933037786`*^9}, {3.766940580557439*^9, 
   3.7669406491095257`*^9}, {3.766940700903775*^9, 3.766940901524476*^9}},
 CellLabel->
  "In[811]:=",ExpressionUUID->"428cac86-1ce8-470c-a840-f1e1340dab63"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.738284112367519*^9, 3.738284173092161*^9}, {
  3.750092940368393*^9, 3.750092956172657*^9}},
 CellLabel->
  "In[822]:=",ExpressionUUID->"fd64a93b-779e-45d1-bf53-7a41829841eb"],

Cell[BoxData[
 GraphicsBox[{
   GraphicsComplexBox[{{0., 0.}, {2., 0.}, {3., 3.}, {4., 0.}, {7., 5.}, {4., 
    6.}, {0., 6.}, {1., 4.}, {2.8, 3.8}, {3.5, 4.7}, {2.3, 5.}, {2.6, 4.5}}, 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     TagBox[
      FilledCurveBox[{{Line[{1, 2, 3, 4, 5, 6, 7}]}, {
        Line[{8, 9, 10, 11, 12}]}}],
      Annotation[#, "Geometry"]& ]}], 
   {RGBColor[1, 0, 0], PointBox[{2.44, 4.2}]}, 
   {RGBColor[0, 1, 0], PointBox[{1.2, 3.8}]}}]], "Output",
 CellChangeTimes->{
  3.766935127658557*^9, 3.766935357706502*^9, 3.7669356649491243`*^9, {
   3.7669362443286467`*^9, 3.766936257479273*^9}, 3.76693692576677*^9, {
   3.766937065873773*^9, 3.766937083123837*^9}, 3.766938203842029*^9, 
   3.766938293821027*^9, {3.7669390044973927`*^9, 3.766939108106662*^9}, {
   3.766939146029557*^9, 3.766939155787551*^9}, {3.766939479139347*^9, 
   3.766939502820475*^9}, 3.766939941464511*^9, 3.766940146207411*^9, 
   3.7669404958961678`*^9, {3.766940636158414*^9, 3.766940651470984*^9}, {
   3.766940738368011*^9, 3.766940815787678*^9}, 3.7669408614483013`*^9, {
   3.766940894340046*^9, 3.766940903410489*^9}},
 CellLabel->
  "Out[822]=",ExpressionUUID->"dad38e97-5f1c-46c7-bcbe-bdb29c5cb0b2"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Region BROKEN", "Subsubsection",
 CellChangeTimes->{{3.766938049999228*^9, 3.766938053733856*^9}, {
  3.7669391328158007`*^9, 3.7669391328933907`*^9}, {3.766939263625839*^9, 
  3.766939268599331*^9}},ExpressionUUID->"753b154f-77df-4e29-81bc-\
2608bcfecc5e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nHoles", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorBoundaryPoints", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2.5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{".5", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", ".5"}], ",", "1.2"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nExteriorBoundaryPoints", "=", 
   RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"holePointsList", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"RotationMatrix", "[", 
         RowBox[{"Pi", "/", "4"}], "]"}], ".", "#"}], "&"}], "/@", 
      RowBox[{"CirclePoints", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", ".3", ",", "4"}], "]"}]}], "+", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1.7"}], "}"}], ",", 
       RowBox[{"{", "4", "}"}]}], "]"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"nHoles", "+", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorVertices", " ", "=", " ", 
   RowBox[{"Range", "[", "nExteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", "=", 
   RowBox[{"{", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}], "+", "1"}], 
      ",", " ", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"holePointsList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], " ", "+", " ", 
       RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}]}], " ", "]"}],
     "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"regionVertices", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"exteriorBoundaryPoints", ",", 
     RowBox[{"Delete", "[", 
      RowBox[{"holePointsList", ",", "0"}], "]"}]}], " ", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"regionVertices", ",", "\[IndentingNewLine]", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"exteriorVertices", ",", 
        RowBox[{"exteriorVertices", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Delete", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}], ",", "0"}], "]"}]}], 
    " ", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"omega0Seq", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
      RowBox[{"{", 
       RowBox[{".2", ",", 
        RowBox[{"-", ".2"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"pointsInHoles", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Mean", "[", 
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.738344788026334*^9}, {3.73834499365376*^9, 
   3.738345007381412*^9}, {3.738345041585004*^9, 3.7383450491514063`*^9}, {
   3.7383451644523897`*^9, 3.738345181717914*^9}, {3.7391147015206738`*^9, 
   3.739114701566883*^9}, 3.739114820074377*^9, {3.739116019013297*^9, 
   3.739116022468959*^9}, {3.739888997348928*^9, 3.739888997459691*^9}, {
   3.749474629526999*^9, 3.749474629605356*^9}, {3.749475888244898*^9, 
   3.749475923820779*^9}, 3.749476152858592*^9, {3.749476247478722*^9, 
   3.749476247756988*^9}, {3.750091291619179*^9, 3.750091339142214*^9}, {
   3.75138214163763*^9, 3.751382156190321*^9}, 3.751382186327859*^9, {
   3.751382363700944*^9, 3.751382364899321*^9}, {3.751382479417938*^9, 
   3.751382480192438*^9}, {3.751382513665051*^9, 3.751382543245013*^9}, {
   3.751382798423822*^9, 3.751382799070187*^9}, 3.751382865276003*^9, {
   3.751382906641285*^9, 3.751382917727352*^9}, {3.7513829479598083`*^9, 
   3.751383044520556*^9}, {3.766934646743341*^9, 3.7669346621110983`*^9}, {
   3.76693508481115*^9, 3.766935123454219*^9}, {3.766936153112279*^9, 
   3.766936253214611*^9}, {3.766937056229465*^9, 3.7669370808127832`*^9}, {
   3.766938184483717*^9, 3.76693820082472*^9}, {3.766938289693804*^9, 
   3.766938292077182*^9}, {3.766938592376636*^9, 3.766938615111511*^9}, {
   3.766938926465578*^9, 3.766939105655684*^9}, {3.766939140486435*^9, 
   3.766939152888254*^9}},
 CellLabel->
  "In[537]:=",ExpressionUUID->"26257dac-ef9b-49fd-9eb3-2c6e3b0bafe4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.738284112367519*^9, 3.738284173092161*^9}, {
  3.750092940368393*^9, 3.750092956172657*^9}},
 CellLabel->
  "In[548]:=",ExpressionUUID->"d509ae24-874d-41ff-9199-88435588b701"],

Cell[BoxData[
 GraphicsBox[{
   GraphicsComplexBox[{{0., 0.}, {4., 2.}, {2., 0.}, {5., 0.}, {6., 5.}, {2., 
    2.5}, {0.5, 3.}, {-0.5, 1.2}, {1.2999999999999998`, 1.7}, {1., 2.}, {
    0.7000000000000001, 1.7}, {1., 1.4}}, 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     TagBox[
      FilledCurveBox[{{Line[{1, 2, 3, 4, 5, 6, 7, 8}]}, {
        Line[{9, 10, 11, 12}]}}],
      Annotation[#, "Geometry"]& ]}], 
   {RGBColor[1, 0, 0], PointBox[{1., 1.7000000000000002`}]}, 
   {RGBColor[0, 1, 0], PointBox[{1.4999999999999998`, 1.5}]}}]], "Output",
 CellChangeTimes->{
  3.766935127658557*^9, 3.766935357706502*^9, 3.7669356649491243`*^9, {
   3.7669362443286467`*^9, 3.766936257479273*^9}, 3.76693692576677*^9, {
   3.766937065873773*^9, 3.766937083123837*^9}, 3.766938203842029*^9, 
   3.766938293821027*^9, {3.7669390044973927`*^9, 3.766939108106662*^9}, {
   3.766939146029557*^9, 3.766939155787551*^9}},
 CellLabel->
  "Out[548]=",ExpressionUUID->"d2b02c53-4f34-483e-b12b-8d3aed9eef65"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Genus 2 Examples", "Subsection",
 CellChangeTimes->{{3.738076564329453*^9, 3.738076575104495*^9}, {
  3.7380767169187527`*^9, 3.738076718820952*^9}, {3.739888965409711*^9, 
  3.7398889770427847`*^9}, {3.76684841343181*^9, 3.766848420540247*^9}, {
  3.7669351461680603`*^9, 
  3.7669351575967093`*^9}},ExpressionUUID->"f07e2766-5465-49ec-a9a5-\
e5b9df25eeea"],

Cell[CellGroupData[{

Cell["Test Region 1", "Subsubsection",
 CellChangeTimes->{{3.738288162576043*^9, 3.738288166728807*^9}, {
  3.763906622778932*^9, 3.76390662287358*^9}, {3.766847061311968*^9, 
  3.766847062206053*^9}},ExpressionUUID->"a0c5b497-5a34-47f7-a794-\
28316627340d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"omega0Seq", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1.1", ",", "1.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4.`", ",", "1.2928932188134525`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4.5", ",", ".5"}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nHoles", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"nHoles", "+", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pointsInHoles", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{".75", ",", ".75"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4.", ",", "2."}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{".75", ",", ".75"}], "}"}]}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Last", " ", "element", " ", "can", " ", "be", " ", "any", " ", "of", " ", 
    "the", " ", "previous", " ", "elements", " ", "because", " ", "the", " ", 
    "outer", " ", "partition", " ", "contains", " ", "all", " ", "holes"}], 
   " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"exteriorVertices", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "6", ",", "7", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "10", ",", "11", ",", "12"}], "}"}]}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"regionVertices", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.", ",", "0."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5.", ",", "0."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5.", ",", "3."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "3."}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{".5", ",", ".5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.", ",", ".5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.", ",", "1."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{".5", ",", "1."}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"4.353553390593274`", ",", "1.6464466094067263`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4.353553390593274`", ",", "2.353553390593274`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3.646446609406726`", ",", "2.353553390593274`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3.646446609406726`", ",", "1.6464466094067263`"}], "}"}]}], 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"regionVertices", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"exteriorVertices", ",", 
        RowBox[{"exteriorVertices", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}], 
     ",", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, 3.763906835108906*^9, {3.7639068937065163`*^9, 
   3.763906901864003*^9}, 3.763906949513083*^9, {3.763906993693411*^9, 
   3.763907017819634*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"3ca57537-98d7-428c-b566-9233df8682fe"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.738284112367519*^9, 3.738284173092161*^9}},
 CellLabel->
  "In[141]:=",ExpressionUUID->"0393895b-02cd-40e8-bd7d-71f2aea0d490"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test Region 2", "Subsubsection",
 CellChangeTimes->{{3.738288162576043*^9, 3.738288166728807*^9}, {
  3.766847049498852*^9, 
  3.76684707195776*^9}},ExpressionUUID->"ca7b30dd-bc70-455e-8e74-\
014b56e6fdaa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"omega0Seq", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1.1", ",", "1.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3.5", ",", "1.5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4.5", ",", ".5"}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nHoles", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"nHoles", "+", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pointsInHoles", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{".75", ",", ".75"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4.", ",", "2."}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{".75", ",", ".75"}], "}"}]}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Last", " ", "element", " ", "can", " ", "be", " ", "any", " ", "of", " ", 
    "the", " ", "previous", " ", "elements", " ", "because", " ", "the", " ", 
    "outer", " ", "partition", " ", "contains", " ", "all", " ", "holes"}], 
   " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"exteriorVertices", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "6", ",", "7", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "10", ",", "11", ",", "12"}], "}"}]}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"regionVertices", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.", ",", "0."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5.", ",", "0."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5.", ",", "3."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "3."}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{".5", ",", ".5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.", ",", ".5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.", ",", "1."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{".5", ",", "1."}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"4.", ",", "1.5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4.5", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4.", ",", "2.5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3.5", ",", "2"}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"regionVertices", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"exteriorVertices", ",", 
        RowBox[{"exteriorVertices", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}], 
     ",", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
  3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
  3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
  3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
  3.738288130195485*^9}},
 CellLabel->
  "In[654]:=",ExpressionUUID->"aa07e622-187a-4738-ac5f-1113df531772"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.738284112367519*^9, 3.738284173092161*^9}},
 CellLabel->
  "In[662]:=",ExpressionUUID->"47e3fdef-0040-471d-a501-7b8819e2549e"],

Cell[BoxData[
 GraphicsBox[{
   GraphicsComplexBox[{{0., 0.}, {5., 0.}, {5., 3.}, {0., 3.}, {0.5, 0.5}, {
    1., 0.5}, {1., 1.}, {0.5, 1.}, {4., 1.5}, {4.5, 2.}, {4., 2.5}, {3.5, 
    2.}}, 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     TagBox[
      FilledCurveBox[{{Line[{1, 2, 3, 4}]}, {Line[{5, 6, 7, 8}]}, {
        Line[{9, 10, 11, 12}]}}],
      Annotation[#, "Geometry"]& ]}], 
   {RGBColor[1, 0, 0], PointBox[{0.75, 0.75}]}, 
   {RGBColor[1, 0, 0], PointBox[{4., 2.}]}, 
   {RGBColor[1, 0, 0], PointBox[{0.75, 0.75}]}, 
   {RGBColor[0, 1, 0], PointBox[{1.1, 1.1}]}, 
   {RGBColor[0, 1, 0], PointBox[{3.5, 1.5}]}, 
   {RGBColor[0, 1, 0], PointBox[{4.5, 0.5}]}}]], "Output",
 CellChangeTimes->{3.763906634286396*^9, 3.7668417625699463`*^9, 
  3.76955408156004*^9, 3.8106724335695467`*^9},
 CellLabel->
  "Out[662]=",ExpressionUUID->"8a061abc-2a23-4133-aff9-33c7c1dba977"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Region 3", "Subsubsection",
 CellChangeTimes->{{3.738288173467177*^9, 3.73828817620988*^9}, {
  3.766847079645275*^9, 3.7668470805966682`*^9}, {3.766857761081966*^9, 
  3.766857761184091*^9}},ExpressionUUID->"8823070d-3f94-474f-bb2c-\
3752472b1d3f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"omega0Seq", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1.1", ",", "1.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "1.5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4.5", ",", ".5"}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nHoles", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hole2Points", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{".2", "*", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", "t", "]"}], ",", 
         RowBox[{"Sin", "[", "t", "]"}]}], "}"}]}], "+", 
      RowBox[{"{", 
       RowBox[{"2.5", ",", "1.5"}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", 
       RowBox[{
        RowBox[{"2", "*", "Pi"}], "-", ".0000001"}], ",", 
       RowBox[{"2", "*", 
        RowBox[{"Pi", "/", "12"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"nHoles", "+", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pointsInHoles", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{".75", ",", ".75"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2.5", ",", "1.5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{".75", ",", ".75"}], "}"}]}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Last", " ", "element", " ", "can", " ", "be", " ", "any", " ", "of", " ", 
    "the", " ", "previous", " ", "elements", " ", "because", " ", "the", " ", 
    "outer", " ", "partition", " ", "contains", " ", "all", " ", "holes"}], 
   " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"exteriorVertices", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "6", ",", "7", ",", "8"}], "}"}], ",", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "hole2Points", "]"}], "]"}], "+", "8"}]}], 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"regionVertices", " ", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.", ",", "0."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5.", ",", "0."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5.", ",", "3."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.", ",", "3."}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{".5", ",", ".5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1.", ",", ".5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1.", ",", "1."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{".5", ",", "1."}], "}"}]}], "}"}], ",", "hole2Points"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"regionVertices", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"exteriorVertices", ",", 
        RowBox[{"exteriorVertices", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}], 
     ",", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}},
 CellLabel->
  "In[196]:=",ExpressionUUID->"1f7aa43e-5f1b-49a8-b404-55355c4964b4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.738284112367519*^9, 3.738284173092161*^9}},
 CellLabel->
  "In[205]:=",ExpressionUUID->"b8c44ce5-70ea-408a-9708-297c436c7719"],

Cell[BoxData[
 GraphicsBox[{GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQjR2IOGDnc6CJw/gP7FHpDzj4mOKzZoIAK9ScH/aL
LmRF7ExidYCI/7Q/ewYEWBxcFl7dUHT0F1Qfi4MxGPy2h9DMcPk4/anL3eYy
wfWngQET3HyYPET8G1z/njgt/16rr3DzIfZ+gdsPk4e5D6YfAHIWWbo=
    "], 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     TagBox[
      FilledCurveBox[{{Line[{1, 2, 3, 4}]}, {Line[{5, 6, 7, 8}]}, {
        Line[{9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20}]}}],
      Annotation[#, "Geometry"]& ]}], 
   {RGBColor[1, 0, 0], PointBox[{0.75, 0.75}]}, 
   {RGBColor[1, 0, 0], PointBox[{2.5, 1.5}]}, 
   {RGBColor[1, 0, 0], PointBox[{0.75, 0.75}]}, 
   {RGBColor[0, 1, 0], PointBox[{1.1, 1.1}]}, 
   {RGBColor[0, 1, 0], PointBox[{3, 1.5}]}, 
   {RGBColor[0, 1, 0], PointBox[{4.5, 0.5}]}}]], "Output",
 CellChangeTimes->{3.766857756443988*^9, 3.76955408943867*^9},
 CellLabel->
  "Out[205]=",ExpressionUUID->"f28ac1ac-65be-4991-bdd7-d31bb99fb10c"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Region Stars", "Subsubsection",
 CellChangeTimes->{{3.7382881402020063`*^9, 3.738288152872981*^9}, {
  3.766847074917534*^9, 3.766847075853694*^9}, {3.766857776241012*^9, 
  3.766857776319697*^9}, {3.766930249046226*^9, 
  3.766930250236905*^9}},ExpressionUUID->"79c2220a-f646-4186-8701-\
e090a44f709f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"exteriorBoundaryPoints", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.", ",", "0."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5.", ",", "0."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5.", ",", "3."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "3."}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nCirclePoints", " ", "=", " ", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nExteriorBoundaryPoints", "=", 
   RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"holePointsList", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Riffle", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"RotationMatrix", "[", 
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{"Pi", "/", "nCirclePoints"}], ")"}]}], "]"}], ".", 
            "#"}], "&"}], ",", 
          RowBox[{"CirclePoints", "[", 
           RowBox[{".4", ",", " ", "nCirclePoints"}], "]"}]}], " ", "]"}], 
        ",", " ", 
        RowBox[{"CirclePoints", "[", 
         RowBox[{".15", ",", " ", "nCirclePoints"}], "]"}]}], "]"}], " ", "+",
       " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1.67", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"nCirclePoints", "*", "2"}], "}"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Riffle", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"RotationMatrix", "[", 
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{"Pi", "/", "nCirclePoints"}], ")"}]}], "]"}], ".", 
            "#"}], "&"}], ",", 
          RowBox[{"CirclePoints", "[", 
           RowBox[{".6", ",", " ", "nCirclePoints"}], "]"}]}], " ", "]"}], 
        ",", " ", 
        RowBox[{"CirclePoints", "[", 
         RowBox[{".2", ",", " ", "nCirclePoints"}], "]"}]}], "]"}], " ", "+", 
      " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"3.5", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"nCirclePoints", "*", "2"}], "}"}]}], " ", "]"}]}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nHoles", "=", 
   RowBox[{"Length", "[", "holePointsList", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"nHoles", "+", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorVertices", " ", "=", " ", 
   RowBox[{"Range", "[", "nExteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Range", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}], "+", "1"}], 
       ",", " ", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"holePointsList", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], " ", "+", " ", 
        RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}]}], " ", 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Range", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}], "+", 
        RowBox[{"Length", "[", 
         RowBox[{"holePointsList", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], "+", "1"}], ",", " ", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"holePointsList", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], " ", "+", 
        RowBox[{"Length", "[", 
         RowBox[{"holePointsList", "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", "]"}], " ", "+", " ", 
        RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}]}], " ", 
      "]"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"regionVertices", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"exteriorBoundaryPoints", ",", 
     RowBox[{"Delete", "[", 
      RowBox[{"holePointsList", ",", "0"}], "]"}]}], " ", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pointsInHoles", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Mean", "[", 
        RowBox[{"holePointsList", "[", 
         RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"regionVertices", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"exteriorVertices", ",", 
        RowBox[{"exteriorVertices", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}], 
     ",", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"omega0Seq", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", ".1"}], ",", 
        RowBox[{"-", ".1"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"convex", "=", "False"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.738344788026334*^9}, {3.73834499365376*^9, 
   3.738345007381412*^9}, {3.738345041585004*^9, 3.7383450491514063`*^9}, {
   3.7383451644523897`*^9, 3.738345181717914*^9}, {3.7391147015206738`*^9, 
   3.739114701566883*^9}, 3.739114820074377*^9, {3.739116019013297*^9, 
   3.739116022468959*^9}, {3.739888997348928*^9, 3.739888997459691*^9}, {
   3.749474629526999*^9, 3.749474629605356*^9}, {3.749475888244898*^9, 
   3.749475923820779*^9}, 3.749476152858592*^9, {3.749476247478722*^9, 
   3.749476247756988*^9}, {3.750091291619179*^9, 3.750091339142214*^9}, {
   3.75138214163763*^9, 3.751382156190321*^9}, 3.751382186327859*^9, {
   3.751382363700944*^9, 3.751382364899321*^9}, {3.751382479417938*^9, 
   3.751382480192438*^9}, {3.751382513665051*^9, 3.751382543245013*^9}, {
   3.751382798423822*^9, 3.751382799070187*^9}, 3.751382865276003*^9, {
   3.751382906641285*^9, 3.751382917727352*^9}, {3.7513829479598083`*^9, 
   3.751383044520556*^9}, {3.75138785798564*^9, 3.75138786285723*^9}, {
   3.751387935108169*^9, 3.751387952448113*^9}, {3.7513880236961613`*^9, 
   3.75138804321243*^9}, 3.751388097908833*^9, {3.751388150257206*^9, 
   3.751388156759486*^9}, {3.75138822008313*^9, 3.7513882715416327`*^9}, {
   3.751388448599422*^9, 3.7513884565906153`*^9}, 3.7513898897148438`*^9, {
   3.7513900233953657`*^9, 3.751390026120509*^9}, {3.7668031962202263`*^9, 
   3.766803210935417*^9}},
 CellLabel->
  "In[206]:=",ExpressionUUID->"3d64c287-679e-4010-a3c2-758532c8bc87"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.738284112367519*^9, 3.738284173092161*^9}},
 CellLabel->
  "In[219]:=",ExpressionUUID->"511de29b-84db-4015-be0a-eadf7239750d"],

Cell[BoxData[
 GraphicsBox[{GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGCQAGIQjR2IOGDnc6CJczjskGt9Hbjjl/2smSDw037Tjlvd
JYp/7B3SFRd+4Ptnz396/XfndAaHe7MfPtjC+s++jvu7zjKGv/bHNl0VfRfH
4PAvOfNNRPU/+1WnNTT3T2OCm2cMBowORTcXvPL6+g0u/8lQeNXf/B9w/UHL
Vz2XXvTF/j7U/H0t+t76/j/h9kPcyeMAcd9N+yBBywMHP/A4rM5Yt7bx0iv7
Y28KHUM8BBzmXF6ySE7wlf2tud8aelt5HQSN+vtV/36w/2q82sH1Ep/D/6Sq
atsj3+HmQdz32Z7nTMj+XbqccHm1JM76oiouuP5iNZna8Hx2uPnr3h2zt+Pn
htsPAIbamAE=
    "], 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     TagBox[
      FilledCurveBox[{{Line[{1, 2, 3, 4}]}, {
        Line[{5, 6, 7, 8, 9, 10, 11, 12, 13, 14}]}, {
        Line[{15, 16, 17, 18, 19, 20, 21, 22, 23, 24}]}}],
      Annotation[#, "Geometry"]& ]}], 
   {RGBColor[1, 0, 0], PointBox[{1.67, 2.}]}, 
   {RGBColor[1, 0, 0], PointBox[{3.5, 1.0000000000000002`}]}, 
   {RGBColor[0, 1, 0], PointBox[{1.5699999999999998`, 1.5}]}, 
   {RGBColor[0, 1, 0], PointBox[{3.4, 0.30000000000000004`}]}}]], "Output",
 CellChangeTimes->{3.7695540979935837`*^9},
 CellLabel->
  "Out[219]=",ExpressionUUID->"308508b2-b567-4ca3-b86b-18e2498774c6"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Region 4", "Subsubsection",
 CellChangeTimes->{{3.766872001520749*^9, 3.766872004158887*^9}, {
  3.766930253055705*^9, 
  3.7669302596525707`*^9}},ExpressionUUID->"2b317b6e-3a6f-47e5-b9aa-\
8c1e9c2a259e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"exteriorBoundaryPoints", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "3"}], ",", 
       RowBox[{"1", "/", "4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"8", "/", "3"}], ",", 
       RowBox[{"7", "/", "3"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "3"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nExteriorBoundaryPoints", "=", 
   RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"holePointsList", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"CirclePoints", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{".9", ",", "2.1"}], "}"}], ",", ".3", ",", "4"}], "]"}], ",", 
     RowBox[{"StarPoints", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2.1", ",", ".9"}], "}"}], ",", ".4", ",", ".15", ",", "5."}],
       "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nHoles", "=", 
   RowBox[{"Length", "[", "holePointsList", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"nHoles", "+", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorVertices", " ", "=", " ", 
   RowBox[{"Range", "[", "nExteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Range", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}], "+", "1"}], 
       ",", " ", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"holePointsList", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], " ", "+", " ", 
        RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}]}], " ", 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Range", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}], "+", 
        RowBox[{"Length", "[", 
         RowBox[{"holePointsList", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], "+", "1"}], ",", " ", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"holePointsList", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], " ", "+", 
        RowBox[{"Length", "[", 
         RowBox[{"holePointsList", "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", "]"}], " ", "+", " ", 
        RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}]}], " ", 
      "]"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"regionVertices", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"exteriorBoundaryPoints", ",", 
     RowBox[{"Delete", "[", 
      RowBox[{"holePointsList", ",", "0"}], "]"}]}], " ", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pointsInHoles", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Mean", "[", 
        RowBox[{"holePointsList", "[", 
         RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"regionVertices", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"exteriorVertices", ",", 
        RowBox[{"exteriorVertices", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}], 
     ",", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"omega0Seq", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", ".1"}], ",", 
        RowBox[{"-", ".1"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"convex", "=", "False"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.738344788026334*^9}, {3.73834499365376*^9, 
   3.738345007381412*^9}, {3.738345041585004*^9, 3.7383450491514063`*^9}, {
   3.7383451644523897`*^9, 3.738345181717914*^9}, {3.7391147015206738`*^9, 
   3.739114701566883*^9}, 3.739114820074377*^9, {3.739116019013297*^9, 
   3.739116022468959*^9}, {3.739888997348928*^9, 3.739888997459691*^9}, {
   3.749474629526999*^9, 3.749474629605356*^9}, {3.749475888244898*^9, 
   3.749475923820779*^9}, 3.749476152858592*^9, {3.749476247478722*^9, 
   3.749476247756988*^9}, {3.750091291619179*^9, 3.750091339142214*^9}, {
   3.75138214163763*^9, 3.751382156190321*^9}, 3.751382186327859*^9, {
   3.751382363700944*^9, 3.751382364899321*^9}, {3.751382479417938*^9, 
   3.751382480192438*^9}, {3.751382513665051*^9, 3.751382543245013*^9}, {
   3.751382798423822*^9, 3.751382799070187*^9}, 3.751382865276003*^9, {
   3.751382906641285*^9, 3.751382917727352*^9}, {3.7513829479598083`*^9, 
   3.751383044520556*^9}, {3.75138785798564*^9, 3.75138786285723*^9}, {
   3.751387935108169*^9, 3.751387952448113*^9}, {3.7513880236961613`*^9, 
   3.75138804321243*^9}, 3.751388097908833*^9, {3.751388150257206*^9, 
   3.751388156759486*^9}, {3.75138822008313*^9, 3.7513882715416327`*^9}, {
   3.751388448599422*^9, 3.7513884565906153`*^9}, 3.7513898897148438`*^9, {
   3.7513900233953657`*^9, 3.751390026120509*^9}, {3.7668031962202263`*^9, 
   3.766803210935417*^9}, {3.766872474903043*^9, 3.766872475629941*^9}, {
   3.766872806406475*^9, 3.7668728092663183`*^9}, {3.766873356658667*^9, 
   3.76687339145362*^9}, {3.7668736395091457`*^9, 3.7668736586323566`*^9}, {
   3.7668737136155567`*^9, 3.766873730644093*^9}, {3.766929444514048*^9, 
   3.766929444713756*^9}, 3.766929489209901*^9, {3.766929530975977*^9, 
   3.7669295422406397`*^9}, {3.7669298495062323`*^9, 3.7669298624472933`*^9}},
 CellLabel->
  "In[198]:=",ExpressionUUID->"8fd2c489-199b-458b-b761-ffa53706ff68"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.738284112367519*^9, 3.738284173092161*^9}},
 CellLabel->
  "In[210]:=",ExpressionUUID->"92b87722-92c5-4126-b8de-2186b3d9787c"],

Cell[BoxData[
 GraphicsBox[{
   GraphicsComplexBox[{{0.3333333333333333, 0.25}, {3., 0.}, {
    2.6666666666666665`, 2.3333333333333335`}, {0., 3.}, {1.1121320343559642`,
     1.8878679656440358`}, {1.1121320343559642`, 2.3121320343559644`}, {
    0.6878679656440359, 2.3121320343559644`}, {0.6878679656440357, 
    1.8878679656440358`}, {2.1, 0.75}, {2.3351141009169893`, 
    0.5763932022500211}, {2.242658477444273, 0.8536474508437579}, {
    2.4804226065180615`, 1.023606797749979}, {2.188167787843871, 
    1.021352549156242}, {2.1, 1.3}, {2.011832212156129, 1.021352549156242}, {
    1.7195773934819387`, 1.023606797749979}, {1.9573415225557271`, 
    0.8536474508437579}, {1.8648858990830108`, 0.5763932022500211}}, 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     TagBox[
      FilledCurveBox[{{Line[{1, 2, 3, 4}]}, {Line[{5, 6, 7, 8}]}, {
        Line[{9, 10, 11, 12, 13, 14, 15, 16, 17, 18}]}}],
      Annotation[#, "Geometry"]& ]}], 
   {RGBColor[1, 0, 0], PointBox[{0.8999999999999999, 2.1}]}, 
   {RGBColor[1, 0, 0], PointBox[{2.1, 0.8999999999999998}]}, 
   {RGBColor[0, 1, 0], PointBox[{1.012132034355964, 1.7878679656440357`}]}, 
   {RGBColor[0, 1, 0], PointBox[{2., 0.65}]}}]], "Output",
 CellChangeTimes->{3.810569554986865*^9, 3.810569597845387*^9},
 CellLabel->
  "Out[210]=",ExpressionUUID->"30523bf3-a505-45e8-aff6-9f782dcffe1c"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Region 5", "Subsubsection",
 CellChangeTimes->{{3.766930272414638*^9, 
  3.7669302754200687`*^9}},ExpressionUUID->"fc8f060b-1efd-44db-b88d-\
743b28485025"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"exteriorBoundaryPoints", "=", 
   RowBox[{"CirclePoints", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", "2", ",", " ", "6"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nExteriorBoundaryPoints", "=", 
   RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"holePointsList", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"CirclePoints", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{".9", ",", "2.1"}], "}"}], ",", ".3", ",", "3"}], "]"}], ",", 
     RowBox[{"CirclePoints", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2.1", ",", ".9"}], "}"}], ",", ".3", ",", "3"}], "]"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nHoles", "=", 
   RowBox[{"Length", "[", "holePointsList", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"nHoles", "+", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorVertices", " ", "=", " ", 
   RowBox[{"Range", "[", "nExteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Range", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}], "+", "1"}], 
       ",", " ", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"holePointsList", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], " ", "+", " ", 
        RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}]}], " ", 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Range", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}], "+", 
        RowBox[{"Length", "[", 
         RowBox[{"holePointsList", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], "+", "1"}], ",", " ", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"holePointsList", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], " ", "+", 
        RowBox[{"Length", "[", 
         RowBox[{"holePointsList", "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", "]"}], " ", "+", " ", 
        RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}]}], " ", 
      "]"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"regionVertices", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"exteriorBoundaryPoints", ",", 
     RowBox[{"Delete", "[", 
      RowBox[{"holePointsList", ",", "0"}], "]"}]}], " ", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pointsInHoles", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Mean", "[", 
        RowBox[{"holePointsList", "[", 
         RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"regionVertices", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"exteriorVertices", ",", 
        RowBox[{"exteriorVertices", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}], 
     ",", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"omega0Seq", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", ".1"}], ",", 
        RowBox[{"-", ".1"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"convex", "=", "True"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.738344788026334*^9}, {3.73834499365376*^9, 
   3.738345007381412*^9}, {3.738345041585004*^9, 3.7383450491514063`*^9}, {
   3.7383451644523897`*^9, 3.738345181717914*^9}, {3.7391147015206738`*^9, 
   3.739114701566883*^9}, 3.739114820074377*^9, {3.739116019013297*^9, 
   3.739116022468959*^9}, {3.739888997348928*^9, 3.739888997459691*^9}, {
   3.749474629526999*^9, 3.749474629605356*^9}, {3.749475888244898*^9, 
   3.749475923820779*^9}, 3.749476152858592*^9, {3.749476247478722*^9, 
   3.749476247756988*^9}, {3.750091291619179*^9, 3.750091339142214*^9}, {
   3.75138214163763*^9, 3.751382156190321*^9}, 3.751382186327859*^9, {
   3.751382363700944*^9, 3.751382364899321*^9}, {3.751382479417938*^9, 
   3.751382480192438*^9}, {3.751382513665051*^9, 3.751382543245013*^9}, {
   3.751382798423822*^9, 3.751382799070187*^9}, 3.751382865276003*^9, {
   3.751382906641285*^9, 3.751382917727352*^9}, {3.7513829479598083`*^9, 
   3.751383044520556*^9}, {3.75138785798564*^9, 3.75138786285723*^9}, {
   3.751387935108169*^9, 3.751387952448113*^9}, {3.7513880236961613`*^9, 
   3.75138804321243*^9}, 3.751388097908833*^9, {3.751388150257206*^9, 
   3.751388156759486*^9}, {3.75138822008313*^9, 3.7513882715416327`*^9}, {
   3.751388448599422*^9, 3.7513884565906153`*^9}, 3.7513898897148438`*^9, {
   3.7513900233953657`*^9, 3.751390026120509*^9}, {3.7668031962202263`*^9, 
   3.766803210935417*^9}, {3.766872474903043*^9, 3.766872475629941*^9}, {
   3.766872806406475*^9, 3.7668728092663183`*^9}, {3.766873356658667*^9, 
   3.76687339145362*^9}, {3.7668736395091457`*^9, 3.7668736586323566`*^9}, {
   3.7668737136155567`*^9, 3.766873730644093*^9}, {3.766929444514048*^9, 
   3.766929444713756*^9}, 3.766929489209901*^9, {3.766929530975977*^9, 
   3.7669295422406397`*^9}, {3.7669298495062323`*^9, 3.7669298624472933`*^9}, 
   3.766930319660769*^9, {3.7669303749872417`*^9, 3.766930387072215*^9}, {
   3.766930588128495*^9, 3.766930588508347*^9}},
 CellLabel->
  "In[159]:=",ExpressionUUID->"495385b8-676a-495d-8736-254503ad8274"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.738284112367519*^9, 3.738284173092161*^9}},
 CellLabel->
  "In[171]:=",ExpressionUUID->"586a4a79-b56c-4ac3-a371-612574f27ba8"],

Cell[BoxData[
 GraphicsBox[{
   GraphicsComplexBox[{{2., -0.7320508075688772}, {3., 1.}, {2., 
    2.732050807568877}, {0., 2.732050807568877}, {-1., 1.}, {
    0., -0.7320508075688772}, {1.1598076211353316`, 1.9500000000000002`}, {
    0.9, 2.4}, {0.6401923788646684, 1.9500000000000002`}, {
    2.3598076211353316`, 0.75}, {2.1, 1.2}, {1.8401923788646686`, 
    0.7500000000000001}}, 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     TagBox[
      FilledCurveBox[{{Line[{1, 2, 3, 4, 5, 6}]}, {Line[{7, 8, 9}]}, {
        Line[{10, 11, 12}]}}],
      Annotation[#, "Geometry"]& ]}], 
   {RGBColor[1, 0, 0], PointBox[{0.9, 2.1}]}, 
   {RGBColor[1, 0, 0], PointBox[{2.1, 0.9}]}, 
   {RGBColor[0, 1, 0], PointBox[{1.0598076211353316`, 1.85}]}, 
   {RGBColor[0, 1, 0], PointBox[{2.2598076211353315`, 0.65}]}}]], "Output",
 CellChangeTimes->{3.810569568976912*^9},
 CellLabel->
  "Out[171]=",ExpressionUUID->"8c7ce0d2-46b8-4172-af11-e21e6749cb5f"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Region 6", "Subsubsection",
 CellChangeTimes->{{3.7669305944704657`*^9, 
  3.766930598677679*^9}},ExpressionUUID->"ad42fbb3-532a-4ecf-ad75-\
486c2bd01dab"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"exteriorBoundaryPoints", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nExteriorBoundaryPoints", "=", 
   RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"holePointsList", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"CirclePoints", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1.5", ",", "1"}], "}"}], ",", ".2", ",", "9"}], "]"}], ",", 
     RowBox[{"CirclePoints", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1.6", ",", "2.5"}], "}"}], ",", ".2", ",", "3"}], "]"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nHoles", "=", 
   RowBox[{"Length", "[", "holePointsList", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"nHoles", "+", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorVertices", " ", "=", " ", 
   RowBox[{"Range", "[", "nExteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Range", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}], "+", "1"}], 
       ",", " ", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"holePointsList", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], " ", "+", " ", 
        RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}]}], " ", 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Range", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}], "+", 
        RowBox[{"Length", "[", 
         RowBox[{"holePointsList", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], "+", "1"}], ",", " ", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"holePointsList", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], " ", "+", 
        RowBox[{"Length", "[", 
         RowBox[{"holePointsList", "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", "]"}], " ", "+", " ", 
        RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}]}], " ", 
      "]"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"regionVertices", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"exteriorBoundaryPoints", ",", 
     RowBox[{"Delete", "[", 
      RowBox[{"holePointsList", ",", "0"}], "]"}]}], " ", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pointsInHoles", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Mean", "[", 
        RowBox[{"holePointsList", "[", 
         RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"regionVertices", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"exteriorVertices", ",", 
        RowBox[{"exteriorVertices", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}], 
     ",", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"omega0Seq", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", ".1"}], ",", 
        RowBox[{"-", ".1"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"convex", "=", "False"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.738344788026334*^9}, {3.73834499365376*^9, 
   3.738345007381412*^9}, {3.738345041585004*^9, 3.7383450491514063`*^9}, {
   3.7383451644523897`*^9, 3.738345181717914*^9}, {3.7391147015206738`*^9, 
   3.739114701566883*^9}, 3.739114820074377*^9, {3.739116019013297*^9, 
   3.739116022468959*^9}, {3.739888997348928*^9, 3.739888997459691*^9}, {
   3.749474629526999*^9, 3.749474629605356*^9}, {3.749475888244898*^9, 
   3.749475923820779*^9}, 3.749476152858592*^9, {3.749476247478722*^9, 
   3.749476247756988*^9}, {3.750091291619179*^9, 3.750091339142214*^9}, {
   3.75138214163763*^9, 3.751382156190321*^9}, 3.751382186327859*^9, {
   3.751382363700944*^9, 3.751382364899321*^9}, {3.751382479417938*^9, 
   3.751382480192438*^9}, {3.751382513665051*^9, 3.751382543245013*^9}, {
   3.751382798423822*^9, 3.751382799070187*^9}, 3.751382865276003*^9, {
   3.751382906641285*^9, 3.751382917727352*^9}, {3.7513829479598083`*^9, 
   3.751383044520556*^9}, {3.75138785798564*^9, 3.75138786285723*^9}, {
   3.751387935108169*^9, 3.751387952448113*^9}, {3.7513880236961613`*^9, 
   3.75138804321243*^9}, 3.751388097908833*^9, {3.751388150257206*^9, 
   3.751388156759486*^9}, {3.75138822008313*^9, 3.7513882715416327`*^9}, {
   3.751388448599422*^9, 3.7513884565906153`*^9}, 3.7513898897148438`*^9, {
   3.7513900233953657`*^9, 3.751390026120509*^9}, {3.7668031962202263`*^9, 
   3.766803210935417*^9}, {3.766872474903043*^9, 3.766872475629941*^9}, {
   3.766872806406475*^9, 3.7668728092663183`*^9}, {3.766873356658667*^9, 
   3.76687339145362*^9}, {3.7668736395091457`*^9, 3.7668736586323566`*^9}, {
   3.7668737136155567`*^9, 3.766873730644093*^9}, {3.766929444514048*^9, 
   3.766929444713756*^9}, 3.766929489209901*^9, {3.766929530975977*^9, 
   3.7669295422406397`*^9}, {3.7669298495062323`*^9, 3.7669298624472933`*^9}, 
   3.766930319660769*^9, {3.7669303749872417`*^9, 3.766930387072215*^9}, {
   3.766930588128495*^9, 3.766930588508347*^9}, {3.766930666313469*^9, 
   3.7669307632464037`*^9}, {3.766931341481102*^9, 3.7669313419688683`*^9}},
 CellLabel->
  "In[172]:=",ExpressionUUID->"a7d9a7e2-e439-4a62-ba2c-ed82b30b7364"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.738284112367519*^9, 3.738284173092161*^9}},
 CellLabel->
  "In[184]:=",ExpressionUUID->"06cad2af-fee0-4313-948b-210f816e1e27"],

Cell[BoxData[
 GraphicsBox[{GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGAQBmIQjQM4oHI5HNDEHdDE0dR9sMduzgf7mQ0LLulJ/LQ/
flgpMuPPS3uXhVc3FB39ZX/2DAi8sT/ftEz9oNpve3Gx3pUOfR/szZjYQifx
/bJn63io2V38CWruD3tjMPhsf+rvz1W5H7/C5Q1rI2/Y3fwC178nTsu/1+or
3Pz0+njdi8+/we2/Z5XvxRP/B2oes8OsmSDw0x5CszqE/Tj8Qu3KN7g8ANZU
Yr4=
    "], 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     TagBox[
      FilledCurveBox[{{Line[{1, 2, 3, 4, 5, 6, 7}]}, {
        Line[{8, 9, 10, 11, 12, 13, 14, 15, 16}]}, {Line[{17, 18, 19}]}}],
      Annotation[#, "Geometry"]& ]}], 
   {RGBColor[1, 0, 0], PointBox[{1.4999999999999998`, 1.}]}, 
   {RGBColor[1, 0, 0], PointBox[{1.6000000000000003`, 2.5}]}, 
   {RGBColor[0, 1, 0], PointBox[{1.4684040286651336`, 0.7120614758428183}]}, 
   {RGBColor[0, 1, 0], PointBox[{1.6732050807568877`, 2.3}]}}]], "Output",
 CellChangeTimes->{3.810569577065922*^9},
 CellLabel->
  "Out[184]=",ExpressionUUID->"b17535e4-6226-4cbd-a7d5-8edfac425c83"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Region 7", "Subsubsection",
 CellChangeTimes->{{3.766932061175313*^9, 
  3.7669320637495413`*^9}},ExpressionUUID->"5676e7b5-6bfc-46e7-af28-\
f6f7bb47c897"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"exteriorBoundaryPoints", "=", 
   RowBox[{"StarPoints", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", "1.3", ",", "3", ",", "5"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nExteriorBoundaryPoints", "=", 
   RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"holePointsList", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"CirclePoints", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", ".6"}], ",", 
         RowBox[{"-", ".3"}]}], "}"}], ",", ".25", ",", "3"}], "]"}], ",", 
     RowBox[{"CirclePoints", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{".5", ",", ".5"}], "}"}], ",", ".25", ",", "9"}], "]"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nHoles", "=", 
   RowBox[{"Length", "[", "holePointsList", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"nHoles", "+", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorVertices", " ", "=", " ", 
   RowBox[{"Range", "[", "nExteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Range", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}], "+", "1"}], 
       ",", " ", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"holePointsList", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], " ", "+", " ", 
        RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}]}], " ", 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Range", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}], "+", 
        RowBox[{"Length", "[", 
         RowBox[{"holePointsList", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], "+", "1"}], ",", " ", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"holePointsList", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], " ", "+", 
        RowBox[{"Length", "[", 
         RowBox[{"holePointsList", "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", "]"}], " ", "+", " ", 
        RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}]}], " ", 
      "]"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"regionVertices", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"exteriorBoundaryPoints", ",", 
     RowBox[{"Delete", "[", 
      RowBox[{"holePointsList", ",", "0"}], "]"}]}], " ", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pointsInHoles", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Mean", "[", 
        RowBox[{"holePointsList", "[", 
         RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"regionVertices", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"exteriorVertices", ",", 
        RowBox[{"exteriorVertices", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}], 
     ",", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"omega0Seq", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", ".1"}], ",", 
        RowBox[{"-", ".1"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"convex", "=", "False"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.738344788026334*^9}, {3.73834499365376*^9, 
   3.738345007381412*^9}, {3.738345041585004*^9, 3.7383450491514063`*^9}, {
   3.7383451644523897`*^9, 3.738345181717914*^9}, {3.7391147015206738`*^9, 
   3.739114701566883*^9}, 3.739114820074377*^9, {3.739116019013297*^9, 
   3.739116022468959*^9}, {3.739888997348928*^9, 3.739888997459691*^9}, {
   3.749474629526999*^9, 3.749474629605356*^9}, {3.749475888244898*^9, 
   3.749475923820779*^9}, 3.749476152858592*^9, {3.749476247478722*^9, 
   3.749476247756988*^9}, {3.750091291619179*^9, 3.750091339142214*^9}, {
   3.75138214163763*^9, 3.751382156190321*^9}, 3.751382186327859*^9, {
   3.751382363700944*^9, 3.751382364899321*^9}, {3.751382479417938*^9, 
   3.751382480192438*^9}, {3.751382513665051*^9, 3.751382543245013*^9}, {
   3.751382798423822*^9, 3.751382799070187*^9}, 3.751382865276003*^9, {
   3.751382906641285*^9, 3.751382917727352*^9}, {3.7513829479598083`*^9, 
   3.751383044520556*^9}, {3.75138785798564*^9, 3.75138786285723*^9}, {
   3.751387935108169*^9, 3.751387952448113*^9}, {3.7513880236961613`*^9, 
   3.75138804321243*^9}, 3.751388097908833*^9, {3.751388150257206*^9, 
   3.751388156759486*^9}, {3.75138822008313*^9, 3.7513882715416327`*^9}, {
   3.751388448599422*^9, 3.7513884565906153`*^9}, 3.7513898897148438`*^9, {
   3.7513900233953657`*^9, 3.751390026120509*^9}, {3.7668031962202263`*^9, 
   3.766803210935417*^9}, {3.766872474903043*^9, 3.766872475629941*^9}, {
   3.766872806406475*^9, 3.7668728092663183`*^9}, {3.766873356658667*^9, 
   3.76687339145362*^9}, {3.7668736395091457`*^9, 3.7668736586323566`*^9}, {
   3.7668737136155567`*^9, 3.766873730644093*^9}, {3.766929444514048*^9, 
   3.766929444713756*^9}, 3.766929489209901*^9, {3.766929530975977*^9, 
   3.7669295422406397`*^9}, {3.7669298495062323`*^9, 3.7669298624472933`*^9}, 
   3.766930319660769*^9, {3.7669303749872417`*^9, 3.766930387072215*^9}, {
   3.766930588128495*^9, 3.766930588508347*^9}, {3.766930666313469*^9, 
   3.7669307632464037`*^9}, {3.766931341481102*^9, 3.7669313419688683`*^9}, {
   3.766932069438252*^9, 3.7669323137465687`*^9}},
 CellLabel->
  "In[185]:=",ExpressionUUID->"3afb0082-363e-420f-89b4-89d9f3002c83"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.738284112367519*^9, 3.738284173092161*^9}},
 CellLabel->
  "In[197]:=",ExpressionUUID->"c4c2fd81-d63b-40c6-b020-05cca3ddf9ba"],

Cell[BoxData[
 GraphicsBox[{GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGAQA2IQjQo4DngeOt26tviF/WXtzu5blz/sP2Bf3Od1mc3h
+93jl9JWvd3Pw9LWo3/is/0W0e4pF7betO9l39C2xeyPfd33jVtmZjE72Aqa
8M/4OM3m7BkQ+GLfA5HfD5OH6t+/Daofav6BH1Dzofbvh9kv4GD1SaP7xn5j
MLgNpR/vnzETBFbuj3PzfHtR4dV+I6h8veNEvtI9j+yLXl67x/L9gr22sNiu
eW+f2UP8d8OezV3h8aMHz+0ttz9YvjD5oX0Ha/+VXJWn9nxXNr+4rQBT9wBK
v7D/9OVhmMr2q3D5L4X7La3sLsD1r7p5ufuQyiV7Rqj5LLV3H4m234LbDwAw
mawu
    "], 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     TagBox[
      FilledCurveBox[{{Line[{1, 2, 3, 4, 5, 6, 7, 8, 9, 10}]}, {
        Line[{11, 12, 13}]}, {Line[{14, 15, 16, 17, 18, 19, 20, 21, 22}]}}],
      Annotation[#, "Geometry"]& ]}], 
   {RGBColor[1, 0, 0], PointBox[{-0.6, -0.3}]}, 
   {RGBColor[1, 0, 0], PointBox[{0.5, 0.5}]}, 
   {RGBColor[0, 1, 0], PointBox[{-0.48349364905389025`, -0.525}]}, 
   {RGBColor[0, 1, 0], 
    PointBox[{0.48550503583141724`, 0.1650768448035229}]}}]], "Output",
 CellChangeTimes->{3.8105695871058702`*^9},
 CellLabel->
  "Out[197]=",ExpressionUUID->"a4d02d6f-d94a-4eff-875b-7fa6ab4e0e46"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Higher Genus Examples", "Subsection",
 CellChangeTimes->{{3.7805951673182507`*^9, 
  3.7805951751951723`*^9}},ExpressionUUID->"9435f51b-48f1-418a-ad45-\
e5e5eef206b1"],

Cell[CellGroupData[{

Cell["Test Region 1", "Subsubsection",
 CellChangeTimes->{{3.780347667917659*^9, 3.78034767639148*^9}, {
  3.780361382414071*^9, 3.780361382476801*^9}, {3.780596141446781*^9, 
  3.780596141517212*^9}},ExpressionUUID->"85fad600-926d-4828-a1f7-\
2558e1dbc0ec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"exteriorBoundaryPoints", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.3", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.7", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.7", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.3", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "3"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nExteriorBoundaryPoints", "=", 
   RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"holePointsList", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"RotationMatrix", "[", "0", "]"}], ".", "#"}], "+", 
         RowBox[{"{", 
          RowBox[{".5", ",", "1.5"}], "}"}]}], "&"}], ",", 
       RowBox[{"CirclePoints", "[", 
        RowBox[{".1", ",", " ", "4"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"RotationMatrix", "[", 
           RowBox[{"Pi", "/", "2"}], "]"}], ".", "#"}], "+", 
         RowBox[{"{", 
          RowBox[{"3.5", ",", "2.5"}], "}"}]}], "&"}], ",", 
       RowBox[{"CirclePoints", "[", 
        RowBox[{".1", ",", " ", "3"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"RotationMatrix", "[", "0", "]"}], ".", "#"}], "+", 
         RowBox[{"{", 
          RowBox[{"3.5", ",", ".5"}], "}"}]}], "&"}], ",", 
       RowBox[{"CirclePoints", "[", 
        RowBox[{".1", ",", " ", "3"}], "]"}]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nHoles", "=", 
   RowBox[{"Length", "[", "holePointsList", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"nHoles", "+", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorVertices", " ", "=", " ", 
   RowBox[{"Range", "[", "nExteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", "=", 
   RowBox[{"Table", "[", 
    RowBox[{",", 
     RowBox[{"{", "nHoles", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sum", "=", "nExteriorBoundaryPoints"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "nHoles"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"interiorVerticesByHole", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", 
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"sum", "+", "1"}], ",", " ", 
        RowBox[{"sum", "+", 
         RowBox[{"Length", "[", 
          RowBox[{"holePointsList", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", "]"}]}]}], "]"}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sum", "=", 
      RowBox[{"sum", "+", 
       RowBox[{"Length", "[", 
        RowBox[{"holePointsList", "[", 
         RowBox[{"[", "i", "]"}], "]"}], " ", "]"}]}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"regionVertices", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"exteriorBoundaryPoints", ",", 
     RowBox[{"Delete", "[", 
      RowBox[{"holePointsList", ",", "0"}], "]"}]}], " ", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pointsInHoles", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Mean", "[", 
        RowBox[{"holePointsList", "[", 
         RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"regionVertices", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"exteriorVertices", ",", 
        RowBox[{"exteriorVertices", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"omega0Seq", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", ".15"}], ",", 
        RowBox[{"-", ".15"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"convex", "=", "False"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.738344788026334*^9}, {3.73834499365376*^9, 
   3.738345007381412*^9}, {3.738345041585004*^9, 3.7383450491514063`*^9}, {
   3.7383451644523897`*^9, 3.738345181717914*^9}, {3.7391147015206738`*^9, 
   3.739114701566883*^9}, 3.739114820074377*^9, {3.739116019013297*^9, 
   3.739116022468959*^9}, {3.739888997348928*^9, 3.739888997459691*^9}, {
   3.749474629526999*^9, 3.749474629605356*^9}, {3.749475888244898*^9, 
   3.749475923820779*^9}, 3.749476152858592*^9, {3.749476247478722*^9, 
   3.749476247756988*^9}, {3.750090906556975*^9, 3.7500909223059072`*^9}, {
   3.750096104294702*^9, 3.7500961052705936`*^9}, 3.750096144679007*^9, {
   3.780347702080537*^9, 3.7803477021826973`*^9}, {3.780348495440506*^9, 
   3.78034850101717*^9}, {3.780348551002808*^9, 3.780348572828505*^9}, {
   3.780348759494318*^9, 3.7803488175406218`*^9}, {3.78034887511618*^9, 
   3.7803489222398357`*^9}, {3.780349199200159*^9, 3.780349247330846*^9}, {
   3.780349279441757*^9, 3.780349321035058*^9}, {3.780349485284835*^9, 
   3.780349511279542*^9}, {3.7803495759688396`*^9, 3.7803495767817783`*^9}, {
   3.7803614926093187`*^9, 3.780361564715777*^9}, {3.780361604836193*^9, 
   3.780361676930827*^9}, 3.7805117140915947`*^9, 3.780624677812319*^9},
 CellLabel->
  "In[344]:=",ExpressionUUID->"8e7e5174-eb00-4a88-ae0b-d781ea205c8f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}], ",", 
   RowBox[{"ShowHoleNumbers", "[", "pointsInHoles", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.738344788026334*^9}, {3.73834499365376*^9, 
   3.738345007381412*^9}, {3.738345041585004*^9, 3.7383450491514063`*^9}, {
   3.7383451644523897`*^9, 3.738345181717914*^9}, {3.7391147015206738`*^9, 
   3.739114701566883*^9}, 3.739114820074377*^9, {3.739116019013297*^9, 
   3.739116022468959*^9}, {3.739888997348928*^9, 3.739888997459691*^9}, {
   3.749474629526999*^9, 3.749474629605356*^9}, {3.749475888244898*^9, 
   3.749475923820779*^9}, 3.749476152858592*^9, {3.749476247478722*^9, 
   3.749476247756988*^9}, {3.750090906556975*^9, 3.7500909223059072`*^9}, {
   3.750096104294702*^9, 3.7500961052705936`*^9}, 3.750096144679007*^9, {
   3.780347702080537*^9, 3.7803477021826973`*^9}, {3.780348495440506*^9, 
   3.78034850101717*^9}, {3.780348551002808*^9, 3.780348572828505*^9}, {
   3.780348759494318*^9, 3.7803488175406218`*^9}, {3.78034887511618*^9, 
   3.7803489222398357`*^9}, {3.780349199200159*^9, 3.780349247330846*^9}, {
   3.780349279441757*^9, 3.780349321035058*^9}, {3.780349485284835*^9, 
   3.780349511279542*^9}, {3.7803495759688396`*^9, 3.7803495767817783`*^9}, {
   3.7803614926093187`*^9, 3.780361564715777*^9}, {3.780361604836193*^9, 
   3.780361676930827*^9}, 3.7805117140915947`*^9, {3.780512702486662*^9, 
   3.780512705941223*^9}},
 CellLabel->
  "In[358]:=",ExpressionUUID->"7bf67a49-d512-4234-bd6d-b6c367804fea"],

Cell[BoxData[
 GraphicsBox[{GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGAQA2IQjR18sIexzp4BgS/2MPFZM0GA1QFVHYcDqn4BHHwO
DBrVPAYHVPsYCNjD4ZD4xp7L2fmR/XnOB1Vx977Zw/iG3+RbFyr+tLdTb3hd
WXkbzreF8mHq08CAxyEww3RNzEYWB2Mw4Ibaw+IAk18//VTwYj9mqDoeqDvv
QN3FA9X32B6ijhsuDwBcCF6e
    "], 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     TagBox[
      FilledCurveBox[{{Line[{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12}]}, {
        Line[{13, 14, 15, 16}]}, {Line[{17, 18, 19}]}, {Line[{20, 21, 22}]}}],
      Annotation[#, "Geometry"]& ]}], 
   {RGBColor[1, 0, 0], PointBox[{0.49999999999999994`, 1.5}]}, 
   {RGBColor[1, 0, 0], PointBox[{3.5, 2.5}]}, 
   {RGBColor[1, 0, 0], PointBox[{3.5, 0.5}]}, 
   {RGBColor[0, 1, 0], PointBox[{0.4207106781186547, 1.2792893218813453`}]}, 
   {RGBColor[0, 1, 0], PointBox[{3.4, 2.436602540378444}]}, 
   {RGBColor[0, 1, 0], PointBox[{3.436602540378444, 0.30000000000000004`}]}, {
    InsetBox["\<\"1\"\>", {0.49999999999999994, 1.5}], 
    InsetBox["\<\"2\"\>", {3.5, 2.5}], 
    InsetBox["\<\"3\"\>", {3.5, 0.5}]}}]], "Output",
 CellChangeTimes->{3.780511715249489*^9, 3.780512706419146*^9, 
  3.780521702114571*^9, 3.787942238981567*^9},
 CellLabel->
  "Out[358]=",ExpressionUUID->"ea206ea5-7b2a-401e-876e-c87b542d5878"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Region 2", "Subsubsection",
 CellChangeTimes->{{3.780347667917659*^9, 3.78034767639148*^9}, {
  3.780361382414071*^9, 3.780361382476801*^9}, {3.780549813617073*^9, 
  3.7805498143038397`*^9}, {3.780595320169969*^9, 
  3.780595322166504*^9}},ExpressionUUID->"4cb58fad-9cea-4a3e-9a7b-\
bc11b9f168d5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"exteriorBoundaryPoints", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.3", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.7", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4.3", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5.7", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5.7", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4.3", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.7", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.3", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "3"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nExteriorBoundaryPoints", "=", 
   RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"holePointsList", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"RotationMatrix", "[", "0", "]"}], ".", "#"}], "+", 
         RowBox[{"{", 
          RowBox[{".5", ",", "1.5"}], "}"}]}], "&"}], ",", 
       RowBox[{"CirclePoints", "[", 
        RowBox[{".1", ",", " ", "4"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"RotationMatrix", "[", 
           RowBox[{"Pi", "/", "2"}], "]"}], ".", "#"}], "+", 
         RowBox[{"{", 
          RowBox[{"3.5", ",", "2.5"}], "}"}]}], "&"}], ",", 
       RowBox[{"CirclePoints", "[", 
        RowBox[{".1", ",", " ", "3"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"RotationMatrix", "[", "0", "]"}], ".", "#"}], "+", 
         RowBox[{"{", 
          RowBox[{"3.5", ",", ".5"}], "}"}]}], "&"}], ",", 
       RowBox[{"CirclePoints", "[", 
        RowBox[{".1", ",", " ", "3"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"RotationMatrix", "[", "0", "]"}], ".", "#"}], "+", 
         RowBox[{"{", 
          RowBox[{"6.5", ",", "2.5"}], "}"}]}], "&"}], ",", 
       RowBox[{"CirclePoints", "[", 
        RowBox[{".1", ",", " ", "3"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"RotationMatrix", "[", "0", "]"}], ".", "#"}], "+", 
         RowBox[{"{", 
          RowBox[{"6.5", ",", ".5"}], "}"}]}], "&"}], ",", 
       RowBox[{"CirclePoints", "[", 
        RowBox[{".1", ",", " ", "3"}], "]"}]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nHoles", "=", 
   RowBox[{"Length", "[", "holePointsList", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"nHoles", "+", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorVertices", " ", "=", " ", 
   RowBox[{"Range", "[", "nExteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", "=", 
   RowBox[{"Table", "[", 
    RowBox[{",", 
     RowBox[{"{", "nHoles", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sum", "=", "nExteriorBoundaryPoints"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "nHoles"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"interiorVerticesByHole", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", 
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"sum", "+", "1"}], ",", " ", 
        RowBox[{"sum", "+", 
         RowBox[{"Length", "[", 
          RowBox[{"holePointsList", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", "]"}]}]}], "]"}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sum", "=", 
      RowBox[{"sum", "+", 
       RowBox[{"Length", "[", 
        RowBox[{"holePointsList", "[", 
         RowBox[{"[", "i", "]"}], "]"}], " ", "]"}]}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"regionVertices", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"exteriorBoundaryPoints", ",", 
     RowBox[{"Delete", "[", 
      RowBox[{"holePointsList", ",", "0"}], "]"}]}], " ", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pointsInHoles", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Mean", "[", 
        RowBox[{"holePointsList", "[", 
         RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}], ";"}], 
  " "}], "\n", 
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"regionVertices", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"exteriorVertices", ",", 
        RowBox[{"exteriorVertices", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Delete", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}], ",", "0"}], "]"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"omega0Seq", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", ".15"}], ",", 
        RowBox[{"-", ".15"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"convex", "=", "False"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.738344788026334*^9}, {3.73834499365376*^9, 
   3.738345007381412*^9}, {3.738345041585004*^9, 3.7383450491514063`*^9}, {
   3.7383451644523897`*^9, 3.738345181717914*^9}, {3.7391147015206738`*^9, 
   3.739114701566883*^9}, 3.739114820074377*^9, {3.739116019013297*^9, 
   3.739116022468959*^9}, {3.739888997348928*^9, 3.739888997459691*^9}, {
   3.749474629526999*^9, 3.749474629605356*^9}, {3.749475888244898*^9, 
   3.749475923820779*^9}, 3.749476152858592*^9, {3.749476247478722*^9, 
   3.749476247756988*^9}, {3.750090906556975*^9, 3.7500909223059072`*^9}, {
   3.750096104294702*^9, 3.7500961052705936`*^9}, 3.750096144679007*^9, {
   3.780347702080537*^9, 3.7803477021826973`*^9}, {3.780348495440506*^9, 
   3.78034850101717*^9}, {3.780348551002808*^9, 3.780348572828505*^9}, {
   3.780348759494318*^9, 3.7803488175406218`*^9}, {3.78034887511618*^9, 
   3.7803489222398357`*^9}, {3.780349199200159*^9, 3.780349247330846*^9}, {
   3.780349279441757*^9, 3.780349321035058*^9}, {3.780349485284835*^9, 
   3.780349511279542*^9}, {3.7803495759688396`*^9, 3.7803495767817783`*^9}, {
   3.7803614926093187`*^9, 3.780361564715777*^9}, {3.780361604836193*^9, 
   3.780361676930827*^9}, 3.7805117140915947`*^9, {3.780549832488955*^9, 
   3.780549984584461*^9}, {3.780550024320738*^9, 3.780550051267886*^9}, 
   3.78055030092107*^9, 3.780550739343112*^9},
 CellLabel->
  "In[1067]:=",ExpressionUUID->"deeb5e4c-c6dc-407b-a817-cf870f51a96b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}], ",", 
   RowBox[{"ShowHoleNumbers", "[", "pointsInHoles", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.738344788026334*^9}, {3.73834499365376*^9, 
   3.738345007381412*^9}, {3.738345041585004*^9, 3.7383450491514063`*^9}, {
   3.7383451644523897`*^9, 3.738345181717914*^9}, {3.7391147015206738`*^9, 
   3.739114701566883*^9}, 3.739114820074377*^9, {3.739116019013297*^9, 
   3.739116022468959*^9}, {3.739888997348928*^9, 3.739888997459691*^9}, {
   3.749474629526999*^9, 3.749474629605356*^9}, {3.749475888244898*^9, 
   3.749475923820779*^9}, 3.749476152858592*^9, {3.749476247478722*^9, 
   3.749476247756988*^9}, {3.750090906556975*^9, 3.7500909223059072`*^9}, {
   3.750096104294702*^9, 3.7500961052705936`*^9}, 3.750096144679007*^9, {
   3.780347702080537*^9, 3.7803477021826973`*^9}, {3.780348495440506*^9, 
   3.78034850101717*^9}, {3.780348551002808*^9, 3.780348572828505*^9}, {
   3.780348759494318*^9, 3.7803488175406218`*^9}, {3.78034887511618*^9, 
   3.7803489222398357`*^9}, {3.780349199200159*^9, 3.780349247330846*^9}, {
   3.780349279441757*^9, 3.780349321035058*^9}, {3.780349485284835*^9, 
   3.780349511279542*^9}, {3.7803495759688396`*^9, 3.7803495767817783`*^9}, {
   3.7803614926093187`*^9, 3.780361564715777*^9}, {3.780361604836193*^9, 
   3.780361676930827*^9}, 3.7805117140915947`*^9, {3.780512702486662*^9, 
   3.780512705941223*^9}},
 CellLabel->
  "In[1081]:=",ExpressionUUID->"58fdf1d6-9b1a-4a60-bf46-73cf3013f453"],

Cell[BoxData[
 GraphicsBox[{GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGBQAWIQjR18sIexzp4BgS/2MPFZM0GA1QFVHYcDqn4BON8Y
DATh6iHmiaHpl0DTL4ODD7NHAs5HNY/BAdU+BgdU93Bg0Kj+YXBA9S9MPy5/
cjgkvrHncnZ+ZH+e80FV3L1v9jC+4Tf51oWKP+3t1BteV1behvNtoXyY+jQw
4HEIzDBdE7ORBep+bqg9LA4w+fXTTwUv9mOGquOBuvMO1F08UH2P7SHquOHy
mlukwtZFSEH9yQw1Vwoqz+Jw3fvpysDlknB5mHpU86Xg5sPUw+QBGVmZsw==

    "], 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     TagBox[
      FilledCurveBox[{{
        Line[{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 
          19, 20}]}, {Line[{21, 22, 23, 24}]}, {Line[{25, 26, 27}]}, {
        Line[{28, 29, 30}]}, {Line[{31, 32, 33}]}, {Line[{34, 35, 36}]}}],
      Annotation[#, "Geometry"]& ]}], 
   {RGBColor[1, 0, 0], PointBox[{0.49999999999999994`, 1.5}]}, 
   {RGBColor[1, 0, 0], PointBox[{3.5, 2.5}]}, 
   {RGBColor[1, 0, 0], PointBox[{3.5, 0.5}]}, 
   {RGBColor[1, 0, 0], PointBox[{6.5, 2.5000000000000004`}]}, 
   {RGBColor[1, 0, 0], PointBox[{6.5, 0.5}]}, 
   {RGBColor[0, 1, 0], PointBox[{0.4207106781186547, 1.2792893218813453`}]}, 
   {RGBColor[0, 1, 0], PointBox[{3.4, 2.436602540378444}]}, 
   {RGBColor[0, 1, 0], PointBox[{3.436602540378444, 0.30000000000000004`}]}, 
   {RGBColor[0, 1, 0], PointBox[{6.436602540378444, 2.3000000000000003`}]}, 
   {RGBColor[0, 1, 0], PointBox[{6.436602540378444, 0.30000000000000004`}]}, {
    InsetBox["\<\"1\"\>", {0.49999999999999994, 1.5}], 
    InsetBox["\<\"2\"\>", {3.5, 2.5}], InsetBox["\<\"3\"\>", {3.5, 0.5}], 
    InsetBox["\<\"4\"\>", {6.5, 2.5000000000000004}], 
    InsetBox["\<\"5\"\>", {6.5, 0.5}]}}]], "Output",
 CellChangeTimes->{3.78055074209936*^9},
 CellLabel->
  "Out[1081]=",ExpressionUUID->"aa40dd92-8850-476f-98c0-5339c27255cd"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Region 3", "Subsubsection",
 CellChangeTimes->{{3.7805953478002033`*^9, 
  3.7805953557740517`*^9}},ExpressionUUID->"ac44a345-2294-4691-8c04-\
81e621ed8cad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nHoles", "=", "4"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nOuterCirclePoints", "=", "9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nInnerCirclePoints", "=", "4"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nHolePointsList", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"nInnerCirclePoints", ",", 
     RowBox[{"{", "nHoles", "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorBoundaryPoints", "=", 
   RowBox[{"CirclePoints", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"Pi", "/", "2."}]}], "}"}], ",", "nOuterCirclePoints"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nExteriorBoundaryPoints", "=", 
   RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"holePointsList", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"CirclePoints", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"CirclePoints", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.6", ",", " ", 
            RowBox[{"Pi", "/", "2."}]}], "}"}], ",", "nHoles"}], "]"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{".1", ",", " ", 
         RowBox[{"Pi", "/", "2."}]}], "}"}], ",", "nInnerCirclePoints"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"nHoles", "+", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorVertices", " ", "=", " ", 
   RowBox[{"Range", "[", "nExteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"nExteriorBoundaryPoints", "+", 
      RowBox[{"Range", "[", 
       RowBox[{"nHolePointsList", "[", 
        RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], "+", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"nHolePointsList", "[", 
         RowBox[{"[", "j", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"regionVertices", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"exteriorBoundaryPoints", ",", 
     RowBox[{"Delete", "[", 
      RowBox[{"holePointsList", ",", "0"}], "]"}]}], " ", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pointsInHoles", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Mean", "[", 
        RowBox[{"holePointsList", "[", 
         RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}], ";"}], 
  " "}], "\n", 
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"regionVertices", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"exteriorVertices", ",", 
        RowBox[{"exteriorVertices", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Delete", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}], ",", "0"}], "]"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"omega0Seq", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", ".15"}], ",", 
        RowBox[{"-", ".15"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"convex", "=", "False"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.738344788026334*^9}, {3.73834499365376*^9, 
   3.738345007381412*^9}, {3.738345041585004*^9, 3.7383450491514063`*^9}, {
   3.7383451644523897`*^9, 3.738345181717914*^9}, {3.7391147015206738`*^9, 
   3.739114701566883*^9}, 3.739114820074377*^9, {3.739116019013297*^9, 
   3.739116022468959*^9}, {3.739888997348928*^9, 3.739888997459691*^9}, {
   3.780595365094997*^9, 3.780595365516653*^9}, 3.78059543352314*^9, {
   3.780596731271167*^9, 3.780596731372171*^9}, 3.78062482131179*^9},
 CellLabel->
  "In[452]:=",ExpressionUUID->"ef7f9a55-7935-406b-a046-4a9444d64cfa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}], ",", 
   RowBox[{"ShowHoleNumbers", "[", "pointsInHoles", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.738284112367519*^9, 3.738284173092161*^9}, 
   3.780595443377923*^9},
 CellLabel->
  "In[467]:=",ExpressionUUID->"69d7b4dd-50f5-45a5-80c8-b5f0902b7dbe"],

Cell[BoxData[
 GraphicsBox[{GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGCQBGIQzR4jYqy2bKINAxh8sJcRswnaPvHJfquA84vym1/Y
S8g09nQ3v9/fVsxdJ2V1zH6NT8SLqm2v9//5DwL393/k7ipZ8fjqfhndIKdv
gu/2v4Hw7WWh/BUQ9fYsYPMf7IeaZ18FNU8BYp+9OdS+xb4v12Zs7bBJA4Nn
9tNngsDO/cZg8Nj+6pW6guO6pVD3PrCfC5G3h8lD6f3zoeJQc/ZDzJ1hA5Of
CjUXas7+wmPBrzlte2xuMHF23WKYtwcmvgjV/v1Wv/Ka+DoW7YGZOwnVfrg7
+6HiMHfmzTh58Vvm4j0w+aVQc2H+hLhvxR4AbQq3dw==
    "], 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     TagBox[
      FilledCurveBox[{{Line[{1, 2, 3, 4, 5, 6, 7, 8, 9}]}, {
        Line[{10, 11, 12, 13}]}, {Line[{14, 15, 16, 17}]}, {
        Line[{18, 19, 20, 21}]}, {Line[{22, 23, 24, 25}]}}],
      Annotation[#, "Geometry"]& ]}], 
   {RGBColor[1, 0, 0], PointBox[{3.469446951953614*^-17, 0.6}]}, 
   {RGBColor[1, 0, 0], PointBox[{-0.6, 6.775761922273136*^-17}]}, 
   {RGBColor[1, 0, 0], PointBox[{-1.1449174941446927`*^-16, -0.6}]}, 
   {RGBColor[1, 0, 0], 
    PointBox[{0.6000000000000001, -1.5388494043267302`*^-16}]}, 
   {RGBColor[0, 1, 0], PointBox[{-0.14999999999999994`, 0.5499999999999999}]}, 
   {RGBColor[0, 1, 0], PointBox[{-0.75, -0.04999999999999992}]}, 
   {RGBColor[0, 1, 0], PointBox[{-0.1500000000000001, -0.65}]}, 
   {RGBColor[0, 1, 0], 
    PointBox[{0.44999999999999996`, -0.05000000000000014}]}, {
    InsetBox["\<\"1\"\>", {3.469446951953614*^-17, 0.6}], 
    InsetBox["\<\"2\"\>", {-0.6, 6.775761922273136*^-17}], 
    InsetBox["\<\"3\"\>", {-1.1449174941446927*^-16, -0.6}], 
    InsetBox["\<\"4\"\>", \
{0.6000000000000001, -1.5388494043267302*^-16}]}}]], "Output",
 CellChangeTimes->{
  3.743515913654375*^9, 3.743515984397201*^9, {3.780595422793939*^9, 
   3.780595444515818*^9}, 3.78059625072996*^9, 3.78059684567383*^9, 
   3.780624833323319*^9},
 CellLabel->
  "Out[467]=",ExpressionUUID->"ce709fcf-3ffa-4221-a06b-5d97ab795d96"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Region 4", "Subsubsection",
 CellChangeTimes->{{3.780347667917659*^9, 
  3.78034767639148*^9}},ExpressionUUID->"07d3162b-1869-47af-bcdf-\
df26b0778ca2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"exteriorBoundaryPoints", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", " ", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", " ", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", " ", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nExteriorBoundaryPoints", "=", 
   RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"holePointsList", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", ".1"}], ",", ".1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "/", "4"}], ",", " ", 
         RowBox[{"2", "/", "3"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}], ",", " ", 
         RowBox[{"2", "/", "3"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "/", "3"}], ",", " ", 
         RowBox[{"1", "/", "4"}]}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"RotationMatrix", "[", 
           RowBox[{"Pi", "/", "2"}], "]"}], ".", "#"}], "+", 
         RowBox[{"{", 
          RowBox[{".7", ",", 
           RowBox[{"-", ".3"}]}], "}"}]}], "&"}], ",", 
       RowBox[{"CirclePoints", "[", 
        RowBox[{".1", ",", " ", "3"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"RotationMatrix", "[", "0", "]"}], ".", "#"}], "+", 
         RowBox[{"{", 
          RowBox[{".5", ",", 
           RowBox[{"-", ".75"}]}], "}"}]}], "&"}], ",", 
       RowBox[{"CirclePoints", "[", 
        RowBox[{".1", ",", " ", "3"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"RotationMatrix", "[", "0", "]"}], ".", "#"}], "+", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", ".5"}], ",", 
           RowBox[{"-", ".75"}]}], "}"}]}], "&"}], ",", 
       RowBox[{"CirclePoints", "[", 
        RowBox[{".1", ",", " ", "3"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"RotationMatrix", "[", 
           RowBox[{"Pi", "/", "2"}], "]"}], ".", "#"}], "+", 
         RowBox[{"{", 
          RowBox[{".7", ",", ".7"}], "}"}]}], "&"}], ",", 
       RowBox[{"CirclePoints", "[", 
        RowBox[{".1", ",", " ", "3"}], "]"}]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nHoles", "=", 
   RowBox[{"Length", "[", "holePointsList", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"nHoles", "+", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorVertices", " ", "=", " ", 
   RowBox[{"Range", "[", "nExteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", "=", 
   RowBox[{"Table", "[", 
    RowBox[{",", 
     RowBox[{"{", "nHoles", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"regionVertices", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"exteriorBoundaryPoints", ",", 
     RowBox[{"Delete", "[", 
      RowBox[{"holePointsList", ",", "0"}], "]"}]}], " ", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sum", "=", "nExteriorBoundaryPoints"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "nHoles"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"interiorVerticesByHole", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", 
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"sum", "+", "1"}], ",", " ", 
        RowBox[{"sum", "+", 
         RowBox[{"Length", "[", 
          RowBox[{"holePointsList", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", "]"}]}]}], "]"}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sum", "=", 
      RowBox[{"sum", "+", 
       RowBox[{"Length", "[", 
        RowBox[{"holePointsList", "[", 
         RowBox[{"[", "i", "]"}], "]"}], " ", "]"}]}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pointsInHoles", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Mean", "[", 
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"regionVertices", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"exteriorVertices", ",", 
        RowBox[{"exteriorVertices", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Delete", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}], ",", "0"}], "]"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"omega0Seq", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", ".15"}], ",", 
        RowBox[{"-", ".15"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"convex", "=", "False"}], ";"}], "\n", 
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.738344788026334*^9}, {3.73834499365376*^9, 
   3.738345007381412*^9}, {3.738345041585004*^9, 3.7383450491514063`*^9}, {
   3.7383451644523897`*^9, 3.738345181717914*^9}, {3.7391147015206738`*^9, 
   3.739114701566883*^9}, 3.739114820074377*^9, {3.739116019013297*^9, 
   3.739116022468959*^9}, {3.739888997348928*^9, 3.739888997459691*^9}, {
   3.749474629526999*^9, 3.749474629605356*^9}, {3.749475888244898*^9, 
   3.749475923820779*^9}, 3.749476152858592*^9, {3.749476247478722*^9, 
   3.749476247756988*^9}, {3.750090906556975*^9, 3.7500909223059072`*^9}, {
   3.750096104294702*^9, 3.7500961052705936`*^9}, 3.750096144679007*^9, {
   3.780347702080537*^9, 3.7803477021826973`*^9}, {3.780348495440506*^9, 
   3.78034850101717*^9}, {3.780348551002808*^9, 3.780348572828505*^9}, {
   3.780348759494318*^9, 3.7803488175406218`*^9}, {3.78034887511618*^9, 
   3.7803489222398357`*^9}, {3.780349199200159*^9, 3.780349247330846*^9}, {
   3.780349279441757*^9, 3.780349321035058*^9}, {3.780349485284835*^9, 
   3.780349511279542*^9}, {3.7803495759688396`*^9, 3.7803495767817783`*^9}, {
   3.780624621388592*^9, 3.780624641625245*^9}, 3.780624713642652*^9, 
   3.780624789371686*^9, {3.7806248514820957`*^9, 3.78062485606595*^9}, {
   3.780624887962277*^9, 3.780624893208343*^9}, {3.7806249312415533`*^9, 
   3.7806249486143723`*^9}, {3.780625025974062*^9, 3.780625080145638*^9}},
 CellLabel->
  "In[569]:=",ExpressionUUID->"5ca14681-2569-4620-8487-e8482184d7e8"],

Cell[BoxData[
 GraphicsBox[{GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQEf9qPR9jj4GOKzZoLAzv1QGip/YX8oGDyF8h/A
+VAaqv8CVP6FfchD/sWzA07vNwaDx/YQ+vL+/2Dw3H5P6b0pEvtu7HdZeHVD
0dFHUHtfQs15YH/2DAg82V++N2SeVOkt+5lQeSh/P5r6/TD1UPP2z0SRf2G/
it1G/Kb2S3uYe9LA4Jk9zD1KRyds/bzgsT0AvvaIqw==
    "], 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     TagBox[
      FilledCurveBox[{{Line[{1, 2, 3, 4}]}, {Line[{5, 6, 7, 8}]}, {
        Line[{9, 10, 11}]}, {Line[{12, 13, 14}]}, {Line[{15, 16, 17}]}, {
        Line[{18, 19, 20}]}}],
      Annotation[#, "Geometry"]& ]}], 
   {RGBColor[1, 0, 0], PointBox[{-0.37916666666666665`, 0.4208333333333333}]}, 
   {RGBColor[1, 0, 0], PointBox[{0.7000000000000001, -0.3}]}, 
   {RGBColor[1, 0, 0], PointBox[{0.5, -0.75}]}, 
   {RGBColor[1, 0, 0], PointBox[{-0.5, -0.75}]}, 
   {RGBColor[1, 0, 0], PointBox[{0.7000000000000001, 0.6999999999999998}]}, 
   {RGBColor[0, 1, 0], PointBox[{-0.25, -0.04999999999999999}]}, 
   {RGBColor[0, 1, 0], PointBox[{0.6, -0.3633974596215561}]}, 
   {RGBColor[0, 1, 0], PointBox[{0.4366025403784438, -0.9500000000000001}]}, 
   {RGBColor[0, 1, 0], PointBox[{-0.5633974596215561, -0.9500000000000001}]}, 
   {RGBColor[0, 1, 0], PointBox[{0.6, 0.6366025403784438}]}}]], "Output",
 CellChangeTimes->{
  3.780624900578676*^9, {3.780624938978593*^9, 3.780624955936268*^9}, {
   3.780625038164789*^9, 3.780625080583919*^9}},
 CellLabel->
  "Out[583]=",ExpressionUUID->"20d9b1d6-dd80-4c40-800b-fbbcbac71e9c"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Region 5", "Subsubsection",
 CellChangeTimes->{{3.738344687374275*^9, 3.7383446915004053`*^9}, {
  3.780338358009581*^9, 3.780338358046278*^9}, {3.78059618465349*^9, 
  3.7805961874354763`*^9}},ExpressionUUID->"f4a27504-f30b-4e97-8f9a-\
80341cf50fb4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nHoles", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nHole1Points", "=", "12"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nHole2Points", "=", "12"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nHole3Points", "=", "12"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exteriorBoundaryPoints", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.", ",", "0."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5.", ",", "0."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5.", ",", "3."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "3."}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nExteriorBoundaryPoints", "=", 
   RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hole1Points", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{".2", "*", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", "t", "]"}], ",", 
         RowBox[{"Sin", "[", "t", "]"}]}], "}"}]}], "+", 
      RowBox[{"{", 
       RowBox[{"1.5", ",", "1"}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", 
       RowBox[{
        RowBox[{"2", "*", "Pi"}], "-", ".0000001"}], ",", 
       RowBox[{"2", "*", 
        RowBox[{"Pi", "/", "nHole1Points"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hole2Points", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{".2", "*", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", "t", "]"}], ",", 
         RowBox[{"Sin", "[", "t", "]"}]}], "}"}]}], "+", 
      RowBox[{"{", 
       RowBox[{"2.5", ",", "1.5"}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", 
       RowBox[{
        RowBox[{"2", "*", "Pi"}], "-", ".0000001"}], ",", 
       RowBox[{"2", "*", 
        RowBox[{"Pi", "/", "nHole2Points"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hole3Points", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{".2", "*", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", "t", "]"}], ",", 
         RowBox[{"Sin", "[", "t", "]"}]}], "}"}]}], "+", 
      RowBox[{"{", 
       RowBox[{"3.5", ",", "2"}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", 
       RowBox[{
        RowBox[{"2", "*", "Pi"}], "-", ".0000001"}], ",", 
       RowBox[{"2", "*", 
        RowBox[{"Pi", "/", "nHole3Points"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"nHoles", "+", "1"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.738344788026334*^9}, {3.73834499365376*^9, 
   3.738345007381412*^9}, {3.738345041585004*^9, 3.7383450491514063`*^9}, {
   3.7383451644523897`*^9, 3.738345181717914*^9}},
 CellLabel->
  "In[310]:=",ExpressionUUID->"1e11413d-a348-42a8-a11f-33d19ce17ff7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"exteriorVertices", " ", "=", " ", 
   RowBox[{"Range", "[", "nExteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Range", "[", "nHole1Points", "]"}], "+", "4"}], ",", 
     RowBox[{
      RowBox[{"Range", "[", "nHole1Points", "]"}], "+", "4", "+", 
      "nHole1Points"}], ",", 
     RowBox[{
      RowBox[{"Range", "[", "nHole3Points", "]"}], "+", "4", "+", 
      "nHole1Points", "+", "nHole2Points"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"regionVertices", " ", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
    "exteriorBoundaryPoints", ",", "hole1Points", ",", "hole2Points", ",", 
     "hole3Points"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"regionVertices", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"exteriorVertices", ",", 
        RowBox[{"exteriorVertices", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{"interiorVerticesByHole", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.7383447412361517`*^9}, {3.7383447823861847`*^9, 
   3.738344833829782*^9}, {3.7383448651775312`*^9, 3.738344870702899*^9}, {
   3.738345020982286*^9, 3.738345085960609*^9}, {3.7383451232204437`*^9, 
   3.738345161197155*^9}, {3.738345198440514*^9, 3.738345203460009*^9}},
 CellLabel->
  "In[320]:=",ExpressionUUID->"16e405d0-bbf6-43fe-bbe8-e9556b58f071"],

Cell[BoxData[
 RowBox[{
  RowBox[{"omega0Seq", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"hole1Points", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "+", 
      RowBox[{"{", 
       RowBox[{".1", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hole2Points", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "+", 
      RowBox[{"{", 
       RowBox[{".1", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hole3Points", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "+", 
      RowBox[{"{", 
       RowBox[{".1", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"exteriorBoundaryPoints", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "+", 
      RowBox[{"{", 
       RowBox[{".1", ",", ".1"}], "}"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.738345592462002*^9, 3.738345681403084*^9}},
 CellLabel->
  "In[324]:=",ExpressionUUID->"6b0bd721-5b74-499c-9d09-02d088964f1f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"omega0Seq", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1.1", ",", "1.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "1.5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4.5", ",", ".5"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pointsInHoles", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Mean", "[", "hole1Points", "]"}], ",", 
      RowBox[{"Mean", "[", "hole2Points", "]"}], ",", 
      RowBox[{"Mean", "[", "hole3Points", "]"}]}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Last", " ", "element", " ", "can", " ", "be", " ", "any", " ", "of", " ", 
    "the", " ", "previous", " ", "elements", " ", "because", " ", "the", " ", 
    "outer", " ", "partition", " ", "contains", " ", "all", " ", "holes"}], 
   " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7383447910264378`*^9, 3.7383447914517193`*^9}, {
   3.738344938932295*^9, 3.738344948618271*^9}, 3.738344984591922*^9, {
   3.7383450654821177`*^9, 3.738345068024321*^9}, 3.7806243976664953`*^9},
 CellLabel->
  "In[388]:=",ExpressionUUID->"32c9d034-e380-4c23-9e3d-8ff98364deba"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.738284112367519*^9, 3.738284173092161*^9}},
 CellLabel->
  "In[327]:=",ExpressionUUID->"33b1dd9d-8c26-4269-8501-6f9c536d0a2a"],

Cell[BoxData[
 GraphicsBox[{GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGDQAGIQjR2IOGDnc6CJczgYg8Fvewj/g73Lwqsbio7+sp81
EwQ+QumfUPFPUHU/7CH6PtungcE3uPyeOC3/XquvcP1nz4DAF7j5MHmI+Bu4
/oq9IfOkSl/BzYfofwm3HyYPcx9MP0Se1QGmb9GFrIidSawOMH0QdSwOMH0Q
dSxwf0NoZrh8nP7U5W5zmeD6Ie5jgpsPk4e5G6Yf5i+Y+TB/w+yHycPcB9MP
sYcXFi8OEHleqH4GKM0DFWeEquOBuo8R6g9uuDzEfVxw/RB7uODmw+Qh4v/s
Yfoh7vtrDzMfov+PPcx+mDzMfTD9AFXs+NM=
    "], 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     TagBox[
      FilledCurveBox[{{Line[{1, 2, 3, 4}]}, {
        Line[{5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16}]}, {
        Line[{17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28}]}, {
        Line[{29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40}]}}],
      Annotation[#, "Geometry"]& ]}], 
   {RGBColor[1, 0, 0], PointBox[{1.5, 1.0000000000000002`}]}, 
   {RGBColor[1, 0, 0], PointBox[{2.5, 1.5}]}, 
   {RGBColor[1, 0, 0], PointBox[{3.5, 2.}]}, 
   {RGBColor[1, 0, 0], PointBox[{1.5, 1.0000000000000002`}]}, 
   {RGBColor[0, 1, 0], PointBox[{1.1, 1.1}]}, 
   {RGBColor[0, 1, 0], PointBox[{3, 1.5}]}, 
   {RGBColor[0, 1, 0], PointBox[{4.5, 0.5}]}}]], "Output",
 CellChangeTimes->{
  3.738284113062908*^9, 3.738286794876683*^9, {3.7382868662883053`*^9, 
   3.738286887028317*^9}, 3.738289105448517*^9, 3.738289171836624*^9, 
   3.7382892219896708`*^9, 3.738293108668326*^9, 3.7382931950355864`*^9, 
   3.7382932287507973`*^9, 3.7383421900997353`*^9, 3.738344879064657*^9, {
   3.73834495787002*^9, 3.7383449866248817`*^9}, 3.73834506981956*^9, 
   3.7383451301263943`*^9, {3.738345641623509*^9, 3.738345683672369*^9}, 
   3.780338387816596*^9, 3.780623672651887*^9},
 CellLabel->
  "Out[327]=",ExpressionUUID->"6808989f-b673-4ae0-aac3-8a551579bbb4"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Region 6", "Subsubsection",
 CellChangeTimes->{{3.780625777369585*^9, 
  3.780625781856222*^9}},ExpressionUUID->"980f03cb-e69f-40f8-981a-\
e7f3cb25d5b9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"exteriorBoundaryPoints", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.3", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.7", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4.3", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5.7", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5.7", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4.3", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.7", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.3", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "3"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nExteriorBoundaryPoints", "=", 
   RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"holePointsList", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"RotationMatrix", "[", "0", "]"}], ".", "#"}], "+", 
         RowBox[{"{", 
          RowBox[{".5", ",", "2.5"}], "}"}]}], "&"}], ",", 
       RowBox[{"CirclePoints", "[", 
        RowBox[{".1", ",", " ", "4"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"RotationMatrix", "[", "0", "]"}], ".", "#"}], "+", 
         RowBox[{"{", 
          RowBox[{".5", ",", ".5"}], "}"}]}], "&"}], ",", 
       RowBox[{"CirclePoints", "[", 
        RowBox[{".1", ",", " ", "4"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"RotationMatrix", "[", "0", "]"}], ".", "#"}], "+", 
         RowBox[{"{", 
          RowBox[{"3.5", ",", "2.5"}], "}"}]}], "&"}], ",", 
       RowBox[{"CirclePoints", "[", 
        RowBox[{".1", ",", " ", "4"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"RotationMatrix", "[", "0", "]"}], ".", "#"}], "+", 
         RowBox[{"{", 
          RowBox[{"3.5", ",", ".5"}], "}"}]}], "&"}], ",", 
       RowBox[{"CirclePoints", "[", 
        RowBox[{".1", ",", " ", "4"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"RotationMatrix", "[", "0", "]"}], ".", "#"}], "+", 
         RowBox[{"{", 
          RowBox[{"6.5", ",", "2.5"}], "}"}]}], "&"}], ",", 
       RowBox[{"CirclePoints", "[", 
        RowBox[{".1", ",", " ", "4"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"RotationMatrix", "[", "0", "]"}], ".", "#"}], "+", 
         RowBox[{"{", 
          RowBox[{"6.5", ",", ".5"}], "}"}]}], "&"}], ",", 
       RowBox[{"CirclePoints", "[", 
        RowBox[{".1", ",", " ", "4"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"RotationMatrix", "[", "0", "]"}], ".", "#"}], "+", 
         RowBox[{"{", 
          RowBox[{"2", ",", "1.5"}], "}"}]}], "&"}], ",", 
       RowBox[{"CirclePoints", "[", 
        RowBox[{".1", ",", " ", "4"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"RotationMatrix", "[", "0", "]"}], ".", "#"}], "+", 
         RowBox[{"{", 
          RowBox[{"5", ",", "1.5"}], "}"}]}], "&"}], ",", 
       RowBox[{"CirclePoints", "[", 
        RowBox[{".1", ",", " ", "4"}], "]"}]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nHoles", "=", 
   RowBox[{"Length", "[", "holePointsList", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"nHoles", "+", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorVertices", " ", "=", " ", 
   RowBox[{"Range", "[", "nExteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", "=", 
   RowBox[{"Table", "[", 
    RowBox[{",", 
     RowBox[{"{", "nHoles", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sum", "=", "nExteriorBoundaryPoints"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "nHoles"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"interiorVerticesByHole", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", 
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"sum", "+", "1"}], ",", " ", 
        RowBox[{"sum", "+", 
         RowBox[{"Length", "[", 
          RowBox[{"holePointsList", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", "]"}]}]}], "]"}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sum", "=", 
      RowBox[{"sum", "+", 
       RowBox[{"Length", "[", 
        RowBox[{"holePointsList", "[", 
         RowBox[{"[", "i", "]"}], "]"}], " ", "]"}]}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"regionVertices", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"exteriorBoundaryPoints", ",", 
     RowBox[{"Delete", "[", 
      RowBox[{"holePointsList", ",", "0"}], "]"}]}], " ", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pointsInHoles", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Mean", "[", 
        RowBox[{"holePointsList", "[", 
         RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}], ";"}], 
  " "}], "\n", 
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"regionVertices", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"exteriorVertices", ",", 
        RowBox[{"exteriorVertices", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Delete", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}], ",", "0"}], "]"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"omega0Seq", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", ".15"}], ",", 
        RowBox[{"-", ".15"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"convex", "=", "False"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.738344788026334*^9}, {3.73834499365376*^9, 
   3.738345007381412*^9}, {3.738345041585004*^9, 3.7383450491514063`*^9}, {
   3.7383451644523897`*^9, 3.738345181717914*^9}, {3.7391147015206738`*^9, 
   3.739114701566883*^9}, 3.739114820074377*^9, {3.739116019013297*^9, 
   3.739116022468959*^9}, {3.739888997348928*^9, 3.739888997459691*^9}, {
   3.749474629526999*^9, 3.749474629605356*^9}, {3.749475888244898*^9, 
   3.749475923820779*^9}, 3.749476152858592*^9, {3.749476247478722*^9, 
   3.749476247756988*^9}, {3.750090906556975*^9, 3.7500909223059072`*^9}, {
   3.750096104294702*^9, 3.7500961052705936`*^9}, 3.750096144679007*^9, {
   3.780347702080537*^9, 3.7803477021826973`*^9}, {3.780348495440506*^9, 
   3.78034850101717*^9}, {3.780348551002808*^9, 3.780348572828505*^9}, {
   3.780348759494318*^9, 3.7803488175406218`*^9}, {3.78034887511618*^9, 
   3.7803489222398357`*^9}, {3.780349199200159*^9, 3.780349247330846*^9}, {
   3.780349279441757*^9, 3.780349321035058*^9}, {3.780349485284835*^9, 
   3.780349511279542*^9}, {3.7803495759688396`*^9, 3.7803495767817783`*^9}, {
   3.7803614926093187`*^9, 3.780361564715777*^9}, {3.780361604836193*^9, 
   3.780361676930827*^9}, 3.7805117140915947`*^9, {3.780549832488955*^9, 
   3.780549984584461*^9}, {3.780550024320738*^9, 3.780550051267886*^9}, 
   3.78055030092107*^9, 3.780550739343112*^9, {3.780625813441704*^9, 
   3.780625902736123*^9}},
 CellLabel->
  "In[750]:=",ExpressionUUID->"664eac06-a9f2-4512-ab8e-c9cec7227129"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}], ",", 
   RowBox[{"ShowHoleNumbers", "[", "pointsInHoles", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.738344788026334*^9}, {3.73834499365376*^9, 
   3.738345007381412*^9}, {3.738345041585004*^9, 3.7383450491514063`*^9}, {
   3.7383451644523897`*^9, 3.738345181717914*^9}, {3.7391147015206738`*^9, 
   3.739114701566883*^9}, 3.739114820074377*^9, {3.739116019013297*^9, 
   3.739116022468959*^9}, {3.739888997348928*^9, 3.739888997459691*^9}, {
   3.749474629526999*^9, 3.749474629605356*^9}, {3.749475888244898*^9, 
   3.749475923820779*^9}, 3.749476152858592*^9, {3.749476247478722*^9, 
   3.749476247756988*^9}, {3.750090906556975*^9, 3.7500909223059072`*^9}, {
   3.750096104294702*^9, 3.7500961052705936`*^9}, 3.750096144679007*^9, {
   3.780347702080537*^9, 3.7803477021826973`*^9}, {3.780348495440506*^9, 
   3.78034850101717*^9}, {3.780348551002808*^9, 3.780348572828505*^9}, {
   3.780348759494318*^9, 3.7803488175406218`*^9}, {3.78034887511618*^9, 
   3.7803489222398357`*^9}, {3.780349199200159*^9, 3.780349247330846*^9}, {
   3.780349279441757*^9, 3.780349321035058*^9}, {3.780349485284835*^9, 
   3.780349511279542*^9}, {3.7803495759688396`*^9, 3.7803495767817783`*^9}, {
   3.7803614926093187`*^9, 3.780361564715777*^9}, {3.780361604836193*^9, 
   3.780361676930827*^9}, 3.7805117140915947`*^9, {3.780512702486662*^9, 
   3.780512705941223*^9}},
 CellLabel->
  "In[764]:=",ExpressionUUID->"418dd248-0918-4cbd-acac-b89e38f748b3"],

Cell[BoxData[
 GraphicsBox[{GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGAwAWIQjR18sIexzp4BgS/2MPFZM0GA1QFVHYcDqn4BON8Y
DATh6iHmiaHpl0DTL4ODD7NHAs5HNY/BAdU+BgdU93Bg0Kj+YXBA9S9MPy5/
cjgkvrHncnZ+ZP+CpcBWP58Zzpf43X/owgQWBzv1hteVlbfhfFsoH109TB2M
j0scph/VXB4HmHkwPsw+iDg3Bh9dPbp5qP7ixuDD1Pf8dU/M8JCCmwfjw+wr
Ydoxb/p2SQw+unp082D2wdSj81Hdy+BwnvNBVdy9b3C+4Tf51oWKP+0h4v/s
0fkw9RD7RBzQ+TD1EPuEMfgw9QDXZxKN
    "], 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     TagBox[
      FilledCurveBox[{{
        Line[{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 
          19, 20}]}, {Line[{21, 22, 23, 24}]}, {Line[{25, 26, 27, 28}]}, {
        Line[{29, 30, 31, 32}]}, {Line[{33, 34, 35, 36}]}, {
        Line[{37, 38, 39, 40}]}, {Line[{41, 42, 43, 44}]}, {
        Line[{45, 46, 47, 48}]}, {Line[{49, 50, 51, 52}]}}],
      Annotation[#, "Geometry"]& ]}], 
   {RGBColor[1, 0, 0], PointBox[{0.49999999999999994`, 2.5}]}, 
   {RGBColor[1, 0, 0], PointBox[{0.49999999999999994`, 0.5}]}, 
   {RGBColor[1, 0, 0], PointBox[{3.5, 2.5}]}, 
   {RGBColor[1, 0, 0], PointBox[{3.5, 0.5}]}, 
   {RGBColor[1, 0, 0], PointBox[{6.5, 2.5}]}, 
   {RGBColor[1, 0, 0], PointBox[{6.5, 0.5}]}, 
   {RGBColor[1, 0, 0], PointBox[{2., 1.5}]}, 
   {RGBColor[1, 0, 0], PointBox[{5., 1.5}]}, 
   {RGBColor[0, 1, 0], PointBox[{0.4207106781186547, 2.2792893218813455`}]}, 
   {RGBColor[0, 1, 0], PointBox[{0.4207106781186547, 0.27928932188134525`}]}, 
   {RGBColor[0, 1, 0], PointBox[{3.4207106781186547`, 2.2792893218813455`}]}, 
   {RGBColor[0, 1, 0], PointBox[{3.4207106781186547`, 0.27928932188134525`}]}, 
   {RGBColor[0, 1, 0], PointBox[{6.420710678118654, 2.2792893218813455`}]}, 
   {RGBColor[0, 1, 0], PointBox[{6.420710678118654, 0.27928932188134525`}]}, 
   {RGBColor[0, 1, 0], PointBox[{1.9207106781186547`, 1.2792893218813453`}]}, 
   {RGBColor[0, 1, 0], PointBox[{4.920710678118654, 1.2792893218813453`}]}, {
    InsetBox["\<\"1\"\>", {0.49999999999999994, 2.5}], 
    InsetBox["\<\"2\"\>", {0.49999999999999994, 0.5}], 
    InsetBox["\<\"3\"\>", {3.5, 2.5}], InsetBox["\<\"4\"\>", {3.5, 0.5}], 
    InsetBox["\<\"5\"\>", {6.5, 2.5}], InsetBox["\<\"6\"\>", {6.5, 0.5}], 
    InsetBox["\<\"7\"\>", {2., 1.5}], 
    InsetBox["\<\"8\"\>", {5., 1.5}]}}]], "Output",
 CellChangeTimes->{
  3.78055074209936*^9, 3.780625844751903*^9, {3.7806258821520557`*^9, 
   3.780625906769548*^9}},
 CellLabel->
  "Out[764]=",ExpressionUUID->"664fa8ae-fe9d-4f7b-bb8e-5c301a2abf31"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Region 7", "Subsubsection",
 CellChangeTimes->{{3.7805973792130423`*^9, 
  3.78059738051828*^9}},ExpressionUUID->"0fdf8fa7-ada2-4d6c-a23b-\
c9ed90f090c3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nHoles", "=", "7"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nOuterCirclePoints", "=", "9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nInnerCirclePoints", "=", "4"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nHolePointsList", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"nInnerCirclePoints", ",", 
     RowBox[{"{", "nHoles", "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorBoundaryPoints", "=", 
   RowBox[{"CirclePoints", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"Pi", "/", "2."}]}], "}"}], ",", "nOuterCirclePoints"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nExteriorBoundaryPoints", "=", 
   RowBox[{"Length", "[", "exteriorBoundaryPoints", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"holePointsList", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"CirclePoints", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"CirclePoints", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.6", ",", " ", 
            RowBox[{"Pi", "/", "2."}]}], "}"}], ",", "nHoles"}], "]"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{".05", ",", " ", 
         RowBox[{"Pi", "/", "2."}]}], "}"}], ",", "nInnerCirclePoints"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nClasses", "=", 
   RowBox[{"nHoles", "+", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"exteriorVertices", " ", "=", " ", 
   RowBox[{"Range", "[", "nExteriorBoundaryPoints", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"nExteriorBoundaryPoints", "+", 
      RowBox[{"Range", "[", 
       RowBox[{"nHolePointsList", "[", 
        RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], "+", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"nHolePointsList", "[", 
         RowBox[{"[", "j", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"regionVertices", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"exteriorBoundaryPoints", ",", 
     RowBox[{"Delete", "[", 
      RowBox[{"holePointsList", ",", "0"}], "]"}]}], " ", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"region", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"regionVertices", ",", "\[IndentingNewLine]", 
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"exteriorVertices", ",", 
        RowBox[{"exteriorVertices", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Delete", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}], ",", "0"}], "]"}]}], 
    " ", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"omega0Seq", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"holePointsList", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
       RowBox[{"{", 
        RowBox[{"0", ",", ".03"}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"omega0Seq", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"holePointsList", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
        RowBox[{"{", 
         RowBox[{"0", ",", ".01"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}], "*)"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Gives", " ", "\"\<omega0notcontainedincontainedface\>\"", " ", "error", 
    " ", "when", " ", "building", " ", "SlittedLambdaGraph"}], "*)"}], 
  " "}], "\n", 
 RowBox[{
  RowBox[{"pointsInHoles", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Mean", "[", 
      RowBox[{"holePointsList", "[", 
       RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7381627075324163`*^9, 3.73816271393192*^9}, {
   3.7381628533442802`*^9, 3.7381629478989487`*^9}, {3.738163064626759*^9, 
   3.738163068495736*^9}, {3.7381806434556713`*^9, 3.738180649030188*^9}, {
   3.738286855955411*^9, 3.738286884827859*^9}, {3.7382881198801603`*^9, 
   3.738288130195485*^9}, {3.738288777369894*^9, 3.738288789034136*^9}, 
   3.738288850101864*^9, 3.738288904485908*^9, {3.738289059100904*^9, 
   3.7382890850928288`*^9}, {3.738289120663417*^9, 3.738289169078599*^9}, {
   3.738289212577661*^9, 3.738289219783348*^9}, {3.7382930911694717`*^9, 
   3.738293097939209*^9}, {3.738293221315784*^9, 3.7382932229274817`*^9}, {
   3.738344694894*^9, 3.738344788026334*^9}, {3.73834499365376*^9, 
   3.738345007381412*^9}, {3.738345041585004*^9, 3.7383450491514063`*^9}, {
   3.7383451644523897`*^9, 3.738345181717914*^9}, {3.7391147015206738`*^9, 
   3.739114701566883*^9}, 3.739114820074377*^9, {3.739116019013297*^9, 
   3.739116022468959*^9}, {3.739888997348928*^9, 3.739888997459691*^9}, {
   3.780595365094997*^9, 3.780595365516653*^9}, 3.78059543352314*^9, {
   3.780596731271167*^9, 3.780596731372171*^9}, {3.780597388246986*^9, 
   3.780597388735023*^9}, {3.780626651948492*^9, 3.780626665664178*^9}, {
   3.799348793729195*^9, 3.799348801936377*^9}, {3.799349508814898*^9, 
   3.7993495120085907`*^9}, {3.7993495890098753`*^9, 3.799349615541527*^9}},
 CellLabel->
  "In[296]:=",ExpressionUUID->"39d8500f-35d3-4d8f-aa25-d50dcbd0de40"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}], ",", 
   RowBox[{"ShowHoleNumbers", "[", "pointsInHoles", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.738284112367519*^9, 3.738284173092161*^9}, 
   3.780595443377923*^9},
 CellLabel->
  "In[290]:=",ExpressionUUID->"5bb59c26-0729-4ed3-9d0b-20d88184a62d"],

Cell[BoxData[
 GraphicsBox[{GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGBQBWIQzR4jYqy2bKINAxh8sJcRswnaPvHJfquA84vym1/Y
S8g09nQ3v9/fVsxdJ2V1zH6NT8SLqm2v9//5DwL393/k7ipZ8fjqfhndIKdv
gu/2v4Hw7WWh/BUQ9fYsYPMf7IeaZ18FNU8BYp+9OdQ+G0ET/hkf22zOngGB
J/ZTZ4LAyv3GYPDY3sF+n8bqI/U2YOGZD+3nQ+TtYfKfbK0it7Pe2/9nW8nK
KJXb9pN3mLmVznmw/2SzY5n6x+tw+WkBfM5f9l6x38/FrtZy6RZcnqcnw+z7
9kf7k4PnOIskbt2/TJXpwoTAJ/slJph0fBA7uB8mX/dt1ruw2uP7iz6dmxMr
9xAuz59eruew8sL+ndbqRutT7+93mrUqsfjO5f1l5muNCn0ewuUFLrqd4Xr2
aP+O9I5vkm9OweW5IfL2u6H6N0Dk7cvR5AWh+u0g5iPkIe6zL4a6vxDiPnsF
qPtg8m1Q9y+F+A8u/wUSPvY/oeF3EBI+9seg4QOTnwwNvymQ8IXLAwBi7ylf

    "], 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     TagBox[
      FilledCurveBox[{{Line[{1, 2, 3, 4, 5, 6, 7, 8, 9}]}, {
        Line[{10, 11, 12, 13}]}, {Line[{14, 15, 16, 17}]}, {
        Line[{18, 19, 20, 21}]}, {Line[{22, 23, 24, 25}]}, {
        Line[{26, 27, 28, 29}]}, {Line[{30, 31, 32, 33}]}, {
        Line[{34, 35, 36, 37}]}}],
      Annotation[#, "Geometry"]& ]}], 
   {RGBColor[1, 0, 0], PointBox[{3.469446951953614*^-17, 0.6}]}, 
   {RGBColor[1, 0, 0], PointBox[{-0.4690988894808178, 0.3740938811152401}]}, 
   {RGBColor[1, 0, 0], 
    PointBox[{-0.5849567473090942, -0.13351256037378856`}]}, 
   {RGBColor[1, 0, 0], 
    PointBox[{-0.26033024347053496`, -0.5405813207414514}]}, 
   {RGBColor[1, 0, 0], PointBox[{0.26033024347053474`, -0.5405813207414515}]}, 
   {RGBColor[1, 0, 0], PointBox[{0.5849567473090941, -0.13351256037378878`}]}, 
   {RGBColor[1, 0, 0], PointBox[{0.4690988894808179, 0.37409388111524}]}, 
   {RGBColor[0, 1, 0], PointBox[{3.980102097228898*^-17, 0.66}]}, 
   {RGBColor[0, 1, 0], PointBox[{-0.4690988894808178, 0.43409388111524017`}]}, 
   {RGBColor[0, 1, 0], PointBox[{-0.5849567473090942, -0.07351256037378856}]}, 
   {RGBColor[0, 1, 0], 
    PointBox[{-0.26033024347053496`, -0.4805813207414514}]}, 
   {RGBColor[0, 1, 0], PointBox[{0.26033024347053474`, -0.4805813207414515}]},
    
   {RGBColor[0, 1, 0], PointBox[{0.5849567473090941, -0.07351256037378878}]}, 
   {RGBColor[0, 1, 0], PointBox[{0.4690988894808179, 0.43409388111524}]}, {
    InsetBox["\<\"1\"\>", {3.469446951953614*^-17, 0.6}], 
    InsetBox["\<\"2\"\>", {-0.4690988894808178, 0.3740938811152401}], 
    InsetBox["\<\"3\"\>", {-0.5849567473090942, -0.13351256037378856}], 
    InsetBox["\<\"4\"\>", {-0.26033024347053496, -0.5405813207414514}], 
    InsetBox["\<\"5\"\>", {0.26033024347053474, -0.5405813207414515}], 
    InsetBox["\<\"6\"\>", {0.5849567473090941, -0.13351256037378878}], 
    InsetBox["\<\"7\"\>", {0.4690988894808179, 0.37409388111524}]}}]], \
"Output",
 CellChangeTimes->{
  3.743515913654375*^9, 3.743515984397201*^9, {3.780595422793939*^9, 
   3.780595444515818*^9}, 3.78059625072996*^9, 3.78059684567383*^9, {
   3.780626641645639*^9, 3.7806266681227617`*^9}, 3.799342000872138*^9, 
   3.799342076068368*^9, {3.799348796814479*^9, 3.799348805649218*^9}, 
   3.799349513498645*^9},
 CellLabel->
  "Out[290]=",ExpressionUUID->"d37150b2-f480-466f-ab29-2b890793dac7"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Region 8", "Subsubsection",
 CellChangeTimes->{{3.801161326727272*^9, 
  3.8011613283976917`*^9}},ExpressionUUID->"84eca0d7-0c30-4a0f-a8be-\
a30fe0091af3"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"From", " ", "SaarEric5820", 
   RowBox[{".1", ".", "nb"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.801161373795663*^9, 3.801161402163559*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"9e8db104-d5db-4802-aa59-3dad60dfb2c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"region", "=", 
   GraphicsBox[
    TagBox[
     DynamicModuleBox[{Typeset`mesh = HoldComplete[
       BoundaryMeshRegion[{{-3.6799999999999997`, -3.6799999999999997`}, {
        4.23, -3.9699999999999998`}, {4.210000000000001, 
        4.700000000000001}, {-4.32, 
        4.390000000000001}, {-0.3200000000000003, -0.4299999999999997}, {
        0.9199999999999999, -0.45999999999999996`}, {
        1.8200000000000003`, -2.2199999999999998`}, {0., -2.}, {-3.09, 
        0.6600000000000001}, {-0.6399999999999997, 
        2.0600000000000005`}, {-2.1, 2.8500000000000005`}, {-2.89, 
        2.3500000000000005`}, {1.5200000000000005`, 3.6500000000000004`}, {
        1.1400000000000006`, 2.0700000000000003`}, {3., 2.}, {3., 3.}}, {
         Line[{{1, 2}, {2, 3}, {3, 4}, {4, 1}}]}, {
         Line[{{5, 8}, {8, 7}, {7, 6}, {6, 5}}]}, {
         Line[{{12, 9}, {9, 10}, {10, 11}, {11, 12}}]}, {
         Line[{{13, 14}, {14, 15}, {15, 16}, {16, 13}}]}, 
        Method -> {
         "EliminateUnusedCoordinates" -> True, "DeleteDuplicateCoordinates" -> 
          Automatic, "DeleteDuplicateCells" -> Automatic, "VertexAlias" -> 
          Identity, "CheckOrientation" -> Automatic, "CoplanarityTolerance" -> 
          Automatic, "CheckIntersections" -> Automatic, 
          "BoundaryNesting" -> {{0, 0}, {1, 1}, {1, 1}, {1, 1}}, 
          "SeparateBoundaries" -> False, "TJunction" -> Automatic, 
          "PropagateMarkers" -> True, "ZeroTest" -> Automatic, "Hash" -> 
          8484320165349681806}]]}, 
      TagBox[
       GraphicsComplexBox[{{-3.6799999999999997`, -3.6799999999999997`}, {
        4.23, -3.9699999999999998`}, {4.210000000000001, 
        4.700000000000001}, {-4.32, 
        4.390000000000001}, {-0.3200000000000003, -0.4299999999999997}, {
        0.9199999999999999, -0.45999999999999996`}, {
        1.8200000000000003`, -2.2199999999999998`}, {0., -2.}, {-3.09, 
        0.6600000000000001}, {-0.6399999999999997, 
        2.0600000000000005`}, {-2.1, 2.8500000000000005`}, {-2.89, 
        2.3500000000000005`}, {1.5200000000000005`, 3.6500000000000004`}, {
        1.1400000000000006`, 2.0700000000000003`}, {3., 2.}, {3., 3.}}, 
        {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
         TagBox[
          FilledCurveBox[{{Line[{1, 2, 3, 4}]}, {Line[{5, 8, 7, 6}]}, {
            Line[{12, 9, 10, 11}]}, {Line[{13, 14, 15, 16}]}}],
          Annotation[#, "Geometry"]& ]}],
       MouseAppearanceTag["LinkHand"]],
      AllowKernelInitialization->False],
     "MeshGraphics",
     AutoDelete->True,
     Editable->False,
     Selectable->False],
    DefaultBaseStyle->{
     "MeshGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.1, 1, 0.7]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.801161347375094*^9, 3.801161371206667*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"ed480afc-666c-45ba-ab92-e974b15bfc01"],

Cell[BoxData[
 RowBox[{
  RowBox[{"regionVertices", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "3.6799999999999997`"}], ",", 
       RowBox[{"-", "3.6799999999999997`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4.23`", ",", 
       RowBox[{"-", "3.9699999999999998`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4.210000000000001`", ",", "4.700000000000001`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4.32`"}], ",", "4.390000000000001`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.3200000000000003`"}], ",", 
       RowBox[{"-", "0.4299999999999997`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.9199999999999999`", ",", 
       RowBox[{"-", "0.45999999999999996`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.8200000000000003`", ",", 
       RowBox[{"-", "2.2199999999999998`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", 
       RowBox[{"-", "2.`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "3.09`"}], ",", "0.6600000000000001`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.6399999999999997`"}], ",", "2.0600000000000005`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2.1`"}], ",", "2.8500000000000005`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2.89`"}], ",", "2.3500000000000005`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.5200000000000005`", ",", "3.6500000000000004`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.1400000000000006`", ",", "2.0700000000000003`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3.`", ",", "2.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3.`", ",", "3.`"}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.801164353253277*^9, 3.801164367073915*^9}, {
  3.801164663913837*^9, 3.801164676948454*^9}, {3.801324359063532*^9, 
  3.8013243598958483`*^9}},
 CellLabel->
  "In[152]:=",ExpressionUUID->"c9eb842f-3902-4b9f-9344-63b8a0d6e27d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"exteriorVertices", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"interiorVerticesByHole", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "6", ",", "7", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "10", ",", "11", ",", "12"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"13", ",", "14", ",", "15", ",", "16"}], "}"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.801164454737008*^9, 3.801164459567786*^9}, {
  3.801164639445409*^9, 3.801164652938285*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"8eaf1c6a-0cd3-4b80-99b6-6de104592716"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nHoles", "=", 
   RowBox[{"Length", "[", "interiorVerticesByHole", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.801164592427204*^9, 3.8011645976080523`*^9}, 
   3.801164688873568*^9},
 CellLabel->
  "In[155]:=",ExpressionUUID->"fcb77d7b-7395-425f-8327-4108ccb4b714"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"pointsInHoles", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Mean", "[", 
        RowBox[{"Sbound1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
       RowBox[{"Mean", "[", 
        RowBox[{"Sbound2", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
       RowBox[{"Mean", "[", 
        RowBox[{"Sbound3", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"pointsInHoles", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.605`", ",", 
         RowBox[{"-", "1.2774999999999999`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2.18`"}], ",", "1.9800000000000004`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2.165`", ",", "2.68`"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"omega0Seq", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Sbound1", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "3"}], "]"}], "]"}], "-", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0.2"}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"Sbound2", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0.2"}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"Sbound3", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "3"}], "]"}], "]"}], "-", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0.2"}], "}"}]}]}], "}"}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"omega0Seq", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1.8200000000000003`", ",", 
         RowBox[{"-", "2.42`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3.09`"}], ",", "0.46000000000000013`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3.`", ",", "1.8`"}], "}"}]}], "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.801163836770679*^9, 3.801163926571146*^9}, {
  3.801163968593173*^9, 3.8011640059754963`*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"407413f4-09f9-43bf-9d2f-b90190ad84c9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.80116393848991*^9, 3.8011639386649313`*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"21e05149-e999-4bc0-836c-92e1e587e4af"],

Cell[BoxData[
 GraphicsBox[{
   GraphicsComplexBox[{{-3.6799999999999997`, -3.6799999999999997`}, {
    4.23, -3.9699999999999998`}, {4.210000000000001, 
    4.700000000000001}, {-4.32, 
    4.390000000000001}, {-0.3200000000000003, -0.4299999999999997}, {
    0.9199999999999999, -0.45999999999999996`}, {
    1.8200000000000003`, -2.2199999999999998`}, {0., -2.}, {-3.09, 
    0.6600000000000001}, {-0.6399999999999997, 2.0600000000000005`}, {-2.1, 
    2.8500000000000005`}, {-2.89, 2.3500000000000005`}, {1.5200000000000005`, 
    3.6500000000000004`}, {1.1400000000000006`, 2.0700000000000003`}, {3., 
    2.}, {3., 3.}}, 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     TagBox[
      FilledCurveBox[{{Line[{1, 2, 3, 4}]}, {Line[{5, 8, 7, 6}]}, {
        Line[{12, 9, 10, 11}]}, {Line[{13, 14, 15, 16}]}}],
      Annotation[#, "Geometry"]& ]}], 
   {RGBColor[1, 0, 0], PointBox[{0.605, -1.2774999999999999`}]}, 
   {RGBColor[1, 0, 0], PointBox[{-2.18, 1.9800000000000004`}]}, 
   {RGBColor[1, 0, 0], PointBox[{2.165, 2.68}]}, 
   {RGBColor[0, 1, 0], PointBox[{1.8200000000000003`, -2.42}]}, 
   {RGBColor[0, 1, 0], PointBox[{-3.09, 0.46000000000000013`}]}, 
   {RGBColor[0, 1, 0], PointBox[{3., 1.8}]}}]], "Output",
 CellChangeTimes->{3.801163939056321*^9, 3.801164008095562*^9, 
  3.801246458059664*^9, 3.801324208789309*^9, 3.8013243652603483`*^9, 
  3.803690491603732*^9, 3.809373969823373*^9, 3.809379168100909*^9, 
  3.809383749718177*^9, 3.809392646470625*^9, 3.809446126686679*^9},
 CellLabel->
  "Out[158]=",ExpressionUUID->"fcdf1601-46f7-4c23-81d6-58472cec140e"]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Test Main for Genus 1 Examples", "Section"]], \
"Section",
 CellChangeTimes->{{3.750086964229536*^9, 3.750086965292103*^9}, {
  3.766935824893497*^9, 
  3.7669358284781113`*^9}},ExpressionUUID->"f0b723d7-8119-4c62-9d49-\
00b5482a1b6a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"refinementLevel", "=", "2"}], ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwlxT1IQmEUAFAVAiUHCWsyfIqFETRU7j2DEExJCZWkoiKIkIQCCUmMaCka
pE0IlSSiSArRQEWRyJDoh0ISTM1SKFBLEhuEoO/ehsMRzZq18ywGgyEgYHap
Tx6slenrwB5u7Dp4C5NN1QBuYXLf4fG6Ej9qKVARsvihiG/uqpSwKx9Sw5f3
ic7+epmufKZx8cqQDB5Ma3H5sM02QJ5QrOPeWPsdPCIS4oyU3yAj600hvM2g
7uUwK7TQMYZbWY+Kc16F1iWf8Cm94eWZLI3s4B3+kDFLrjVj+KipcQLbVT0+
ONZNZeCFLV0OznDdDVgQ9+Ba7m0TvnFO/sJe6kySI6eEfpy9EVXB/O0LvFAM
a2D1YQy3zLATcFjiTcKr39XWPJk6/sJrhYwUnnNm/59eWoQ/HGZ8+cpjh1Py
fTzu47jg02zQDUdfk1YNv0KXfnhr8B9VifBP
  "],
 CellLabel->
  "In[156]:=",ExpressionUUID->"f8cffd12-2590-48e1-a2f6-8f7ae5bec112"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "regionSkeleton", ",", "T", ",", "f", ",", "Lambda", ",", "LambdaGraph", 
     ",", "GSBValuesExtended", ",", "phiValuesExtended", ",", 
     "interiorNonslitTriangles", ",", "interpolatedGSBValueMeshExtended", ",",
      "h2", ",", "newPoints", ",", "cleaned", ",", "radius", ",", 
     "slitVertices"}], "}"}], "=", 
   RowBox[{"Main", "[", 
    RowBox[{
    "region", ",", "regionVertices", ",", "interiorVerticesByHole", ",", 
     "exteriorVertices", ",", "nHoles", ",", "pointsInHoles", ",", 
     "omega0Seq", ",", "refinementLevel", ",", " ", "False"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.750078987235818*^9, 3.750078988073586*^9}, {
   3.750079092249254*^9, 3.75007909386707*^9}, {3.750086240995222*^9, 
   3.750086242983272*^9}, {3.7500866553588953`*^9, 3.750086661260998*^9}, {
   3.7500889728867817`*^9, 3.75008898992461*^9}, 3.7500890500622272`*^9, {
   3.7500892675399323`*^9, 3.750089269213202*^9}, {3.750089333575735*^9, 
   3.7500893347270813`*^9}, {3.7500898051914682`*^9, 3.750089806675062*^9}, {
   3.7513860050222607`*^9, 3.751386006437129*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"8f0629c7-6347-4832-813a-7cab746230f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"h", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"i", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "1", ",", ".05"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.750089735177541*^9, 3.7500897354556932`*^9}, 
   3.750089766449644*^9},
 CellLabel->
  "In[158]:=",ExpressionUUID->"24d95e43-d828-490b-8e15-201ef0eb586e"],

Cell[BoxData[
 RowBox[{"GraphicsGrid", "[", 
  RowBox[{"{", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LinearSplineLevelCurves2D", "[", 
        RowBox[{
         RowBox[{"T", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"Delete", "[", 
            RowBox[{
             RowBox[{"T", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], ",", "0"}], "]"}], 
           "]"}], "&"}], " ", ",", " ", "h", ",", " ", 
         RowBox[{"T", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\"\<AvocadoColors\>\"", 
         ",", " ", "Transparent"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Graphics", "/@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"regionSkeleton", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], "&"}], ",", 
          RowBox[{"regionSkeleton", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
          RowBox[{"{", "2", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"LinearSplineLevelCurves2D", "[", 
        RowBox[{"interiorNonslitTriangles", ",", " ", 
         RowBox[{
          RowBox[{"interpolatedGSBValueMeshExtended", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "&"}], ",", " ", "h2", ",", " ", 
         RowBox[{"T", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\"\<CandyColors\>\"", 
         ",", "  ", 
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.84", ",", "0.84", ",", "0.84"}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Graphics", "/@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"regionSkeleton", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], "&"}], ",", 
          RowBox[{"regionSkeleton", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
          RowBox[{"{", "2", "}"}]}], "]"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"LinearSplineLevelCurves2D", "[", 
        RowBox[{"interiorNonslitTriangles", ",", " ", 
         RowBox[{
          RowBox[{"interpolatedGSBValueMeshExtended", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "&"}], ",", " ", "h2", ",", " ", 
         RowBox[{"T", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\"\<CandyColors\>\"", 
         ",", " ", "Transparent"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"LinearSplineLevelCurves2D", "[", 
        RowBox[{
         RowBox[{"T", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"Delete", "[", 
            RowBox[{
             RowBox[{"T", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], ",", "0"}], "]"}], 
           "]"}], "&"}], " ", ",", " ", "h", ",", " ", 
         RowBox[{"T", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\"\<AvocadoColors\>\"", 
         ",", " ", "Transparent"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Graphics", "/@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"regionSkeleton", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], "&"}], ",", 
          RowBox[{"regionSkeleton", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
          RowBox[{"{", "2", "}"}]}], "]"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "}"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.733668552992518*^9, 3.7336685820139647`*^9}, {
   3.733668622678598*^9, 3.733668662059663*^9}, {3.733743734456108*^9, 
   3.733743740556603*^9}, {3.733743838618285*^9, 3.733743854080759*^9}, {
   3.733743885041329*^9, 3.733743888303382*^9}, {3.733743938871714*^9, 
   3.7337439396860113`*^9}, {3.733743984452228*^9, 3.7337440159935226`*^9}, {
   3.733744373782214*^9, 3.7337444174905167`*^9}, {3.733744468856512*^9, 
   3.7337444938562737`*^9}, 3.734091156395405*^9, {3.735420016153471*^9, 
   3.735420016176614*^9}, {3.735656866916383*^9, 3.7356568706975403`*^9}, {
   3.750088827975836*^9, 3.750088956958353*^9}, {3.750089091663211*^9, 
   3.750089093789413*^9}, {3.750126100577346*^9, 3.750126102524624*^9}},
 CellLabel->
  "In[159]:=",ExpressionUUID->"84851f28-ba6f-493f-ac94-589413a26365"],

Cell[BoxData[
 RowBox[{"Show2Skeleton", "[", "T", "]"}]], "Input",
 CellChangeTimes->{{3.766935781706234*^9, 3.7669357864229507`*^9}},
 CellLabel->
  "In[342]:=",ExpressionUUID->"de078f73-7694-44d4-ae26-9395df62d5fb"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "radius"}], ",", " ", "radius"}], "}"}], ",", " ", 
     RowBox[{"PlotRange", "\[Rule]", "radius"}], ",", " ", 
     RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}], ",", 
   RowBox[{"ListPlot", "[", "newPoints", "]"}], ",", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{"Red", ",", " ", 
         RowBox[{"PointSize", "[", ".008", "]"}], ",", " ", "#"}], "}"}], 
       "]"}], "&"}], " ", "/@", " ", 
     RowBox[{"Point", "/@", 
      RowBox[{"newPoints", "[", 
       RowBox[{"[", "slitVertices", "]"}], "]"}]}]}], " ", "]"}]}], " ", 
  "]"}]], "Input",
 CellChangeTimes->{{3.750089309986261*^9, 3.7500893762784557`*^9}, {
  3.750089505887411*^9, 3.7500895098714437`*^9}},
 CellLabel->
  "In[343]:=",ExpressionUUID->"2a89485d-dece-49a9-b65b-c068a8d640ae"]
}, Closed]],

Cell[CellGroupData[{

Cell["Import Triangulation Data from Julia", "Section",
 CellChangeTimes->{{3.8091312212956543`*^9, 
  3.8091312293253736`*^9}},ExpressionUUID->"ce79603b-0909-4f3f-b6ce-\
9740c8e4f714"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "fullFileStem", "=", 
   "\"\</Users/eric/Code/combinatorial-topology/regions/ex_3\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8487500743701267`*^9, 3.848750074473227*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"8881e4bc-7329-430f-b788-c74691953045"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "regionVertices", ",", "regionBdryMarkers", ",", "regionEdges", ",", 
     "pointsInHoles", ",", "coordinates", ",", "bdryMarkers", ",", 
     "triangles", ",", "triangulationTopology"}], "}"}], "=", 
   RowBox[{"readData", "[", "fullFileStem", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.848705158457507*^9, {3.848705414582437*^9, 3.848705416953987*^9}, 
   3.848710219450378*^9, 3.848710550988701*^9, 3.848711297570191*^9},
 CellLabel->
  "In[165]:=",ExpressionUUID->"cb3ddc6f-4eca-4503-906a-7122d838dea2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "exteriorVertices", ",", "interiorVerticesByHole", ",", "region", ",", 
     "regionSkeleton", ",", "nHoles", ",", "nClasses", ",", "omega0Seq"}], 
    "}"}], "=", 
   RowBox[{"makeRegionData", "[", 
    RowBox[{
    "regionVertices", ",", "regionEdges", ",", "pointsInHoles", ",", "5"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.84871070057938*^9, 3.848710722668551*^9}, {
   3.848710878851927*^9, 3.848710879480299*^9}, 3.848711136114567*^9, {
   3.848711840460185*^9, 3.848711840705735*^9}, 3.848711883639531*^9, 
   3.848711977338539*^9, {3.8487120220945263`*^9, 3.848712031371373*^9}, {
   3.8487441773897753`*^9, 3.8487441875535297`*^9}, {3.8487500831415577`*^9, 
   3.8487500854830914`*^9}},
 CellLabel->
  "In[166]:=",ExpressionUUID->"af2a9886-d912-4f57-a4a2-91ef2cd06d57"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Line-by-Line Function Version for Genus n Examples", \
"Section"]], "Section",
 CellChangeTimes->{{3.751389913834941*^9, 3.7513899167851562`*^9}, {
   3.766935813160796*^9, 3.7669358193344307`*^9}, {3.780339626744426*^9, 
   3.780339626823007*^9}, {3.780509742792459*^9, 3.7805097443455048`*^9}, {
   3.780549192460553*^9, 3.780549198929305*^9}, {3.780550066749069*^9, 
   3.7805500669377203`*^9}, 
   3.780594273272541*^9},ExpressionUUID->"6c669723-35c0-4499-8e5c-\
22cbe2e036ff"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "pointsInHoles"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
    RowBox[{"Point", "/@", "omega0Seq"}]}]}], "]"}]], "Input",
 CellLabel->
  "In[604]:=",ExpressionUUID->"c7f01c73-c6d7-4c5f-bf9c-177fca81cf0e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Triangulate", " ", "using", " ", "imported", " ", "data", " ", "from", 
    " ", "Julia", " ", "program", " ", 
    RowBox[{"TriVor", ".", "jl"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"showImages", "=", "True"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "1", ",", ".01"}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T", "=", 
     RowBox[{"{", 
      RowBox[{"coordinates", ",", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"EdgesWrapCompiled", "/@", "triangles"}], "]"}], ",", "2"}],
         "]"}], ",", "triangles"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"[", "2", "]"}], "]"}], " ", "=", " ", 
     RowBox[{"Union", "[", 
      RowBox[{"Sort", "/@", 
       RowBox[{"T", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], " ", "]"}]}], ";"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Remove", " ", "duplicated", " ", "edges"}], " ", "*)"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.809374276495113*^9, 3.809374350288641*^9}, 
   3.80937444962897*^9, {3.809379155561957*^9, 3.8093791561835012`*^9}, {
   3.809382900436819*^9, 3.809382901278199*^9}, 3.810569991448185*^9, {
   3.8487054406588*^9, 3.8487054775720243`*^9}, {3.848744199754854*^9, 
   3.848744200361804*^9}, {3.848750109293421*^9, 3.848750110548099*^9}, {
   3.8487504372539997`*^9, 3.848750440263257*^9}},
 CellLabel->
  "In[605]:=",ExpressionUUID->"fbe3e047-4952-4ae6-beb2-22b9a2237ed8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Triangulate", " ", "OLD", " ", "METHOD"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"showImages", "=", "True"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"refinementLevel", "=", "3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "1", ",", ".025"}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TUnrefined", "=", 
     RowBox[{"AcuteTriangulate", "[", 
      RowBox[{"region", ",", "pointsInHoles"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T", "=", 
     RowBox[{"Nest", "[", 
      RowBox[{
      "RefineTriangulation", ",", "TUnrefined", ",", "refinementLevel"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"[", "2", "]"}], "]"}], " ", "=", " ", 
     RowBox[{"Union", "[", 
      RowBox[{"Sort", "/@", 
       RowBox[{"T", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], " ", "]"}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"Remove", " ", "duplicated", " ", "edges"}], " ", "*)"}], 
    RowBox[{"regionSkeleton", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MeshCoordinates", "[", "region", "]"}], ",", " ", 
       RowBox[{"MeshCells", "[", 
        RowBox[{"region", ",", "1"}], "]"}]}], "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.751389924662174*^9, {3.763472152701272*^9, 3.763472153078126*^9}, {
   3.7634722320841637`*^9, 3.7634722324016743`*^9}, {3.763477136527197*^9, 
   3.763477139230693*^9}, {3.7634771764133377`*^9, 3.763477176484932*^9}, {
   3.763477761256236*^9, 3.763477761299532*^9}, {3.7639047123034763`*^9, 
   3.763904712363121*^9}, {3.766847616181176*^9, 3.766847616213182*^9}, {
   3.766848468846653*^9, 3.7668484689390163`*^9}, {3.766853566648645*^9, 
   3.7668535667587147`*^9}, {3.766858316296488*^9, 3.76685831644009*^9}, {
   3.766860280740123*^9, 3.766860280826981*^9}, {3.76686212550126*^9, 
   3.76686212557036*^9}, {3.769554109260277*^9, 3.769554109849647*^9}, {
   3.78033963712882*^9, 3.780339645373907*^9}, 3.780361745015895*^9, {
   3.780366656211787*^9, 3.780366656365735*^9}, {3.780550807877892*^9, 
   3.780550807961783*^9}, {3.78059688080956*^9, 3.780596880921817*^9}, {
   3.78062371083582*^9, 3.780623710896503*^9}, {3.780626397010816*^9, 
   3.78062639708282*^9}, {3.799342007599978*^9, 3.799342007622583*^9}, {
   3.801164085751362*^9, 3.8011640922279263`*^9}, {3.801164304902722*^9, 
   3.8011643049891863`*^9}, {3.801172959861598*^9, 3.801172992353188*^9}, {
   3.801174853847436*^9, 3.8011748539098463`*^9}, {3.8012464537447567`*^9, 
   3.801246466361779*^9}, 3.8012536735501423`*^9, {3.801267955695413*^9, 
   3.801267955778759*^9}, {3.803690506692059*^9, 3.803690506981124*^9}, 
   3.803692509166399*^9, {3.809374266450582*^9, 3.8093742710905037`*^9}, 
   3.810569994387724*^9, {3.810571112372542*^9, 3.810571112982943*^9}, 
   3.848711268125836*^9},
 CellLabel->
  "In[606]:=",ExpressionUUID->"7ae43432-6220-41f6-b89b-98226f7a174b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"showImages", ",", 
   RowBox[{"Show2Skeleton", "[", "T", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.763906416251609*^9, 3.763906419856633*^9}, {
   3.763907059664982*^9, 3.7639070606623*^9}, {3.766841780045195*^9, 
   3.766841783102709*^9}, {3.76684710563834*^9, 3.766847109199883*^9}, {
   3.766847988927327*^9, 3.766847998693844*^9}, 3.7668484712425833`*^9, 
   3.766852731576545*^9, {3.7668535717980413`*^9, 3.7668535788559237`*^9}, {
   3.766857876741383*^9, 3.766857888279934*^9}, 3.76686028369954*^9, 
   3.766866243730028*^9, 3.766929556324883*^9, {3.801172995195056*^9, 
   3.801173009936096*^9}, {3.801173670229813*^9, 3.801173696843617*^9}, {
   3.801267956980266*^9, 3.801267960388623*^9}, 3.809381944325441*^9},
 CellLabel->
  "In[148]:=",ExpressionUUID->"63b9b634-42ab-48a9-b883-f371e4be2c1c"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"coordinates", ",", 
   RowBox[{"Flatten", "[", "]"}], ",", "triangles"}], "]"}]], "Output",
 CellChangeTimes->{3.8667710314949083`*^9, 3.8668902670126553`*^9, 
  3.867458456621971*^9},
 CellLabel->
  "Out[148]=",ExpressionUUID->"2334e712-b8a1-49cc-abdf-8a619151b96f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"showImages", ",", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"VoronoiMesh", "[", 
      RowBox[{"T", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
     RowBox[{"Show2Skeleton", "[", "T", "]"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.803690520459116*^9, 3.8036905234368277`*^9}, {
  3.803690605969891*^9, 3.803690619529677*^9}, {3.809381937902501*^9, 
  3.80938194271883*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"71dacd8c-96e0-4355-aa3f-246cbd861715"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Compute", " ", "f"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"triangulationTopology", "=", 
     RowBox[{"BuildTriangulationTopologyNDLUACompiled", "[", 
      RowBox[{"T", "[", 
       RowBox[{"[", "3", "]"}], "]"}], " ", "]"}]}], ";"}], "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"triangulationTopology", "=", "topologyImported"}], ";"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "interiorEdgesOrientedTriangulation", ",", 
       "boundaryEdgesOrientedTriangulation"}], "}"}], "=", 
     RowBox[{"InteriorAndBoundaryEdges", "[", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", "triangulationTopology"}], 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"eMesh", "=", 
     RowBox[{"ToElementMesh", "[", 
      RowBox[{
       RowBox[{"\"\<Coordinates\>\"", "\[Rule]", 
        RowBox[{"T", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"\"\<MeshElements\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"TriangleElement", "[", 
          RowBox[{"T", "[", 
           RowBox[{"[", "3", "]"}], "]"}], " ", "]"}], "}"}]}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.751389924662174*^9, 3.751389947057588*^9}, {
   3.799342090896118*^9, 3.799342100206428*^9}, 3.7993488456208067`*^9, {
   3.809381959784075*^9, 3.809381978445751*^9}, {3.81057001571688*^9, 
   3.81057003003123*^9}, {3.848711288300694*^9, 3.84871130146749*^9}},
 CellLabel->
  "In[174]:=",ExpressionUUID->"67e3d0fb-2c44-4184-b8e4-a11d531df6cd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"exteriorBoundary", " ", "=", " ", 
   RowBox[{"Line", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"regionVertices", "[", 
       RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", " ", 
     RowBox[{"Append", "[", 
      RowBox[{"exteriorVertices", ",", 
       RowBox[{"exteriorVertices", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}]}], " ", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"interiorBoundaries", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"regionVertices", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", " ", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"interiorVerticesByHole", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"interiorVerticesByHole", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}]}], " ", "]"}]}], " ", "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[CapitalGamma]1", "=", 
   RowBox[{"DirichletCondition", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"x", ",", "y"}], "]"}], " ", "\[Equal]", " ", "1"}], ",", " ", 
     RowBox[{
      RowBox[{"RegionDistance", "[", 
       RowBox[{"exteriorBoundary", ",", " ", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}]}], "]"}], " ", "<", " ", 
      RowBox[{"1", "*", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"-", "5"}], ")"}]}]}]}]}], "]"}]}], ";", 
  RowBox[{"\[CapitalGamma]2", "=", 
   RowBox[{"DirichletCondition", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"x", ",", "y"}], "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"RegionDistance", "[", 
          RowBox[{"#", ",", " ", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}]}], "]"}], "&"}], "/@", 
        "interiorBoundaries"}], "]"}], " ", "<", " ", 
      RowBox[{"1", "*", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"-", "5"}], ")"}]}]}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.751389924662174*^9, 3.751389947057588*^9}, {
   3.799342090896118*^9, 3.7993421448798933`*^9}, {3.801164469061788*^9, 
   3.801164473563603*^9}, 3.8011646965128107`*^9, {3.801164746513996*^9, 
   3.801164756237084*^9}},
 CellLabel->
  "In[176]:=",ExpressionUUID->"53e8e83c-98d6-432e-8425-baadf2b1aa55"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f", "=", 
   RowBox[{"NDSolveValue", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Laplacian", "[", 
          RowBox[{
           RowBox[{"u", "[", 
            RowBox[{"x", ",", "y"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], "\[Equal]", "0"}], ",",
        "\[CapitalGamma]1", ",", "\[CapitalGamma]2"}], " ", "}"}], ",", "u", 
     ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "eMesh"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fValues", "=", 
   RowBox[{"f", "@@@", 
    RowBox[{"T", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.751389924662174*^9, 3.751389947057588*^9}, {
  3.799342090896118*^9, 3.7993421585780783`*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"300870c9-7188-46e0-bfb2-f30184059c1b"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"showImages", ",", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"LinearSplineLevelCurves2D", "[", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"Delete", "[", 
          RowBox[{
           RowBox[{"T", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], ",", "0"}], "]"}], 
         "]"}], "&"}], " ", ",", " ", "h", ",", " ", 
       RowBox[{"T", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\"\<AvocadoColors\>\"", 
       ",", " ", "Transparent"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Graphics", "/@", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"regionSkeleton", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], "&"}], ",", 
        RowBox[{"regionSkeleton", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
        RowBox[{"{", "2", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.766852974389934*^9, 3.7668579484166107`*^9, {3.8011730168948927`*^9, 
   3.8011730247508698`*^9}, 3.801173702467009*^9, {3.809383787205062*^9, 
   3.809383787555723*^9}, {3.809384100535952*^9, 3.809384131513146*^9}, {
   3.809392661430949*^9, 3.809392662461821*^9}, {3.809393228531723*^9, 
   3.809393229708243*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"b5635eb8-f280-46e1-b385-25b07a035a2b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Construct", " ", "Lambda"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Lambda", "=", 
    RowBox[{"BuildLambda", "[", 
     RowBox[{
     "T", ",", "exteriorVertices", ",", "interiorVerticesByHole", ",", 
      "regionVertices"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.751389924662174*^9, 3.751389947057588*^9}, 
   3.751390088929863*^9, {3.7668487821399603`*^9, 3.7668487838644753`*^9}, {
   3.7668530839740553`*^9, 3.7668530899081507`*^9}, 3.7668583288662148`*^9, {
   3.780511194480961*^9, 3.780511215662053*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"8f44f503-fe0c-42d6-8262-266d2d5f4e24"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Compute", " ", "contained", " ", "vertices", " ", "and", " ", "contained",
     " ", "faces"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rmf", "=", 
     RowBox[{"RegionMember", "[", "region", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"containedVerticesIndicator", "=", 
     RowBox[{"rmf", "/@", 
      RowBox[{"Lambda", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"containedVertices", "=", 
     RowBox[{"Pick", "[", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", 
         RowBox[{"Lambda", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
       "containedVerticesIndicator"}], "]"}]}], ";"}], "\n", 
   RowBox[{"If", "[", 
    RowBox[{"showImages", ",", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"Show2Skeleton", "[", 
        RowBox[{"Lambda", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"containedVertices", ",", 
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", "}"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Graphics", "/@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"regionSkeleton", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], "&"}], ",", 
          RowBox[{"regionSkeleton", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
          RowBox[{"{", "2", "}"}]}], "]"}]}]}], "]"}]}], "]"}], "\n", 
   RowBox[{
    RowBox[{"containedFaces", "=", 
     RowBox[{"ContainedFaces", "[", 
      RowBox[{
       RowBox[{"Lambda", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", "containedVertices"}], "]"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"paddedPolygons", "=", 
     RowBox[{"PadPolygonsToMatrix", "[", 
      RowBox[{"Lambda", "[", 
       RowBox[{"[", "3", "]"}], "]"}], " ", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"toRightOfEdgeTriAssociation", "=", 
     RowBox[{"BuildEdgeToRightTriangulationAssociation", "[", 
      RowBox[{"T", "[", 
       RowBox[{"[", "3", "]"}], "]"}], " ", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"toRightOfEdgePolyAssociation", "=", 
     RowBox[{
     "BuildEdgeToRightPolygonsAssociation", "[", "paddedPolygons", "]"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"conductanceAssociation", "=", 
     RowBox[{"BuildConductanceAssociation", "[", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       "interiorEdgesOrientedTriangulation", ",", 
       "toRightOfEdgeTriAssociation", ",", 
       RowBox[{"T", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7669315949015913`*^9, 3.766931628235836*^9}, 
   3.766931830148384*^9, {3.780511228319994*^9, 3.780511240045373*^9}, 
   3.780597027127305*^9, {3.787942658760036*^9, 3.787942660320883*^9}, 
   3.799342290858444*^9, 3.799343582687867*^9, 3.799349050288896*^9, {
   3.801173576183984*^9, 3.801173580717667*^9}, 3.801173709924103*^9},
 CellLabel->
  "In[183]:=",ExpressionUUID->"bd479ab5-8b22-426e-85cc-cb5687f31e66"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Build", " ", "the", " ", "Lambda", " ", "graph"}], " ", "*)"}], 
  "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"LambdaGraph", ",", "omega0n", ",", "slitVertices"}], "}"}], "=",
     "\[IndentingNewLine]", 
    RowBox[{"BuildSlittedWeightedVoronoiGraph", "[", 
     RowBox[{"Lambda", ",", "containedVertices", ",", "containedFaces", ",", 
      RowBox[{"omega0Seq", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"pointsInHoles", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "toRightOfEdgePolyAssociation"}], 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.799343623589757*^9, 3.799343631414572*^9}, 
   3.810571971582855*^9},
 CellLabel->
  "In[192]:=",ExpressionUUID->"7bd737c9-f36d-4601-9600-1c6aac77d024"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Find", " ", "singular", " ", "level", " ", "curves", " ", "and", " ", 
    "partition", " ", "region"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"boundaryVertices", "=", 
     RowBox[{"Union", "[", 
      RowBox[{"Flatten", "[", "boundaryEdgesOrientedTriangulation", "]"}], 
      " ", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"interiorVertices", "=", 
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", 
         RowBox[{"T", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], " ", "]"}], ",", 
       "boundaryVertices"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"vertexTopology", "=", 
     RowBox[{"VertexTopologyBuilderCompiled", "[", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"T", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], ",", 
       RowBox[{"T", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], " ", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.751390320098461*^9, 3.7513903333216677`*^9}, 
   3.7513908116456614`*^9},
 CellLabel->
  "In[193]:=",ExpressionUUID->"e78dd254-fe82-468e-95d0-597bcbe1547a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"indexFunctionValues", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"IndexFunction", "[", 
      RowBox[{"#", ",", "vertexTopology", ",", 
       RowBox[{"T", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}], "&"}], "/@", 
    "interiorVertices"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.760909754206571*^9, {3.780509986581761*^9, 3.780509992396091*^9}},
 CellLabel->
  "In[196]:=",ExpressionUUID->"da5756a9-bb08-4398-8213-a8aaff391d28"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"singularVerticesInd", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Position", "[", 
     RowBox[{"indexFunctionValues", ",", 
      RowBox[{"x_", "/;", 
       RowBox[{"x", "\[NotEqual]", "2"}]}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nSingularVertices", "=", 
   RowBox[{"Length", "[", "singularVerticesInd", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"singularVertices", "=", 
   RowBox[{"interiorVertices", "[", 
    RowBox[{"[", "singularVerticesInd", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.751390947850152*^9, 3.751391044414599*^9}, 
   3.751391532956983*^9, {3.780510030596545*^9, 3.7805100359770184`*^9}},
 CellLabel->
  "In[197]:=",ExpressionUUID->"d096a26a-a95c-40ea-979b-8bb4d79f1e2c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"singularHeights", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"f", "@@@", 
     RowBox[{"T", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "singularVertices"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nSingularHeights", "=", 
   RowBox[{"Length", "[", "singularHeights", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.751391966848287*^9, 3.751391988913763*^9}, 
   3.7514998279902554`*^9, {3.761006255756963*^9, 3.761006258218206*^9}, {
   3.780372528085498*^9, 3.7803725342017803`*^9}, {3.780510921099852*^9, 
   3.780510931428186*^9}},
 CellLabel->
  "In[200]:=",ExpressionUUID->"15fd2fc3-a3ba-4e0f-874e-52d05d5ecbf5"],

Cell[CellGroupData[{

Cell[BoxData["singularHeights"], "Input",
 CellLabel->
  "In[202]:=",ExpressionUUID->"eae05402-2aaa-48d8-bf55-c4b5ece6eea6"],

Cell[BoxData[
 RowBox[{"{", "0.040943824183886424`", "}"}]], "Output",
 CellChangeTimes->{3.8487510820596523`*^9, 3.8667719571139717`*^9},
 CellLabel->
  "Out[202]=",ExpressionUUID->"d4d284b4-1bf5-44b8-b392-40be4aab7fdb"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TriLevelSets", "[", 
    RowBox[{"#", ",", " ", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"Delete", "[", 
        RowBox[{
         RowBox[{"T", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], ",", "0"}], "]"}], 
       "]"}], "&"}], ",", " ", 
     RowBox[{"singularHeights", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"T", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], "/@", " ", 
  RowBox[{"T", "[", 
   RowBox[{"[", "3", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.86686007485176*^9, 3.8668600932336483`*^9}, {
  3.866860216472748*^9, 3.866860220743979*^9}, {3.866860367848846*^9, 
  3.866860377620652*^9}},
 CellLabel->
  "In[247]:=",ExpressionUUID->"96ea015a-1382-4680-94c2-2f3d4347d19d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"colorList", "=", 
   RowBox[{
    RowBox[{"ColorData", "[", "\"\<NeonColors\>\"", "]"}], "/@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Range", "[", "nSingularHeights", "]"}], "/", 
      "nSingularHeights"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{"showImages", ",", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"LinearSplineLevelCurves2D", "[", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"Delete", "[", 
          RowBox[{
           RowBox[{"T", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], ",", "0"}], "]"}], 
         "]"}], "&"}], ",", "h", ",", 
       RowBox[{"T", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\"\<AvocadoColors\>\"", 
       ",", " ", "Transparent"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"LinearSplineLevelCurve2D", "[", 
        RowBox[{
         RowBox[{"T", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"Delete", "[", 
            RowBox[{
             RowBox[{"T", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], ",", "0"}], "]"}], 
           "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"singularHeights", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
         RowBox[{"T", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"colorList", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "Transparent"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nSingularHeights"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics", "/@", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"regionSkeleton", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], "&"}], ",", 
        RowBox[{"regionSkeleton", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
        RowBox[{"{", "2", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.780343265045141*^9, 3.780343302857373*^9}, {
   3.7803618686499233`*^9, 3.7803618725375*^9}, {3.780551221678233*^9, 
   3.780551250618267*^9}, {3.7805515666814613`*^9, 3.7805515707208776`*^9}, {
   3.780552075904004*^9, 3.780552076622436*^9}, {3.801173752505617*^9, 
   3.801173758496459*^9}, 3.866860012114127*^9},
 CellLabel->
  "In[204]:=",ExpressionUUID->"1a735156-1a0b-4843-8b5e-799d5efa773a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"intersectingTrianglesIndices", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "#"}], "]"}], "&"}], "/@", 
     "intersectingTriangles"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intersectingTriangles", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"t_", "/;", 
      RowBox[{"IntersectingQ", "[", 
       RowBox[{"t", ",", "singularVertices"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonsingularTriangleVertices", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"intersectingTriangles", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "singularVertices"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "intersectingTriangles", "]"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonsingularfValues", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"fValues", "[", 
       RowBox[{"[", "#", "]"}], "]"}], "&"}], ",", 
     "nonsingularTriangleVertices", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"test", "=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "-", 
         RowBox[{"singularHeights", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "-", 
         RowBox[{"singularHeights", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "<", "0"}], "&"}], ",", 
    "nonsingularfValues"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.810627146912624*^9, 3.8106271670245457`*^9}, {
  3.810627232815425*^9, 3.81062724047293*^9}, {3.8106273175651827`*^9, 
  3.8106273745504723`*^9}},
 CellLabel->
  "In[206]:=",ExpressionUUID->"e3f88ad9-a776-4d26-b9c0-befabeda5a98"],

Cell[BoxData[
 TemplateBox[{
  "Flatten", "normal", 
   "\"Nonatomic expression expected at position \
\\!\\(\\*RowBox[{\\\"1\\\"}]\\) in \\!\\(\\*RowBox[{\\\"Flatten\\\", \
\\\"[\\\", \\\"intersectingTriangles\\\", \\\"]\\\"}]\\).\"", 2, 206, 23, 
   25169983238204021244, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.866771968501398*^9},
 CellLabel->
  "During evaluation of \
In[206]:=",ExpressionUUID->"79850675-f946-42bb-9578-7fa17951608e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "True", ",", "True", ",", "True", ",", "True", ",", "False", ",", "False"}],
   "}"}]], "Output",
 CellChangeTimes->{3.810627375204064*^9, 3.848712323447935*^9, 
  3.848744405194318*^9, 3.86677196854646*^9},
 CellLabel->
  "Out[210]=",ExpressionUUID->"9cf46acb-6fc2-40fe-8b9f-519116d721bf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["WIP", "Subsection",
 CellChangeTimes->{{3.810653147584251*^9, 
  3.810653147819853*^9}},ExpressionUUID->"39b116eb-a0a3-45a3-9f81-\
a4f34663cdd3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"conflux", "=", 
   RowBox[{"Pick", "[", 
    RowBox[{"intersectingTrianglesIndices", ",", "test"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.810627386884206*^9, 3.810627413421844*^9}},
 CellLabel->
  "In[687]:=",ExpressionUUID->"e68b715f-69ea-45e1-8e41-403b1a5a60cc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gammaS", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gammaSTriangles", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"triangleIndex", "=", 
   RowBox[{"conflux", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"gammaS", ",", 
    RowBox[{"T", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", 
       RowBox[{"singularVertices", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}], "]"}]}], " ", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"gammaSTriangles", ",", "triangleIndex"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.810628199014448*^9, 3.810628201909727*^9}, {
  3.8106508679460373`*^9, 3.810650893200939*^9}, {3.810651014333716*^9, 
  3.810651038892291*^9}, {3.810651273804937*^9, 3.810651351117713*^9}, {
  3.810651507927092*^9, 3.8106516621158237`*^9}, {3.810653776885632*^9, 
  3.8106538544424963`*^9}, {3.810654219376195*^9, 3.810654238755712*^9}},
 CellLabel->
  "In[719]:=",ExpressionUUID->"f15ca24f-5530-412b-9ede-71a7f123da2f"],

Cell[CellGroupData[{

Cell[BoxData["triangleIndex"], "Input",
 CellChangeTimes->{{3.810698320134411*^9, 3.81069832170182*^9}},
 CellLabel->
  "In[725]:=",ExpressionUUID->"1246cc0d-75ec-4133-93c4-658b810da050"],

Cell[BoxData["1190"], "Output",
 CellChangeTimes->{3.8106983229507732`*^9},
 CellLabel->
  "Out[725]=",ExpressionUUID->"1f1cc08b-0f5e-4169-b704-f27dc9685e98"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["gammaS"], "Input",
 CellChangeTimes->{{3.81069834498064*^9, 3.8106983457613487`*^9}},
 CellLabel->
  "In[727]:=",ExpressionUUID->"e854eea8-40a2-43d1-8011-b6eac919036a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"2.2114011356606422`", ",", "1.410170317111028`"}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.810698346079473*^9},
 CellLabel->
  "Out[727]=",ExpressionUUID->"70d14128-6793-433e-9d6b-eacb42d251bc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["gammaSTriangles"], "Input",
 CellChangeTimes->{{3.810698347063642*^9, 3.810698348538095*^9}},
 CellLabel->
  "In[728]:=",ExpressionUUID->"2837ccb3-0146-46d2-bc52-ff371cbec05c"],

Cell[BoxData[
 RowBox[{"{", "1190", "}"}]], "Output",
 CellChangeTimes->{3.810698348952944*^9},
 CellLabel->
  "Out[728]=",ExpressionUUID->"f69659b3-b889-4d59-be6e-b67d8a2e68f1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"triangleVertexIndices", "=", 
  RowBox[{"T", "[", 
   RowBox[{"[", 
    RowBox[{"3", ",", "triangleIndex"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trifValues", "=", 
   RowBox[{"f", "@@@", 
    RowBox[{"T", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", 
       RowBox[{"T", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "triangleIndex"}], "]"}], "]"}]}], "]"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Cycle", "[", "v_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Mod", "[", 
    RowBox[{"v", ",", "3"}], "]"}], "+", "1"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"v", "=", "1"}], ",", 
    RowBox[{"v", "++"}], ",", 
    RowBox[{"v", "\[LessEqual]", "3"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"trifValues", "[", 
            RowBox[{"[", "v", "]"}], "]"}], "-", 
           RowBox[{"singularHeights", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"trifValues", "[", 
            RowBox[{"[", 
             RowBox[{"Cycle", "[", "v", "]"}], " ", "]"}], "]"}], "-", 
           RowBox[{"singularHeights", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "<", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"gammaS", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"LineHeightIntersect", "[", 
            RowBox[{
             RowBox[{"T", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", 
                RowBox[{"triangleVertexIndices", "[", 
                 RowBox[{"[", "v", "]"}], "]"}]}], " ", "]"}], "]"}], ",", 
             RowBox[{"T", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", 
                RowBox[{"triangleVertexIndices", "[", 
                 RowBox[{"[", 
                  RowBox[{"Cycle", "[", "v", "]"}], " ", "]"}], "]"}]}], " ", 
               "]"}], "]"}], ",", 
             RowBox[{"trifValues", "[", 
              RowBox[{"[", "v", "]"}], "]"}], ",", 
             RowBox[{"trifValues", "[", 
              RowBox[{"[", 
               RowBox[{"Cycle", "[", "v", "]"}], " ", "]"}], "]"}], ",", 
             RowBox[{"singularHeights", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"triangleIndex", "=", 
         RowBox[{"triangulationTopology", "[", 
          RowBox[{"[", 
           RowBox[{"triangleIndex", ",", "v"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"ToString", "@", "triangleIndex"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Break", "[", "]"}], ";"}], "\[IndentingNewLine]", ","}], 
      "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.810652777787725*^9, 3.810652810313798*^9}, {
  3.8106529012915154`*^9, 3.81065300801789*^9}, {3.8106533840408278`*^9, 
  3.81065340203485*^9}, {3.810653589663065*^9, 3.810653748746004*^9}, {
  3.810653876707589*^9, 3.810653877770355*^9}, {3.810654273053213*^9, 
  3.8106543102620697`*^9}, {3.8106960839653177`*^9, 3.810696245836944*^9}, {
  3.810696309300202*^9, 3.810696309842927*^9}, {3.8106974204740477`*^9, 
  3.810697452999948*^9}},
 CellLabel->
  "In[715]:=",ExpressionUUID->"6ef689cf-3da9-4705-84f5-62eb5a006488"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"313", ",", "1114", ",", "1113"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8106963318439493`*^9, {3.810697413522461*^9, 3.81069741737498*^9}, 
   3.8106974534457397`*^9},
 CellLabel->
  "Out[715]=",ExpressionUUID->"6cee2245-ad81-477b-8f93-e6d3e5e44d4e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["triangleIndex"], "Input",
 CellChangeTimes->{{3.8106962503919563`*^9, 3.810696252052953*^9}},
 CellLabel->
  "In[714]:=",ExpressionUUID->"4ec4c834-c251-4f5b-b405-b92b582f3ddb"],

Cell[BoxData["1190"], "Output",
 CellChangeTimes->{{3.81069625254011*^9, 3.810696262113394*^9}, {
   3.8106963210524693`*^9, 3.8106963346423798`*^9}, 3.8106974237761908`*^9},
 CellLabel->
  "Out[714]=",ExpressionUUID->"86263b09-6116-4fc9-a757-413666e30b8e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["gammaS"], "Input",
 CellChangeTimes->{{3.810696255407201*^9, 3.810696256029965*^9}},
 CellLabel->
  "In[705]:=",ExpressionUUID->"70d545b2-6274-470f-9ef6-3ac329449568"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"2.2114011356606422`", ",", "1.410170317111028`"}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8106962563611927`*^9, 3.810696263492373*^9}, {
  3.8106963270378923`*^9, 3.8106963365071707`*^9}},
 CellLabel->
  "Out[705]=",ExpressionUUID->"67203c76-aa80-4b32-bec6-e3a27b3ef6aa"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"trifValues", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"singularHeights", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"trifValues", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "-", 
        RowBox[{"singularHeights", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "<", "0"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AppendTo", "[", 
      RowBox[{"gammaS", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"LineHeightIntersect", "[", 
         RowBox[{
          RowBox[{"T", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", 
             RowBox[{"triangleVertexIndices", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}], "]"}], ",", 
          RowBox[{"T", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", 
             RowBox[{"triangleVertexIndices", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], " ", "]"}], "]"}], ",", 
          RowBox[{"trifValues", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"trifValues", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"singularHeights", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"triangleIndex", "=", 
      RowBox[{"triangulationTopology", "[", 
       RowBox[{"[", 
        RowBox[{"triangleIndex", ",", "1"}], "]"}], "]"}]}], ";"}], 
    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"trifValues", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "-", 
           RowBox[{"singularHeights", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"trifValues", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "-", 
           RowBox[{"singularHeights", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "<", "0"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"triangleIndex", "=", 
         RowBox[{"triangulationTopology", "[", 
          RowBox[{"[", 
           RowBox[{"triangleIndex", ",", "2"}], "]"}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"trifValues", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "-", 
              RowBox[{"singularHeights", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"trifValues", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "-", 
              RowBox[{"singularHeights", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "<", "0"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"triangleIndex", "=", 
            RowBox[{"triangulationTopology", "[", 
             RowBox[{"[", 
              RowBox[{"triangleIndex", ",", "3"}], "]"}], "]"}]}], ";"}], 
          "\[IndentingNewLine]", ","}], "]"}], ";"}]}], "\[IndentingNewLine]",
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.810652777787725*^9, 3.810652810313798*^9}, {
  3.8106529012915154`*^9, 3.81065300801789*^9}, {3.8106533840408278`*^9, 
  3.81065340203485*^9}, {3.810653589663065*^9, 3.810653748746004*^9}, {
  3.810653876707589*^9, 3.810653877770355*^9}, {3.810654273053213*^9, 
  3.8106543102620697`*^9}, {3.8106960839653177`*^9, 
  3.810696245836944*^9}},ExpressionUUID->"ffbc023d-af28-48d1-89e7-\
201d6c7b2587"],

Cell[BoxData[
 RowBox[{"While", "[", 
  RowBox[{"True", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trifValues", "=", 
     RowBox[{"f", "@@@", 
      RowBox[{"T", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", 
         RowBox[{"T", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "triangle"}], "]"}], "]"}]}], "]"}], "]"}]}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"trifValues", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", 
          RowBox[{"singularHeights", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"trifValues", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"singularHeights", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "<", "0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"triangle", "=", 
        RowBox[{"triangulationTopology", "[", 
         RowBox[{"[", 
          RowBox[{"triangle", ",", "1"}], "]"}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"trifValues", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"singularHeights", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"trifValues", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "-", 
             RowBox[{"singularHeights", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "<", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"triangle", "=", 
           RowBox[{"triangulationTopology", "[", 
            RowBox[{"[", 
             RowBox[{"triangle", ",", "2"}], "]"}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"trifValues", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "-", 
                RowBox[{"singularHeights", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"trifValues", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", 
                RowBox[{"singularHeights", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "<", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"triangle", "=", 
              RowBox[{"triangulationTopology", "[", 
               RowBox[{"[", 
                RowBox[{"triangle", ",", "3"}], "]"}], "]"}]}], ";"}], 
            "\[IndentingNewLine]", ","}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{"conflux", ",", "triangle"}], "]"}], ",", 
      RowBox[{
       RowBox[{"Break", "[", "]"}], ";"}]}], "]"}], ";"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Break", " ", "While", " ", "loop"}], " ", "*)"}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.810628199014448*^9, 3.810628201909727*^9}, {
  3.8106508679460373`*^9, 3.810650893200939*^9}, {3.810651014333716*^9, 
  3.810651038892291*^9}, {3.810651273804937*^9, 3.810651333536879*^9}, {
  3.81065169856947*^9, 3.8106517004038887`*^9}, {3.8106518096132593`*^9, 
  3.810651841197003*^9}, {3.810651893594047*^9, 3.8106520020144587`*^9}, {
  3.8106520384038067`*^9, 3.810652062411059*^9}, {3.810652758111994*^9, 
  3.810652766697814*^9}, {3.8106530588321447`*^9, 
  3.810653070787067*^9}},ExpressionUUID->"bd22482b-9e61-400c-9745-\
5e7209e834ba"],

Cell[BoxData[
 RowBox[{"Show2Skeleton", "[", 
  RowBox[{"T", ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"conflux", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "1192"}], "}"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.81062742899537*^9, 3.8106274596137238`*^9}, {
  3.810628033626215*^9, 3.8106280455511503`*^9}, {3.81062808085231*^9, 
  3.8106280816677628`*^9}},
 CellLabel->
  "In[456]:=",ExpressionUUID->"6c690b3f-0cf1-4e74-b2a2-6409155b6ddb"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"showImages", ",", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Show2Skeleton", "[", 
      RowBox[{"T", ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", "conflux"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"LinearSplineLevelCurves2D", "[", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"Delete", "[", 
          RowBox[{
           RowBox[{"T", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], ",", "0"}], "]"}], 
         "]"}], "&"}], ",", "h", ",", 
       RowBox[{"T", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\"\<AvocadoColors\>\"", 
       ",", " ", "Transparent"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"LinearSplineLevelCurve2D", "[", 
        RowBox[{
         RowBox[{"T", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"Delete", "[", 
            RowBox[{
             RowBox[{"T", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], ",", "0"}], "]"}], 
           "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"singularHeights", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
         RowBox[{"T", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"colorList", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "Transparent"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nSingularHeights"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics", "/@", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"regionSkeleton", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], "&"}], ",", 
        RowBox[{"regionSkeleton", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
        RowBox[{"{", "2", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.810580831072624*^9, 3.8105808532963047`*^9}, {
  3.810627507850843*^9, 3.810627511350453*^9}},
 CellLabel->
  "In[449]:=",ExpressionUUID->"cc5433ea-cb75-4490-87e8-6c54dfd478ad"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Iterate over Singular Level Curves", "Subsection",
 CellChangeTimes->{{3.8105740307939367`*^9, 
  3.8105740357197733`*^9}},ExpressionUUID->"73659359-4b4f-45f9-baba-\
09fc1e7d8432"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Iterate", " ", "over", " ", "the", " ", "singular", " ", "level", " ", 
    "curves"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"fluxList", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nSingularHeights"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"contributingEdgesListList", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nSingularHeights"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"holeRepresentatives", "=", 
     RowBox[{"interiorVerticesByHole", "[", 
      RowBox[{"[", 
       RowBox[{";;", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"holeContainmentByConnectedComponentList", "=", 
     RowBox[{"Table", "[", 
      RowBox[{",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nSingularHeights"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"connectedComponentsByHeightClass", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nSingularHeights"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"s", "=", "1"}], ",", 
     RowBox[{"s", "\[LessEqual]", "nSingularHeights"}], ",", 
     RowBox[{"s", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lowerHeightClass", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"T", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"x_", "/;", 
           RowBox[{
            RowBox[{"f", "@@", "x"}], "<", 
            RowBox[{"singularHeights", "[", 
             RowBox[{"[", "s", "]"}], "]"}]}]}], ",", "1"}], "]"}], " ", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"upperHeightClass", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", 
           RowBox[{"T", "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], " ", "]"}], ",", 
         "lowerHeightClass"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lowerHeightClassEdges", "=", 
       RowBox[{"UndirectedEdge", "@@@", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"T", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"x_", "/;", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"lowerHeightClass", ",", 
              RowBox[{"x", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}], "&&", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"lowerHeightClass", ",", 
              RowBox[{"x", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], " ", "]"}]}]}]}], " ", 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"undirectedGraph", "=", 
       RowBox[{"Graph", "[", "lowerHeightClassEdges", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"connectedComponents", "=", 
       RowBox[{"Sort", "/@", 
        RowBox[{"ConnectedComponents", "[", "undirectedGraph", "]"}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"connectedComponentsByHeightClass", "[", 
        RowBox[{"[", "s", "]"}], "]"}], "=", "connectedComponents"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nConnectedComponents", "=", 
       RowBox[{"Length", "[", "connectedComponents", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"holeContainmentByConnectedComponentList", "[", 
        RowBox[{"[", "s", "]"}], "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"holeRepresentatives", ",", "#"}], "]"}], "&"}], "/@", 
           RowBox[{"Intersection", "[", 
            RowBox[{"holeRepresentatives", ",", 
             RowBox[{"connectedComponents", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nConnectedComponents"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"connectedComponentMeans", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Mean", "[", 
          RowBox[{"T", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", 
             RowBox[{"connectedComponents", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}], "]"}], " ", "]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nConnectedComponents"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"crossingEdgesList", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"T", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"x_", "/;", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"connectedComponents", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", 
                 RowBox[{"x", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}], "&&", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"upperHeightClass", ",", 
                 RowBox[{"x", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], " ", "]"}]}], ")"}], "||", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"connectedComponents", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", 
                 RowBox[{"x", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], " ", "]"}], "&&", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"upperHeightClass", ",", 
                 RowBox[{"x", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}]}], ")"}]}]}]}],
           "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nConnectedComponents"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"innerVerticesList", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Intersection", "[", 
          RowBox[{
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"crossingEdgesList", "[", 
              RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], "]"}], ",", 
           RowBox[{"connectedComponents", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nConnectedComponents"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"contributingEdgesList", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"FluxContributingEdgesCompiled", "[", 
          RowBox[{
           RowBox[{"innerVerticesList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "fValues", ",", 
           RowBox[{"singularHeights", "[", 
            RowBox[{"[", "s", "]"}], "]"}], ",", "vertexTopology"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nConnectedComponents"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"contributingEdgesListList", "[", 
        RowBox[{"[", "s", "]"}], "]"}], "=", "contributingEdgesList"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fluxList", "[", 
        RowBox[{"[", "s", "]"}], "]"}], "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Chop", "[", 
           RowBox[{"FluxOnTriangulation", "[", 
            RowBox[{"#", ",", "conductanceAssociation", ",", "f", ",", 
             RowBox[{"T", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}], " ", "]"}], "&"}],
          ",", "contributingEdgesList"}], "]"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.780510908514449*^9, 3.780510943675276*^9}, 
   3.78051099401289*^9, {3.7805114566943893`*^9, 3.780511473179637*^9}, {
   3.780511507539439*^9, 3.780511526177278*^9}, {3.780511871057786*^9, 
   3.780511896225725*^9}, {3.780513048706841*^9, 3.780513060071498*^9}, {
   3.780513136790579*^9, 3.780513256654868*^9}, {3.780513522076395*^9, 
   3.780513550059101*^9}, {3.780513601259688*^9, 3.780513688692605*^9}, {
   3.780513733617901*^9, 3.780513749256702*^9}, {3.7805140598898773`*^9, 
   3.780514062242403*^9}, {3.780514108379382*^9, 3.780514109657816*^9}, {
   3.7805153489305553`*^9, 3.780515386377076*^9}, {3.780519667312368*^9, 
   3.7805198266718063`*^9}, {3.780521320436694*^9, 3.7805213328886213`*^9}, {
   3.780521379649884*^9, 3.780521412187134*^9}, 3.780521482939296*^9, {
   3.780521595173102*^9, 3.780521663768173*^9}, 3.7805222880759583`*^9, {
   3.78052454456771*^9, 3.7805245469048634`*^9}, {3.7805252757940273`*^9, 
   3.780525285982657*^9}, {3.780525327126194*^9, 3.780525329477776*^9}, {
   3.780537356828485*^9, 3.7805374283929873`*^9}, {3.780548868342903*^9, 
   3.780548976023716*^9}, {3.780549038333349*^9, 3.780549040796445*^9}, {
   3.780597112979805*^9, 3.780597114368402*^9}, {3.801172544195994*^9, 
   3.801172596791494*^9}},
 CellLabel->
  "In[523]:=",ExpressionUUID->"fdb6868b-dedf-4552-bbc8-7b3ac43318e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Compute", " ", "fluxes", " ", "on", " ", "the", " ", "interior", " ", 
    "and", " ", "exterior", " ", "boundaries"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"allExteriorVertices", "=", 
     RowBox[{"BoundaryConnectedClasses", "[", 
      RowBox[{"T", ",", 
       RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"intVerticesList", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"BoundaryConnectedClasses", "[", 
        RowBox[{"T", ",", 
         RowBox[{"{", 
          RowBox[{"interiorVerticesByHole", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "interiorVerticesByHole", "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"contributingEdgesIntList", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"FluxContributingEdgesCompiled", "[", 
        RowBox[{
         RowBox[{"intVerticesList", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"1", "-", " ", "fValues"}], ",", "1.", ",", 
         "vertexTopology"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "interiorVerticesByHole", "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"contributingEdgesExt", "=", 
     RowBox[{"FluxContributingEdgesCompiled", "[", 
      RowBox[{
       RowBox[{"allExteriorVertices", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "fValues", ",", "1.", ",", 
       "vertexTopology"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fluxInt", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"FluxOnTriangulation", "[", 
        RowBox[{
         RowBox[{"contributingEdgesIntList", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "conductanceAssociation", ",", 
         "f", ",", 
         RowBox[{"T", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "interiorVerticesByHole", "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fluxExt", "=", 
     RowBox[{"{", 
      RowBox[{"FluxOnTriangulation", "[", 
       RowBox[{
       "contributingEdgesExt", ",", "conductanceAssociation", ",", "f", ",", 
        RowBox[{"T", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PrependTo", "[", 
     RowBox[{"fluxList", ",", "fluxInt"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AppendTo", "[", 
     RowBox[{"fluxList", ",", "fluxExt"}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.780525396581016*^9, 3.780525478520667*^9}, {
   3.780525760980728*^9, 3.780525784644227*^9}, 3.780526170646722*^9, {
   3.780594242970879*^9, 3.780594247786417*^9}},
 CellLabel->
  "In[529]:=",ExpressionUUID->"920bde13-e842-4607-ad1d-77126b17c208"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PrependTo", "[", 
   RowBox[{"holeContainmentByConnectedComponentList", ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", "i", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"holeContainmentByConnectedComponentList", ",", 
    RowBox[{"{", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}], "}"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7805943624041843`*^9, 3.780594428861094*^9}, {
  3.780594562952145*^9, 3.780594564695883*^9}, {3.7805948557936907`*^9, 
  3.780594865158868*^9}},
 CellLabel->
  "In[537]:=",ExpressionUUID->"abe65978-29eb-4c7f-b118-6aa43c19b55f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Check", " ", "final", " ", "computation", " ", "of", " ", "fluxes"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{"fluxList", "//", "Column"}]}]], "Input",
 CellChangeTimes->{{3.780526072004244*^9, 3.780526072939891*^9}, {
  3.7805261740485783`*^9, 3.780526183990428*^9}, {3.780594311411264*^9, 
  3.7805943129762774`*^9}},
 CellLabel->
  "In[539]:=",ExpressionUUID->"e011f94b-71b4-4b53-8793-e089845a6f6c"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{
      "3.5167297920098757`", ",", "4.74583458223632`", ",", 
       "4.607480779129706`"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{
      "4.50435375796878`", ",", "3.1669084347134286`", ",", 
       "3.967102980788458`"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"7.671197909026087`", ",", "4.055224618206347`"}], "}"}]},
    {
     RowBox[{"{", "12.870045153374928`", "}"}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{3.799349666401814*^9, 3.801164819396676*^9, 
  3.8011737840593348`*^9, 3.801176946181855*^9},
 CellLabel->
  "Out[539]=",ExpressionUUID->"6d4446ee-3a31-4bdc-9f42-26aec0d4ead5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"holeContainmentByConnectedComponentList", "//", "Column"}]], "Input",
 CellChangeTimes->{{3.780549054328327*^9, 3.780549065576784*^9}},
 CellLabel->
  "In[540]:=",ExpressionUUID->"e1840103-9ffb-44f9-8fe9-76aa855e679c"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "3", "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", "3", "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", "3", "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}], "}"}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{3.7993496699376297`*^9, 3.8011648223813267`*^9, 
  3.801173788416781*^9, 3.801176949971265*^9},
 CellLabel->
  "Out[540]=",ExpressionUUID->"90602025-e0ef-4431-842d-bc8e7bf713fa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Print", "[", 
  RowBox[{"StringJoin", "@@", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"\"\<Flux on element \>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"holeContainmentByConnectedComponentList", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i", "+", "1"}], ",", "j"}], "]"}], "]"}], " ", "]"}], 
           " ", "<>", "\"\< at height level \>\"", "<>", 
           RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<:          \>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"fluxList", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i", "+", "1"}], ",", "j"}], "]"}], "]"}], " ", "]"}], 
           "<>", "\"\<\\n\>\""}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"holeContainmentByConnectedComponentList", "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}],
         ",", 
        RowBox[{"{", "\"\<\\n\>\"", "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", 
        RowBox[{"nSingularHeights", "+", "1"}]}], "}"}]}], "]"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.780553188193445*^9, 3.780553368574006*^9}, {
  3.780594466356824*^9, 3.780594497241699*^9}, {3.7805946828234243`*^9, 
  3.780594698812676*^9}, {3.780625431081106*^9, 3.780625433998399*^9}},
 CellLabel->
  "In[541]:=",ExpressionUUID->"b3d14784-fe95-468b-a8b8-a771e8abdcb1"],

Cell[BoxData["\<\"Flux on element {1} at height level 0:          \
3.51673\\nFlux on element {2} at height level 0:          4.74583\\nFlux on \
element {3} at height level 0:          4.60748\\n\\nFlux on element {2} at \
height level 1:          4.50435\\nFlux on element {1} at height level 1:     \
     3.16691\\nFlux on element {3} at height level 1:          \
3.9671\\n\\nFlux on element {1, 2} at height level 2:          7.6712\\nFlux \
on element {3} at height level 2:          4.05522\\n\\nFlux on element {1, \
2, 3} at height level 3:          12.87\\n\\n\"\>"], "Print",
 CellChangeTimes->{3.7993496714184103`*^9, 3.801164825417377*^9, 
  3.801173797696464*^9, 3.8011769541491203`*^9},
 CellLabel->
  "During evaluation of \
In[541]:=",ExpressionUUID->"25260b2e-4c7d-48a0-9eea-0bd742f7f86c"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"colorList", "=", 
   RowBox[{
    RowBox[{"ColorData", "[", "\"\<RustTones\>\"", "]"}], "/@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Range", "[", "nSingularHeights", "]"}], "-", "1"}], ")"}], 
      "/", "nSingularHeights"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"LinearSplineLevelCurves2D", "[", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"Delete", "[", 
        RowBox[{
         RowBox[{"T", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], ",", "0"}], "]"}], 
       "]"}], "&"}], ",", "h", ",", 
     RowBox[{"T", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\"\<AvocadoColors\>\"", ",", 
     " ", "Transparent"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"LinearSplineLevelCurve2D", "[", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"Delete", "[", 
          RowBox[{
           RowBox[{"T", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], ",", "0"}], "]"}], 
         "]"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"singularHeights", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
       RowBox[{"T", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"colorList", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "Transparent"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nSingularHeights"}], "}"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Graphics", "/@", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"regionSkeleton", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], "&"}], ",", 
      RowBox[{"regionSkeleton", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"ShowHoleNumbers", "[", "pointsInHoles", "]"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.780418719086981*^9, 3.7804187319011517`*^9}, 
   3.78055215532403*^9, {3.7805521884346037`*^9, 3.7805522206461573`*^9}, {
   3.780593078200666*^9, 3.780593080005074*^9}, 3.7805931409776373`*^9},
 CellLabel->
  "In[542]:=",ExpressionUUID->"194d79d2-1fe0-4997-9363-e3a26f2f5e7c"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"Show2Skeleton", "[", "T", "]"}], ",", 
   RowBox[{"ShowHoleNumbers", "[", "pointsInHoles", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.766857651079782*^9, 3.766857654112576*^9}, {
  3.780597304860423*^9, 3.780597307844716*^9}},
 CellLabel->
  "In[544]:=",ExpressionUUID->"1f0834f3-2b35-4c84-ac57-1e97a2b70473"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"region", ",", 
   RowBox[{"ShowHoleNumbers", "[", "pointsInHoles", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.76685766267033*^9, 3.766857663904076*^9}, {
  3.7805952678992243`*^9, 3.780595270505788*^9}},
 CellLabel->
  "In[545]:=",ExpressionUUID->"1e984d87-e459-4457-85dc-abd77ac5995d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Run GSB on each Annulus", "Subsection",
 CellChangeTimes->{{3.801171730554068*^9, 
  3.8011717428720293`*^9}},ExpressionUUID->"5d23382b-03be-4f63-ae04-\
4ed987fcb65f"],

Cell[BoxData[
 RowBox[{"GraphicsGrid", "[", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Show2Skeleton", "[", 
      RowBox[{"Lambda", ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"containedVertices", ",", ","}], "}"}]}], "]"}], ",", 
     RowBox[{"Show2Skeleton", "[", 
      RowBox[{"Lambda", ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{",", ",", "containedFaces"}], "}"}]}], "]"}]}], "}"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.801171904281116*^9, 3.801171904994499*^9}, {
  3.801172030032002*^9, 3.8011720338861856`*^9}, {3.80117208142537*^9, 
  3.8011721263723927`*^9}},
 CellLabel->
  "In[546]:=",ExpressionUUID->"cc5203e1-13d7-431e-9c8a-2de9c6c4ab04"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"LambdaGraphSub", ",", "omega0nSub", ",", "slitVerticesSub"}], 
    "}"}], "=", "\[IndentingNewLine]", 
   RowBox[{"BuildSlittedWeightedVoronoiGraph", "[", 
    RowBox[{"Lambda", ",", "containedVertices", ",", "containedFaces", ",", 
     RowBox[{"omega0Seq", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"pointsInHoles", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "toRightOfEdgePolyAssociation"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.801172220739277*^9, 3.8011722261132402`*^9}},
 CellLabel->
  "In[547]:=",ExpressionUUID->"1261eaa4-141f-441f-94ff-d88e8439cfa7"],

Cell[BoxData[
 RowBox[{"Show2Skeleton", "[", 
  RowBox[{"T", ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"connectedComponentsByHeightClass", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", ","}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.801172675152925*^9, 3.801172735814311*^9}, {
  3.801173947492275*^9, 3.801173979741712*^9}, {3.801178482504435*^9, 
  3.801178483551565*^9}},
 CellLabel->
  "In[549]:=",ExpressionUUID->"72cea291-e097-4d6f-b187-88b47c817c2b"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "For", " ", "use", " ", "on", " ", "the", " ", "partitioned", " ", 
    "pieces", " ", "of", " ", "a", " ", "higher"}], "-", 
   RowBox[{"genus", " ", "region"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.8011706559986477`*^9, 
  3.8011706800260468`*^9}},ExpressionUUID->"c6be9fea-96bd-4239-a460-\
df5131e56552"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Main2", "[", 
   RowBox[{
   "region_", ",", "regionVertices_", ",", "interiorVerticesByHole_", ",", 
    "exteriorVertices_", ",", "nHoles_", ",", "pointsInHoles_", ",", 
    "omega0Seq_", ",", "refinementLevel_", ",", "convex_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "TUnrefined", ",", "T", ",", "regionSkeleton", ",", 
      "triangulationTopology", ",", "interiorEdgesOrientedTriangulation", ",",
       "boundaryEdgesOrientedTriangulation", ",", "eMesh", ",", 
      "exteriorBoundary", ",", "interiorBoundaries", ",", "\[CapitalGamma]1", 
      ",", "\[CapitalGamma]2", ",", "f", ",", "u", ",", "fValues", ",", 
      "Lambda", ",", "containedVertices", ",", "containedFaces", ",", 
      "LambdaGraph", ",", "omega0n", ",", "slitVertices", ",", 
      "paddedPolygons", ",", "toRightOfEdgeTriAssociation", ",", 
      "toRightOfEdgePolyAssociation", ",", 
      "conductanceAssociationtoRightOfEdgeTriAssociation", ",", 
      "conductanceAssociation", ",", "LambdaShortestPathFunction", ",", 
      "GSBValuesExtended", ",", "GSBValues", ",", "periodApprox", ",", 
      "GSBValuesExtendedNormalized", ",", "phiValuesExtended", ",", 
      "phiValues", ",", "GSBValuePolygons", ",", "interpolatedGSBValueMesh", 
      ",", "interpolatedGSBValueMeshExtended", ",", "TBoundaryVertices", ",", 
      "interiorTriangles", ",", "GSBMin", ",", "GSBMax", ",", "h2", ",", 
      "slitPolygons", ",", "slitPolygonsByIndex", ",", "slitTriangles", ",", 
      "nonslitTriangles", ",", "interiorNonslitTriangles", ",", "newPoints", 
      ",", "cleaned", ",", "radius", ",", "holeRegion", ",", "rmf", ",", 
      "containedVerticesIndicator"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", "Triangulate", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TUnrefined", "=", 
      RowBox[{"AcuteTriangulate", "[", 
       RowBox[{"region", ",", "pointsInHoles"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"T", "=", 
      RowBox[{"Nest", "[", 
       RowBox[{
       "RefineTriangulation", ",", "TUnrefined", ",", "refinementLevel"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{"[", "2", "]"}], "]"}], " ", "=", " ", 
      RowBox[{"Union", "[", 
       RowBox[{"Sort", "/@", 
        RowBox[{"T", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], " ", "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Remove", " ", "duplicated", " ", "edges"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"regionSkeleton", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"MeshCoordinates", "[", "region", "]"}], ",", " ", 
        RowBox[{"MeshCells", "[", 
         RowBox[{"region", ",", "1"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Compute", " ", "f"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"triangulationTopology", "=", 
      RowBox[{"BuildTriangulationTopologyNDLUACompiled", "[", 
       RowBox[{"T", "[", 
        RowBox[{"[", "3", "]"}], "]"}], " ", "]"}]}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "interiorEdgesOrientedTriangulation", ",", 
        "boundaryEdgesOrientedTriangulation"}], "}"}], "=", 
      RowBox[{"InteriorAndBoundaryEdges", "[", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "triangulationTopology"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"eMesh", "=", 
      RowBox[{"ToElementMesh", "[", 
       RowBox[{
        RowBox[{"\"\<Coordinates\>\"", "\[Rule]", 
         RowBox[{"T", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"\"\<MeshElements\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"TriangleElement", "[", 
           RowBox[{"T", "[", 
            RowBox[{"[", "3", "]"}], "]"}], " ", "]"}], "}"}]}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"exteriorBoundary", " ", "=", " ", 
      RowBox[{"Line", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"regionVertices", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", " ", 
        RowBox[{"Append", "[", 
         RowBox[{"exteriorVertices", ",", 
          RowBox[{"exteriorVertices", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}]}], " ", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"interiorBoundaries", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Line", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"regionVertices", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", " ", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"interiorVerticesByHole", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}]}], " ", "]"}]}], " ", 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"\[CapitalGamma]1", "=", 
      RowBox[{"DirichletCondition", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"u", "[", 
          RowBox[{"x", ",", "y"}], "]"}], " ", "\[Equal]", " ", "1"}], ",", 
        " ", 
        RowBox[{
         RowBox[{"RegionDistance", "[", 
          RowBox[{"exteriorBoundary", ",", " ", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}]}], "]"}], " ", "<", " ", 
         RowBox[{"1", "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "5"}], ")"}]}]}]}]}], "]"}]}], ";", 
     RowBox[{"\[CapitalGamma]2", "=", 
      RowBox[{"DirichletCondition", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"u", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"RegionDistance", "[", 
             RowBox[{"#", ",", " ", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}]}], "]"}], "&"}], "/@", 
           "interiorBoundaries"}], "]"}], " ", "<", " ", 
         RowBox[{"1", "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "5"}], ")"}]}]}]}]}], "]"}]}], ";", 
     RowBox[{"f", "=", 
      RowBox[{"NDSolveValue", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Laplacian", "[", 
             RowBox[{
              RowBox[{"u", "[", 
               RowBox[{"x", ",", "y"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], "\[Equal]", "0"}], 
          ",", "\[CapitalGamma]1", ",", "\[CapitalGamma]2"}], " ", "}"}], ",",
         "u", ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "eMesh"}]}], "]"}]}], 
     ";", 
     RowBox[{"fValues", "=", 
      RowBox[{"f", "@@@", 
       RowBox[{"T", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Constructing", " ", "Lambda"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Lambda", "=", 
      RowBox[{"BuildLambda", "[", 
       RowBox[{
       "T", ",", "exteriorVertices", ",", "interiorVerticesByHole", ",", 
        "regionVertices"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"containedVertices", " ", "=", " ", 
        RowBox[{"ContainedVertices", "[", 
         RowBox[{
          RowBox[{"Lambda", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "exteriorVertices", ",", 
          "interiorVerticesByHole", ",", "regionVertices"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", "convex"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"holeRegion", "=", 
           RowBox[{"BoundaryMeshRegion", "[", 
            RowBox[{"regionVertices", ",", 
             RowBox[{"Delete", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Line", "[", 
                  RowBox[{"Append", "[", 
                   RowBox[{
                    RowBox[{"interiorVerticesByHole", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"interiorVerticesByHole", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", 
                  "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "nHoles"}], "}"}]}], "]"}], ",", "0"}], 
              "]"}]}], " ", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"containedVertices", "=", 
           RowBox[{"Pick", "[", 
            RowBox[{"containedVertices", ",", 
             RowBox[{"Not", "/@", 
              RowBox[{"RegionMember", "[", 
               RowBox[{"holeRegion", ",", 
                RowBox[{"Lambda", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "containedVertices"}], "]"}], "]"}]}], 
               "]"}]}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"rmf", "=", 
      RowBox[{"RegionMember", "[", "region", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"containedVerticesIndicator", "=", 
      RowBox[{"rmf", "/@", 
       RowBox[{"Lambda", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"containedVertices", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", 
          RowBox[{"Lambda", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
        "containedVerticesIndicator"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"containedFaces", "=", 
      RowBox[{"ContainedFaces", "[", 
       RowBox[{
        RowBox[{"Lambda", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "containedVertices"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"paddedPolygons", "=", 
      RowBox[{"PadPolygonsToMatrix", "[", 
       RowBox[{"Lambda", "[", 
        RowBox[{"[", "3", "]"}], "]"}], " ", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"toRightOfEdgeTriAssociation", "=", 
      RowBox[{"BuildEdgeToRightTriangulationAssociation", "[", 
       RowBox[{"T", "[", 
        RowBox[{"[", "3", "]"}], "]"}], " ", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"toRightOfEdgePolyAssociation", "=", 
      RowBox[{
      "BuildEdgeToRightPolygonsAssociation", "[", "paddedPolygons", "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"conductanceAssociation", "=", 
      RowBox[{"BuildConductanceAssociation", "[", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        "interiorEdgesOrientedTriangulation", ",", 
        "toRightOfEdgeTriAssociation", ",", 
        RowBox[{"T", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"LambdaGraph", ",", "omega0n", ",", "slitVertices"}], "}"}], 
      "=", "\[IndentingNewLine]", 
      RowBox[{"BuildSlittedWeightedVoronoiGraph", "[", 
       RowBox[{"Lambda", ",", "containedVertices", ",", "containedFaces", ",", 
        RowBox[{"omega0Seq", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"pointsInHoles", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        "toRightOfEdgePolyAssociation"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Compute", " ", "GSB"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"LambdaShortestPathFunction", "=", 
      RowBox[{"FindShortestPath", "[", 
       RowBox[{"LambdaGraph", ",", "omega0n", ",", "All"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"GSBValuesExtended", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"containedVertices", ",", " ", "i"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"GSB2", "[", 
           RowBox[{
           "i", ",", "conductanceAssociation", ",", 
            "toRightOfEdgePolyAssociation", ",", "f", ",", 
            RowBox[{"T", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            "LambdaShortestPathFunction"}], "]"}], ",", "\[IndentingNewLine]",
           " ", "Null"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", 
          RowBox[{"Length", "[", 
           RowBox[{"Lambda", "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"GSBValues", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"GSBValuesExtended", ",", "Null"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"periodApprox", "=", " ", 
      RowBox[{"Max", "[", 
       RowBox[{"Abs", "[", "GSBValues", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"GSBValuesExtendedNormalized", "=", "GSBValuesExtended"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"phiValuesExtended", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"2", "*", 
          RowBox[{"Pi", "/", "periodApprox"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"containedVertices", ",", " ", "#"}], "]"}], ",", 
              RowBox[{"f", "[", 
               RowBox[{"Delete", "[", 
                RowBox[{
                 RowBox[{"Lambda", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "#"}], "]"}], "]"}], ",", " ", "0"}], 
                "]"}], "]"}], ",", "Null"}], "]"}], " ", "+", " ", 
            RowBox[{"I", "*", 
             RowBox[{"GSBValuesExtendedNormalized", "[", 
              RowBox[{"[", "#", "]"}], "]"}]}]}], ")"}]}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", 
         RowBox[{"Lambda", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"phiValuesExtended", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"NumberQ", "[", "#", "]"}], ",", "#", ",", "Null"}], "]"}],
          "&"}], ",", "phiValuesExtended", ",", 
        RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"phiValues", "=", 
      RowBox[{"phiValuesExtended", "[", 
       RowBox[{"[", "containedVertices", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Compute", " ", "the", " ", "average", " ", 
       RowBox[{"(", 
        RowBox[{
        "use", " ", "Wachspress", " ", "average", " ", "later", " ", "for", 
         " ", "better", " ", "accuracy"}], ")"}], " ", "of", " ", "GSB", " ", 
       "values", " ", "on", " ", "each", " ", "polygon", " ", "for", " ", 
       "interpolation", " ", "values", " ", "for", " ", "points", " ", "in", 
       " ", "T"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"GSBValuePolygons", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GSBValuesExtended", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], ",", 
        RowBox[{"Lambda", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "containedFaces"}], "]"}], "]"}], ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"interpolatedGSBValueMesh", "=", 
      RowBox[{"Mean", "/@", "GSBValuePolygons"}]}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{
      "GSBValues", " ", "on", " ", "containedFaces", " ", "polygons"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"interpolatedGSBValueMeshExtended", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"containedFaces", ",", "i"}], "]"}], ",", 
          RowBox[{"Mean", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"GSBValuesExtended", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
            RowBox[{"Lambda", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "i"}], "]"}], "]"}]}], " ", "]"}], ",", 
          "Null"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"T", "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"TBoundaryVertices", "=", 
      RowBox[{"Union", "[", 
       RowBox[{"Flatten", "[", "boundaryEdgesOrientedTriangulation", "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"regionSkeleton", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"MeshCoordinates", "[", "region", "]"}], ",", " ", 
        RowBox[{"MeshCells", "[", 
         RowBox[{"region", ",", "1"}], "]"}]}], "}"}]}], ";", 
     RowBox[{"interiorTriangles", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{"x_", "/;", 
         RowBox[{"!", 
          RowBox[{"ContainsAny", "[", 
           RowBox[{"x", ",", "TBoundaryVertices"}], " ", "]"}]}]}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"GSBMin", ",", "GSBMax"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Min", "[", "interpolatedGSBValueMesh", "]"}], ",", " ", 
        RowBox[{"Max", "[", "interpolatedGSBValueMesh", "]"}]}], "}"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"h2", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "GSBMin", ",", "GSBMax", ",", ".05"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"slitPolygons", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"Lambda", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
        RowBox[{"x_", "/;", 
         RowBox[{"ContainsAny", "[", 
          RowBox[{"x", ",", " ", "slitVertices"}], "]"}]}]}], " ", "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"slitPolygonsByIndex", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Lambda", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", " ", "#"}], "]"}], "&"}], "/@",
         " ", "slitPolygons"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"slitTriangles", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
        RowBox[{"x_", "/;", 
         RowBox[{"ContainsAny", "[", 
          RowBox[{"x", ",", "slitPolygonsByIndex"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nonslitTriangles", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "slitTriangles"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"interiorNonslitTriangles", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"nonslitTriangles", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{"!", 
          RowBox[{"ContainsAny", "[", 
           RowBox[{"x", ",", " ", "TBoundaryVertices"}], "]"}]}]}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"newPoints", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"#", ",", "Null"}], "]"}], ",", "Null", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Re", "[", "#", "]"}], ",", 
            RowBox[{"Im", "[", "#", "]"}]}], "}"}]}], "]"}], "&"}], "/@", 
       "phiValuesExtended"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cleaned", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"newPoints", ",", "Null"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"radius", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"Norm", "/@", "cleaned"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
       "regionSkeleton", ",", "T", ",", "f", ",", "Lambda", ",", 
        "LambdaGraph", ",", "GSBValuesExtended", ",", "phiValuesExtended", 
        ",", "interiorNonslitTriangles", ",", 
        "interpolatedGSBValueMeshExtended", ",", "h2", ",", "newPoints", ",", 
        "cleaned", ",", "radius", ",", "slitVertices"}], "}"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{
  3.801170653393119*^9, {3.8011707987240343`*^9, 3.801170809284672*^9}, 
   3.8011708403317823`*^9, 
   3.801171616129754*^9},ExpressionUUID->"32fc25f9-11a6-4018-b346-\
f45a98b95fda"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Line-by-line testing of TriLevelSets", "Subsection",
 CellChangeTimes->{{3.867458416462511*^9, 
  3.8674584298898563`*^9}},ExpressionUUID->"d9d2bc1f-1b92-458f-8962-\
7d5061100461"],

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{
   RowBox[{"T", "[", 
    RowBox[{"[", "3", "]"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.866860310656475*^9, 3.866860317084661*^9}},
 CellLabel->
  "In[225]:=",ExpressionUUID->"afda7ec1-7351-4331-ae84-6ea4588a0b35"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2", ",", "13"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.86745839426864*^9, 3.867458395332288*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"8848d55a-212b-442f-9819-b0868b8ed8ae"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "2", ",", "13"}], "}"}]], "Output",
 CellChangeTimes->{3.8674583959840527`*^9},
 CellLabel->
  "Out[132]=",ExpressionUUID->"4f8e428b-20b5-416a-938b-7d810b360d18"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"perm", " ", "=", " ", 
  RowBox[{"Sort", "[", 
   RowBox[{"t", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "#1", "]"}], "<", 
      RowBox[{"f", "[", "#2", "]"}]}], "&"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.866860321182382*^9, 3.866860324979566*^9}},
 CellLabel->
  "In[227]:=",ExpressionUUID->"85cf07cd-87d9-4dba-8718-9f2517644660"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "2", ",", "13"}], "}"}]], "Output",
 CellChangeTimes->{{3.866860321540668*^9, 3.8668603255115757`*^9}},
 CellLabel->
  "Out[227]=",ExpressionUUID->"c70b4bd2-92fb-437d-a737-1efbba1eef23"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"values", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"Delete", "[", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", " ", "#"}], "]"}], "]"}], ",", "0"}], "]"}], "]"}],
     "&"}], " ", "/@", "perm"}]}]], "Input",
 CellChangeTimes->{{3.866860458544115*^9, 3.866860460307094*^9}, {
  3.866889746607589*^9, 3.866889747332588*^9}},
 CellLabel->
  "In[241]:=",ExpressionUUID->"a722f966-398c-400a-8343-0f8b01f59c0d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", "0.10010946461166324`", ",", "0.06470343860855002`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.866860460704216*^9, 3.866889747780363*^9},
 CellLabel->
  "Out[241]=",ExpressionUUID->"53809d84-4e79-4fd3-b0eb-d379fac17ad1"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lowVertex", " ", "=", " ", 
   RowBox[{"perm", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"midVertex", " ", "=", " ", 
   RowBox[{"perm", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"highVertex", " ", "=", " ", 
   RowBox[{"perm", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[242]:=",ExpressionUUID->"45ae485a-c34e-4cdf-8d6e-91662c1c3dce"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BuildLine", "[", "height_", "]"}], " ", ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"And", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"values", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "<", " ", "height"}], ",", "  ", 
          RowBox[{"height", " ", "<", " ", 
           RowBox[{"values", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], " ", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"LineHeightIntersect", "[", 
            RowBox[{
             RowBox[{"coordinates", "[", 
              RowBox[{"[", "lowVertex", "]"}], "]"}], ",", " ", 
             RowBox[{"coordinates", "[", 
              RowBox[{"[", "midVertex", "]"}], "]"}], ",", " ", 
             RowBox[{"f", "[", "lowVertex", "]"}], ",", " ", 
             RowBox[{"f", "[", "midVertex", "]"}], ",", "height"}], " ", 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"LineHeightIntersect", "[", 
            RowBox[{
             RowBox[{"coordinates", "[", 
              RowBox[{"[", "lowVertex", "]"}], "]"}], ",", " ", 
             RowBox[{"coordinates", "[", 
              RowBox[{"[", "highVertex", "]"}], "]"}], ",", " ", 
             RowBox[{"f", "[", "lowVertex", "]"}], ",", " ", 
             RowBox[{"f", "[", "highVertex", "]"}], ",", "height"}], " ", 
            "]"}]}], "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", 
         "]"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"values", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", " ", 
              "height"}], ",", "  ", 
             RowBox[{"height", " ", "<", " ", 
              RowBox[{"values", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], " ", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "\[IndentingNewLine]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"LineHeightIntersect", "[", 
               RowBox[{
                RowBox[{"coordinates", "[", 
                 RowBox[{"[", "lowVertex", "]"}], "]"}], ",", " ", 
                RowBox[{"coordinates", "[", 
                 RowBox[{"[", "highVertex", "]"}], "]"}], ",", " ", 
                RowBox[{"f", "[", "lowVertex", "]"}], ",", " ", 
                RowBox[{"f", "[", "highVertex", "]"}], ",", "height"}], " ", 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"LineHeightIntersect", "[", 
               RowBox[{
                RowBox[{"coordinates", "[", 
                 RowBox[{"[", "midVertex", "]"}], "]"}], ",", " ", 
                RowBox[{"coordinates", "[", 
                 RowBox[{"[", "highVertex", "]"}], "]"}], ",", " ", 
                RowBox[{"f", "[", "midVertex", "]"}], ",", " ", 
                RowBox[{"f", "[", "highVertex", "]"}], ",", "height"}], " ", 
               "]"}]}], "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", 
            "]"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", 
            RowBox[{"{", "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[245]:=",ExpressionUUID->"de9ee849-4566-43aa-befa-eaa187fe8dac"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BuildLine", "/@", " ", "singularHeights"}]], "Input",
 CellChangeTimes->{{3.86688969721071*^9, 3.866889710947468*^9}},
 CellLabel->
  "In[246]:=",ExpressionUUID->"b17aaf81-28f1-4092-a1d4-8df3686d570a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"Null", ",", "Null"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.866860510825354*^9, 3.866889711281639*^9, 
  3.866889754796924*^9},
 CellLabel->
  "Out[246]=",ExpressionUUID->"88af66c3-fb87-4261-9958-d451b78ad15d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["h"], "Input",
 CellChangeTimes->{3.866860517367324*^9},
 CellLabel->
  "In[239]:=",ExpressionUUID->"9d3e1edd-bad2-42b2-91fa-f71655e76063"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.`", ",", "0.01`", ",", "0.02`", ",", "0.03`", ",", "0.04`", ",", "0.05`",
    ",", "0.06`", ",", "0.07`", ",", "0.08`", ",", "0.09`", ",", "0.1`", ",", 
   "0.11`", ",", "0.12`", ",", "0.13`", ",", "0.14`", ",", "0.15`", ",", 
   "0.16`", ",", "0.17`", ",", "0.18`", ",", "0.19`", ",", "0.2`", ",", 
   "0.21`", ",", "0.22`", ",", "0.23`", ",", "0.24`", ",", "0.25`", ",", 
   "0.26`", ",", "0.27`", ",", "0.28`", ",", "0.29`", ",", "0.3`", ",", 
   "0.31`", ",", "0.32`", ",", "0.33`", ",", "0.34`", ",", 
   "0.35000000000000003`", ",", "0.36`", ",", "0.37`", ",", "0.38`", ",", 
   "0.39`", ",", "0.4`", ",", "0.41000000000000003`", ",", "0.42`", ",", 
   "0.43`", ",", "0.44`", ",", "0.45`", ",", "0.46`", ",", 
   "0.47000000000000003`", ",", "0.48`", ",", "0.49`", ",", "0.5`", ",", 
   "0.51`", ",", "0.52`", ",", "0.53`", ",", "0.54`", ",", "0.55`", ",", 
   "0.56`", ",", "0.5700000000000001`", ",", "0.58`", ",", "0.59`", ",", 
   "0.6`", ",", "0.61`", ",", "0.62`", ",", "0.63`", ",", "0.64`", ",", 
   "0.65`", ",", "0.66`", ",", "0.67`", ",", "0.68`", ",", 
   "0.6900000000000001`", ",", "0.7000000000000001`", ",", "0.71`", ",", 
   "0.72`", ",", "0.73`", ",", "0.74`", ",", "0.75`", ",", "0.76`", ",", 
   "0.77`", ",", "0.78`", ",", "0.79`", ",", "0.8`", ",", "0.81`", ",", 
   "0.8200000000000001`", ",", "0.8300000000000001`", ",", "0.84`", ",", 
   "0.85`", ",", "0.86`", ",", "0.87`", ",", "0.88`", ",", "0.89`", ",", 
   "0.9`", ",", "0.91`", ",", "0.92`", ",", "0.93`", ",", 
   "0.9400000000000001`", ",", "0.9500000000000001`", ",", "0.96`", ",", 
   "0.97`", ",", "0.98`", ",", "0.99`", ",", "1.`"}], "}"}]], "Output",
 CellChangeTimes->{3.866860517639208*^9},
 CellLabel->
  "Out[239]=",ExpressionUUID->"8ce1bc48-fb9f-44b9-8dbf-aff0a888e00b"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{3440, 1387},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.25 Inherited,
FrontEndVersion->"12.3 for Mac OS X ARM (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"4c694b1b-56de-4596-94c8-21b349bba59f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 215, 4, 123, "Title",ExpressionUUID->"820cc094-bfce-40b6-b555-2af3e155142c"],
Cell[798, 28, 282, 6, 44, "Text",ExpressionUUID->"214a0f00-39e0-47e8-a191-a1b5c60de4d3"],
Cell[1083, 36, 773, 19, 64, "Input",ExpressionUUID->"46a926a4-9ae1-48db-9962-4c38b4a51137"],
Cell[1859, 57, 1634, 35, 116, "Input",ExpressionUUID->"e5c8f4aa-c9e2-4145-b97c-6724213e0e5c"],
Cell[CellGroupData[{
Cell[3518, 96, 167, 3, 84, "Section",ExpressionUUID->"2bf113dc-25ce-41fb-8ead-2d332d0ac6b7"],
Cell[3688, 101, 6107, 143, 636, "Input",ExpressionUUID->"325c2960-1fa0-4c31-9c0b-c4501cb066e7"],
Cell[9798, 246, 3435, 80, 428, "Input",ExpressionUUID->"f9411da3-6737-4fbb-8671-ab262c59245c"],
Cell[13236, 328, 2805, 69, 402, "Input",ExpressionUUID->"a8b09301-c7d2-4d07-8336-560e7f2546f0"],
Cell[16044, 399, 2424, 56, 220, "Input",ExpressionUUID->"152c9bf9-f594-4c9a-95af-9636cd52651e"],
Cell[18471, 457, 7565, 178, 532, "Input",ExpressionUUID->"d73f0e29-e2a1-41b8-81f0-d347e123fe4b"],
Cell[26039, 637, 631, 16, 37, "Input",ExpressionUUID->"93d7b19d-adc5-4fdd-8cca-c613477e607f"],
Cell[26673, 655, 649, 18, 37, "Input",ExpressionUUID->"351bf80d-2618-4e11-a3bc-c5c597c2dd8e"],
Cell[27325, 675, 5030, 111, 506, "Input",ExpressionUUID->"3d58766d-3a4f-47a7-8465-f416cc1d4907"],
Cell[32358, 788, 2134, 51, 194, "Input",ExpressionUUID->"ac777f35-98e8-4c63-8c96-63ece606791e"],
Cell[34495, 841, 1091, 32, 37, "Input",ExpressionUUID->"796857fb-ea31-420f-895f-fb3a13d94537"],
Cell[35589, 875, 3014, 71, 272, "Input",ExpressionUUID->"b68cea10-9bc7-4a86-8cc8-600f6b2f13b3"],
Cell[38606, 948, 4540, 105, 480, "Input",ExpressionUUID->"4e8fbfa8-4e74-421a-9256-3d7da416f586"],
Cell[43149, 1055, 3556, 84, 506, "Input",ExpressionUUID->"511bb80d-e2fc-460b-965a-be8affdafffd"],
Cell[46708, 1141, 8494, 185, 896, "Input",ExpressionUUID->"8658d419-c103-4ad7-8cfe-879d89a1b867"],
Cell[55205, 1328, 4493, 96, 610, "Input",ExpressionUUID->"204699e0-6828-439b-a059-425d432ed716"],
Cell[59701, 1426, 9268, 186, 1078, "Input",ExpressionUUID->"9e5e84a4-7ad0-4186-8bb5-c7a5617f2e19"],
Cell[68972, 1614, 942, 22, 116, "Input",ExpressionUUID->"f1f948c3-da1c-48c0-98d8-f88ec16ffa97"],
Cell[69917, 1638, 884, 20, 37, "Input",ExpressionUUID->"1c54dea0-ef0f-405d-ba97-9ad44bdca263"],
Cell[70804, 1660, 3074, 74, 298, "Input",ExpressionUUID->"d2228eca-cd12-4a4d-842d-1160b71e4c99"],
Cell[73881, 1736, 1714, 42, 90, "Input",ExpressionUUID->"24f250fe-ee3c-4e1d-9c59-c0c95a8204dc"],
Cell[75598, 1780, 2318, 58, 194, "Input",ExpressionUUID->"f598925e-f141-424a-a420-071279d45be0"],
Cell[77919, 1840, 14703, 316, 1858, "Input",ExpressionUUID->"3565d8e2-1c80-4278-837b-366269905ebe"],
Cell[92625, 2158, 13820, 294, 1884, "Input",ExpressionUUID->"7842211a-3c16-4f88-b4f0-61a0903fe8b2"],
Cell[106448, 2454, 1986, 49, 220, "Input",ExpressionUUID->"6b80da37-a94e-4be1-bbca-6eb61e140c0f"],
Cell[108437, 2505, 2344, 59, 298, "Input",ExpressionUUID->"5e85fb9f-0a88-4208-8268-8b813352c9ac"],
Cell[110784, 2566, 5203, 112, 532, "Input",ExpressionUUID->"20142343-95f3-49d0-9047-e0544ed6a242"],
Cell[115990, 2680, 5396, 114, 532, "Input",ExpressionUUID->"b42eb961-f0f1-490a-9881-7e6ec2a43ae2"],
Cell[121389, 2796, 1227, 33, 142, "Input",ExpressionUUID->"75b6397e-b61c-4261-8151-b87af781f7a1"],
Cell[122619, 2831, 1552, 39, 142, "Input",ExpressionUUID->"9e4cf656-b1bc-44ae-ac2e-984954435f6f"],
Cell[124174, 2872, 3427, 78, 428, "Input",ExpressionUUID->"9843b764-6bc6-452f-b896-079d3d28e2ef"],
Cell[127604, 2952, 15681, 326, 1728, "Input",ExpressionUUID->"ce24e228-0c8d-4368-ad53-1673e4d23151"],
Cell[143288, 3280, 18166, 375, 1988, "Input",ExpressionUUID->"1825d080-3793-48ec-8586-450cf8b18ffc"],
Cell[161457, 3657, 19302, 407, 2248, "Input",ExpressionUUID->"9138ec83-c73f-4800-b1fd-8a0d8944b7ee"],
Cell[180762, 4066, 1243, 32, 116, "Input",ExpressionUUID->"2312b2ca-c72c-4ebf-b1ed-2aab7b241dfb"],
Cell[182008, 4100, 3937, 107, 246, "Input",ExpressionUUID->"390450d0-769f-4922-a636-4276b7d3d71f"],
Cell[185948, 4209, 668, 18, 90, "Input",ExpressionUUID->"2632052c-24a5-4152-ad30-a3d4ed1c2eb7"],
Cell[186619, 4229, 3130, 71, 246, "Input",ExpressionUUID->"9acedfc6-11ac-4918-845d-5d34875ba537"],
Cell[189752, 4302, 824, 20, 116, "Input",ExpressionUUID->"676fd42c-848c-4c6a-92f0-8250e3c73c43"],
Cell[190579, 4324, 1229, 31, 116, "Input",ExpressionUUID->"32503075-63de-412c-957d-75953a59f86b"],
Cell[191811, 4357, 1390, 33, 116, "Input",ExpressionUUID->"8a334cf8-d089-4ebf-8b0b-90c82c56b80e"],
Cell[193204, 4392, 7667, 172, 922, "Input",ExpressionUUID->"3de36991-9613-419e-b5ce-95a10822a382"],
Cell[200874, 4566, 2741, 66, 194, "Input",ExpressionUUID->"e9861e89-56ae-4556-aa29-69c1825f6024"],
Cell[203618, 4634, 7174, 148, 610, "Input",ExpressionUUID->"d4bc25b8-5a67-4f48-b9b6-d721933a7ec5"],
Cell[210795, 4784, 13690, 297, 896, "Input",ExpressionUUID->"1d72571a-fd2b-401a-a90e-19cba3ff7bd1"],
Cell[224488, 5083, 3815, 88, 454, "Input",ExpressionUUID->"18c1bea1-fe3d-408a-9d7b-4494ed32bdbb"],
Cell[228306, 5173, 5281, 120, 688, "Input",ExpressionUUID->"4a03d626-b499-4e1b-bfdf-4e5c8878f0ca"],
Cell[233590, 5295, 2604, 62, 324, "Input",ExpressionUUID->"26876566-9c18-464f-83cf-39e7df770b3e"],
Cell[236197, 5359, 1492, 37, 168, "Input",ExpressionUUID->"a1c3ec6a-f915-4164-8ea4-b27798357efb"],
Cell[237692, 5398, 3411, 81, 506, "Input",ExpressionUUID->"7c6adec0-4c58-4058-85df-1a0da5b7c35f"],
Cell[241106, 5481, 4504, 106, 454, "Input",ExpressionUUID->"d37d4ac1-2f11-4032-ac3a-0d89ceb99768"],
Cell[245613, 5589, 5100, 110, 506, "Input",ExpressionUUID->"5919d89a-45a3-4b10-a9c5-26d61977a3d9"],
Cell[250716, 5701, 6313, 140, 610, "Input",ExpressionUUID->"687b8177-9efe-4ac2-8b72-22b648980e52"],
Cell[257032, 5843, 12573, 260, 1806, "Input",ExpressionUUID->"9875c2a2-cd04-48fd-b536-025343f44586"],
Cell[269608, 6105, 3473, 77, 350, "Input",ExpressionUUID->"ddcbb14f-5fe4-4b54-9343-43b5469750c8"],
Cell[273084, 6184, 2796, 58, 324, "Input",ExpressionUUID->"1e9386ff-ac04-44af-888f-bea60f1e1206"],
Cell[275883, 6244, 3129, 78, 220, "Input",ExpressionUUID->"3684acd5-b38b-4315-a177-9364aaef1b04"],
Cell[279015, 6324, 19781, 438, 1780, "Input",ExpressionUUID->"e9b0a380-2229-42ed-a366-6389f08939d9"],
Cell[298799, 6764, 5400, 127, 428, "Input",ExpressionUUID->"860f6a44-883b-4822-a516-3695febd298a"],
Cell[304202, 6893, 3813, 86, 350, "Input",ExpressionUUID->"1d684129-c7ee-4427-aa80-48a4016234c2"],
Cell[308018, 6981, 4351, 104, 558, "Input",ExpressionUUID->"ed67832d-f94f-4297-be1c-0cc5daed46ba"],
Cell[312372, 7087, 1866, 44, 142, "Input",ExpressionUUID->"8bb0af07-2dea-420b-bfdf-8cbe5ef6ed7c"],
Cell[314241, 7133, 5967, 135, 688, "Input",ExpressionUUID->"50e20fb1-5573-43ff-bade-2834e91b84fd"],
Cell[320211, 7270, 1848, 44, 142, "Input",ExpressionUUID->"ccdea71f-3262-4a40-80a5-2a0061c71d23"],
Cell[322062, 7316, 6656, 130, 298, "Input",ExpressionUUID->"1db5c79d-9caa-4b44-8182-add563980223"],
Cell[328721, 7448, 4745, 106, 454, "Input",ExpressionUUID->"78df3197-662b-4be7-94bf-5dd2dce2a076"],
Cell[333469, 7556, 5760, 121, 454, "Input",ExpressionUUID->"363c882e-ff0f-407d-a340-ada3bbd673c2"],
Cell[339232, 7679, 1503, 36, 142, "Input",ExpressionUUID->"0b27616d-eea0-4eaa-97ed-76463b6ef2e1"],
Cell[340738, 7717, 1411, 32, 142, "Input",ExpressionUUID->"f02eb623-7e7e-430c-b6d5-50e201bb1fe4"],
Cell[342152, 7751, 1665, 45, 90, "Input",ExpressionUUID->"316a4d07-82ee-48a8-bd4f-73782406e608"],
Cell[343820, 7798, 6667, 164, 610, "Input",ExpressionUUID->"5b93cf2c-5504-47c8-bec3-898ee917d84d"],
Cell[350490, 7964, 10398, 261, 1000, "Input",ExpressionUUID->"e2487772-ef9d-4d39-9477-5c3a0af185c0"],
Cell[360891, 8227, 3142, 72, 272, "Input",ExpressionUUID->"43bf2ed3-1b48-486f-961c-b4be71bc39a4"],
Cell[364036, 8301, 2461, 60, 298, "Input",ExpressionUUID->"feb4c7cc-40d8-477c-a0d3-5fe5cdf709cf"],
Cell[366500, 8363, 8396, 160, 818, "Input",ExpressionUUID->"db748872-099f-4061-98cf-ad0aa4c717d6"],
Cell[374899, 8525, 3454, 83, 272, "Input",ExpressionUUID->"afd966be-0ee3-4fd0-bfcf-d2dd31cfb69e"],
Cell[378356, 8610, 5848, 137, 350, "Input",ExpressionUUID->"0955ceb0-2694-4c6b-a692-832fbf2bc81c"],
Cell[384207, 8749, 7041, 168, 376, "Input",ExpressionUUID->"57c01efc-309e-4ef5-ab68-95d8fb5e272b"],
Cell[391251, 8919, 8011, 164, 662, "Input",ExpressionUUID->"e84c35ed-faf0-4a69-af24-6c42060142dc"],
Cell[399265, 9085, 12677, 273, 792, "Input",ExpressionUUID->"dda74a74-986f-4a8c-879f-91d9f349296a"],
Cell[411945, 9360, 3487, 78, 454, "Input",ExpressionUUID->"2ef27559-b98d-47f4-a7ca-63dcdfde1af8"],
Cell[415435, 9440, 2428, 57, 246, "Input",ExpressionUUID->"8bc01033-062d-417f-956d-35f1be89a72f"],
Cell[417866, 9499, 4351, 90, 584, "Input",ExpressionUUID->"884ec593-3c33-493f-83e2-f05901b0bc5f"],
Cell[422220, 9591, 4978, 111, 584, "Input",ExpressionUUID->"43ae648b-e730-4d12-90d1-404bee69f717"],
Cell[427201, 9704, 20469, 445, 1390, "Input",ExpressionUUID->"7fad0a5a-4b29-46f7-af6a-ff3568d8178e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[447707, 10154, 291, 5, 84, "Section",ExpressionUUID->"a7082d18-8b5d-4356-a3a2-925c661afabd"],
Cell[448001, 10161, 686, 14, 194, "Input",ExpressionUUID->"1f7dab26-ed71-4f93-b756-03c07492802f"],
Cell[448690, 10177, 22843, 535, 1650, "Input",ExpressionUUID->"d6313f5f-f615-449a-a77e-47a60bcfaef0"],
Cell[471536, 10714, 23625, 549, 1702, "Input",ExpressionUUID->"f9cf5955-8f3a-485e-9334-a152556dbdad"],
Cell[CellGroupData[{
Cell[495186, 11267, 157, 3, 67, "Subsection",ExpressionUUID->"d6be7719-6bf0-4ad4-a2ae-159979597873"],
Cell[495346, 11272, 405, 11, 64, "Input",ExpressionUUID->"d7902d28-a62e-46a8-98cb-455c8b70444e"],
Cell[495754, 11285, 464, 11, 37, "Input",ExpressionUUID->"d8babc06-1295-485c-827a-d8e61ea6c45a"],
Cell[496221, 11298, 653, 16, 37, "Input",ExpressionUUID->"77b62404-285a-4c43-90e8-266812818805"],
Cell[496877, 11316, 728, 15, 37, "Input",ExpressionUUID->"1d4d57ab-aa93-443a-9847-b2b833f96d4b"],
Cell[497608, 11333, 540, 16, 37, "Input",ExpressionUUID->"d67f1cb2-1faa-4306-a339-1f9756399739"],
Cell[498151, 11351, 390, 11, 37, "Input",ExpressionUUID->"174e292e-8ed3-4b14-a908-47495d8dde7c"],
Cell[498544, 11364, 4614, 104, 298, "Input",ExpressionUUID->"39250806-3a12-4773-82f7-c3c81b7e0580"],
Cell[503161, 11470, 217, 4, 37, "Input",ExpressionUUID->"31392fe6-712f-492f-a3a1-14260eefd447"],
Cell[503381, 11476, 990, 26, 37, "Input",ExpressionUUID->"b8148c51-3c79-4ae3-afc7-a6299f366a6c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[504420, 11508, 368, 6, 84, "Section",ExpressionUUID->"d989e864-5aba-4d8d-b410-34f5838e32d4"],
Cell[CellGroupData[{
Cell[504813, 11518, 159, 2, 67, "Subsection",ExpressionUUID->"d1918a01-2593-4ec9-820a-f7d48b046aaf"],
Cell[CellGroupData[{
Cell[504997, 11524, 411, 6, 56, "Subsubsection",ExpressionUUID->"f3b155bd-e289-47b3-9827-858209a8eb0e"],
Cell[505411, 11532, 2998, 73, 220, "Input",ExpressionUUID->"e4761998-647f-4549-8b42-16926bccbed3"],
Cell[508412, 11607, 1088, 28, 64, "Input",ExpressionUUID->"4de27928-ad6f-4690-9781-08eaf3b1a570"],
Cell[509503, 11637, 723, 19, 37, "Input",ExpressionUUID->"6d37266e-2322-4aba-8a4b-0ec768029a26"],
Cell[510229, 11658, 729, 16, 37, "Input",ExpressionUUID->"702f65e6-c72d-4211-a06e-efb9049370ab"],
Cell[CellGroupData[{
Cell[510983, 11678, 606, 17, 37, "Input",ExpressionUUID->"f614f0fc-47f4-412f-a7a0-8d3735d2c375"],
Cell[511592, 11697, 741, 14, 470, "Output",ExpressionUUID->"57b8ce9c-8700-4f17-869b-b5ff5c791d91"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[512382, 11717, 236, 4, 45, "Subsubsection",ExpressionUUID->"5e96009e-5007-49e2-8847-c07056b6e160"],
Cell[512621, 11723, 3401, 86, 220, "Input",ExpressionUUID->"863208fe-7068-4f60-a4c9-3923efa2c871"],
Cell[516025, 11811, 1088, 28, 64, "Input",ExpressionUUID->"da4245de-11ad-4788-bb8a-a88592934a29"],
Cell[517116, 11841, 856, 22, 37, "Input",ExpressionUUID->"efa7712a-4297-459b-8f44-ceb1532c5500"],
Cell[517975, 11865, 678, 13, 37, "Input",ExpressionUUID->"c557dff3-5185-4089-884f-21d7efba1e8e"],
Cell[CellGroupData[{
Cell[518678, 11882, 606, 17, 37, "Input",ExpressionUUID->"b0a9db28-a31d-46ba-8416-1c45ad093c00"],
Cell[519287, 11901, 605, 12, 470, "Output",ExpressionUUID->"e6516cc6-dd56-4bd8-b042-bfd8d5fbb35d"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[519941, 11919, 215, 4, 45, "Subsubsection",ExpressionUUID->"ff33ea34-70ae-402a-be61-ed7adc31fe04"],
Cell[520159, 11925, 3453, 87, 220, "Input",ExpressionUUID->"a02657cb-3d8a-4b29-8429-124b47a58839"],
Cell[523615, 12014, 1088, 28, 64, "Input",ExpressionUUID->"7b68bab2-3e04-459b-8e16-32a10f126d2f"],
Cell[524706, 12044, 856, 22, 37, "Input",ExpressionUUID->"2540fc18-44fd-4077-b91e-30e8430a37a8"],
Cell[525565, 12068, 678, 13, 37, "Input",ExpressionUUID->"565e35bb-aa31-4f26-aefd-889b15e47fe0"],
Cell[CellGroupData[{
Cell[526268, 12085, 606, 17, 37, "Input",ExpressionUUID->"6c04867f-dab1-4d83-a6f2-eab36948ca0e"],
Cell[526877, 12104, 637, 12, 470, "Output",ExpressionUUID->"92859dd8-1bd5-49ee-990f-004f44ec5ee5"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[527563, 12122, 212, 4, 45, "Subsubsection",ExpressionUUID->"670cf7a0-243c-4bb3-915f-ef399aec3344"],
Cell[527778, 12128, 3387, 84, 220, "Input",ExpressionUUID->"12ab6c87-83a6-49d8-a8f1-185422e1c44a"],
Cell[531168, 12214, 1088, 28, 64, "Input",ExpressionUUID->"e4b33262-e0a5-450a-b310-f288223bb72d"],
Cell[532259, 12244, 856, 22, 37, "Input",ExpressionUUID->"3afefab7-32e0-4e02-a939-f58345ca1b80"],
Cell[533118, 12268, 727, 15, 37, "Input",ExpressionUUID->"b4df3cce-384f-4691-ae09-becd0652b386"],
Cell[CellGroupData[{
Cell[533870, 12287, 606, 17, 37, "Input",ExpressionUUID->"86a78462-f8e0-4d07-923e-521228f167b4"],
Cell[534479, 12306, 734, 14, 470, "Output",ExpressionUUID->"0dc90397-d625-45aa-abe7-feb4e02e12eb"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[535262, 12326, 264, 4, 45, "Subsubsection",ExpressionUUID->"325d8d1e-840f-4d0c-b109-16b74d640c18"],
Cell[535529, 12332, 808, 15, 90, "Input",ExpressionUUID->"6b0bbb70-2227-4eea-8c94-5d2d90c1871a"],
Cell[536340, 12349, 749, 21, 64, "Input",ExpressionUUID->"7de3a8b3-730f-4e09-8a56-0b354bf440d7"],
Cell[537092, 12372, 4867, 115, 324, "Input",ExpressionUUID->"39de57c6-935c-4430-86bf-619c93ecc3b9"],
Cell[541962, 12489, 837, 22, 64, "Input",ExpressionUUID->"7ae37542-d36d-40af-b1d5-4a9cc6a59d1f"],
Cell[CellGroupData[{
Cell[542824, 12515, 236, 5, 37, "Input",ExpressionUUID->"50fec267-23f8-4211-bf17-25af3794d9fb"],
Cell[543063, 12522, 2258, 47, 537, "Output",ExpressionUUID->"38fe61c5-9176-433f-b66d-2f99d4853c35"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[545370, 12575, 219, 4, 45, "Subsubsection",ExpressionUUID->"5b36b870-91a6-45e3-8a2d-4ce3fb2de28b"],
Cell[545592, 12581, 5300, 132, 79442, "Input",ExpressionUUID->"3c73f68d-9064-45d5-82de-da6f093fac08"],
Cell[CellGroupData[{
Cell[550917, 12717, 656, 18, 7684, "Input",ExpressionUUID->"db1550e1-a4f0-4c93-b678-00fafd58bdf5"],
Cell[551576, 12737, 1326, 24, 99310, "Output",ExpressionUUID->"49427b5e-654a-4489-981b-bf0d8365c6fb"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[552951, 12767, 265, 4, 45, "Subsubsection",ExpressionUUID->"f982916d-b932-44dc-baf9-50905808a369"],
Cell[553219, 12773, 5050, 122, 79442, "Input",ExpressionUUID->"8f537ed8-42eb-4b0c-bb95-791f7887c24e"],
Cell[CellGroupData[{
Cell[558294, 12899, 655, 18, 7684, "Input",ExpressionUUID->"dd905fec-3aa0-49d8-a220-50ca5752d0d4"],
Cell[558952, 12919, 967, 19, 94870, "Output",ExpressionUUID->"6704bf49-5e6b-4af4-bc04-43a68c20b466"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[559968, 12944, 314, 5, 45, "Subsubsection",ExpressionUUID->"37da7f79-1e2d-4c30-afb3-0d33661d9a20"],
Cell[560285, 12951, 5551, 138, 79442, "Input",ExpressionUUID->"268c19a1-5f25-463b-9e48-0d1559ee667a"],
Cell[CellGroupData[{
Cell[565861, 13093, 655, 18, 7684, "Input",ExpressionUUID->"b6f5cab2-2a6d-4814-966e-873671e96997"],
Cell[566519, 13113, 684, 14, 99310, "Output",ExpressionUUID->"04295853-bd2d-4def-b98e-63bd679aea65"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[567252, 13133, 365, 6, 45, "Subsubsection",ExpressionUUID->"6e44c868-3e80-447d-aa55-57e903fc5a9f"],
Cell[567620, 13141, 5609, 138, 79442, "Input",ExpressionUUID->"a6ca313b-0c35-46f1-accb-feb1a7fe7ce0"],
Cell[CellGroupData[{
Cell[573254, 13283, 655, 18, 7684, "Input",ExpressionUUID->"9cc7ca0c-ffe2-475d-974a-a240441ebdc6"],
Cell[573912, 13303, 954, 19, 99310, "Output",ExpressionUUID->"385d3bbf-26ac-4442-bb1f-7a1a32e0dd87"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[574915, 13328, 412, 6, 45, "Subsubsection",ExpressionUUID->"e9b1e95b-82fe-4b78-92e2-5595c41b650a"],
Cell[575330, 13336, 5254, 125, 79442, "Input",ExpressionUUID->"62b843b0-222d-47ae-9314-7d62de864fc1"],
Cell[CellGroupData[{
Cell[580609, 13465, 655, 18, 7684, "Input",ExpressionUUID->"254f88fd-0c92-4edd-a816-eb3579a82474"],
Cell[581267, 13485, 881, 18, 113512, "Output",ExpressionUUID->"9a5268f3-d5bf-4dd1-b0ea-670994b2588a"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[582197, 13509, 463, 7, 45, "Subsubsection",ExpressionUUID->"54112d84-e4a8-45ad-8029-103022b111da"],
Cell[582663, 13518, 5348, 126, 79442, "Input",ExpressionUUID->"31d48733-2014-4381-9b60-2489d69ba065"],
Cell[CellGroupData[{
Cell[588036, 13648, 655, 18, 7684, "Input",ExpressionUUID->"d8a96c6a-1928-4e76-baa8-a679915fb714"],
Cell[588694, 13668, 666, 13, 87270, "Output",ExpressionUUID->"151b10fe-17c0-47ca-bfbb-93ee03850f4c"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[589409, 13687, 512, 8, 45, "Subsubsection",ExpressionUUID->"440e3c92-8a36-4230-ae27-a7ab212fd7b1"],
Cell[589924, 13697, 5671, 134, 79442, "Input",ExpressionUUID->"3835584c-a354-4f07-9156-83ea8eaf1fa4"],
Cell[CellGroupData[{
Cell[595620, 13835, 655, 18, 7684, "Input",ExpressionUUID->"72bdc100-1db8-4198-b900-50e79224dc2c"],
Cell[596278, 13855, 1055, 19, 99310, "Output",ExpressionUUID->"f4206ca1-6144-44b1-ae15-969d6dfb33e9"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[597382, 13880, 165, 3, 45, "Subsubsection",ExpressionUUID->"425b798d-050c-4213-af4c-4350f2275346"],
Cell[597550, 13885, 5720, 140, 79442, "Input",ExpressionUUID->"7a0472ab-056b-4cc6-9281-b1b58067d67b"],
Cell[CellGroupData[{
Cell[603295, 14029, 655, 18, 7684, "Input",ExpressionUUID->"1b63fa8d-f02b-4526-845d-6d660d131c02"],
Cell[603953, 14049, 1030, 21, 94870, "Output",ExpressionUUID->"1baae7e2-5dcd-432e-8441-30fc8ca8a215"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[605032, 14076, 266, 4, 45, "Subsubsection",ExpressionUUID->"d242dc60-155f-4ead-8cd4-1ea52e31f8d6"],
Cell[605301, 14082, 5918, 143, 79442, "Input",ExpressionUUID->"fcf7ab20-b2c9-4ff9-866b-94e7d25aa387"],
Cell[CellGroupData[{
Cell[611244, 14229, 655, 18, 7684, "Input",ExpressionUUID->"1d8564ac-4add-49da-8794-ce5b5e3b5b49"],
Cell[611902, 14249, 950, 18, 62900, "Output",ExpressionUUID->"6a16f6c9-0b4b-46f9-b7fc-c7fc08cb756d"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[612901, 14273, 317, 5, 45, "Subsubsection",ExpressionUUID->"032f6b45-7a3e-4723-ae8a-f96633c0364e"],
Cell[613221, 14280, 5905, 142, 79442, "Input",ExpressionUUID->"fe184d55-e3c8-44ea-8747-85862dc9ed94"],
Cell[CellGroupData[{
Cell[619151, 14426, 655, 18, 7684, "Input",ExpressionUUID->"1e79d43f-8138-4fa0-b15f-2a29ce108c93"],
Cell[619809, 14446, 1114, 20, 99310, "Output",ExpressionUUID->"403a0c63-d170-4563-b883-e1c7a0d6c92c"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[620972, 14472, 368, 6, 45, "Subsubsection",ExpressionUUID->"2ec8b8b2-cfcb-40fc-9913-5a82ea1243f7"],
Cell[621343, 14480, 6248, 147, 79442, "Input",ExpressionUUID->"e2946f32-3711-43e5-86a7-004264061e52"],
Cell[CellGroupData[{
Cell[627616, 14631, 655, 18, 7684, "Input",ExpressionUUID->"68455884-9540-4759-b9c3-e41dcf78d14b"],
Cell[628274, 14651, 1255, 22, 86467, "Output",ExpressionUUID->"17a634f0-2671-4880-a2f7-f540fd33a2b9"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[629578, 14679, 420, 6, 45, "Subsubsection",ExpressionUUID->"d5e2d86e-92e5-4ccd-ba52-bea590b91757"],
Cell[630001, 14687, 6304, 150, 1156026, "Input",ExpressionUUID->"428cac86-1ce8-470c-a840-f1e1340dab63"],
Cell[CellGroupData[{
Cell[636330, 14841, 655, 18, 111806, "Input",ExpressionUUID->"fd64a93b-779e-45d1-bf53-7a41829841eb"],
Cell[636988, 14861, 1229, 22, 1258248, "Output",ExpressionUUID->"dad38e97-5f1c-46c7-bcbe-bdb29c5cb0b2"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[638266, 14889, 268, 4, 45, "Subsubsection",ExpressionUUID->"753b154f-77df-4e29-81bc-2608bcfecc5e"],
Cell[638537, 14895, 6117, 151, 1156026, "Input",ExpressionUUID->"26257dac-ef9b-49fd-9eb3-2c6e3b0bafe4"],
Cell[CellGroupData[{
Cell[644679, 15050, 655, 18, 111806, "Input",ExpressionUUID->"d509ae24-874d-41ff-9199-88435588b701"],
Cell[645337, 15070, 1006, 19, 1139854, "Output",ExpressionUUID->"d2b02c53-4f34-483e-b12b-8d3aed9eef65"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[646404, 15096, 364, 6, 67, "Subsection",ExpressionUUID->"f07e2766-5465-49ec-a9a5-e5b9df25eeea"],
Cell[CellGroupData[{
Cell[646793, 15106, 258, 4, 56, "Subsubsection",ExpressionUUID->"a0c5b497-5a34-47f7-a794-28316627340d"],
Cell[647054, 15112, 4124, 110, 272, "Input",ExpressionUUID->"3ca57537-98d7-428c-b566-9233df8682fe"],
Cell[651181, 15224, 606, 17, 37, "Input",ExpressionUUID->"0393895b-02cd-40e8-bd7d-71f2aea0d490"]
}, Open  ]],
Cell[CellGroupData[{
Cell[651824, 15246, 212, 4, 56, "Subsubsection",ExpressionUUID->"ca7b30dd-bc70-455e-8e74-014b56e6fdaa"],
Cell[652039, 15252, 3825, 107, 272, "Input",ExpressionUUID->"aa07e622-187a-4738-ac5f-1113df531772"],
Cell[CellGroupData[{
Cell[655889, 15363, 606, 17, 37, "Input",ExpressionUUID->"47e3fdef-0040-471d-a501-7b8819e2549e"],
Cell[656498, 15382, 896, 19, 298, "Output",ExpressionUUID->"8a061abc-2a23-4133-aff9-33c7c1dba977"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[657443, 15407, 260, 4, 45, "Subsubsection",ExpressionUUID->"8823070d-3f94-474f-bb2c-3752472b1d3f"],
Cell[657706, 15413, 4610, 126, 272, "Input",ExpressionUUID->"1f7aa43e-5f1b-49a8-b404-55355c4964b4"],
Cell[CellGroupData[{
Cell[662341, 15543, 606, 17, 37, "Input",ExpressionUUID->"b8c44ce5-70ea-408a-9708-297c436c7719"],
Cell[662950, 15562, 939, 19, 298, "Output",ExpressionUUID->"f28ac1ac-65be-4991-bdd7-d31bb99fb10c"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[663938, 15587, 314, 5, 45, "Subsubsection",ExpressionUUID->"79c2220a-f646-4186-8701-e090a44f709f"],
Cell[664255, 15594, 8163, 206, 402, "Input",ExpressionUUID->"3d64c287-679e-4010-a3c2-758532c8bc87"],
Cell[CellGroupData[{
Cell[672443, 15804, 606, 17, 37, "Input",ExpressionUUID->"511de29b-84db-4015-be0a-eadf7239750d"],
Cell[673052, 15823, 1098, 22, 298, "Output",ExpressionUUID->"308508b2-b567-4ca3-b86b-18e2498774c6"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[674199, 15851, 215, 4, 45, "Subsubsection",ExpressionUUID->"2b317b6e-3a6f-47e5-b9aa-8c1e9c2a259e"],
Cell[674417, 15857, 7226, 171, 402, "Input",ExpressionUUID->"8fd2c489-199b-458b-b761-ffa53706ff68"],
Cell[CellGroupData[{
Cell[681668, 16032, 606, 17, 37, "Input",ExpressionUUID->"92b87722-92c5-4126-b8de-2186b3d9787c"],
Cell[682277, 16051, 1366, 23, 470, "Output",ExpressionUUID->"30523bf3-a505-45e8-aff6-9f782dcffe1c"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[683692, 16080, 166, 3, 45, "Subsubsection",ExpressionUUID->"fc8f060b-1efd-44db-b88d-743b28485025"],
Cell[683861, 16085, 7079, 164, 402, "Input",ExpressionUUID->"495385b8-676a-495d-8736-254503ad8274"],
Cell[CellGroupData[{
Cell[690965, 16253, 606, 17, 37, "Input",ExpressionUUID->"586a4a79-b56c-4ac3-a371-612574f27ba8"],
Cell[691574, 16272, 957, 19, 413, "Output",ExpressionUUID->"8c7ce0d2-46b8-4172-af11-e21e6749cb5f"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[692580, 16297, 166, 3, 45, "Subsubsection",ExpressionUUID->"ad42fbb3-532a-4ecf-ad75-486c2bd01dab"],
Cell[692749, 16302, 7514, 176, 402, "Input",ExpressionUUID->"a7d9a7e2-e439-4a62-ba2c-ed82b30b7364"],
Cell[CellGroupData[{
Cell[700288, 16482, 606, 17, 37, "Input",ExpressionUUID->"06cad2af-fee0-4313-948b-210f816e1e27"],
Cell[700897, 16501, 966, 19, 470, "Output",ExpressionUUID->"b17535e4-6226-4cbd-a7d5-8edfac425c83"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[701912, 16526, 166, 3, 45, "Subsubsection",ExpressionUUID->"5676e7b5-6bfc-46e7-af28-f6f7bb47c897"],
Cell[702081, 16531, 7289, 168, 402, "Input",ExpressionUUID->"3afb0082-363e-420f-89b4-89d9f3002c83"],
Cell[CellGroupData[{
Cell[709395, 16703, 606, 17, 37, "Input",ExpressionUUID->"c4c2fd81-d63b-40c6-b020-05cca3ddf9ba"],
Cell[710004, 16722, 1084, 22, 449, "Output",ExpressionUUID->"a4d02d6f-d94a-4eff-875b-7fa6ab4e0e46"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[711149, 16751, 173, 3, 67, "Subsection",ExpressionUUID->"9435f51b-48f1-418a-ad45-e5e5eef206b1"],
Cell[CellGroupData[{
Cell[711347, 16758, 258, 4, 56, "Subsubsection",ExpressionUUID->"85fad600-926d-4828-a1f7-2558e1dbc0ec"],
Cell[711608, 16764, 8214, 212, 52870, "Input",ExpressionUUID->"8e7e5174-eb00-4a88-ae0b-d781ea205c8f"],
Cell[CellGroupData[{
Cell[719847, 16980, 2550, 44, 3148, "Input",ExpressionUUID->"7bf67a49-d512-4234-bd6d-b6c367804fea"],
Cell[722400, 17026, 1263, 24, 31407, "Output",ExpressionUUID->"ea206ea5-7b2a-401e-876e-c87b542d5878"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[723712, 17056, 309, 5, 45, "Subsubsection",ExpressionUUID->"4cb58fad-9cea-4a3e-9a7b-bc11b9f168d5"],
Cell[724024, 17063, 9117, 241, 210071, "Input",ExpressionUUID->"deeb5e4c-c6dc-407b-a817-cf870f51a96b"],
Cell[CellGroupData[{
Cell[733166, 17308, 2551, 44, 12006, "Input",ExpressionUUID->"58fdf1d6-9b1a-4a60-bf46-73cf3013f453"],
Cell[735720, 17354, 1743, 32, 73893, "Output",ExpressionUUID->"aa40dd92-8850-476f-98c0-5339c27255cd"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[737512, 17392, 168, 3, 45, "Subsubsection",ExpressionUUID->"ac44a345-2294-4691-8c04-81e621ed8cad"],
Cell[737683, 17397, 5473, 145, 141229, "Input",ExpressionUUID->"ef7f9a55-7935-406b-a046-4a9444d64cfa"],
Cell[CellGroupData[{
Cell[743181, 17546, 697, 19, 12006, "Input",ExpressionUUID->"69d7b4dd-50f5-45a5-80c8-b5f0902b7dbe"],
Cell[743881, 17567, 1847, 35, 153281, "Output",ExpressionUUID->"ce709fcf-3ffa-4221-a06b-5d97ab795d96"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[745777, 17608, 163, 3, 45, "Subsubsection",ExpressionUUID->"07d3162b-1869-47af-bcdf-df26b0778ca2"],
Cell[CellGroupData[{
Cell[745965, 17615, 9016, 240, 201681, "Input",ExpressionUUID->"5ca14681-2569-4620-8487-e8482184d7e8"],
Cell[754984, 17857, 1488, 27, 155171, "Output",ExpressionUUID->"20d9b1d6-dd80-4c40-800b-fbbcbac71e9c"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[756521, 17890, 262, 4, 45, "Subsubsection",ExpressionUUID->"f4a27504-f30b-4e97-8f9a-80341cf50fb4"],
Cell[756786, 17896, 3655, 99, 89892, "Input",ExpressionUUID->"1e11413d-a348-42a8-a11f-33d19ce17ff7"],
Cell[760444, 17997, 3193, 72, 64028, "Input",ExpressionUUID->"16e405d0-bbf6-43fe-bbe8-e9556b58f071"],
Cell[763640, 18071, 982, 27, 38085, "Input",ExpressionUUID->"6b0bd721-5b74-499c-9d09-02d088964f1f"],
Cell[764625, 18100, 1189, 30, 29425, "Input",ExpressionUUID->"32c9d034-e380-4c23-9e3d-8ff98364deba"],
Cell[CellGroupData[{
Cell[765839, 18134, 606, 17, 12006, "Input",ExpressionUUID->"33b1dd9d-8c26-4269-8501-6f9c536d0a2a"],
Cell[766448, 18153, 1726, 32, 98281, "Output",ExpressionUUID->"6808989f-b673-4ae0-aac3-8a551579bbb4"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[768223, 18191, 164, 3, 45, "Subsubsection",ExpressionUUID->"980f03cb-e69f-40f8-981a-e7f3cb25d5b9"],
Cell[768390, 18196, 10249, 274, 235942, "Input",ExpressionUUID->"664eac06-a9f2-4512-ab8e-c9cec7227129"],
Cell[CellGroupData[{
Cell[778664, 18474, 2550, 44, 12006, "Input",ExpressionUUID->"418dd248-0918-4cbd-acac-b89e38f748b3"],
Cell[781217, 18520, 2472, 44, 73893, "Output",ExpressionUUID->"664fa8ae-fe9d-4f7b-bb8e-5c301a2abf31"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[783738, 18570, 165, 3, 45, "Subsubsection",ExpressionUUID->"0fdf8fa7-ada2-4d6c-a23b-c9ed90f090c3"],
Cell[783906, 18575, 6182, 159, 25148, "Input",ExpressionUUID->"39d8500f-35d3-4d8f-aa25-d50dcbd0de40"],
Cell[CellGroupData[{
Cell[790113, 18738, 697, 19, 2015, "Input",ExpressionUUID->"5bb59c26-0729-4ed3-9d0b-20d88184a62d"],
Cell[790813, 18759, 3033, 54, 25717, "Output",ExpressionUUID->"d37150b2-f480-466f-ab29-2b890793dac7"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[793895, 18819, 166, 3, 45, "Subsubsection",ExpressionUUID->"84eca0d7-0c30-4a0f-a8be-a30fe0091af3"],
Cell[794064, 18824, 278, 6, 37, "Input",ExpressionUUID->"9e8db104-d5db-4802-aa59-3dad60dfb2c6"],
Cell[794345, 18832, 2900, 56, 132, "Input",ExpressionUUID->"ed480afc-666c-45ba-ab92-e974b15bfc01"],
Cell[797248, 18890, 2079, 55, 142, "Input",ExpressionUUID->"c9eb842f-3902-4b9f-9344-63b8a0d6e27d"],
Cell[799330, 18947, 731, 20, 64, "Input",ExpressionUUID->"8eaf1c6a-0cd3-4b80-99b6-6de104592716"],
Cell[800064, 18969, 304, 7, 37, "Input",ExpressionUUID->"fcb77d7b-7395-425f-8327-4108ccb4b714"],
Cell[800371, 18978, 2332, 70, 116, "Input",ExpressionUUID->"407413f4-09f9-43bf-9d2f-b90190ad84c9"],
Cell[CellGroupData[{
Cell[802728, 19052, 607, 17, 37, "Input",ExpressionUUID->"21e05149-e999-4bc0-836c-92e1e587e4af"],
Cell[803338, 19071, 1591, 28, 476, "Output",ExpressionUUID->"fcdf1601-46f7-4c23-81d6-58472cec140e"]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[805002, 19107, 259, 5, 84, "Section",ExpressionUUID->"f0b723d7-8119-4c62-9d49-00b5482a1b6a"],
Cell[805264, 19114, 671, 14, 37, "Input",ExpressionUUID->"f8cffd12-2590-48e1-a2f6-8f7ae5bec112"],
Cell[805938, 19130, 1234, 24, 37, "Input",ExpressionUUID->"8f0629c7-6347-4832-813a-7cab746230f3"],
Cell[807175, 19156, 390, 11, 37, "Input",ExpressionUUID->"24d95e43-d828-490b-8e15-201ef0eb586e"],
Cell[807568, 19169, 4614, 104, 298, "Input",ExpressionUUID->"84851f28-ba6f-493f-ac94-589413a26365"],
Cell[812185, 19275, 217, 4, 37, "Input",ExpressionUUID->"de078f73-7694-44d4-ae26-9395df62d5fb"],
Cell[812405, 19281, 990, 26, 37, "Input",ExpressionUUID->"2a89485d-dece-49a9-b65b-c068a8d640ae"]
}, Closed]],
Cell[CellGroupData[{
Cell[813432, 19312, 185, 3, 65, "Section",ExpressionUUID->"ce79603b-0909-4f3f-b6ce-9740c8e4f714"],
Cell[813620, 19317, 298, 8, 37, "Input",ExpressionUUID->"8881e4bc-7329-430f-b788-c74691953045"],
Cell[813921, 19327, 583, 13, 37, "Input",ExpressionUUID->"cb3ddc6f-4eca-4503-906a-7122d838dea2"],
Cell[814507, 19342, 862, 19, 37, "Input",ExpressionUUID->"af2a9886-d912-4f57-a4a2-91ef2cd06d57"]
}, Closed]],
Cell[CellGroupData[{
Cell[815406, 19366, 505, 8, 65, "Section",ExpressionUUID->"6c669723-35c0-4499-8e5c-22cbe2e036ff"],
Cell[815914, 19376, 540, 16, 37, "Input",ExpressionUUID->"c7f01c73-c6d7-4c5f-bf9c-177fca81cf0e"],
Cell[816457, 19394, 1766, 44, 142, "Input",ExpressionUUID->"fbe3e047-4952-4ae6-beb2-22b9a2237ed8"],
Cell[818226, 19440, 3193, 68, 220, "Input",ExpressionUUID->"7ae43432-6220-41f6-b89b-98226f7a174b"],
Cell[CellGroupData[{
Cell[821444, 19512, 857, 14, 37, "Input",ExpressionUUID->"63b9b634-42ab-48a9-b883-f371e4be2c1c"],
Cell[822304, 19528, 315, 7, 42, "Output",ExpressionUUID->"2334e712-b8a1-49cc-abdf-8a619151b96f"]
}, Open  ]],
Cell[822634, 19538, 536, 13, 37, "Input",ExpressionUUID->"71dacd8c-96e0-4355-aa3f-246cbd861715"],
Cell[823173, 19553, 1682, 44, 142, "Input",ExpressionUUID->"67e3d0fb-2c44-4184-b8e4-a11d531df6cd"],
Cell[824858, 19599, 2547, 72, 116, "Input",ExpressionUUID->"53e8e83c-98d6-432e-8425-baadf2b1aa55"],
Cell[827408, 19673, 977, 29, 64, "Input",ExpressionUUID->"300870c9-7188-46e0-bfb2-f30184059c1b"],
Cell[828388, 19704, 1558, 38, 116, "Input",ExpressionUUID->"b5635eb8-f280-46e1-b385-25b07a035a2b"],
Cell[829949, 19744, 677, 15, 64, "Input",ExpressionUUID->"8f44f503-fe0c-42d6-8262-266d2d5f4e24"],
Cell[830629, 19761, 3187, 83, 272, "Input",ExpressionUUID->"bd479ab5-8b22-426e-85cc-cb5687f31e66"],
Cell[833819, 19846, 814, 20, 90, "Input",ExpressionUUID->"7bd737c9-f36d-4601-9600-1c6aac77d024"],
Cell[834636, 19868, 1245, 33, 116, "Input",ExpressionUUID->"e78dd254-fe82-468e-95d0-597bcbe1547a"],
Cell[835884, 19903, 484, 13, 37, "Input",ExpressionUUID->"da5756a9-bb08-4398-8213-a8aaff391d28"],
Cell[836371, 19918, 805, 20, 90, "Input",ExpressionUUID->"d096a26a-a95c-40ea-979b-8bb4d79f1e2c"],
Cell[837179, 19940, 702, 17, 64, "Input",ExpressionUUID->"15fd2fc3-a3ba-4e0f-874e-52d05d5ecbf5"],
Cell[CellGroupData[{
Cell[837906, 19961, 124, 2, 37, "Input",ExpressionUUID->"eae05402-2aaa-48d8-bf55-c4b5ece6eea6"],
Cell[838033, 19965, 221, 4, 42, "Output",ExpressionUUID->"d4d284b4-1bf5-44b8-b392-40be4aab7fdb"]
}, Open  ]],
Cell[838269, 19972, 829, 23, 37, "Input",ExpressionUUID->"96ea015a-1382-4680-94c2-2f3d4347d19d"],
Cell[839101, 19997, 2706, 69, 168, "Input",ExpressionUUID->"1a735156-1a0b-4843-8b5e-799d5efa773a"],
Cell[CellGroupData[{
Cell[841832, 20070, 2240, 65, 142, "Input",ExpressionUUID->"e3f88ad9-a776-4d26-b9c0-befabeda5a98"],
Cell[844075, 20137, 472, 11, 35, "Message",ExpressionUUID->"79850675-f946-42bb-9578-7fa17951608e"],
Cell[844550, 20150, 332, 8, 42, "Output",ExpressionUUID->"9cf46acb-6fc2-40fe-8b9f-519116d721bf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[844919, 20163, 151, 3, 67, "Subsection",ExpressionUUID->"39b116eb-a0a3-45a3-9f81-a4f34663cdd3"],
Cell[845073, 20168, 312, 8, 37, "Input",ExpressionUUID->"e68b715f-69ea-45e1-8e41-403b1a5a60cc"],
Cell[845388, 20178, 1189, 29, 142, "Input",ExpressionUUID->"f15ca24f-5530-412b-9ede-71a7f123da2f"],
Cell[CellGroupData[{
Cell[846602, 20211, 187, 3, 37, "Input",ExpressionUUID->"1246cc0d-75ec-4133-93c4-658b810da050"],
Cell[846792, 20216, 158, 3, 42, "Output",ExpressionUUID->"1f1cc08b-0f5e-4169-b704-f27dc9685e98"]
}, Open  ]],
Cell[CellGroupData[{
Cell[846987, 20224, 182, 3, 37, "Input",ExpressionUUID->"e854eea8-40a2-43d1-8011-b6eac919036a"],
Cell[847172, 20229, 260, 7, 42, "Output",ExpressionUUID->"70d14128-6793-433e-9d6b-eacb42d251bc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[847469, 20241, 190, 3, 37, "Input",ExpressionUUID->"2837ccb3-0146-46d2-bc52-ff371cbec05c"],
Cell[847662, 20246, 178, 4, 42, "Output",ExpressionUUID->"f69659b3-b889-4d59-be6e-b67d8a2e68f1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[847877, 20255, 3616, 90, 350, "Input",ExpressionUUID->"6ef689cf-3da9-4705-84f5-62eb5a006488"],
Cell[851496, 20347, 294, 7, 42, "Output",ExpressionUUID->"6cee2245-ad81-477b-8f93-e6d3e5e44d4e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[851827, 20359, 190, 3, 37, "Input",ExpressionUUID->"4ec4c834-c251-4f5b-b405-b92b582f3ddb"],
Cell[852020, 20364, 257, 4, 42, "Output",ExpressionUUID->"86263b09-6116-4fc9-a757-413666e30b8e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[852314, 20373, 181, 3, 37, "Input",ExpressionUUID->"70d545b2-6274-470f-9ef6-3ac329449568"],
Cell[852498, 20378, 339, 8, 42, "Output",ExpressionUUID->"67203c76-aa80-4b32-bec6-e3a27b3ef6aa"]
}, Open  ]],
Cell[852852, 20389, 4049, 102, 428, "Input",ExpressionUUID->"ffbc023d-af28-48d1-89e7-201d6c7b2587"],
Cell[856904, 20493, 4082, 103, 428, "Input",ExpressionUUID->"bd22482b-9e61-400c-9745-5e7209e834ba"],
Cell[860989, 20598, 597, 17, 37, "Input",ExpressionUUID->"6c690b3f-0cf1-4e74-b2a2-6409155b6ddb"],
Cell[861589, 20617, 2468, 66, 168, "Input",ExpressionUUID->"cc5433ea-cb75-4490-87e8-6c54dfd478ad"]
}, Open  ]],
Cell[CellGroupData[{
Cell[864094, 20688, 186, 3, 67, "Subsection",ExpressionUUID->"73659359-4b4f-45f9-baba-09fc1e7d8432"],
Cell[864283, 20693, 9614, 230, 584, "Input",ExpressionUUID->"fdb6868b-dedf-4552-bbc8-7b3ac43318e5"],
Cell[873900, 20925, 3155, 84, 246, "Input",ExpressionUUID->"920bde13-e842-4607-ad1d-77126b17c208"],
Cell[877058, 21011, 839, 23, 64, "Input",ExpressionUUID->"abe65978-29eb-4c7f-b118-6aa43c19b55f"],
Cell[CellGroupData[{
Cell[877922, 21038, 475, 11, 64, "Input",ExpressionUUID->"e011f94b-71b4-4b53-8793-e089845a6f6c"],
Cell[878400, 21051, 842, 25, 109, "Output",ExpressionUUID->"6d4446ee-3a31-4bdc-9f42-26aec0d4ead5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[879279, 21081, 242, 4, 37, "Input",ExpressionUUID->"e1840103-9ffb-44f9-8fe9-76aa855e679c"],
Cell[879524, 21087, 978, 32, 109, "Output",ExpressionUUID->"90602025-e0ef-4431-842d-bc8e7bf713fa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[880539, 21124, 1690, 40, 37, "Input",ExpressionUUID->"b3d14784-fe95-468b-a8b8-a771e8abdcb1"],
Cell[882232, 21166, 808, 12, 342, "Print",ExpressionUUID->"25260b2e-4c7d-48a0-9eea-0bd742f7f86c"]
}, Open  ]],
Cell[883055, 21181, 2567, 68, 194, "Input",ExpressionUUID->"194d79d2-1fe0-4997-9363-e3a26f2f5e7c"],
Cell[885625, 21251, 374, 8, 37, "Input",ExpressionUUID->"1f0834f3-2b35-4c84-ac57-1e97a2b70473"],
Cell[886002, 21261, 339, 7, 37, "Input",ExpressionUUID->"1e984d87-e459-4457-85dc-abd77ac5995d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[886378, 21273, 173, 3, 67, "Subsection",ExpressionUUID->"5d23382b-03be-4f63-ae04-4ed987fcb65f"],
Cell[886554, 21278, 749, 20, 37, "Input",ExpressionUUID->"cc5203e1-13d7-431e-9c8a-2de9c6c4ab04"],
Cell[887306, 21300, 668, 15, 64, "Input",ExpressionUUID->"1261eaa4-141f-441f-94ff-d88e8439cfa7"],
Cell[887977, 21317, 534, 14, 37, "Input",ExpressionUUID->"72cea291-e097-4d6f-b187-88b47c817c2b"],
Cell[888514, 21333, 378, 9, 37, "Input",ExpressionUUID->"c6be9fea-96bd-4239-a460-df5131e56552"],
Cell[888895, 21344, 21169, 513, 1676, "Input",ExpressionUUID->"32fc25f9-11a6-4018-b346-f45a98b95fda"]
}, Open  ]],
Cell[CellGroupData[{
Cell[910101, 21862, 186, 3, 67, "Subsection",ExpressionUUID->"d9d2bc1f-1b92-458f-8962-7d5061100461"],
Cell[910290, 21867, 304, 8, 37, "Input",ExpressionUUID->"afda7ec1-7351-4331-ae84-6ea4588a0b35"],
Cell[CellGroupData[{
Cell[910619, 21879, 255, 6, 37, "Input",ExpressionUUID->"8848d55a-212b-442f-9819-b0868b8ed8ae"],
Cell[910877, 21887, 211, 5, 42, "Output",ExpressionUUID->"4f8e428b-20b5-416a-938b-7d810b360d18"]
}, Open  ]],
Cell[CellGroupData[{
Cell[911125, 21897, 378, 10, 37, "Input",ExpressionUUID->"85cf07cd-87d9-4dba-8718-9f2517644660"],
Cell[911506, 21909, 235, 5, 42, "Output",ExpressionUUID->"c70b4bd2-92fb-437d-a737-1efbba1eef23"]
}, Open  ]],
Cell[CellGroupData[{
Cell[911778, 21919, 498, 14, 37, "Input",ExpressionUUID->"a722f966-398c-400a-8343-0f8b01f59c0d"],
Cell[912279, 21935, 273, 6, 42, "Output",ExpressionUUID->"53809d84-4e79-4fd3-b0eb-d379fac17ad1"]
}, Open  ]],
Cell[912567, 21944, 514, 14, 90, "Input",ExpressionUUID->"45ae485a-c34e-4cdf-8d6e-91662c1c3dce"],
Cell[913084, 21960, 3748, 81, 558, "Input",ExpressionUUID->"de9ee849-4566-43aa-befa-eaa187fe8dac"],
Cell[CellGroupData[{
Cell[916857, 22045, 225, 4, 37, "Input",ExpressionUUID->"b17aaf81-28f1-4092-a1d4-8df3686d570a"],
Cell[917085, 22051, 275, 7, 42, "Output",ExpressionUUID->"88af66c3-fb87-4261-9958-d451b78ad15d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[917397, 22063, 152, 3, 37, "Input",ExpressionUUID->"9d3e1edd-bad2-42b2-91fa-f71655e76063"],
Cell[917552, 22068, 1814, 28, 69, "Output",ExpressionUUID->"8ce1bc48-fb9f-44b9-8dbf-aff0a888e00b"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

