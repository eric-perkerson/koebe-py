\documentclass{article}

\usepackage{
	graphicx,
	fullpage,
	amsmath,
	amssymb,
}
\usepackage[parfill]{parskip}
\usepackage[ruled]{algorithm2e}

\newcommand{\problem}[2][]{ \vspace{10pt}{\Large \bf{Problem #2} } {\em #1} \\ \vspace{0pt}}
\newcommand{\subproblem}[2][]{ \vspace{10pt} {\large \bf{#2} } {\em #1} \\ }

\DeclareMathOperator*{\geo}{\text{geo}}

\newcommand{\solutions}[5]{
	\begin{center}
	{
		\small  #1 #2
		\hfill {\Large \bf {Eric Perkerson} }\\ \vspace{.5pt}
		#3 \hfill
		{
			 Date: #5
		}
	} \\
	\vspace{-1ex}
	\hrulefill\\
	\vspace{4ex}
	{
		\LARGE Uniformization of Annuli via an Algorithmic Construction of a Harmonic Conjugate Function
	} \\
	\vspace{20pt}
	\end{center}
}

\begin{document}

\solutions{}{}{}{1}{\today}

\section{Introduction}

\section{Mathematical Background}

\section{Construction of the Harmonic Function}

\section{Construction of the Slit}

Notation: let $[a : b] := \{ z \in \mathbb{Z} \colon a \le z \le b \}$.

Given a region $R \subset \mathbb{R}^2$ which is a topological annulus, we construct a triangulation $T = (T_0, T_1, T_2)$ where $T_0 = (v_0, v_1, \dots, v_{n_v - 1})$ is a tuple of triangulation vertices $v_i \in \mathbb{R}^2$, $T_1 = (e_0, e_1, \dots, e_{n_e - 1})$ is a tuple of triangulation edges $e_i \in T_0 \times T_0$, and $T_2 = (t_0, t_1, \dots, t_{n_t - 1})$ is a tuple of triangles $t_i \in T_0 \times T_0 \times T_0$. The triangulation is constructed to be acute, meaning that for all $i$, $t_i \in T_2$ is an acute triangle.

We also construct the Voronoi tesselation $\Lambda = (\Lambda_0, \Lambda_1, \Lambda_2)$ dual to the (Delaunay) triangulation, where $\Lambda_0 = (\nu_0, \nu_1, \dots, \nu_{n_\nu - 1})$ is a tuple of the Voronoi vertices $\nu_i \in \mathbb{R}^2$, $\Lambda_1 = (\varepsilon_0, \varepsilon_1, \dots, \varepsilon_{n_\varepsilon - 1})$ is a tuple of the Voronoi edges $\varepsilon_i \in \Lambda_0 \times \Lambda_0$, and $\Lambda_2 = (\rho_0, \rho_1, \dots, \rho_{n_t - 1})$ is a tuple of the Voronoi polygons $\rho_i \in (\Lambda_0) \cup (\Lambda_0 \times \Lambda_0) \cup \dots \cup (\Lambda_0 \times \dots_{V\text{-times}} \times \Lambda_0)$ where $V$ is the maximum number of vertices of the constructed polygons. Duality means that each polygon $\rho_i$ corresponds to triangle $t_i \in T_2$.

Quite often, we will limit attention to the contained Voronoi tesselation $\tilde{\Lambda} = (\tilde{\Lambda}_0, \tilde{\Lambda}_1, \tilde{\Lambda}_2)$, where we only keep polygons $\tilde{\Lambda}_2 = \{ \rho_i \in \Lambda_2 \colon \geo(\rho_i) \subseteq R \}$, and we only keep the necessary vertices and edges of $\Lambda_0$ and $\Lambda_1$ in order to compose the polygons in $\tilde{\Lambda}_2$, i.e. if a vertex $\nu_i$ only appears in a non-contained polygon $\rho \in \tilde{\Lambda_2} \setminus \Lambda_2$ then it will not be contained in $\tilde{\Lambda_0}$, and similarly with edges to form $\tilde{\Lambda_1}$. Note that the contained polygons $\tilde{\Lambda}_2$ correspond to the interior vertices of $T_0$. Since $\tilde{\Lambda}_2 \subseteq \Lambda_2$ if they are regarded as sets rather than tuples, we can define a reindexing map $h \colon [1 \colon n_\rho] \to [1 \colon n_t]$ defined by $h(i) = j$ if $v_i \in \geo(\rho_i)$, i.e. $h$ maps the index in the contained polygons $\tilde{\Lambda}_2$ to the index of that polygon in the original tuple of polygons $\Lambda_2$.

Next, we solve the PDE $g$ on the triangulation vertices $T_0$.

Now, we arbitrarily choose a base cell from the contained vertices, denoted by $\rho_\omega \in \tilde{\Lambda_2}$. If desired, this can be done by choosing a base point $p_\omega \in R$ and then choosing the base cell to be the contained cell $\rho_\omega \in \tilde{\Lambda_2}$ such that $\geo(\rho_\omega) \ni p_\omega$. This will not always work, since typically $\geo(\tilde{\Lambda}_2) := \cup_{\rho \in \tilde{\Lambda}_2} \{ \geo(\rho) \} \subsetneq R$, but if the triangulation is refined enough it will generally cause $\geo(\tilde{\Lambda}_2)$ to approach $R$.

We now use the base cell to begin constructing topological slit of the annulus. Choose an arbitrary point $h \in \mathbb{R}^2$ in the hole of the annulus $R$. This ``point in the hole'' of $R$ will serve the role of the origin in defining an angle measure on $R$. To this end, we take the triangular vertex $v_\omega$ corresponding to the base cell $\rho_\omega$ and construct the ray $r_0 = \overrightarrow{h v_\omega}$.

Using the ray $r$, we construct a slit path of Voronoi cells $S_\rho$ in $\tilde{\Lambda}_2$ by the following constructive algorithm:
\begin{enumerate}
	\item Given: Voronoi polygon topology $A_\rho$, the index of the base cell $\omega$, the ray $r$ defining the slit of the plane.
	\item First, we construct the outward component of the cell path slit.
	\item Initialize $p = \omega$.
	\item (1) For \texttt{edge} in \texttt{edges}$(p)$:
	if \texttt{edge} intersects $r$ with a positive orientation, then update $p \leftarrow A_\rho[p, \texttt{edge}]$. If $p \ne -1$, goto step (1).
	\item Finally, we perform a similar process to construct the inward component of the cell path slit, reversing the orientation of the intersection being searched for. Now the two components can be appropriately concatenated to form the entire cell path slit from inner boundary to outer boundary.
\end{enumerate}

\begin{algorithm}%[H]
	\SetAlgoLined
	\LinesNumbered
	\DontPrintSemicolon
	\SetArgSty{textnormal}
	\KwIn{Voronoi polygon topology $A_\rho$, the index of the base cell $\omega$, the ray $r$ defining the slit of the plane}
	\KwOut{The slit path}
	$p \leftarrow \omega$\;
	f = solve\_pdf(T)\;
	% $\Lambda$ = build\_lambda(T)\;
	singular\_vertex = find\_singular\_vertex(T)\;
	singular\_height = f(singular\_vertex)\;
	singular\_level\_curve = compute\_level\_curve(T, singular\_height)\;
	\caption{Algorithm to Compute the Slit Cell Path}
\end{algorithm}

Note: it is simpler (and avoids a possible issue with having the base cell not in the first connected component of the cells intersected by the ray $r$) to restrict the selection of the base cell $\rho_\omega$ to the cells with are hit first by the ray $r$.

\section{Computation of the Harmonic Conjugate}

The harmonic conjugate function $g^*$ is approximated by the combinatorial harmonic conjugate function $g^*_n$ which is initially defined on $\Lambda_0$. For each $\omega \in \Lambda_0$, we compute a discrete path $\gamma$ from $\omega_0$ to $\omega$, represented as a list where the first element $\gamma_0$ is $\omega_0$ and the last element $\gamma_{n_\gamma}$ is $\omega$, where $n_\gamma$ is the number of elements of the path. To be a path, $\gamma$ must have $(\gamma_i, \gamma_{i + 1}) \in \Lambda_1$ or $(\gamma_{i + 1}, \gamma_i) \in \Lambda_1$ for all $i = 1, 2, \dots, n_\gamma - 1$. The path $\gamma$ is computed by constructing a weighted graph where the edges of $\Lambda_1$ that intersect the slit have weight infinity, and then finding the shortest path from $\omega_0$ to $\omega$ on the path. Since $\omega_0$ was chosen to have the smallest angle of all $\omega \in \lambda_0$, this ensures that the path $\gamma$ is counter-clockwise in the sense that $\theta(\omega) > \theta(\omega_0)$, where $\theta$ is the angle of the point with respect to the slit. The function that computes this path will be denoted \texttt{shortest\_cck\_path}, since it computes the shortest counter-clockwise path from $\omega_0$ to $\omega$.

To compute the values of the harmonic conjugate function $g^*$ on each $\omega \in \Lambda_0$, we need to compute the flux contributing edges along the path $\gamma = \texttt{shortest\_cck\_path} (\omega_0, \omega)$. For each edge $e \in \Lambda_0 \times \Lambda_0$ in the path $\gamma$, we compute the perpendicular edge $e^\perp \in T_0 \times T_0$. This can be quickly computed using the information stored in the topology objects. The perpendicular edges $\gamma^\perp = \{ e^\perp_i \}_{i = 1}^{n_\gamma}$ corresponding to the edges $\gamma = \{ e_i \}_{i = 1}^{n_\gamma}$ are the flux contributing edges for the path $\gamma$.

The flux itself gives the value $g^* (\omega)$, and is computed given the flux contributing edges $\gamma^\perp$ by the formula:
\[
	\sum_{e^\perp \in \gamma^\perp} c(e^\perp) | g(e^\perp_0) - g(e^\perp_1) |
\]
Note that this formula for the flux uses the absolute value of the difference in $g$ along the edge $e^\perp$ to avoid the unnecessary step of orienting all of the flux contributing edges in the same way. Recall that $c$ denotes the conductance of an edge.

\begin{algorithm}%[H]
	\SetAlgoLined
	\LinesNumbered
	\DontPrintSemicolon
	\SetArgSty{textnormal}
	\KwIn{$\Lambda_0$}
	\KwOut{A function $g^*_n$ defined on the indices $\omega \in \Lambda_0$}
	$g^*_n (\omega) \leftarrow 0$\;
	\For{$\omega \in \Lambda_0$}{
		$\gamma$ = \texttt{shortest\_cck\_path}($\omega_0$, $\omega$)\;
		\For{$e \in \gamma$}{
			$e^\perp$ = \texttt{perpendicular\_edge}($e$)\;
			$g^*_n (\omega) \leftarrow g^*_n (\omega) + c(e^\perp) |g(e^\perp_0) - g(e^\perp_1)|$\;
		}
	\Return{$g^*_n$}
	}
	\caption{Algorithm to Compute the Discrete Harmonic Conjugate on $\Lambda_0$}
\end{algorithm}

\section{Computation of the Period}



\section{Construction of the Uniformizing Function}

Linear interpolation of the harmonic function $g$, which is defined on $T_0$, using barycentric average to define an interpolated $g$ defined on $\Lambda_0$

\section{Previous Work and Numerical Results}

\end{document}
